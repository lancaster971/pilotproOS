import{d as Pe,A as Rs,C as Zt,D as zs,E as De,G as Zi,c as qi,e as O,f as $,m as j,H as ct,y as qe,g as d,l as M,J as ze,r as ge,K as W,o as dt,n as ye,L as Ki,M as qt,N as ji,O as Nn,P as Ji,F as xe,z as Me,Q as Ye,R as ot,S as Bs,h as we,T as Qi,k as Ie,U as An,t as V,V as Po,W as er,X as tr,Y as Gt,Z as Et,$ as Ae,a0 as Ne,a1 as nr,q as Nt,a2 as or,a3 as We,a4 as Cn,a5 as sr,I as be,_ as Yn,a6 as Ls,a7 as ir,w as rr,a8 as lr,u as ar,a9 as cr}from"./index-B3p8Zp6V.js";import{M as ur}from"./MainLayout-T3D1Ki1p.js";import{s as Rt,a as zt}from"./index-BpeNG2h-.js";import{b as et,$ as dr}from"./api-client-CB8UOio5.js";import{T as fr,D as gr}from"./TimelineModal-DQnBmgBw.js";import"./settings-B5YbfqJu.js";function an(e){return Rs()?(Nn(e),!0):!1}function mt(e){return typeof e=="function"?e():M(e)}const pr=typeof window<"u"&&typeof document<"u",hr=e=>typeof e<"u",mr=Object.prototype.toString,vr=e=>mr.call(e)==="[object Object]",yr=()=>{};function wr(e,t){function n(...o){return new Promise((s,i)=>{Promise.resolve(e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})).then(s).catch(i)})}return n}const Vs=e=>e();function xr(e=Vs){const t=ge(!0);function n(){t.value=!1}function o(){t.value=!0}const s=(...i)=>{t.value&&e(...i)};return{isActive:sr(t),pause:n,resume:o,eventFilter:s}}function Uo(e,t=!1,n="Timeout"){return new Promise((o,s)=>{setTimeout(t?()=>s(n):o,e)})}function _r(e,t,n={}){const{eventFilter:o=Vs,...s}=n;return De(e,wr(o,t),s)}function Bt(e,t,n={}){const{eventFilter:o,...s}=n,{eventFilter:i,pause:r,resume:l,isActive:a}=xr(o);return{stop:_r(e,t,{...s,eventFilter:i}),pause:r,resume:l,isActive:a}}function br(e,t={}){if(!Po(e))return er(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const o in e.value)n[o]=tr(()=>({get(){return e.value[o]},set(s){var i;if((i=mt(t.replaceRef))!=null?i:!0)if(Array.isArray(e.value)){const l=[...e.value];l[o]=s,e.value=l}else{const l={...e.value,[o]:s};Object.setPrototypeOf(l,Object.getPrototypeOf(e.value)),e.value=l}else e.value[o]=s}}));return n}function yo(e,t=!1){function n(p,{flush:f="sync",deep:m=!1,timeout:S,throwOnTimeout:g}={}){let h=null;const P=[new Promise(k=>{h=De(e,y=>{p(y)!==t&&(h?.(),k(y))},{flush:f,deep:m,immediate:!0})})];return S!=null&&P.push(Uo(S,g).then(()=>mt(e)).finally(()=>h?.())),Promise.race(P)}function o(p,f){if(!Po(p))return n(y=>y===p,f);const{flush:m="sync",deep:S=!1,timeout:g,throwOnTimeout:h}=f??{};let C=null;const k=[new Promise(y=>{C=De([e,p],([I,U])=>{t!==(I===U)&&(C?.(),y(I))},{flush:m,deep:S,immediate:!0})})];return g!=null&&k.push(Uo(g,h).then(()=>mt(e)).finally(()=>(C?.(),mt(e)))),Promise.race(k)}function s(p){return n(f=>!!f,p)}function i(p){return o(null,p)}function r(p){return o(void 0,p)}function l(p){return n(Number.isNaN,p)}function a(p,f){return n(m=>{const S=Array.from(m);return S.includes(p)||S.includes(mt(p))},f)}function c(p){return u(1,p)}function u(p=1,f){let m=-1;return n(()=>(m+=1,m>=p),f)}return Array.isArray(mt(e))?{toMatch:n,toContains:a,changed:c,changedTimes:u,get not(){return yo(e,!t)}}:{toMatch:n,toBe:o,toBeTruthy:s,toBeNull:i,toBeNaN:l,toBeUndefined:r,changed:c,changedTimes:u,get not(){return yo(e,!t)}}}function wo(e){return yo(e)}function Er(e){var t;const n=mt(e);return(t=n?.$el)!=null?t:n}const Fs=pr?window:void 0;function Hs(...e){let t,n,o,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,o,s]=e,t=Fs):[t,n,o,s]=e,!t)return yr;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const i=[],r=()=>{i.forEach(u=>u()),i.length=0},l=(u,p,f,m)=>(u.addEventListener(p,f,m),()=>u.removeEventListener(p,f,m)),a=De(()=>[Er(t),mt(s)],([u,p])=>{if(r(),!u)return;const f=vr(p)?{...p}:p;i.push(...n.flatMap(m=>o.map(S=>l(u,m,S,f))))},{immediate:!0,flush:"post"}),c=()=>{a(),r()};return an(c),c}function kr(e){return typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0}function Xo(...e){let t,n,o={};e.length===3?(t=e[0],n=e[1],o=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,n=e[0],o=e[1]):(t=e[0],n=e[1]):(t=!0,n=e[0]);const{target:s=Fs,eventName:i="keydown",passive:r=!1,dedupe:l=!1}=o,a=kr(t);return Hs(s,i,u=>{u.repeat&&mt(l)||a(u)&&n(u)},r)}function Sr(e){return JSON.parse(JSON.stringify(e))}function io(e,t,n,o={}){var s,i,r;const{clone:l=!1,passive:a=!1,eventName:c,deep:u=!1,defaultValue:p,shouldEmit:f}=o,m=qt(),S=n||m?.emit||((s=m?.$emit)==null?void 0:s.bind(m))||((r=(i=m?.proxy)==null?void 0:i.$emit)==null?void 0:r.bind(m?.proxy));let g=c;t||(t="modelValue"),g=g||`update:${t.toString()}`;const h=k=>l?typeof l=="function"?l(k):Sr(k):k,C=()=>hr(e[t])?h(e[t]):p,P=k=>{f?f(k)&&S(g,k):S(g,k)};if(a){const k=C(),y=ge(k);let I=!1;return De(()=>e[t],U=>{I||(I=!0,y.value=h(U),ot(()=>I=!1))}),De(y,U=>{!I&&(U!==e[t]||u)&&P(U)},{deep:u}),y}else return W({get(){return C()},set(k){P(k)}})}var Nr={value:()=>{}};function Wn(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new $n(n)}function $n(e){this._=e}function Cr(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",s=n.indexOf(".");if(s>=0&&(o=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}$n.prototype=Wn.prototype={constructor:$n,on:function(e,t){var n=this._,o=Cr(e+"",n),s,i=-1,r=o.length;if(arguments.length<2){for(;++i<r;)if((s=(e=o[i]).type)&&(s=$r(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<r;)if(s=(e=o[i]).type)n[s]=Zo(n[s],e.name,t);else if(t==null)for(s in n)n[s]=Zo(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $n(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),o=0,s,i;o<s;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,s=i.length;o<s;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,i=o.length;s<i;++s)o[s].value.apply(t,n)}};function $r(e,t){for(var n=0,o=e.length,s;n<o;++n)if((s=e[n]).name===t)return s.value}function Zo(e,t,n){for(var o=0,s=e.length;o<s;++o)if(e[o].name===t){e[o]=Nr,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var xo="http://www.w3.org/1999/xhtml";const qo={svg:"http://www.w3.org/2000/svg",xhtml:xo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Un(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),qo.hasOwnProperty(t)?{space:qo[t],local:e}:e}function Ir(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xo&&t.documentElement.namespaceURI===xo?t.createElement(e):t.createElementNS(n,e)}}function Tr(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gs(e){var t=Un(e);return(t.local?Tr:Ir)(t)}function Mr(){}function Oo(e){return e==null?Mr:function(){return this.querySelector(e)}}function Dr(e){typeof e!="function"&&(e=Oo(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,l=o[s]=new Array(r),a,c,u=0;u<r;++u)(a=i[u])&&(c=e.call(a,a.__data__,u,i))&&("__data__"in a&&(c.__data__=a.__data__),l[u]=c);return new je(o,this._parents)}function Ar(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Pr(){return[]}function Ys(e){return e==null?Pr:function(){return this.querySelectorAll(e)}}function Or(e){return function(){return Ar(e.apply(this,arguments))}}function Rr(e){typeof e=="function"?e=Or(e):e=Ys(e);for(var t=this._groups,n=t.length,o=[],s=[],i=0;i<n;++i)for(var r=t[i],l=r.length,a,c=0;c<l;++c)(a=r[c])&&(o.push(e.call(a,a.__data__,c,r)),s.push(a));return new je(o,s)}function Ws(e){return function(){return this.matches(e)}}function Us(e){return function(t){return t.matches(e)}}var zr=Array.prototype.find;function Br(e){return function(){return zr.call(this.children,e)}}function Lr(){return this.firstElementChild}function Vr(e){return this.select(e==null?Lr:Br(typeof e=="function"?e:Us(e)))}var Fr=Array.prototype.filter;function Hr(){return Array.from(this.children)}function Gr(e){return function(){return Fr.call(this.children,e)}}function Yr(e){return this.selectAll(e==null?Hr:Gr(typeof e=="function"?e:Us(e)))}function Wr(e){typeof e!="function"&&(e=Ws(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,l=o[s]=[],a,c=0;c<r;++c)(a=i[c])&&e.call(a,a.__data__,c,i)&&l.push(a);return new je(o,this._parents)}function Xs(e){return new Array(e.length)}function Ur(){return new je(this._enter||this._groups.map(Xs),this._parents)}function Pn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Pn.prototype={constructor:Pn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Xr(e){return function(){return e}}function Zr(e,t,n,o,s,i){for(var r=0,l,a=t.length,c=i.length;r<c;++r)(l=t[r])?(l.__data__=i[r],o[r]=l):n[r]=new Pn(e,i[r]);for(;r<a;++r)(l=t[r])&&(s[r]=l)}function qr(e,t,n,o,s,i,r){var l,a,c=new Map,u=t.length,p=i.length,f=new Array(u),m;for(l=0;l<u;++l)(a=t[l])&&(f[l]=m=r.call(a,a.__data__,l,t)+"",c.has(m)?s[l]=a:c.set(m,a));for(l=0;l<p;++l)m=r.call(e,i[l],l,i)+"",(a=c.get(m))?(o[l]=a,a.__data__=i[l],c.delete(m)):n[l]=new Pn(e,i[l]);for(l=0;l<u;++l)(a=t[l])&&c.get(f[l])===a&&(s[l]=a)}function Kr(e){return e.__data__}function jr(e,t){if(!arguments.length)return Array.from(this,Kr);var n=t?qr:Zr,o=this._parents,s=this._groups;typeof e!="function"&&(e=Xr(e));for(var i=s.length,r=new Array(i),l=new Array(i),a=new Array(i),c=0;c<i;++c){var u=o[c],p=s[c],f=p.length,m=Jr(e.call(u,u&&u.__data__,c,o)),S=m.length,g=l[c]=new Array(S),h=r[c]=new Array(S),C=a[c]=new Array(f);n(u,p,g,h,C,m,t);for(var P=0,k=0,y,I;P<S;++P)if(y=g[P]){for(P>=k&&(k=P+1);!(I=h[k])&&++k<S;);y._next=I||null}}return r=new je(r,o),r._enter=l,r._exit=a,r}function Jr(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Qr(){return new je(this._exit||this._groups.map(Xs),this._parents)}function el(e,t,n){var o=this.enter(),s=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),o&&s?o.merge(s).order():s}function tl(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,s=n.length,i=o.length,r=Math.min(s,i),l=new Array(s),a=0;a<r;++a)for(var c=n[a],u=o[a],p=c.length,f=l[a]=new Array(p),m,S=0;S<p;++S)(m=c[S]||u[S])&&(f[S]=m);for(;a<s;++a)l[a]=n[a];return new je(l,this._parents)}function nl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],s=o.length-1,i=o[s],r;--s>=0;)(r=o[s])&&(i&&r.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(r,i),i=r);return this}function ol(e){e||(e=sl);function t(p,f){return p&&f?e(p.__data__,f.__data__):!p-!f}for(var n=this._groups,o=n.length,s=new Array(o),i=0;i<o;++i){for(var r=n[i],l=r.length,a=s[i]=new Array(l),c,u=0;u<l;++u)(c=r[u])&&(a[u]=c);a.sort(t)}return new je(s,this._parents).order()}function sl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function il(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function rl(){return Array.from(this)}function ll(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],s=0,i=o.length;s<i;++s){var r=o[s];if(r)return r}return null}function al(){let e=0;for(const t of this)++e;return e}function cl(){return!this.node()}function ul(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var s=t[n],i=0,r=s.length,l;i<r;++i)(l=s[i])&&e.call(l,l.__data__,i,s);return this}function dl(e){return function(){this.removeAttribute(e)}}function fl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function gl(e,t){return function(){this.setAttribute(e,t)}}function pl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function hl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ml(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function vl(e,t){var n=Un(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?fl:dl:typeof t=="function"?n.local?ml:hl:n.local?pl:gl)(n,t))}function Zs(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function yl(e){return function(){this.style.removeProperty(e)}}function wl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function xl(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function _l(e,t,n){return arguments.length>1?this.each((t==null?yl:typeof t=="function"?xl:wl)(e,t,n??"")):Yt(this.node(),e)}function Yt(e,t){return e.style.getPropertyValue(t)||Zs(e).getComputedStyle(e,null).getPropertyValue(t)}function bl(e){return function(){delete this[e]}}function El(e,t){return function(){this[e]=t}}function kl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Sl(e,t){return arguments.length>1?this.each((t==null?bl:typeof t=="function"?kl:El)(e,t)):this.node()[e]}function qs(e){return e.trim().split(/^|\s+/)}function Ro(e){return e.classList||new Ks(e)}function Ks(e){this._node=e,this._names=qs(e.getAttribute("class")||"")}Ks.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function js(e,t){for(var n=Ro(e),o=-1,s=t.length;++o<s;)n.add(t[o])}function Js(e,t){for(var n=Ro(e),o=-1,s=t.length;++o<s;)n.remove(t[o])}function Nl(e){return function(){js(this,e)}}function Cl(e){return function(){Js(this,e)}}function $l(e,t){return function(){(t.apply(this,arguments)?js:Js)(this,e)}}function Il(e,t){var n=qs(e+"");if(arguments.length<2){for(var o=Ro(this.node()),s=-1,i=n.length;++s<i;)if(!o.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?$l:t?Nl:Cl)(n,t))}function Tl(){this.textContent=""}function Ml(e){return function(){this.textContent=e}}function Dl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Al(e){return arguments.length?this.each(e==null?Tl:(typeof e=="function"?Dl:Ml)(e)):this.node().textContent}function Pl(){this.innerHTML=""}function Ol(e){return function(){this.innerHTML=e}}function Rl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function zl(e){return arguments.length?this.each(e==null?Pl:(typeof e=="function"?Rl:Ol)(e)):this.node().innerHTML}function Bl(){this.nextSibling&&this.parentNode.appendChild(this)}function Ll(){return this.each(Bl)}function Vl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fl(){return this.each(Vl)}function Hl(e){var t=typeof e=="function"?e:Gs(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Gl(){return null}function Yl(e,t){var n=typeof e=="function"?e:Gs(e),o=t==null?Gl:typeof t=="function"?t:Oo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Wl(){var e=this.parentNode;e&&e.removeChild(this)}function Ul(){return this.each(Wl)}function Xl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Zl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ql(e){return this.select(e?Zl:Xl)}function Kl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function jl(e){return function(t){e.call(this,t,this.__data__)}}function Jl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Ql(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function ea(e,t,n){return function(){var o=this.__on,s,i=jl(t);if(o){for(var r=0,l=o.length;r<l;++r)if((s=o[r]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(s):this.__on=[s]}}function ta(e,t,n){var o=Jl(e+""),s,i=o.length,r;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,c=l.length,u;a<c;++a)for(s=0,u=l[a];s<i;++s)if((r=o[s]).type===u.type&&r.name===u.name)return u.value}return}for(l=t?ea:Ql,s=0;s<i;++s)this.each(l(o[s],t,n));return this}function Qs(e,t,n){var o=Zs(e),s=o.CustomEvent;typeof s=="function"?s=new s(t,n):(s=o.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function na(e,t){return function(){return Qs(this,e,t)}}function oa(e,t){return function(){return Qs(this,e,t.apply(this,arguments))}}function sa(e,t){return this.each((typeof t=="function"?oa:na)(e,t))}function*ia(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],s=0,i=o.length,r;s<i;++s)(r=o[s])&&(yield r)}var ei=[null];function je(e,t){this._groups=e,this._parents=t}function hn(){return new je([[document.documentElement]],ei)}function ra(){return this}je.prototype=hn.prototype={constructor:je,select:Dr,selectAll:Rr,selectChild:Vr,selectChildren:Yr,filter:Wr,data:jr,enter:Ur,exit:Qr,join:el,merge:tl,selection:ra,order:nl,sort:ol,call:il,nodes:rl,node:ll,size:al,empty:cl,each:ul,attr:vl,style:_l,property:Sl,classed:Il,text:Al,html:zl,raise:Ll,lower:Fl,append:Hl,insert:Yl,remove:Ul,clone:ql,datum:Kl,on:ta,dispatch:sa,[Symbol.iterator]:ia};function tt(e){return typeof e=="string"?new je([[document.querySelector(e)]],[document.documentElement]):new je([[e]],ei)}function la(e){let t;for(;t=e.sourceEvent;)e=t;return e}function rt(e,t){if(e=la(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const aa={passive:!1},cn={capture:!0,passive:!1};function ro(e){e.stopImmediatePropagation()}function Vt(e){e.preventDefault(),e.stopImmediatePropagation()}function ti(e){var t=e.document.documentElement,n=tt(e).on("dragstart.drag",Vt,cn);"onselectstart"in t?n.on("selectstart.drag",Vt,cn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ni(e,t){var n=e.document.documentElement,o=tt(e).on("dragstart.drag",null);t&&(o.on("click.drag",Vt,cn),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const yn=e=>()=>e;function _o(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:i,x:r,y:l,dx:a,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}_o.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ca(e){return!e.ctrlKey&&!e.button}function ua(){return this.parentNode}function da(e,t){return t??{x:e.x,y:e.y}}function fa(){return navigator.maxTouchPoints||"ontouchstart"in this}function ga(){var e=ca,t=ua,n=da,o=fa,s={},i=Wn("start","drag","end"),r=0,l,a,c,u,p=0;function f(y){y.on("mousedown.drag",m).filter(o).on("touchstart.drag",h).on("touchmove.drag",C,aa).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(y,I){if(!(u||!e.call(this,y,I))){var U=k(this,t.call(this,y,I),y,I,"mouse");U&&(tt(y.view).on("mousemove.drag",S,cn).on("mouseup.drag",g,cn),ti(y.view),ro(y),c=!1,l=y.clientX,a=y.clientY,U("start",y))}}function S(y){if(Vt(y),!c){var I=y.clientX-l,U=y.clientY-a;c=I*I+U*U>p}s.mouse("drag",y)}function g(y){tt(y.view).on("mousemove.drag mouseup.drag",null),ni(y.view,c),Vt(y),s.mouse("end",y)}function h(y,I){if(e.call(this,y,I)){var U=y.changedTouches,K=t.call(this,y,I),F=U.length,re,ne;for(re=0;re<F;++re)(ne=k(this,K,y,I,U[re].identifier,U[re]))&&(ro(y),ne("start",y,U[re]))}}function C(y){var I=y.changedTouches,U=I.length,K,F;for(K=0;K<U;++K)(F=s[I[K].identifier])&&(Vt(y),F("drag",y,I[K]))}function P(y){var I=y.changedTouches,U=I.length,K,F;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),K=0;K<U;++K)(F=s[I[K].identifier])&&(ro(y),F("end",y,I[K]))}function k(y,I,U,K,F,re){var ne=i.copy(),D=rt(re||U,I),E,le,b;if((b=n.call(y,new _o("beforestart",{sourceEvent:U,target:f,identifier:F,active:r,x:D[0],y:D[1],dx:0,dy:0,dispatch:ne}),K))!=null)return E=b.x-D[0]||0,le=b.y-D[1]||0,function B(T,L,H){var J=D,X;switch(T){case"start":s[F]=B,X=r++;break;case"end":delete s[F],--r;case"drag":D=rt(H||L,I),X=r;break}ne.call(T,y,new _o(T,{sourceEvent:L,subject:b,target:f,identifier:F,active:X,x:D[0]+E,y:D[1]+le,dx:D[0]-J[0],dy:D[1]-J[1],dispatch:ne}),K)}}return f.filter=function(y){return arguments.length?(e=typeof y=="function"?y:yn(!!y),f):e},f.container=function(y){return arguments.length?(t=typeof y=="function"?y:yn(y),f):t},f.subject=function(y){return arguments.length?(n=typeof y=="function"?y:yn(y),f):n},f.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:yn(!!y),f):o},f.on=function(){var y=i.on.apply(i,arguments);return y===i?f:y},f.clickDistance=function(y){return arguments.length?(p=(y=+y)*y,f):Math.sqrt(p)},f}function zo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function oi(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function mn(){}var un=.7,On=1/un,Ft="\\s*([+-]?\\d+)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ut="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pa=/^#([0-9a-f]{3,8})$/,ha=new RegExp(`^rgb\\(${Ft},${Ft},${Ft}\\)$`),ma=new RegExp(`^rgb\\(${ut},${ut},${ut}\\)$`),va=new RegExp(`^rgba\\(${Ft},${Ft},${Ft},${dn}\\)$`),ya=new RegExp(`^rgba\\(${ut},${ut},${ut},${dn}\\)$`),wa=new RegExp(`^hsl\\(${dn},${ut},${ut}\\)$`),xa=new RegExp(`^hsla\\(${dn},${ut},${ut},${dn}\\)$`),Ko={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};zo(mn,Dt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:jo,formatHex:jo,formatHex8:_a,formatHsl:ba,formatRgb:Jo,toString:Jo});function jo(){return this.rgb().formatHex()}function _a(){return this.rgb().formatHex8()}function ba(){return si(this).formatHsl()}function Jo(){return this.rgb().formatRgb()}function Dt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pa.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Qo(t):n===3?new Ke(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?wn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?wn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ha.exec(e))?new Ke(t[1],t[2],t[3],1):(t=ma.exec(e))?new Ke(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=va.exec(e))?wn(t[1],t[2],t[3],t[4]):(t=ya.exec(e))?wn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wa.exec(e))?ns(t[1],t[2]/100,t[3]/100,1):(t=xa.exec(e))?ns(t[1],t[2]/100,t[3]/100,t[4]):Ko.hasOwnProperty(e)?Qo(Ko[e]):e==="transparent"?new Ke(NaN,NaN,NaN,0):null}function Qo(e){return new Ke(e>>16&255,e>>8&255,e&255,1)}function wn(e,t,n,o){return o<=0&&(e=t=n=NaN),new Ke(e,t,n,o)}function Ea(e){return e instanceof mn||(e=Dt(e)),e?(e=e.rgb(),new Ke(e.r,e.g,e.b,e.opacity)):new Ke}function bo(e,t,n,o){return arguments.length===1?Ea(e):new Ke(e,t,n,o??1)}function Ke(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}zo(Ke,bo,oi(mn,{brighter(e){return e=e==null?On:Math.pow(On,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ke(Tt(this.r),Tt(this.g),Tt(this.b),Rn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:es,formatHex:es,formatHex8:ka,formatRgb:ts,toString:ts}));function es(){return`#${It(this.r)}${It(this.g)}${It(this.b)}`}function ka(){return`#${It(this.r)}${It(this.g)}${It(this.b)}${It((isNaN(this.opacity)?1:this.opacity)*255)}`}function ts(){const e=Rn(this.opacity);return`${e===1?"rgb(":"rgba("}${Tt(this.r)}, ${Tt(this.g)}, ${Tt(this.b)}${e===1?")":`, ${e})`}`}function Rn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function It(e){return e=Tt(e),(e<16?"0":"")+e.toString(16)}function ns(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new nt(e,t,n,o)}function si(e){if(e instanceof nt)return new nt(e.h,e.s,e.l,e.opacity);if(e instanceof mn||(e=Dt(e)),!e)return new nt;if(e instanceof nt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,s=Math.min(t,n,o),i=Math.max(t,n,o),r=NaN,l=i-s,a=(i+s)/2;return l?(t===i?r=(n-o)/l+(n<o)*6:n===i?r=(o-t)/l+2:r=(t-n)/l+4,l/=a<.5?i+s:2-i-s,r*=60):l=a>0&&a<1?0:r,new nt(r,l,a,e.opacity)}function Sa(e,t,n,o){return arguments.length===1?si(e):new nt(e,t,n,o??1)}function nt(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}zo(nt,Sa,oi(mn,{brighter(e){return e=e==null?On:Math.pow(On,e),new nt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new nt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,s=2*n-o;return new Ke(lo(e>=240?e-240:e+120,s,o),lo(e,s,o),lo(e<120?e+240:e-120,s,o),this.opacity)},clamp(){return new nt(os(this.h),xn(this.s),xn(this.l),Rn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Rn(this.opacity);return`${e===1?"hsl(":"hsla("}${os(this.h)}, ${xn(this.s)*100}%, ${xn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function os(e){return e=(e||0)%360,e<0?e+360:e}function xn(e){return Math.max(0,Math.min(1,e||0))}function lo(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Bo=e=>()=>e;function Na(e,t){return function(n){return e+n*t}}function Ca(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function $a(e){return(e=+e)==1?ii:function(t,n){return n-t?Ca(t,n,e):Bo(isNaN(t)?n:t)}}function ii(e,t){var n=t-e;return n?Na(e,n):Bo(isNaN(e)?t:e)}const zn=function e(t){var n=$a(t);function o(s,i){var r=n((s=bo(s)).r,(i=bo(i)).r),l=n(s.g,i.g),a=n(s.b,i.b),c=ii(s.opacity,i.opacity);return function(u){return s.r=r(u),s.g=l(u),s.b=a(u),s.opacity=c(u),s+""}}return o.gamma=e,o}(1);function Ia(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),s;return function(i){for(s=0;s<n;++s)o[s]=e[s]*(1-i)+t[s]*i;return o}}function Ta(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ma(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,s=new Array(o),i=new Array(n),r;for(r=0;r<o;++r)s[r]=sn(e[r],t[r]);for(;r<n;++r)i[r]=t[r];return function(l){for(r=0;r<o;++r)i[r]=s[r](l);return i}}function Da(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function lt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Aa(e,t){var n={},o={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=sn(e[s],t[s]):o[s]=t[s];return function(i){for(s in n)o[s]=n[s](i);return o}}var Eo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ao=new RegExp(Eo.source,"g");function Pa(e){return function(){return e}}function Oa(e){return function(t){return e(t)+""}}function ri(e,t){var n=Eo.lastIndex=ao.lastIndex=0,o,s,i,r=-1,l=[],a=[];for(e=e+"",t=t+"";(o=Eo.exec(e))&&(s=ao.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),l[r]?l[r]+=i:l[++r]=i),(o=o[0])===(s=s[0])?l[r]?l[r]+=s:l[++r]=s:(l[++r]=null,a.push({i:r,x:lt(o,s)})),n=ao.lastIndex;return n<t.length&&(i=t.slice(n),l[r]?l[r]+=i:l[++r]=i),l.length<2?a[0]?Oa(a[0].x):Pa(t):(t=a.length,function(c){for(var u=0,p;u<t;++u)l[(p=a[u]).i]=p.x(c);return l.join("")})}function sn(e,t){var n=typeof t,o;return t==null||n==="boolean"?Bo(t):(n==="number"?lt:n==="string"?(o=Dt(t))?(t=o,zn):ri:t instanceof Dt?zn:t instanceof Date?Da:Ta(t)?Ia:Array.isArray(t)?Ma:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Aa:lt)(e,t)}var ss=180/Math.PI,ko={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function li(e,t,n,o,s,i){var r,l,a;return(r=Math.sqrt(e*e+t*t))&&(e/=r,t/=r),(a=e*n+t*o)&&(n-=e*a,o-=t*a),(l=Math.sqrt(n*n+o*o))&&(n/=l,o/=l,a/=l),e*o<t*n&&(e=-e,t=-t,a=-a,r=-r),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*ss,skewX:Math.atan(a)*ss,scaleX:r,scaleY:l}}var _n;function Ra(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ko:li(t.a,t.b,t.c,t.d,t.e,t.f)}function za(e){return e==null||(_n||(_n=document.createElementNS("http://www.w3.org/2000/svg","g")),_n.setAttribute("transform",e),!(e=_n.transform.baseVal.consolidate()))?ko:(e=e.matrix,li(e.a,e.b,e.c,e.d,e.e,e.f))}function ai(e,t,n,o){function s(c){return c.length?c.pop()+" ":""}function i(c,u,p,f,m,S){if(c!==p||u!==f){var g=m.push("translate(",null,t,null,n);S.push({i:g-4,x:lt(c,p)},{i:g-2,x:lt(u,f)})}else(p||f)&&m.push("translate("+p+t+f+n)}function r(c,u,p,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:p.push(s(p)+"rotate(",null,o)-2,x:lt(c,u)})):u&&p.push(s(p)+"rotate("+u+o)}function l(c,u,p,f){c!==u?f.push({i:p.push(s(p)+"skewX(",null,o)-2,x:lt(c,u)}):u&&p.push(s(p)+"skewX("+u+o)}function a(c,u,p,f,m,S){if(c!==p||u!==f){var g=m.push(s(m)+"scale(",null,",",null,")");S.push({i:g-4,x:lt(c,p)},{i:g-2,x:lt(u,f)})}else(p!==1||f!==1)&&m.push(s(m)+"scale("+p+","+f+")")}return function(c,u){var p=[],f=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,p,f),r(c.rotate,u.rotate,p,f),l(c.skewX,u.skewX,p,f),a(c.scaleX,c.scaleY,u.scaleX,u.scaleY,p,f),c=u=null,function(m){for(var S=-1,g=f.length,h;++S<g;)p[(h=f[S]).i]=h.x(m);return p.join("")}}}var Ba=ai(Ra,"px, ","px)","deg)"),La=ai(za,", ",")",")"),Va=1e-12;function is(e){return((e=Math.exp(e))+1/e)/2}function Fa(e){return((e=Math.exp(e))-1/e)/2}function Ha(e){return((e=Math.exp(2*e))-1)/(e+1)}const In=function e(t,n,o){function s(i,r){var l=i[0],a=i[1],c=i[2],u=r[0],p=r[1],f=r[2],m=u-l,S=p-a,g=m*m+S*S,h,C;if(g<Va)C=Math.log(f/c)/t,h=function(K){return[l+K*m,a+K*S,c*Math.exp(t*K*C)]};else{var P=Math.sqrt(g),k=(f*f-c*c+o*g)/(2*c*n*P),y=(f*f-c*c-o*g)/(2*f*n*P),I=Math.log(Math.sqrt(k*k+1)-k),U=Math.log(Math.sqrt(y*y+1)-y);C=(U-I)/t,h=function(K){var F=K*C,re=is(I),ne=c/(n*P)*(re*Ha(t*F+I)-Fa(I));return[l+ne*m,a+ne*S,c*re/is(t*F+I)]}}return h.duration=C*1e3*t/Math.SQRT2,h}return s.rho=function(i){var r=Math.max(.001,+i),l=r*r,a=l*l;return e(r,l,a)},s}(Math.SQRT2,2,4);var Wt=0,tn=0,Jt=0,ci=1e3,Bn,nn,Ln=0,At=0,Xn=0,fn=typeof performance=="object"&&performance.now?performance:Date,ui=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Lo(){return At||(ui(Ga),At=fn.now()+Xn)}function Ga(){At=0}function Vn(){this._call=this._time=this._next=null}Vn.prototype=di.prototype={constructor:Vn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Lo():+n)+(t==null?0:+t),!this._next&&nn!==this&&(nn?nn._next=this:Bn=this,nn=this),this._call=e,this._time=n,So()},stop:function(){this._call&&(this._call=null,this._time=1/0,So())}};function di(e,t,n){var o=new Vn;return o.restart(e,t,n),o}function Ya(){Lo(),++Wt;for(var e=Bn,t;e;)(t=At-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Wt}function rs(){At=(Ln=fn.now())+Xn,Wt=tn=0;try{Ya()}finally{Wt=0,Ua(),At=0}}function Wa(){var e=fn.now(),t=e-Ln;t>ci&&(Xn-=t,Ln=e)}function Ua(){for(var e,t=Bn,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bn=n);nn=e,So(o)}function So(e){if(!Wt){tn&&(tn=clearTimeout(tn));var t=e-At;t>24?(e<1/0&&(tn=setTimeout(rs,e-fn.now()-Xn)),Jt&&(Jt=clearInterval(Jt))):(Jt||(Ln=fn.now(),Jt=setInterval(Wa,ci)),Wt=1,ui(rs))}}function ls(e,t,n){var o=new Vn;return t=t==null?0:+t,o.restart(s=>{o.stop(),e(s+t)},t,n),o}var Xa=Wn("start","end","cancel","interrupt"),Za=[],fi=0,as=1,No=2,Tn=3,cs=4,Co=5,Mn=6;function Zn(e,t,n,o,s,i){var r=e.__transition;if(!r)e.__transition={};else if(n in r)return;qa(e,n,{name:t,index:o,group:s,on:Xa,tween:Za,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:fi})}function Vo(e,t){var n=st(e,t);if(n.state>fi)throw new Error("too late; already scheduled");return n}function ft(e,t){var n=st(e,t);if(n.state>Tn)throw new Error("too late; already running");return n}function st(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function qa(e,t,n){var o=e.__transition,s;o[t]=n,n.timer=di(i,0,n.time);function i(c){n.state=as,n.timer.restart(r,n.delay,n.time),n.delay<=c&&r(c-n.delay)}function r(c){var u,p,f,m;if(n.state!==as)return a();for(u in o)if(m=o[u],m.name===n.name){if(m.state===Tn)return ls(r);m.state===cs?(m.state=Mn,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete o[u]):+u<t&&(m.state=Mn,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete o[u])}if(ls(function(){n.state===Tn&&(n.state=cs,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=No,n.on.call("start",e,e.__data__,n.index,n.group),n.state===No){for(n.state=Tn,s=new Array(f=n.tween.length),u=0,p=-1;u<f;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++p]=m);s.length=p+1}}function l(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(a),n.state=Co,1),p=-1,f=s.length;++p<f;)s[p].call(e,u);n.state===Co&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){n.state=Mn,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function Dn(e,t){var n=e.__transition,o,s,i=!0,r;if(n){t=t==null?null:t+"";for(r in n){if((o=n[r]).name!==t){i=!1;continue}s=o.state>No&&o.state<Co,o.state=Mn,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[r]}i&&delete e.__transition}}function Ka(e){return this.each(function(){Dn(this,e)})}function ja(e,t){var n,o;return function(){var s=ft(this,e),i=s.tween;if(i!==n){o=n=i;for(var r=0,l=o.length;r<l;++r)if(o[r].name===t){o=o.slice(),o.splice(r,1);break}}s.tween=o}}function Ja(e,t,n){var o,s;if(typeof n!="function")throw new Error;return function(){var i=ft(this,e),r=i.tween;if(r!==o){s=(o=r).slice();for(var l={name:t,value:n},a=0,c=s.length;a<c;++a)if(s[a].name===t){s[a]=l;break}a===c&&s.push(l)}i.tween=s}}function Qa(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=st(this.node(),n).tween,s=0,i=o.length,r;s<i;++s)if((r=o[s]).name===e)return r.value;return null}return this.each((t==null?ja:Ja)(n,e,t))}function Fo(e,t,n){var o=e._id;return e.each(function(){var s=ft(this,o);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return st(s,o).value[t]}}function gi(e,t){var n;return(typeof t=="number"?lt:t instanceof Dt?zn:(n=Dt(t))?(t=n,zn):ri)(e,t)}function ec(e){return function(){this.removeAttribute(e)}}function tc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function nc(e,t,n){var o,s=n+"",i;return function(){var r=this.getAttribute(e);return r===s?null:r===o?i:i=t(o=r,n)}}function oc(e,t,n){var o,s=n+"",i;return function(){var r=this.getAttributeNS(e.space,e.local);return r===s?null:r===o?i:i=t(o=r,n)}}function sc(e,t,n){var o,s,i;return function(){var r,l=n(this),a;return l==null?void this.removeAttribute(e):(r=this.getAttribute(e),a=l+"",r===a?null:r===o&&a===s?i:(s=a,i=t(o=r,l)))}}function ic(e,t,n){var o,s,i;return function(){var r,l=n(this),a;return l==null?void this.removeAttributeNS(e.space,e.local):(r=this.getAttributeNS(e.space,e.local),a=l+"",r===a?null:r===o&&a===s?i:(s=a,i=t(o=r,l)))}}function rc(e,t){var n=Un(e),o=n==="transform"?La:gi;return this.attrTween(e,typeof t=="function"?(n.local?ic:sc)(n,o,Fo(this,"attr."+e,t)):t==null?(n.local?tc:ec)(n):(n.local?oc:nc)(n,o,t))}function lc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ac(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function cc(e,t){var n,o;function s(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&ac(e,i)),n}return s._value=t,s}function uc(e,t){var n,o;function s(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&lc(e,i)),n}return s._value=t,s}function dc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Un(e);return this.tween(n,(o.local?cc:uc)(o,t))}function fc(e,t){return function(){Vo(this,e).delay=+t.apply(this,arguments)}}function gc(e,t){return t=+t,function(){Vo(this,e).delay=t}}function pc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fc:gc)(t,e)):st(this.node(),t).delay}function hc(e,t){return function(){ft(this,e).duration=+t.apply(this,arguments)}}function mc(e,t){return t=+t,function(){ft(this,e).duration=t}}function vc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hc:mc)(t,e)):st(this.node(),t).duration}function yc(e,t){if(typeof t!="function")throw new Error;return function(){ft(this,e).ease=t}}function wc(e){var t=this._id;return arguments.length?this.each(yc(t,e)):st(this.node(),t).ease}function xc(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ft(this,e).ease=n}}function _c(e){if(typeof e!="function")throw new Error;return this.each(xc(this._id,e))}function bc(e){typeof e!="function"&&(e=Ws(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,l=o[s]=[],a,c=0;c<r;++c)(a=i[c])&&e.call(a,a.__data__,c,i)&&l.push(a);return new wt(o,this._parents,this._name,this._id)}function Ec(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,s=n.length,i=Math.min(o,s),r=new Array(o),l=0;l<i;++l)for(var a=t[l],c=n[l],u=a.length,p=r[l]=new Array(u),f,m=0;m<u;++m)(f=a[m]||c[m])&&(p[m]=f);for(;l<o;++l)r[l]=t[l];return new wt(r,this._parents,this._name,this._id)}function kc(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Sc(e,t,n){var o,s,i=kc(t)?Vo:ft;return function(){var r=i(this,e),l=r.on;l!==o&&(s=(o=l).copy()).on(t,n),r.on=s}}function Nc(e,t){var n=this._id;return arguments.length<2?st(this.node(),n).on.on(e):this.each(Sc(n,e,t))}function Cc(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function $c(){return this.on("end.remove",Cc(this._id))}function Ic(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Oo(e));for(var o=this._groups,s=o.length,i=new Array(s),r=0;r<s;++r)for(var l=o[r],a=l.length,c=i[r]=new Array(a),u,p,f=0;f<a;++f)(u=l[f])&&(p=e.call(u,u.__data__,f,l))&&("__data__"in u&&(p.__data__=u.__data__),c[f]=p,Zn(c[f],t,n,f,c,st(u,n)));return new wt(i,this._parents,t,n)}function Tc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ys(e));for(var o=this._groups,s=o.length,i=[],r=[],l=0;l<s;++l)for(var a=o[l],c=a.length,u,p=0;p<c;++p)if(u=a[p]){for(var f=e.call(u,u.__data__,p,a),m,S=st(u,n),g=0,h=f.length;g<h;++g)(m=f[g])&&Zn(m,t,n,g,f,S);i.push(f),r.push(u)}return new wt(i,r,t,n)}var Mc=hn.prototype.constructor;function Dc(){return new Mc(this._groups,this._parents)}function Ac(e,t){var n,o,s;return function(){var i=Yt(this,e),r=(this.style.removeProperty(e),Yt(this,e));return i===r?null:i===n&&r===o?s:s=t(n=i,o=r)}}function pi(e){return function(){this.style.removeProperty(e)}}function Pc(e,t,n){var o,s=n+"",i;return function(){var r=Yt(this,e);return r===s?null:r===o?i:i=t(o=r,n)}}function Oc(e,t,n){var o,s,i;return function(){var r=Yt(this,e),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(e),Yt(this,e))),r===a?null:r===o&&a===s?i:(s=a,i=t(o=r,l))}}function Rc(e,t){var n,o,s,i="style."+t,r="end."+i,l;return function(){var a=ft(this,e),c=a.on,u=a.value[i]==null?l||(l=pi(t)):void 0;(c!==n||s!==u)&&(o=(n=c).copy()).on(r,s=u),a.on=o}}function zc(e,t,n){var o=(e+="")=="transform"?Ba:gi;return t==null?this.styleTween(e,Ac(e,o)).on("end.style."+e,pi(e)):typeof t=="function"?this.styleTween(e,Oc(e,o,Fo(this,"style."+e,t))).each(Rc(this._id,e)):this.styleTween(e,Pc(e,o,t),n).on("end.style."+e,null)}function Bc(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function Lc(e,t,n){var o,s;function i(){var r=t.apply(this,arguments);return r!==s&&(o=(s=r)&&Bc(e,r,n)),o}return i._value=t,i}function Vc(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Lc(e,t,n??""))}function Fc(e){return function(){this.textContent=e}}function Hc(e){return function(){var t=e(this);this.textContent=t??""}}function Gc(e){return this.tween("text",typeof e=="function"?Hc(Fo(this,"text",e)):Fc(e==null?"":e+""))}function Yc(e){return function(t){this.textContent=e.call(this,t)}}function Wc(e){var t,n;function o(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Yc(s)),t}return o._value=e,o}function Uc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Wc(e))}function Xc(){for(var e=this._name,t=this._id,n=hi(),o=this._groups,s=o.length,i=0;i<s;++i)for(var r=o[i],l=r.length,a,c=0;c<l;++c)if(a=r[c]){var u=st(a,t);Zn(a,e,n,c,r,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new wt(o,this._parents,e,n)}function Zc(){var e,t,n=this,o=n._id,s=n.size();return new Promise(function(i,r){var l={value:r},a={value:function(){--s===0&&i()}};n.each(function(){var c=ft(this,o),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(a)),c.on=t}),s===0&&i()})}var qc=0;function wt(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function hi(){return++qc}var ht=hn.prototype;wt.prototype={constructor:wt,select:Ic,selectAll:Tc,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:bc,merge:Ec,selection:Dc,transition:Xc,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:Nc,attr:rc,attrTween:dc,style:zc,styleTween:Vc,text:Gc,textTween:Uc,remove:$c,tween:Qa,delay:pc,duration:vc,ease:wc,easeVarying:_c,end:Zc,[Symbol.iterator]:ht[Symbol.iterator]};function Kc(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var jc={time:null,delay:0,duration:250,ease:Kc};function Jc(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Qc(e){var t,n;e instanceof wt?(t=e._id,e=e._name):(t=hi(),(n=jc).time=Lo(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,i=0;i<s;++i)for(var r=o[i],l=r.length,a,c=0;c<l;++c)(a=r[c])&&Zn(a,e,t,c,r,n||Jc(a,t));return new wt(o,this._parents,e,t)}hn.prototype.interrupt=Ka;hn.prototype.transition=Qc;const bn=e=>()=>e;function eu(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function vt(e,t,n){this.k=e,this.x=t,this.y=n}vt.prototype={constructor:vt,scale:function(e){return e===1?this:new vt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ut=new vt(1,0,0);vt.prototype;function co(e){e.stopImmediatePropagation()}function Qt(e){e.preventDefault(),e.stopImmediatePropagation()}function tu(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function nu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function us(){return this.__zoom||Ut}function ou(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function su(){return navigator.maxTouchPoints||"ontouchstart"in this}function iu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],r=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r))}function ru(){var e=tu,t=nu,n=iu,o=ou,s=su,i=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],l=250,a=In,c=Wn("start","zoom","end"),u,p,f,m=500,S=150,g=0,h=10;function C(b){b.property("__zoom",us).on("wheel.zoom",F,{passive:!1}).on("mousedown.zoom",re).on("dblclick.zoom",ne).filter(s).on("touchstart.zoom",D).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",le).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}C.transform=function(b,B,T,L){var H=b.selection?b.selection():b;H.property("__zoom",us),b!==H?I(b,B,T,L):H.interrupt().each(function(){U(this,arguments).event(L).start().zoom(null,typeof B=="function"?B.apply(this,arguments):B).end()})},C.scaleBy=function(b,B,T,L){C.scaleTo(b,function(){var H=this.__zoom.k,J=typeof B=="function"?B.apply(this,arguments):B;return H*J},T,L)},C.scaleTo=function(b,B,T,L){C.transform(b,function(){var H=t.apply(this,arguments),J=this.__zoom,X=T==null?y(H):typeof T=="function"?T.apply(this,arguments):T,se=J.invert(X),de=typeof B=="function"?B.apply(this,arguments):B;return n(k(P(J,de),X,se),H,r)},T,L)},C.translateBy=function(b,B,T,L){C.transform(b,function(){return n(this.__zoom.translate(typeof B=="function"?B.apply(this,arguments):B,typeof T=="function"?T.apply(this,arguments):T),t.apply(this,arguments),r)},null,L)},C.translateTo=function(b,B,T,L,H){C.transform(b,function(){var J=t.apply(this,arguments),X=this.__zoom,se=L==null?y(J):typeof L=="function"?L.apply(this,arguments):L;return n(Ut.translate(se[0],se[1]).scale(X.k).translate(typeof B=="function"?-B.apply(this,arguments):-B,typeof T=="function"?-T.apply(this,arguments):-T),J,r)},L,H)};function P(b,B){return B=Math.max(i[0],Math.min(i[1],B)),B===b.k?b:new vt(B,b.x,b.y)}function k(b,B,T){var L=B[0]-T[0]*b.k,H=B[1]-T[1]*b.k;return L===b.x&&H===b.y?b:new vt(b.k,L,H)}function y(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function I(b,B,T,L){b.on("start.zoom",function(){U(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){U(this,arguments).event(L).end()}).tween("zoom",function(){var H=this,J=arguments,X=U(H,J).event(L),se=t.apply(H,J),de=T==null?y(se):typeof T=="function"?T.apply(H,J):T,me=Math.max(se[1][0]-se[0][0],se[1][1]-se[0][1]),ee=H.__zoom,ce=typeof B=="function"?B.apply(H,J):B,ae=a(ee.invert(de).concat(me/ee.k),ce.invert(de).concat(me/ce.k));return function(he){if(he===1)he=ce;else{var ke=ae(he),_e=me/ke[2];he=new vt(_e,de[0]-ke[0]*_e,de[1]-ke[1]*_e)}X.zoom(null,he)}})}function U(b,B,T){return!T&&b.__zooming||new K(b,B)}function K(b,B){this.that=b,this.args=B,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,B),this.taps=0}K.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,B){return this.mouse&&b!=="mouse"&&(this.mouse[1]=B.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=B.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=B.invert(this.touch1[0])),this.that.__zoom=B,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var B=tt(this.that).datum();c.call(b,this.that,new eu(b,{sourceEvent:this.sourceEvent,target:C,transform:this.that.__zoom,dispatch:c}),B)}};function F(b,...B){if(!e.apply(this,arguments))return;var T=U(this,B).event(b),L=this.__zoom,H=Math.max(i[0],Math.min(i[1],L.k*Math.pow(2,o.apply(this,arguments)))),J=rt(b);if(T.wheel)(T.mouse[0][0]!==J[0]||T.mouse[0][1]!==J[1])&&(T.mouse[1]=L.invert(T.mouse[0]=J)),clearTimeout(T.wheel);else{if(L.k===H)return;T.mouse=[J,L.invert(J)],Dn(this),T.start()}Qt(b),T.wheel=setTimeout(X,S),T.zoom("mouse",n(k(P(L,H),T.mouse[0],T.mouse[1]),T.extent,r));function X(){T.wheel=null,T.end()}}function re(b,...B){if(f||!e.apply(this,arguments))return;var T=b.currentTarget,L=U(this,B,!0).event(b),H=tt(b.view).on("mousemove.zoom",de,!0).on("mouseup.zoom",me,!0),J=rt(b,T),X=b.clientX,se=b.clientY;ti(b.view),co(b),L.mouse=[J,this.__zoom.invert(J)],Dn(this),L.start();function de(ee){if(Qt(ee),!L.moved){var ce=ee.clientX-X,ae=ee.clientY-se;L.moved=ce*ce+ae*ae>g}L.event(ee).zoom("mouse",n(k(L.that.__zoom,L.mouse[0]=rt(ee,T),L.mouse[1]),L.extent,r))}function me(ee){H.on("mousemove.zoom mouseup.zoom",null),ni(ee.view,L.moved),Qt(ee),L.event(ee).end()}}function ne(b,...B){if(e.apply(this,arguments)){var T=this.__zoom,L=rt(b.changedTouches?b.changedTouches[0]:b,this),H=T.invert(L),J=T.k*(b.shiftKey?.5:2),X=n(k(P(T,J),L,H),t.apply(this,B),r);Qt(b),l>0?tt(this).transition().duration(l).call(I,X,L,b):tt(this).call(C.transform,X,L,b)}}function D(b,...B){if(e.apply(this,arguments)){var T=b.touches,L=T.length,H=U(this,B,b.changedTouches.length===L).event(b),J,X,se,de;for(co(b),X=0;X<L;++X)se=T[X],de=rt(se,this),de=[de,this.__zoom.invert(de),se.identifier],H.touch0?!H.touch1&&H.touch0[2]!==de[2]&&(H.touch1=de,H.taps=0):(H.touch0=de,J=!0,H.taps=1+!!u);u&&(u=clearTimeout(u)),J&&(H.taps<2&&(p=de[0],u=setTimeout(function(){u=null},m)),Dn(this),H.start())}}function E(b,...B){if(this.__zooming){var T=U(this,B).event(b),L=b.changedTouches,H=L.length,J,X,se,de;for(Qt(b),J=0;J<H;++J)X=L[J],se=rt(X,this),T.touch0&&T.touch0[2]===X.identifier?T.touch0[0]=se:T.touch1&&T.touch1[2]===X.identifier&&(T.touch1[0]=se);if(X=T.that.__zoom,T.touch1){var me=T.touch0[0],ee=T.touch0[1],ce=T.touch1[0],ae=T.touch1[1],he=(he=ce[0]-me[0])*he+(he=ce[1]-me[1])*he,ke=(ke=ae[0]-ee[0])*ke+(ke=ae[1]-ee[1])*ke;X=P(X,Math.sqrt(he/ke)),se=[(me[0]+ce[0])/2,(me[1]+ce[1])/2],de=[(ee[0]+ae[0])/2,(ee[1]+ae[1])/2]}else if(T.touch0)se=T.touch0[0],de=T.touch0[1];else return;T.zoom("touch",n(k(X,se,de),T.extent,r))}}function le(b,...B){if(this.__zooming){var T=U(this,B).event(b),L=b.changedTouches,H=L.length,J,X;for(co(b),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),J=0;J<H;++J)X=L[J],T.touch0&&T.touch0[2]===X.identifier?delete T.touch0:T.touch1&&T.touch1[2]===X.identifier&&delete T.touch1;if(T.touch1&&!T.touch0&&(T.touch0=T.touch1,delete T.touch1),T.touch0)T.touch0[1]=this.__zoom.invert(T.touch0[0]);else if(T.end(),T.taps===2&&(X=rt(X,this),Math.hypot(p[0]-X[0],p[1]-X[1])<h)){var se=tt(this).on("dblclick.zoom");se&&se.apply(this,arguments)}}}return C.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:bn(+b),C):o},C.filter=function(b){return arguments.length?(e=typeof b=="function"?b:bn(!!b),C):e},C.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:bn(!!b),C):s},C.extent=function(b){return arguments.length?(t=typeof b=="function"?b:bn([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),C):t},C.scaleExtent=function(b){return arguments.length?(i[0]=+b[0],i[1]=+b[1],C):[i[0],i[1]]},C.translateExtent=function(b){return arguments.length?(r[0][0]=+b[0][0],r[1][0]=+b[1][0],r[0][1]=+b[0][1],r[1][1]=+b[1][1],C):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},C.constrain=function(b){return arguments.length?(n=b,C):n},C.duration=function(b){return arguments.length?(l=+b,C):l},C.interpolate=function(b){return arguments.length?(a=b,C):a},C.on=function(){var b=c.on.apply(c,arguments);return b===c?C:b},C.clickDistance=function(b){return arguments.length?(g=(b=+b)*b,C):Math.sqrt(g)},C.tapDistance=function(b){return arguments.length?(h=+b,C):h},C}var Z=(e=>(e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom",e))(Z||{}),Ho=(e=>(e.Partial="partial",e.Full="full",e))(Ho||{}),Ct=(e=>(e.Bezier="default",e.SimpleBezier="simple-bezier",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e))(Ct||{}),kt=(e=>(e.Strict="strict",e.Loose="loose",e))(kt||{}),$o=(e=>(e.Arrow="arrow",e.ArrowClosed="arrowclosed",e))($o||{}),rn=(e=>(e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal",e))(rn||{});const lu=["INPUT","SELECT","TEXTAREA"],au=typeof document<"u"?document:null;function Io(e){var t,n;const o=((n=(t=e.composedPath)==null?void 0:t.call(e))==null?void 0:n[0])||e.target,s=typeof o?.hasAttribute=="function"?o.hasAttribute("contenteditable"):!1,i=typeof o?.closest=="function"?o.closest(".nokey"):null;return lu.includes(o?.nodeName)||s||!!i}function cu(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function ds(e,t,n,o){const s=t.replace("+",`
`).replace(`

`,`
+`).split(`
`).map(r=>r.trim().toLowerCase());if(s.length===1)return e.toLowerCase()===t.toLowerCase();o||n.add(e.toLowerCase());const i=s.every((r,l)=>n.has(r)&&Array.from(n.values())[l]===s[l]);return o&&n.delete(e.toLowerCase()),i}function uu(e,t){return n=>{if(!n.code&&!n.key)return!1;const o=du(n.code,e);return Array.isArray(e)?e.some(s=>ds(n[o],s,t,n.type==="keyup")):ds(n[o],e,t,n.type==="keyup")}}function du(e,t){return t.includes(e)?"code":"key"}function ln(e,t){const n=W(()=>Ne(t?.target)??au),o=An(Ne(e)===!0);let s=!1;const i=new Set;let r=a(Ne(e));De(()=>Ne(e),(c,u)=>{typeof u=="boolean"&&typeof c!="boolean"&&l(),r=a(c)},{immediate:!0}),Hs(["blur","contextmenu"],l),Xo((...c)=>r(...c),c=>{var u,p;const f=Ne(t?.actInsideInputWithModifier)??!0,m=Ne(t?.preventDefault)??!1;if(s=cu(c),(!s||s&&!f)&&Io(c))return;const g=((p=(u=c.composedPath)==null?void 0:u.call(c))==null?void 0:p[0])||c.target,h=g?.nodeName==="BUTTON"||g?.nodeName==="A";!m&&(s||!h)&&c.preventDefault(),o.value=!0},{eventName:"keydown",target:n}),Xo((...c)=>r(...c),c=>{const u=Ne(t?.actInsideInputWithModifier)??!0;if(o.value){if((!s||s&&!u)&&Io(c))return;s=!1,o.value=!1}},{eventName:"keyup",target:n});function l(){s=!1,i.clear(),o.value=Ne(e)===!0}function a(c){return c===null?(l(),()=>!1):typeof c=="boolean"?(l(),o.value=c,()=>!1):Array.isArray(c)||typeof c=="string"?uu(c,i):c}return o}const mi="vue-flow__node-desc",vi="vue-flow__edge-desc",fu="vue-flow__aria-live",yi=["Enter"," ","Escape"],Ht={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Fn(e){return{...e.computedPosition||{x:0,y:0},width:e.dimensions.width||0,height:e.dimensions.height||0}}function Hn(e,t){const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)}function qn(e){return{width:e.offsetWidth,height:e.offsetHeight}}function Pt(e,t=0,n=1){return Math.min(Math.max(e,t),n)}function wi(e,t){return{x:Pt(e.x,t[0][0],t[1][0]),y:Pt(e.y,t[0][1],t[1][1])}}function fs(e){const t=e.getRootNode();return"elementFromPoint"in t?t:window.document}function St(e){return e&&typeof e=="object"&&"id"in e&&"source"in e&&"target"in e}function Mt(e){return e&&typeof e=="object"&&"id"in e&&"position"in e&&!St(e)}function on(e){return Mt(e)&&"computedPosition"in e}function En(e){return!Number.isNaN(e)&&Number.isFinite(e)}function gu(e){return En(e.width)&&En(e.height)&&En(e.x)&&En(e.y)}function pu(e,t,n){const o={id:e.id.toString(),type:e.type??"default",dimensions:Cn({width:0,height:0}),computedPosition:Cn({z:0,...e.position}),handleBounds:{source:[],target:[]},draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,isParent:!1,position:{x:0,y:0},data:Fe(e.data)?e.data:{},events:Cn(Fe(e.events)?e.events:{})};return Object.assign(t??o,e,{id:e.id.toString(),parentNode:n})}function xi(e,t,n){var o,s;const i={id:e.id.toString(),type:e.type??t?.type??"default",source:e.source.toString(),target:e.target.toString(),sourceHandle:(o=e.sourceHandle)==null?void 0:o.toString(),targetHandle:(s=e.targetHandle)==null?void 0:s.toString(),updatable:e.updatable??n?.updatable,selectable:e.selectable??n?.selectable,focusable:e.focusable??n?.focusable,data:Fe(e.data)?e.data:{},events:Cn(Fe(e.events)?e.events:{}),label:e.label??"",interactionWidth:e.interactionWidth??n?.interactionWidth,...n??{}};return Object.assign(t??i,e,{id:e.id.toString()})}function _i(e,t,n,o){const s=typeof e=="string"?e:e.id,i=new Set,r=o==="source"?"target":"source";for(const l of n)l[r]===s&&i.add(l[o]);return t.filter(l=>i.has(l.id))}function hu(...e){if(e.length===3){const[i,r,l]=e;return _i(i,r,l,"target")}const[t,n]=e,o=typeof t=="string"?t:t.id;return n.filter(i=>St(i)&&i.source===o).map(i=>n.find(r=>Mt(r)&&r.id===i.target))}function mu(...e){if(e.length===3){const[i,r,l]=e;return _i(i,r,l,"source")}const[t,n]=e,o=typeof t=="string"?t:t.id;return n.filter(i=>St(i)&&i.target===o).map(i=>n.find(r=>Mt(r)&&r.id===i.source))}function bi({source:e,sourceHandle:t,target:n,targetHandle:o}){return`vueflow__edge-${e}${t??""}-${n}${o??""}`}function vu(e,t){return t.some(n=>St(n)&&n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle))}function To({x:e,y:t},{x:n,y:o,zoom:s}){return{x:e*s+n,y:t*s+o}}function gn({x:e,y:t},{x:n,y:o,zoom:s},i=!1,r=[1,1]){const l={x:(e-n)/s,y:(t-o)/s};return i?Kn(l,r):l}function yu(e,t){return{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}}function Ei({x:e,y:t,width:n,height:o}){return{x:e,y:t,x2:e+n,y2:t+o}}function wu({x:e,y:t,x2:n,y2:o}){return{x:e,y:t,width:n-e,height:o-t}}function ki(e){let t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,x2:Number.NEGATIVE_INFINITY,y2:Number.NEGATIVE_INFINITY};for(let n=0;n<e.length;n++){const o=e[n];t=yu(t,Ei({...o.computedPosition,...o.dimensions}))}return wu(t)}function Si(e,t,n={x:0,y:0,zoom:1},o=!1,s=!1){const i={...gn(t,n),width:t.width/n.zoom,height:t.height/n.zoom},r=[];for(const l of e){const{dimensions:a,selectable:c=!0,hidden:u=!1}=l,p=a.width??l.width??null,f=a.height??l.height??null;if(s&&!c||u)continue;const m=Hn(i,Fn(l)),S=p===null||f===null,g=o&&m>0,h=(p??0)*(f??0);(S||g||m>=h||l.dragging)&&r.push(l)}return r}function Ni(e,t){const n=new Set;if(typeof e=="string")n.add(e);else if(e.length>=1)for(const o of e)n.add(o.id);return t.filter(o=>n.has(o.source)||n.has(o.target))}function gs(e,t,n,o,s,i=.1,r={x:0,y:0}){const l=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(l,a),u=Pt(c,o,s),p=e.x+e.width/2,f=e.y+e.height/2,m=t/2-p*u+(r.x??0),S=n/2-f*u+(r.y??0);return{x:m,y:S,zoom:u}}function xu(e,t){return{x:t.x+e.x,y:t.y+e.y,z:(e.z>t.z?e.z:t.z)+1}}function Ci(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:Ci(n,t):!1}function pn(e,t){return typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`}function ps(e){const t=e.ctrlKey&&Gn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t}function hs(e,t,n){return e<t?Pt(Math.abs(e-t),1,t)/t:e>n?-Pt(Math.abs(e-n),1,t)/t:0}function $i(e,t,n=15,o=40){const s=hs(e.x,o,t.width-o)*n,i=hs(e.y,o,t.height-o)*n;return[s,i]}function uo(e,t){if(t){const n=e.position.x+e.dimensions.width-t.dimensions.width,o=e.position.y+e.dimensions.height-t.dimensions.height;if(n>0||o>0||e.position.x<0||e.position.y<0){let s={};if(typeof t.style=="function"?s={...t.style(t)}:t.style&&(s={...t.style}),s.width=s.width??`${t.dimensions.width}px`,s.height=s.height??`${t.dimensions.height}px`,n>0)if(typeof s.width=="string"){const i=Number(s.width.replace("px",""));s.width=`${i+n}px`}else s.width+=n;if(o>0)if(typeof s.height=="string"){const i=Number(s.height.replace("px",""));s.height=`${i+o}px`}else s.height+=o;if(e.position.x<0){const i=Math.abs(e.position.x);if(t.position.x=t.position.x-i,typeof s.width=="string"){const r=Number(s.width.replace("px",""));s.width=`${r+i}px`}else s.width+=i;e.position.x=0}if(e.position.y<0){const i=Math.abs(e.position.y);if(t.position.y=t.position.y-i,typeof s.height=="string"){const r=Number(s.height.replace("px",""));s.height=`${r+i}px`}else s.height+=i;e.position.y=0}t.dimensions.width=Number(s.width.toString().replace("px","")),t.dimensions.height=Number(s.height.toString().replace("px","")),typeof t.style=="function"?t.style=i=>{const r=t.style;return{...r(i),...s}}:t.style={...t.style,...s}}}}function ms(e,t){var n,o;const s=e.filter(r=>r.type==="add"||r.type==="remove");for(const r of s)if(r.type==="add")t.findIndex(a=>a.id===r.item.id)===-1&&t.push(r.item);else if(r.type==="remove"){const l=t.findIndex(a=>a.id===r.id);l!==-1&&t.splice(l,1)}const i=t.map(r=>r.id);for(const r of t)for(const l of e)if(l.id===r.id)switch(l.type){case"select":r.selected=l.selected;break;case"position":if(on(r)&&(typeof l.position<"u"&&(r.position=l.position),typeof l.dragging<"u"&&(r.dragging=l.dragging),r.expandParent&&r.parentNode)){const a=t[i.indexOf(r.parentNode)];a&&on(a)&&uo(r,a)}break;case"dimensions":if(on(r)&&(typeof l.dimensions<"u"&&(r.dimensions=l.dimensions),typeof l.updateStyle<"u"&&l.updateStyle&&(r.style={...r.style||{},width:`${(n=l.dimensions)==null?void 0:n.width}px`,height:`${(o=l.dimensions)==null?void 0:o.height}px`}),typeof l.resizing<"u"&&(r.resizing=l.resizing),r.expandParent&&r.parentNode)){const a=t[i.indexOf(r.parentNode)];a&&on(a)&&(!!a.dimensions.width&&!!a.dimensions.height?uo(r,a):ot(()=>{uo(r,a)}))}break}return t}function _t(e,t){return{id:e,type:"select",selected:t}}function vs(e){return{item:e,type:"add"}}function ys(e){return{id:e,type:"remove"}}function ws(e,t,n,o,s){return{id:e,source:t,target:n,sourceHandle:o||null,targetHandle:s||null,type:"remove"}}function bt(e,t=new Set,n=!1){const o=[];for(const[s,i]of e){const r=t.has(s);!(i.selected===void 0&&!r)&&i.selected!==r&&(n&&(i.selected=r),o.push(_t(i.id,r)))}return o}const xs=()=>{};function te(e){const t=new Set;let n=xs,o=()=>!1;const s=()=>t.size>0||o(),i=f=>{n=f},r=()=>{n=xs},l=f=>{o=f},a=()=>{o=()=>!1},c=f=>{t.delete(f)};return{on:f=>{t.add(f);const m=()=>c(f);return an(m),{off:m}},off:c,trigger:f=>{const m=[n];return s()?m.push(...t):e&&m.push(e),Promise.allSettled(m.map(S=>S(f)))},hasListeners:s,listeners:t,setEmitter:i,removeEmitter:r,setHasEmitListeners:l,removeHasEmitListeners:a}}function _s(e,t,n){let o=e;do{if(o&&o.matches(t))return!0;if(o===n)return!1;o=o.parentElement}while(o);return!1}function _u(e,t,n,o){var s,i;const r=new Map;for(const[l,a]of e)(a.selected||a.id===o)&&(!a.parentNode||!Ci(a,e))&&(a.draggable||t&&typeof a.draggable>"u")&&e.get(l)&&r.set(l,{id:a.id,position:a.position||{x:0,y:0},distance:{x:n.x-((s=a.computedPosition)==null?void 0:s.x)||0,y:n.y-((i=a.computedPosition)==null?void 0:i.y)||0},from:{x:a.computedPosition.x,y:a.computedPosition.y},extent:a.extent,parentNode:a.parentNode,dimensions:{...a.dimensions},expandParent:a.expandParent});return Array.from(r.values())}function fo({id:e,dragItems:t,findNode:n}){const o=[];for(const s of t){const i=n(s.id);i&&o.push(i)}return[e?o.find(s=>s.id===e):o[0],o]}function Ii(e){if(Array.isArray(e))switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e;default:return[0,0,0,0]}return[e,e,e,e]}function bu(e,t,n){const[o,s,i,r]=typeof e!="string"?Ii(e.padding):[0,0,0,0];return n&&typeof n.computedPosition.x<"u"&&typeof n.computedPosition.y<"u"&&typeof n.dimensions.width<"u"&&typeof n.dimensions.height<"u"?[[n.computedPosition.x+r,n.computedPosition.y+o],[n.computedPosition.x+n.dimensions.width-s,n.computedPosition.y+n.dimensions.height-i]]:!1}function Eu(e,t,n,o){let s=e.extent||n;if((s==="parent"||!Array.isArray(s)&&s?.range==="parent")&&!e.expandParent)if(e.parentNode&&o&&e.dimensions.width&&e.dimensions.height){const i=bu(s,e,o);i&&(s=i)}else t(new Ge(He.NODE_EXTENT_INVALID,e.id)),s=n;else if(Array.isArray(s)){const i=o?.computedPosition.x||0,r=o?.computedPosition.y||0;s=[[s[0][0]+i,s[0][1]+r],[s[1][0]+i,s[1][1]+r]]}else if(s!=="parent"&&s?.range&&Array.isArray(s.range)){const[i,r,l,a]=Ii(s.padding),c=o?.computedPosition.x||0,u=o?.computedPosition.y||0;s=[[s.range[0][0]+c+a,s.range[0][1]+u+i],[s.range[1][0]+c-r,s.range[1][1]+u-l]]}return s==="parent"?[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]]:s}function ku({width:e,height:t},n){return[n[0],[n[1][0]-(e||0),n[1][1]-(t||0)]]}function Go(e,t,n,o,s){const i=ku(e.dimensions,Eu(e,n,o,s)),r=wi(t,i);return{position:{x:r.x-(s?.computedPosition.x||0),y:r.y-(s?.computedPosition.y||0)},computedPosition:r}}function Xt(e,t,n=Z.Left,o=!1){const s=(t?.x??0)+e.computedPosition.x,i=(t?.y??0)+e.computedPosition.y,{width:r,height:l}=t??$u(e);if(o)return{x:s+r/2,y:i+l/2};switch(t?.position??n){case Z.Top:return{x:s+r/2,y:i};case Z.Right:return{x:s+r,y:i+l/2};case Z.Bottom:return{x:s+r/2,y:i+l};case Z.Left:return{x:s,y:i+l/2}}}function bs(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Su({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:l,viewport:a}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const u=Ei({x:(0-a.x)/a.zoom,y:(0-a.y)/a.zoom,width:r/a.zoom,height:l/a.zoom}),p=Math.max(0,Math.min(u.x2,c.x2)-Math.max(u.x,c.x)),f=Math.max(0,Math.min(u.y2,c.y2)-Math.max(u.y,c.y));return Math.ceil(p*f)>0}function Nu(e,t,n=!1){const o=typeof e.zIndex=="number";let s=o?e.zIndex:0;const i=t(e.source),r=t(e.target);return!i||!r?0:(n&&(s=o?e.zIndex:Math.max(i.computedPosition.z||0,r.computedPosition.z||0)),s)}var He=(e=>(e.MISSING_STYLES="MISSING_STYLES",e.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",e.NODE_INVALID="NODE_INVALID",e.NODE_NOT_FOUND="NODE_NOT_FOUND",e.NODE_MISSING_PARENT="NODE_MISSING_PARENT",e.NODE_TYPE_MISSING="NODE_TYPE_MISSING",e.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",e.EDGE_INVALID="EDGE_INVALID",e.EDGE_NOT_FOUND="EDGE_NOT_FOUND",e.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",e.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",e.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",e.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",e.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",e.EDGE_ORPHANED="EDGE_ORPHANED",e.USEVUEFLOW_OPTIONS="USEVUEFLOW_OPTIONS",e))(He||{});const Es={MISSING_STYLES:()=>"It seems that you haven't loaded the necessary styles. Please import '@vue-flow/core/dist/style.css' to ensure that the graph is rendered correctly",MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_INVALID:e=>`Node is invalid
Node: ${e}`,NODE_NOT_FOUND:e=>`Node not found
Node: ${e}`,NODE_MISSING_PARENT:(e,t)=>`Node is missing a parent
Node: ${e}
Parent: ${t}`,NODE_TYPE_MISSING:e=>`Node type is missing
Type: ${e}`,NODE_EXTENT_INVALID:e=>`Only child nodes can use a parent extent
Node: ${e}`,EDGE_INVALID:e=>`An edge needs a source and a target
Edge: ${e}`,EDGE_SOURCE_MISSING:(e,t)=>`Edge source is missing
Edge: ${e} 
Source: ${t}`,EDGE_TARGET_MISSING:(e,t)=>`Edge target is missing
Edge: ${e} 
Target: ${t}`,EDGE_TYPE_MISSING:e=>`Edge type is missing
Type: ${e}`,EDGE_SOURCE_TARGET_SAME:(e,t,n)=>`Edge source and target are the same
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_SOURCE_TARGET_MISSING:(e,t,n)=>`Edge source or target is missing
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_ORPHANED:e=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${e}`,EDGE_NOT_FOUND:e=>`Edge not found
Edge: ${e}`,USEVUEFLOW_OPTIONS:()=>"The options parameter is deprecated and will be removed in the next major version. Please use the id parameter instead"};class Ge extends Error{constructor(t,...n){var o;super((o=Es[t])==null?void 0:o.call(Es,...n)),this.name="VueFlowError",this.code=t,this.args=n}}function Yo(e){return"clientX"in e}function Cu(e){return"sourceEvent"in e}function at(e,t){const n=Yo(e);let o,s;return n?(o=e.clientX,s=e.clientY):"touches"in e&&e.touches.length>0?(o=e.touches[0].clientX,s=e.touches[0].clientY):"changedTouches"in e&&e.changedTouches.length>0?(o=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY):(o=0,s=0),{x:o-(t?.left??0),y:s-(t?.top??0)}}const Gn=()=>{var e;return typeof navigator<"u"&&((e=navigator?.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function $u(e){var t,n;return{width:((t=e.dimensions)==null?void 0:t.width)??e.width??0,height:((n=e.dimensions)==null?void 0:n.height)??e.height??0}}function Kn(e,t=[1,1]){return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}}const Iu=()=>!0;function go(e){e?.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function Tu(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())Hn(s,Fn(i))>0&&o.push(i);return o}const Mu=250;function Du(e,t,n,o){var s,i;let r=[],l=Number.POSITIVE_INFINITY;const a=Tu(e,n,t+Mu);for(const c of a){const u=[...((s=c.handleBounds)==null?void 0:s.source)??[],...((i=c.handleBounds)==null?void 0:i.target)??[]];for(const p of u){if(o.nodeId===p.nodeId&&o.type===p.type&&o.id===p.id)continue;const{x:f,y:m}=Xt(c,p,p.position,!0),S=Math.sqrt((f-e.x)**2+(m-e.y)**2);S>t||(S<l?(r=[{...p,x:f,y:m}],l=S):S===l&&r.push({...p,x:f,y:m}))}}if(!r.length)return null;if(r.length>1){const c=o.type==="source"?"target":"source";return r.find(u=>u.type===c)??r[0]}return r[0]}function ks(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:i,doc:r,lib:l,flowId:a,isValidConnection:c=Iu},u,p,f,m){const S=i==="target",g=t?r.querySelector(`.${l}-flow__handle[data-id="${a}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:h,y:C}=at(e),P=r.elementFromPoint(h,C),k=P?.classList.contains(`${l}-flow__handle`)?P:g,y={handleDomNode:k,isValid:!1,connection:null,toHandle:null};if(k){const I=Ti(void 0,k),U=k.getAttribute("data-nodeid"),K=k.getAttribute("data-handleid"),F=k.classList.contains("connectable"),re=k.classList.contains("connectableend");if(!U||!I)return y;const ne={source:S?U:o,sourceHandle:S?K:s,target:S?o:U,targetHandle:S?s:K};y.connection=ne;const E=F&&re&&(n===kt.Strict?S&&I==="source"||!S&&I==="target":U!==o||K!==s);y.isValid=E&&c(ne,{nodes:p,edges:u,sourceNode:f(ne.source),targetNode:f(ne.target)}),y.toHandle=Mi(U,I,K,m,n,!0)}return y}function Ti(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Au(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Pu(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}function Mi(e,t,n,o,s,i=!1){var r,l,a;const c=o.get(e);if(!c)return null;const u=s===kt.Strict?(r=c.handleBounds)==null?void 0:r[t]:[...((l=c.handleBounds)==null?void 0:l.source)??[],...((a=c.handleBounds)==null?void 0:a.target)??[]],p=(n?u?.find(f=>f.id===n):u?.[0])??null;return p&&i?{...p,...Xt(c,p,p.position,!0)}:p}const Mo={[Z.Left]:Z.Right,[Z.Right]:Z.Left,[Z.Top]:Z.Bottom,[Z.Bottom]:Z.Top},Ou=["production","prod"];function jn(e,...t){Di()&&console.warn(`[Vue Flow]: ${e}`,...t)}function Di(){return!Ou.includes("production")}function Ss(e,t,n,o,s){const i=t.querySelectorAll(`.vue-flow__handle.${e}`);return i?.length?Array.from(i).map(r=>{const l=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),type:e,nodeId:s,position:r.getAttribute("data-handlepos"),x:(l.left-n.left)/o,y:(l.top-n.top)/o,...qn(r)}}):null}function Do(e,t,n,o,s,i=!1,r){s.value=!1,e.selected?(i||e.selected&&t)&&(o([e]),ot(()=>{r.blur()})):n([e])}function Fe(e){return typeof M(e)<"u"}function Ru(e,t,n,o){if(!e||!e.source||!e.target)return n(new Ge(He.EDGE_INVALID,e?.id??"[ID UNKNOWN]")),!1;let s;return St(e)?s=e:s={...e,id:bi(e)},s=xi(s,void 0,o),vu(s,t)?!1:s}function zu(e,t,n,o,s){if(!t.source||!t.target)return s(new Ge(He.EDGE_INVALID,e.id)),!1;if(!n)return s(new Ge(He.EDGE_NOT_FOUND,e.id)),!1;const{id:i,...r}=e;return{...r,id:o?bi(t):i,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}}function Ns(e,t,n){const o={},s=[];for(let i=0;i<e.length;++i){const r=e[i];if(!Mt(r)){n(new Ge(He.NODE_INVALID,r?.id)||`[ID UNKNOWN|INDEX ${i}]`);continue}const l=pu(r,t(r.id),r.parentNode);r.parentNode&&(o[r.parentNode]=!0),s[i]=l}for(const i of s){const r=t(i.parentNode)||s.find(l=>l.id===i.parentNode);i.parentNode&&!r&&n(new Ge(He.NODE_MISSING_PARENT,i.id,i.parentNode)),(i.parentNode||o[i.id])&&(o[i.id]&&(i.isParent=!0),r&&(r.isParent=!0))}return s}function Cs(e,t,n,o,s,i){let r=s;const l=o.get(r)||new Map;o.set(r,l.set(n,t)),r=`${s}-${e}`;const a=o.get(r)||new Map;if(o.set(r,a.set(n,t)),i){r=`${s}-${e}-${i}`;const c=o.get(r)||new Map;o.set(r,c.set(n,t))}}function po(e,t,n){e.clear();for(const o of n){const{source:s,target:i,sourceHandle:r=null,targetHandle:l=null}=o,a={edgeId:o.id,source:s,target:i,sourceHandle:r,targetHandle:l},c=`${s}-${r}--${i}-${l}`,u=`${i}-${l}--${s}-${r}`;Cs("source",a,u,e,s,r),Cs("target",a,c,e,i,l)}}function $s(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ho(e,t,n,o,s,i,r,l){const a=[];for(const c of e){const u=St(c)?c:Ru(c,l,s,i);if(!u)continue;const p=n(u.source),f=n(u.target);if(!p||!f){s(new Ge(He.EDGE_SOURCE_TARGET_MISSING,u.id,u.source,u.target));continue}if(!p){s(new Ge(He.EDGE_SOURCE_MISSING,u.id,u.source));continue}if(!f){s(new Ge(He.EDGE_TARGET_MISSING,u.id,u.target));continue}if(t&&!t(u,{edges:l,nodes:r,sourceNode:p,targetNode:f})){s(new Ge(He.EDGE_INVALID,u.id));continue}const m=o(u.id);a.push({...xi(u,m,i),sourceNode:p,targetNode:f})}return a}const Is=Symbol("vueFlow"),Ai=Symbol("nodeId"),Pi=Symbol("nodeRef"),Bu=Symbol("edgeId"),Lu=Symbol("edgeRef"),Jn=Symbol("slots");function Oi(e){const{vueFlowRef:t,snapToGrid:n,snapGrid:o,noDragClassName:s,nodeLookup:i,nodeExtent:r,nodeDragThreshold:l,viewport:a,autoPanOnNodeDrag:c,autoPanSpeed:u,nodesDraggable:p,panBy:f,findNode:m,multiSelectionActive:S,nodesSelectionActive:g,selectNodesOnDrag:h,removeSelectedElements:C,addSelectedNodes:P,updateNodePositions:k,emits:y}=Be(),{onStart:I,onDrag:U,onStop:K,onClick:F,el:re,disabled:ne,id:D,selectable:E,dragHandle:le}=e,b=An(!1);let B=[],T,L=null,H={x:void 0,y:void 0},J={x:0,y:0},X=null,se=!1,de=!1,me=0,ee=!1;const ce=Hu(),ae=({x:pe,y:Ee})=>{H={x:pe,y:Ee};let w=!1;if(B=B.map(v=>{const _={x:pe-v.distance.x,y:Ee-v.distance.y},{computedPosition:x}=Go(v,n.value?Kn(_,o.value):_,y.error,r.value,v.parentNode?m(v.parentNode):void 0);return w=w||v.position.x!==x.x||v.position.y!==x.y,v.position=x,v}),de=de||w,!!w&&(k(B,!0,!0),b.value=!0,X)){const[v,_]=fo({id:D,dragItems:B,findNode:m});U({event:X,node:v,nodes:_})}},he=()=>{if(!L)return;const[pe,Ee]=$i(J,L,u.value);if(pe!==0||Ee!==0){const w={x:(H.x??0)-pe/a.value.zoom,y:(H.y??0)-Ee/a.value.zoom};f({x:pe,y:Ee})&&ae(w)}me=requestAnimationFrame(he)},ke=(pe,Ee)=>{se=!0;const w=m(D);!h.value&&!S.value&&w&&(w.selected||C()),w&&Ne(E)&&h.value&&Do(w,S.value,P,C,g,!1,Ee);const v=ce(pe.sourceEvent);if(H=v,B=_u(i.value,p.value,v,D),B.length){const[_,x]=fo({id:D,dragItems:B,findNode:m});I({event:pe.sourceEvent,node:_,nodes:x})}},_e=(pe,Ee)=>{var w;pe.sourceEvent.type==="touchmove"&&pe.sourceEvent.touches.length>1||(de=!1,l.value===0&&ke(pe,Ee),H=ce(pe.sourceEvent),L=((w=t.value)==null?void 0:w.getBoundingClientRect())||null,J=at(pe.sourceEvent,L))},Ce=(pe,Ee)=>{const w=ce(pe.sourceEvent);if(!ee&&se&&c.value&&(ee=!0,he()),!se){const v=w.xSnapped-(H.x??0),_=w.ySnapped-(H.y??0);Math.sqrt(v*v+_*_)>l.value&&ke(pe,Ee)}(H.x!==w.xSnapped||H.y!==w.ySnapped)&&B.length&&se&&(X=pe.sourceEvent,J=at(pe.sourceEvent,L),ae(w))},Te=pe=>{let Ee=!1;if(!se&&!b.value&&!S.value){const w=pe.sourceEvent,v=ce(w),_=v.xSnapped-(H.x??0),x=v.ySnapped-(H.y??0),R=Math.sqrt(_*_+x*x);R!==0&&R<=l.value&&(F?.(w),Ee=!0)}if(B.length&&!Ee){de&&(k(B,!1,!1),de=!1);const[w,v]=fo({id:D,dragItems:B,findNode:m});K({event:pe.sourceEvent,node:w,nodes:v})}B=[],b.value=!1,ee=!1,se=!1,H={x:void 0,y:void 0},cancelAnimationFrame(me)};return De([()=>Ne(ne),re],([pe,Ee],w,v)=>{if(Ee){const _=tt(Ee);pe||(T=ga().on("start",x=>_e(x,Ee)).on("drag",x=>Ce(x,Ee)).on("end",x=>Te(x)).filter(x=>{const R=x.target,Q=Ne(le);return!x.button&&(!s.value||!_s(R,`.${s.value}`,Ee)&&(!Q||_s(R,Q,Ee)))}),_.call(T)),v(()=>{_.on(".drag",null),T&&(T.on("start",null),T.on("drag",null),T.on("end",null))})}}),b}function Vu(){return{doubleClick:te(),click:te(),mouseEnter:te(),mouseMove:te(),mouseLeave:te(),contextMenu:te(),updateStart:te(),update:te(),updateEnd:te()}}function Fu(e,t){const n=Vu();return n.doubleClick.on(o=>{var s,i;t.edgeDoubleClick(o),(i=(s=e.events)==null?void 0:s.doubleClick)==null||i.call(s,o)}),n.click.on(o=>{var s,i;t.edgeClick(o),(i=(s=e.events)==null?void 0:s.click)==null||i.call(s,o)}),n.mouseEnter.on(o=>{var s,i;t.edgeMouseEnter(o),(i=(s=e.events)==null?void 0:s.mouseEnter)==null||i.call(s,o)}),n.mouseMove.on(o=>{var s,i;t.edgeMouseMove(o),(i=(s=e.events)==null?void 0:s.mouseMove)==null||i.call(s,o)}),n.mouseLeave.on(o=>{var s,i;t.edgeMouseLeave(o),(i=(s=e.events)==null?void 0:s.mouseLeave)==null||i.call(s,o)}),n.contextMenu.on(o=>{var s,i;t.edgeContextMenu(o),(i=(s=e.events)==null?void 0:s.contextMenu)==null||i.call(s,o)}),n.updateStart.on(o=>{var s,i;t.edgeUpdateStart(o),(i=(s=e.events)==null?void 0:s.updateStart)==null||i.call(s,o)}),n.update.on(o=>{var s,i;t.edgeUpdate(o),(i=(s=e.events)==null?void 0:s.update)==null||i.call(s,o)}),n.updateEnd.on(o=>{var s,i;t.edgeUpdateEnd(o),(i=(s=e.events)==null?void 0:s.updateEnd)==null||i.call(s,o)}),Object.entries(n).reduce((o,[s,i])=>(o.emit[s]=i.trigger,o.on[s]=i.on,o),{emit:{},on:{}})}function Hu(){const{viewport:e,snapGrid:t,snapToGrid:n,vueFlowRef:o}=Be();return s=>{var i;const r=((i=o.value)==null?void 0:i.getBoundingClientRect())??{left:0,top:0},l=Cu(s)?s.sourceEvent:s,{x:a,y:c}=at(l,r),u=gn({x:a,y:c},e.value),{x:p,y:f}=n.value?Kn(u,t.value):u;return{xSnapped:p,ySnapped:f,...u}}}function kn(){return!0}function Ri({handleId:e,nodeId:t,type:n,isValidConnection:o,edgeUpdaterType:s,onEdgeUpdate:i,onEdgeUpdateEnd:r}){const{id:l,vueFlowRef:a,connectionMode:c,connectionRadius:u,connectOnClick:p,connectionClickStartHandle:f,nodesConnectable:m,autoPanOnConnect:S,autoPanSpeed:g,findNode:h,panBy:C,startConnection:P,updateConnection:k,endConnection:y,emits:I,viewport:U,edges:K,nodes:F,isValidConnection:re,nodeLookup:ne}=Be();let D=null,E=!1,le=null;function b(T){var L;const H=Ne(n)==="target",J=Yo(T),X=fs(T.target),se=T.currentTarget;if(se&&(J&&T.button===0||!J)){let de=function(ue){w=at(ue,Te),ae=Du(gn(w,U.value,!1,[1,1]),u.value,ne.value,x),v||(_(),v=!0);const ve=ks(ue,{handle:ae,connectionMode:c.value,fromNodeId:Ne(t),fromHandleId:Ne(e),fromType:H?"target":"source",isValidConnection:ce,doc:X,lib:"vue",flowId:l,nodeLookup:ne.value},K.value,F.value,h,ne.value);le=ve.handleDomNode,D=ve.connection,E=Pu(!!ae,ve.isValid);const Se={...ie,isValid:E,to:ve.toHandle&&E?To({x:ve.toHandle.x,y:ve.toHandle.y},U.value):w,toHandle:ve.toHandle,toPosition:E&&ve.toHandle?ve.toHandle.position:Mo[x.position],toNode:ve.toHandle?ne.value.get(ve.toHandle.nodeId):null};if(E&&ae&&ie?.toHandle&&Se.toHandle&&ie.toHandle.type===Se.toHandle.type&&ie.toHandle.nodeId===Se.toHandle.nodeId&&ie.toHandle.id===Se.toHandle.id&&ie.to.x===Se.to.x&&ie.to.y===Se.to.y)return;const $e=ae??ve.toHandle;if(k($e&&E?To({x:$e.x,y:$e.y},U.value):w,ve.toHandle,Au(!!$e,E)),ie=Se,!ae&&!E&&!le)return go(Ee);D&&D.source!==D.target&&le&&(go(Ee),Ee=le,le.classList.add("connecting","vue-flow__handle-connecting"),le.classList.toggle("valid",!!E),le.classList.toggle("vue-flow__handle-valid",!!E))},me=function(ue){"touches"in ue&&ue.touches.length>0||((ae||le)&&D&&E&&(i?i(ue,D):I.connect(D)),I.connectEnd(ue),s&&r?.(ue),go(Ee),cancelAnimationFrame(he),y(ue),v=!1,E=!1,D=null,le=null,X.removeEventListener("mousemove",de),X.removeEventListener("mouseup",me),X.removeEventListener("touchmove",de),X.removeEventListener("touchend",me))};const ee=h(Ne(t));let ce=Ne(o)||re.value||kn;!ce&&ee&&(ce=(H?ee.isValidSourcePos:ee.isValidTargetPos)||kn);let ae,he=0;const{x:ke,y:_e}=at(T),Ce=Ti(Ne(s),se),Te=(L=a.value)==null?void 0:L.getBoundingClientRect();if(!Te||!Ce)return;const pe=Mi(Ne(t),Ce,Ne(e),ne.value,c.value);if(!pe)return;let Ee,w=at(T,Te),v=!1;const _=()=>{if(!S.value)return;const[ue,ve]=$i(w,Te,g.value);C({x:ue,y:ve}),he=requestAnimationFrame(_)},x={...pe,nodeId:Ne(t),type:Ce,position:pe.position},R=ne.value.get(Ne(t)),oe={inProgress:!0,isValid:null,from:Xt(R,x,Z.Left,!0),fromHandle:x,fromPosition:x.position,fromNode:R,to:w,toHandle:null,toPosition:Mo[x.position],toNode:null};P({nodeId:Ne(t),id:Ne(e),type:Ce,position:se?.getAttribute("data-handlepos")||Z.Top,...w},{x:ke-Te.left,y:_e-Te.top}),I.connectStart({event:T,nodeId:Ne(t),handleId:Ne(e),handleType:Ce});let ie=oe;X.addEventListener("mousemove",de),X.addEventListener("mouseup",me),X.addEventListener("touchmove",de),X.addEventListener("touchend",me)}}function B(T){var L,H;if(!p.value)return;const J=Ne(n)==="target";if(!f.value){I.clickConnectStart({event:T,nodeId:Ne(t),handleId:Ne(e)}),P({nodeId:Ne(t),type:Ne(n),id:Ne(e),position:Z.Top,...at(T)},void 0,!0);return}let X=Ne(o)||re.value||kn;const se=h(Ne(t));if(!X&&se&&(X=(J?se.isValidSourcePos:se.isValidTargetPos)||kn),se&&(typeof se.connectable>"u"?m.value:se.connectable)===!1)return;const de=fs(T.target),me=ks(T,{handle:{nodeId:Ne(t),id:Ne(e),type:Ne(n),position:Z.Top,...at(T)},connectionMode:c.value,fromNodeId:f.value.nodeId,fromHandleId:f.value.id??null,fromType:f.value.type,isValidConnection:X,doc:de,lib:"vue",flowId:l,nodeLookup:ne.value},K.value,F.value,h,ne.value),ee=((L=me.connection)==null?void 0:L.source)===((H=me.connection)==null?void 0:H.target);me.isValid&&me.connection&&!ee&&I.connect(me.connection),I.clickConnectEnd(T),y(T,!0)}return{handlePointerDown:b,handleClick:B}}function Gu(){return Zt(Ai,"")}function zi(e){const t=e??Gu()??"",n=Zt(Pi,ge(null)),{findNode:o,edges:s,emits:i}=Be(),r=o(t);return r||i.error(new Ge(He.NODE_NOT_FOUND,t)),{id:t,nodeEl:n,node:r,parentNode:W(()=>o(r.parentNode)),connectedEdges:W(()=>Ni([r],s.value))}}function Yu(){return{doubleClick:te(),click:te(),mouseEnter:te(),mouseMove:te(),mouseLeave:te(),contextMenu:te(),dragStart:te(),drag:te(),dragStop:te()}}function Wu(e,t){const n=Yu();return n.doubleClick.on(o=>{var s,i;t.nodeDoubleClick(o),(i=(s=e.events)==null?void 0:s.doubleClick)==null||i.call(s,o)}),n.click.on(o=>{var s,i;t.nodeClick(o),(i=(s=e.events)==null?void 0:s.click)==null||i.call(s,o)}),n.mouseEnter.on(o=>{var s,i;t.nodeMouseEnter(o),(i=(s=e.events)==null?void 0:s.mouseEnter)==null||i.call(s,o)}),n.mouseMove.on(o=>{var s,i;t.nodeMouseMove(o),(i=(s=e.events)==null?void 0:s.mouseMove)==null||i.call(s,o)}),n.mouseLeave.on(o=>{var s,i;t.nodeMouseLeave(o),(i=(s=e.events)==null?void 0:s.mouseLeave)==null||i.call(s,o)}),n.contextMenu.on(o=>{var s,i;t.nodeContextMenu(o),(i=(s=e.events)==null?void 0:s.contextMenu)==null||i.call(s,o)}),n.dragStart.on(o=>{var s,i;t.nodeDragStart(o),(i=(s=e.events)==null?void 0:s.dragStart)==null||i.call(s,o)}),n.drag.on(o=>{var s,i;t.nodeDrag(o),(i=(s=e.events)==null?void 0:s.drag)==null||i.call(s,o)}),n.dragStop.on(o=>{var s,i;t.nodeDragStop(o),(i=(s=e.events)==null?void 0:s.dragStop)==null||i.call(s,o)}),Object.entries(n).reduce((o,[s,i])=>(o.emit[s]=i.trigger,o.on[s]=i.on,o),{emit:{},on:{}})}function Bi(){const{getSelectedNodes:e,nodeExtent:t,updateNodePositions:n,findNode:o,snapGrid:s,snapToGrid:i,nodesDraggable:r,emits:l}=Be();return(a,c=!1)=>{const u=i.value?s.value[0]:5,p=i.value?s.value[1]:5,f=c?4:1,m=a.x*u*f,S=a.y*p*f,g=[];for(const h of e.value)if(h.draggable||r&&typeof h.draggable>"u"){const C={x:h.computedPosition.x+m,y:h.computedPosition.y+S},{computedPosition:P}=Go(h,C,l.error,t.value,h.parentNode?o(h.parentNode):void 0);g.push({id:h.id,position:P,from:h.position,distance:{x:a.x,y:a.y},dimensions:h.dimensions})}n(g,!0,!1)}}const mo=.1,Uu=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2;function xt(){return jn("Viewport not initialized yet."),Promise.resolve(!1)}const Xu={zoomIn:xt,zoomOut:xt,zoomTo:xt,fitView:xt,setCenter:xt,fitBounds:xt,project:e=>e,screenToFlowCoordinate:e=>e,flowToScreenCoordinate:e=>e,setViewport:xt,setTransform:xt,getViewport:()=>({x:0,y:0,zoom:1}),getTransform:()=>({x:0,y:0,zoom:1}),viewportInitialized:!1};function Zu(e){function t(o,s){return new Promise(i=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(s?.interpolate==="linear"?sn:In).scaleBy(vo(e.d3Selection,s?.duration,s?.ease,()=>{i(!0)}),o):i(!1)})}function n(o,s,i,r){return new Promise(l=>{var a;const{x:c,y:u}=wi({x:-o,y:-s},e.translateExtent),p=Ut.translate(-c,-u).scale(i);e.d3Selection&&e.d3Zoom?(a=e.d3Zoom)==null||a.interpolate(r?.interpolate==="linear"?sn:In).transform(vo(e.d3Selection,r?.duration,r?.ease,()=>{l(!0)}),p):l(!1)})}return W(()=>e.d3Zoom&&e.d3Selection&&e.dimensions.width&&e.dimensions.height?{viewportInitialized:!0,zoomIn:s=>t(1.2,s),zoomOut:s=>t(1/1.2,s),zoomTo:(s,i)=>new Promise(r=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(i?.interpolate==="linear"?sn:In).scaleTo(vo(e.d3Selection,i?.duration,i?.ease,()=>{r(!0)}),s):r(!1)}),setViewport:(s,i)=>n(s.x,s.y,s.zoom,i),setTransform:(s,i)=>n(s.x,s.y,s.zoom,i),getViewport:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),getTransform:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),fitView:(s={padding:mo,includeHiddenNodes:!1,duration:0})=>{var i,r;const l=[];for(const f of e.nodes)f.dimensions.width&&f.dimensions.height&&(s?.includeHiddenNodes||!f.hidden)&&(!((i=s.nodes)!=null&&i.length)||(r=s.nodes)!=null&&r.length&&s.nodes.includes(f.id))&&l.push(f);if(!l.length)return Promise.resolve(!1);const a=ki(l),{x:c,y:u,zoom:p}=gs(a,e.dimensions.width,e.dimensions.height,s.minZoom??e.minZoom,s.maxZoom??e.maxZoom,s.padding??mo,s.offset);return n(c,u,p,s)},setCenter:(s,i,r)=>{const l=typeof r?.zoom<"u"?r.zoom:e.maxZoom,a=e.dimensions.width/2-s*l,c=e.dimensions.height/2-i*l;return n(a,c,l,r)},fitBounds:(s,i={padding:mo})=>{const{x:r,y:l,zoom:a}=gs(s,e.dimensions.width,e.dimensions.height,e.minZoom,e.maxZoom,i.padding);return n(r,l,a,i)},project:s=>gn(s,e.viewport,e.snapToGrid,e.snapGrid),screenToFlowCoordinate:s=>{if(e.vueFlowRef){const{x:i,y:r}=e.vueFlowRef.getBoundingClientRect(),l={x:s.x-i,y:s.y-r};return gn(l,e.viewport,e.snapToGrid,e.snapGrid)}return{x:0,y:0}},flowToScreenCoordinate:s=>{if(e.vueFlowRef){const{x:i,y:r}=e.vueFlowRef.getBoundingClientRect(),l={x:s.x+i,y:s.y+r};return To(l,e.viewport)}return{x:0,y:0}}}:Xu)}function vo(e,t=0,n=Uu,o=()=>{}){const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e}function qu(e,t,n){const o=zs(!0);return o.run(()=>{const s=()=>{o.run(()=>{let g,h,C=!!(n.nodes.value.length||n.edges.value.length);g=Bt([e.modelValue,()=>{var P,k;return(k=(P=e.modelValue)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setElements(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Bt([n.nodes,n.edges,()=>n.edges.value.length,()=>n.nodes.value.length],([P,k])=>{var y;(y=e.modelValue)!=null&&y.value&&Array.isArray(e.modelValue.value)&&(g?.pause(),e.modelValue.value=[...P,...k],ot(()=>{g?.resume()}))},{immediate:C}),Nn(()=>{g?.stop(),h?.stop()})})},i=()=>{o.run(()=>{let g,h,C=!!n.nodes.value.length;g=Bt([e.nodes,()=>{var P,k;return(k=(P=e.nodes)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setNodes(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Bt([n.nodes,()=>n.nodes.value.length],([P])=>{var k;(k=e.nodes)!=null&&k.value&&Array.isArray(e.nodes.value)&&(g?.pause(),e.nodes.value=[...P],ot(()=>{g?.resume()}))},{immediate:C}),Nn(()=>{g?.stop(),h?.stop()})})},r=()=>{o.run(()=>{let g,h,C=!!n.edges.value.length;g=Bt([e.edges,()=>{var P,k;return(k=(P=e.edges)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setEdges(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Bt([n.edges,()=>n.edges.value.length],([P])=>{var k;(k=e.edges)!=null&&k.value&&Array.isArray(e.edges.value)&&(g?.pause(),e.edges.value=[...P],ot(()=>{g?.resume()}))},{immediate:C}),Nn(()=>{g?.stop(),h?.stop()})})},l=()=>{o.run(()=>{De(()=>t.maxZoom,()=>{t.maxZoom&&Fe(t.maxZoom)&&n.setMaxZoom(t.maxZoom)},{immediate:!0})})},a=()=>{o.run(()=>{De(()=>t.minZoom,()=>{t.minZoom&&Fe(t.minZoom)&&n.setMinZoom(t.minZoom)},{immediate:!0})})},c=()=>{o.run(()=>{De(()=>t.translateExtent,()=>{t.translateExtent&&Fe(t.translateExtent)&&n.setTranslateExtent(t.translateExtent)},{immediate:!0})})},u=()=>{o.run(()=>{De(()=>t.nodeExtent,()=>{t.nodeExtent&&Fe(t.nodeExtent)&&n.setNodeExtent(t.nodeExtent)},{immediate:!0})})},p=()=>{o.run(()=>{De(()=>t.applyDefault,()=>{Fe(t.applyDefault)&&(n.applyDefault.value=t.applyDefault)},{immediate:!0})})},f=()=>{o.run(()=>{const g=async h=>{let C=h;typeof t.autoConnect=="function"&&(C=await t.autoConnect(h)),C!==!1&&n.addEdges([C])};De(()=>t.autoConnect,()=>{Fe(t.autoConnect)&&(n.autoConnect.value=t.autoConnect)},{immediate:!0}),De(n.autoConnect,(h,C,P)=>{h?n.onConnect(g):n.hooks.value.connect.off(g),P(()=>{n.hooks.value.connect.off(g)})},{immediate:!0})})},m=()=>{const g=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];for(const h of Object.keys(t)){const C=h;if(!g.includes(C)){const P=ze(()=>t[C]),k=n[C];Po(k)&&o.run(()=>{De(P,y=>{Fe(y)&&(k.value=y)},{immediate:!0})})}}};(()=>{s(),i(),r(),a(),l(),c(),u(),p(),f(),m()})()}),()=>o.stop()}function Ku(){return{edgesChange:te(),nodesChange:te(),nodeDoubleClick:te(),nodeClick:te(),nodeMouseEnter:te(),nodeMouseMove:te(),nodeMouseLeave:te(),nodeContextMenu:te(),nodeDragStart:te(),nodeDrag:te(),nodeDragStop:te(),nodesInitialized:te(),miniMapNodeClick:te(),miniMapNodeDoubleClick:te(),miniMapNodeMouseEnter:te(),miniMapNodeMouseMove:te(),miniMapNodeMouseLeave:te(),connect:te(),connectStart:te(),connectEnd:te(),clickConnectStart:te(),clickConnectEnd:te(),paneReady:te(),init:te(),move:te(),moveStart:te(),moveEnd:te(),selectionDragStart:te(),selectionDrag:te(),selectionDragStop:te(),selectionContextMenu:te(),selectionStart:te(),selectionEnd:te(),viewportChangeStart:te(),viewportChange:te(),viewportChangeEnd:te(),paneScroll:te(),paneClick:te(),paneContextMenu:te(),paneMouseEnter:te(),paneMouseMove:te(),paneMouseLeave:te(),edgeContextMenu:te(),edgeMouseEnter:te(),edgeMouseMove:te(),edgeMouseLeave:te(),edgeDoubleClick:te(),edgeClick:te(),edgeUpdateStart:te(),edgeUpdate:te(),edgeUpdateEnd:te(),updateNodeInternals:te(),error:te(e=>jn(e.message))}}function ju(e,t){const n=qt();Ji(()=>{for(const[s,i]of Object.entries(t.value)){const r=l=>{e(s,l)};i.setEmitter(r),an(i.removeEmitter),i.setHasEmitListeners(()=>o(s)),an(i.removeHasEmitListeners)}});function o(s){var i;const r=Ju(s);return!!((i=n?.vnode.props)==null?void 0:i[r])}}function Ju(e){const[t,...n]=e.split(":");return`on${t.replace(/(?:^|-)(\w)/g,(s,i)=>i.toUpperCase())}${n.length?`:${n.join(":")}`:""}`}function Li(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],connectionLookup:new Map,nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:Ho.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:rn.Free,paneClickDistance:0,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:Ct.Bezier,style:{}},connectionMode:kt.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:Number.NaN,y:Number.NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,nodeDragThreshold:1,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:Gn()?"Meta":"Control",zoomActivationKeyCode:Gn()?"Meta":"Control",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:Ku(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,fitViewOnInitDone:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,autoPanSpeed:15,disableKeyboardA11y:!1,ariaLiveMessage:""}}const Qu=["id","vueFlowRef","viewportRef","initialized","modelValue","nodes","edges","maxZoom","minZoom","translateExtent","hooks","defaultEdgeOptions"];function ed(e,t,n){const o=Zu(e),s=w=>{const v=w??[];e.hooks.updateNodeInternals.trigger(v)},i=w=>mu(w,e.nodes,e.edges),r=w=>hu(w,e.nodes,e.edges),l=w=>Ni(w,e.edges),a=({id:w,type:v,nodeId:_})=>{var x;const R=w?`-${v}-${w}`:`-${v}`;return Array.from(((x=e.connectionLookup.get(`${_}${R}`))==null?void 0:x.values())??[])},c=w=>{if(w)return t.value.get(w)},u=w=>{if(w)return n.value.get(w)},p=(w,v,_)=>{var x,R;const Q=[];for(const oe of w){const ie={id:oe.id,type:"position",dragging:_,from:oe.from};if(v&&(ie.position=oe.position,oe.parentNode)){const ue=c(oe.parentNode);ie.position={x:ie.position.x-(((x=ue?.computedPosition)==null?void 0:x.x)??0),y:ie.position.y-(((R=ue?.computedPosition)==null?void 0:R.y)??0)}}Q.push(ie)}Q?.length&&e.hooks.nodesChange.trigger(Q)},f=w=>{if(!e.vueFlowRef)return;const v=e.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!v)return;const _=window.getComputedStyle(v),{m22:x}=new window.DOMMatrixReadOnly(_.transform),R=[];for(const Q of w){const oe=Q,ie=c(oe.id);if(ie){const ue=qn(oe.nodeElement);if(!!(ue.width&&ue.height&&(ie.dimensions.width!==ue.width||ie.dimensions.height!==ue.height||oe.forceUpdate))){const Se=oe.nodeElement.getBoundingClientRect();ie.dimensions=ue,ie.handleBounds.source=Ss("source",oe.nodeElement,Se,x,ie.id),ie.handleBounds.target=Ss("target",oe.nodeElement,Se,x,ie.id),R.push({id:ie.id,type:"dimensions",dimensions:ue})}}}!e.fitViewOnInitDone&&e.fitViewOnInit&&o.value.fitView().then(()=>{e.fitViewOnInitDone=!0}),R.length&&e.hooks.nodesChange.trigger(R)},m=(w,v)=>{const _=new Set,x=new Set;for(const oe of w)Mt(oe)?_.add(oe.id):St(oe)&&x.add(oe.id);const R=bt(t.value,_,!0),Q=bt(n.value,x);if(e.multiSelectionActive){for(const oe of _)R.push(_t(oe,v));for(const oe of x)Q.push(_t(oe,v))}R.length&&e.hooks.nodesChange.trigger(R),Q.length&&e.hooks.edgesChange.trigger(Q)},S=w=>{if(e.multiSelectionActive){const v=w.map(_=>_t(_.id,!0));e.hooks.nodesChange.trigger(v);return}e.hooks.nodesChange.trigger(bt(t.value,new Set(w.map(v=>v.id)),!0)),e.hooks.edgesChange.trigger(bt(n.value))},g=w=>{if(e.multiSelectionActive){const v=w.map(_=>_t(_.id,!0));e.hooks.edgesChange.trigger(v);return}e.hooks.edgesChange.trigger(bt(n.value,new Set(w.map(v=>v.id)))),e.hooks.nodesChange.trigger(bt(t.value,new Set,!0))},h=w=>{m(w,!0)},C=w=>{const _=(w||e.nodes).map(x=>(x.selected=!1,_t(x.id,!1)));e.hooks.nodesChange.trigger(_)},P=w=>{const _=(w||e.edges).map(x=>(x.selected=!1,_t(x.id,!1)));e.hooks.edgesChange.trigger(_)},k=w=>{if(!w||!w.length)return m([],!1);const v=w.reduce((_,x)=>{const R=_t(x.id,!1);return Mt(x)?_.nodes.push(R):_.edges.push(R),_},{nodes:[],edges:[]});v.nodes.length&&e.hooks.nodesChange.trigger(v.nodes),v.edges.length&&e.hooks.edgesChange.trigger(v.edges)},y=w=>{var v;(v=e.d3Zoom)==null||v.scaleExtent([w,e.maxZoom]),e.minZoom=w},I=w=>{var v;(v=e.d3Zoom)==null||v.scaleExtent([e.minZoom,w]),e.maxZoom=w},U=w=>{var v;(v=e.d3Zoom)==null||v.translateExtent(w),e.translateExtent=w},K=w=>{e.nodeExtent=w,s()},F=w=>{var v;(v=e.d3Zoom)==null||v.clickDistance(w)},re=w=>{e.nodesDraggable=w,e.nodesConnectable=w,e.elementsSelectable=w},ne=w=>{const v=w instanceof Function?w(e.nodes):w;!e.initialized&&!v.length||(e.nodes=Ns(v,c,e.hooks.error.trigger))},D=w=>{const v=w instanceof Function?w(e.edges):w;if(!e.initialized&&!v.length)return;const _=ho(v,e.isValidConnection,c,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);po(e.connectionLookup,n.value,_),e.edges=_},E=w=>{const v=w instanceof Function?w([...e.nodes,...e.edges]):w;!e.initialized&&!v.length||(ne(v.filter(Mt)),D(v.filter(St)))},le=w=>{let v=w instanceof Function?w(e.nodes):w;v=Array.isArray(v)?v:[v];const _=Ns(v,c,e.hooks.error.trigger),x=[];for(const R of _)x.push(vs(R));x.length&&e.hooks.nodesChange.trigger(x)},b=w=>{let v=w instanceof Function?w(e.edges):w;v=Array.isArray(v)?v:[v];const _=ho(v,e.isValidConnection,c,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges),x=[];for(const R of _)x.push(vs(R));x.length&&e.hooks.edgesChange.trigger(x)},B=(w,v=!0,_=!1)=>{const x=w instanceof Function?w(e.nodes):w,R=Array.isArray(x)?x:[x],Q=[],oe=[];function ie(ve){const Se=l(ve);for(const $e of Se)(!Fe($e.deletable)||$e.deletable)&&oe.push(ws($e.id,$e.source,$e.target,$e.sourceHandle,$e.targetHandle))}function ue(ve){const Se=[];for(const $e of e.nodes)$e.parentNode===ve&&Se.push($e);if(Se.length){for(const $e of Se)Q.push(ys($e.id));v&&ie(Se);for(const $e of Se)ue($e.id)}}for(const ve of R){const Se=typeof ve=="string"?c(ve):ve;Se&&(Fe(Se.deletable)&&!Se.deletable||(Q.push(ys(Se.id)),v&&ie([Se]),_&&ue(Se.id)))}oe.length&&e.hooks.edgesChange.trigger(oe),Q.length&&e.hooks.nodesChange.trigger(Q)},T=w=>{const v=w instanceof Function?w(e.edges):w,_=Array.isArray(v)?v:[v],x=[];for(const R of _){const Q=typeof R=="string"?u(R):R;Q&&(Fe(Q.deletable)&&!Q.deletable||x.push(ws(typeof R=="string"?R:R.id,Q.source,Q.target,Q.sourceHandle,Q.targetHandle)))}e.hooks.edgesChange.trigger(x)},L=(w,v,_=!0)=>{const x=u(w.id);if(!x)return!1;const R=e.edges.indexOf(x),Q=zu(w,v,x,_,e.hooks.error.trigger);if(Q){const[oe]=ho([Q],e.isValidConnection,c,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);return e.edges=e.edges.map((ie,ue)=>ue===R?oe:ie),po(e.connectionLookup,n.value,[oe]),oe}return!1},H=(w,v,_={replace:!1})=>{const x=u(w);if(!x)return;const R=typeof v=="function"?v(x):v;x.data=_.replace?R:{...x.data,...R}},J=w=>ms(w,e.nodes),X=w=>{const v=ms(w,e.edges);return po(e.connectionLookup,n.value,v),v},se=(w,v,_={replace:!1})=>{const x=c(w);if(!x)return;const R=typeof v=="function"?v(x):v;_.replace?e.nodes.splice(e.nodes.indexOf(x),1,R):Object.assign(x,R)},de=(w,v,_={replace:!1})=>{const x=c(w);if(!x)return;const R=typeof v=="function"?v(x):v;x.data=_.replace?R:{...x.data,...R}},me=(w,v,_=!1)=>{_?e.connectionClickStartHandle=w:e.connectionStartHandle=w,e.connectionEndHandle=null,e.connectionStatus=null,v&&(e.connectionPosition=v)},ee=(w,v=null,_=null)=>{e.connectionStartHandle&&(e.connectionPosition=w,e.connectionEndHandle=v,e.connectionStatus=_)},ce=(w,v)=>{e.connectionPosition={x:Number.NaN,y:Number.NaN},e.connectionEndHandle=null,e.connectionStatus=null,v?e.connectionClickStartHandle=null:e.connectionStartHandle=null},ae=w=>{const v=gu(w),_=v?null:on(w)?w:c(w.id);return!v&&!_?[null,null,v]:[v?w:Fn(_),_,v]},he=(w,v=!0,_=e.nodes)=>{const[x,R,Q]=ae(w);if(!x)return[];const oe=[];for(const ie of _||e.nodes){if(!Q&&(ie.id===R.id||!ie.computedPosition))continue;const ue=Fn(ie),ve=Hn(ue,x);(v&&ve>0||ve>=ue.width*ue.height||ve>=Number(x.width)*Number(x.height))&&oe.push(ie)}return oe},ke=(w,v,_=!0)=>{const[x]=ae(w);if(!x)return!1;const R=Hn(x,v);return _&&R>0||R>=Number(x.width)*Number(x.height)},_e=w=>{const{viewport:v,dimensions:_,d3Zoom:x,d3Selection:R,translateExtent:Q}=e;if(!x||!R||!w.x&&!w.y)return!1;const oe=Ut.translate(v.x+w.x,v.y+w.y).scale(v.zoom),ie=[[0,0],[_.width,_.height]],ue=x.constrain()(oe,ie,Q),ve=e.viewport.x!==ue.x||e.viewport.y!==ue.y||e.viewport.zoom!==ue.k;return x.transform(R,ue),ve},Ce=w=>{const v=w instanceof Function?w(e):w,_=["d3Zoom","d3Selection","d3ZoomHandler","viewportRef","vueFlowRef","dimensions","hooks"];Fe(v.defaultEdgeOptions)&&(e.defaultEdgeOptions=v.defaultEdgeOptions);const x=v.modelValue||v.nodes||v.edges?[]:void 0;x&&(v.modelValue&&x.push(...v.modelValue),v.nodes&&x.push(...v.nodes),v.edges&&x.push(...v.edges),E(x));const R=()=>{Fe(v.maxZoom)&&I(v.maxZoom),Fe(v.minZoom)&&y(v.minZoom),Fe(v.translateExtent)&&U(v.translateExtent)};for(const Q of Object.keys(v)){const oe=Q,ie=v[oe];![...Qu,..._].includes(oe)&&Fe(ie)&&(e[oe]=ie)}wo(()=>e.d3Zoom).not.toBeNull().then(R),e.initialized||(e.initialized=!0)};return{updateNodePositions:p,updateNodeDimensions:f,setElements:E,setNodes:ne,setEdges:D,addNodes:le,addEdges:b,removeNodes:B,removeEdges:T,findNode:c,findEdge:u,updateEdge:L,updateEdgeData:H,updateNode:se,updateNodeData:de,applyEdgeChanges:X,applyNodeChanges:J,addSelectedElements:h,addSelectedNodes:S,addSelectedEdges:g,setMinZoom:y,setMaxZoom:I,setTranslateExtent:U,setNodeExtent:K,setPaneClickDistance:F,removeSelectedElements:k,removeSelectedNodes:C,removeSelectedEdges:P,startConnection:me,updateConnection:ee,endConnection:ce,setInteractive:re,setState:Ce,getIntersectingNodes:he,getIncomers:i,getOutgoers:r,getConnectedEdges:l,getHandleConnections:a,isNodeIntersecting:ke,panBy:_e,fitView:w=>o.value.fitView(w),zoomIn:w=>o.value.zoomIn(w),zoomOut:w=>o.value.zoomOut(w),zoomTo:(w,v)=>o.value.zoomTo(w,v),setViewport:(w,v)=>o.value.setViewport(w,v),setTransform:(w,v)=>o.value.setTransform(w,v),getViewport:()=>o.value.getViewport(),getTransform:()=>o.value.getTransform(),setCenter:(w,v,_)=>o.value.setCenter(w,v,_),fitBounds:(w,v)=>o.value.fitBounds(w,v),project:w=>o.value.project(w),screenToFlowCoordinate:w=>o.value.screenToFlowCoordinate(w),flowToScreenCoordinate:w=>o.value.flowToScreenCoordinate(w),toObject:()=>{const w=[],v=[];for(const _ of e.nodes){const{computedPosition:x,handleBounds:R,selected:Q,dimensions:oe,isParent:ie,resizing:ue,dragging:ve,events:Se,...$e}=_;w.push($e)}for(const _ of e.edges){const{selected:x,sourceNode:R,targetNode:Q,events:oe,...ie}=_;v.push(ie)}return JSON.parse(JSON.stringify({nodes:w,edges:v,position:[e.viewport.x,e.viewport.y],zoom:e.viewport.zoom,viewport:e.viewport}))},fromObject:w=>new Promise(v=>{const{nodes:_,edges:x,position:R,zoom:Q,viewport:oe}=w;if(_&&ne(_),x&&D(x),oe?.x&&oe?.y||R){const ie=oe?.x||R[0],ue=oe?.y||R[1],ve=oe?.zoom||Q||e.viewport.zoom;return wo(()=>o.value.viewportInitialized).toBe(!0).then(()=>{o.value.setViewport({x:ie,y:ue,zoom:ve}).then(()=>{v(!0)})})}else v(!0)}),updateNodeInternals:s,viewportHelper:o,$reset:()=>{const w=Li();if(e.edges=[],e.nodes=[],e.d3Zoom&&e.d3Selection){const v=Ut.translate(w.defaultViewport.x??0,w.defaultViewport.y??0).scale(Pt(w.defaultViewport.zoom??1,w.minZoom,w.maxZoom)),_=e.viewportRef.getBoundingClientRect(),x=[[0,0],[_.width,_.height]],R=e.d3Zoom.constrain()(v,x,w.translateExtent);e.d3Zoom.transform(e.d3Selection,R)}Ce(w)},$destroy:()=>{}}}const td=["data-id","data-handleid","data-nodeid","data-handlepos"],nd={name:"Handle",compatConfig:{MODE:3}},Re=Pe({...nd,props:{id:{default:null},type:{},position:{default:()=>Z.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,Number,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(e,{expose:t}){const n=Ki(e,["position","connectable","connectableStart","connectableEnd","id"]),o=ze(()=>n.type??"source"),s=ze(()=>n.isValidConnection??null),{id:i,connectionStartHandle:r,connectionClickStartHandle:l,connectionEndHandle:a,vueFlowRef:c,nodesConnectable:u,noDragClassName:p,noPanClassName:f}=Be(),{id:m,node:S,nodeEl:g,connectedEdges:h}=zi(),C=ge(),P=ze(()=>typeof e.connectableStart<"u"?e.connectableStart:!0),k=ze(()=>typeof e.connectableEnd<"u"?e.connectableEnd:!0),y=ze(()=>{var D,E,le,b,B,T;return((D=r.value)==null?void 0:D.nodeId)===m&&((E=r.value)==null?void 0:E.id)===e.id&&((le=r.value)==null?void 0:le.type)===o.value||((b=a.value)==null?void 0:b.nodeId)===m&&((B=a.value)==null?void 0:B.id)===e.id&&((T=a.value)==null?void 0:T.type)===o.value}),I=ze(()=>{var D,E,le;return((D=l.value)==null?void 0:D.nodeId)===m&&((E=l.value)==null?void 0:E.id)===e.id&&((le=l.value)==null?void 0:le.type)===o.value}),{handlePointerDown:U,handleClick:K}=Ri({nodeId:m,handleId:e.id,isValidConnection:s,type:o}),F=W(()=>typeof e.connectable=="string"&&e.connectable==="single"?!h.value.some(D=>{const E=D[`${o.value}Handle`];return D[o.value]!==m?!1:E?E===e.id:!0}):typeof e.connectable=="number"?h.value.filter(D=>{const E=D[`${o.value}Handle`];return D[o.value]!==m?!1:E?E===e.id:!0}).length<e.connectable:typeof e.connectable=="function"?e.connectable(S,h.value):Fe(e.connectable)?e.connectable:u.value);dt(()=>{var D;if(!S.dimensions.width||!S.dimensions.height)return;const E=(D=S.handleBounds[o.value])==null?void 0:D.find(J=>J.id===e.id);if(!c.value||E)return;const le=c.value.querySelector(".vue-flow__transformationpane");if(!g.value||!C.value||!le||!e.id)return;const b=g.value.getBoundingClientRect(),B=C.value.getBoundingClientRect(),T=window.getComputedStyle(le),{m22:L}=new window.DOMMatrixReadOnly(T.transform),H={id:e.id,position:e.position,x:(B.left-b.left)/L,y:(B.top-b.top)/L,type:o.value,nodeId:m,...qn(C.value)};S.handleBounds[o.value]=[...S.handleBounds[o.value]??[],H]});function re(D){const E=Yo(D);F.value&&P.value&&(E&&D.button===0||!E)&&U(D)}function ne(D){!m||!l.value&&!P.value||F.value&&K(D)}return t({handleClick:K,handlePointerDown:U,onClick:ne,onPointerDown:re}),(D,E)=>($(),O("div",{ref_key:"handle",ref:C,"data-id":`${M(i)}-${M(m)}-${e.id}-${o.value}`,"data-handleid":e.id,"data-nodeid":M(m),"data-handlepos":D.position,class:ye(["vue-flow__handle",[`vue-flow__handle-${D.position}`,`vue-flow__handle-${e.id}`,M(p),M(f),o.value,{connectable:F.value,connecting:I.value,connectablestart:P.value,connectableend:k.value,connectionindicator:F.value&&(P.value&&!y.value||k.value&&y.value)}]]),onMousedown:re,onTouchstartPassive:re,onClick:ne},[ct(D.$slots,"default",{id:D.id})],42,td))}}),Qn=function({sourcePosition:e=Z.Bottom,targetPosition:t=Z.Top,label:n,connectable:o=!0,isValidTargetPos:s,isValidSourcePos:i,data:r}){const l=r.label??n;return[Ae(Re,{type:"target",position:t,connectable:o,isValidConnection:s}),typeof l!="string"&&l?Ae(l):Ae(xe,[l]),Ae(Re,{type:"source",position:e,connectable:o,isValidConnection:i})]};Qn.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable","data"];Qn.inheritAttrs=!1;Qn.compatConfig={MODE:3};const od=Qn,eo=function({targetPosition:e=Z.Top,label:t,connectable:n=!0,isValidTargetPos:o,data:s}){const i=s.label??t;return[Ae(Re,{type:"target",position:e,connectable:n,isValidConnection:o}),typeof i!="string"&&i?Ae(i):Ae(xe,[i])]};eo.props=["targetPosition","label","isValidTargetPos","connectable","data"];eo.inheritAttrs=!1;eo.compatConfig={MODE:3};const sd=eo,to=function({sourcePosition:e=Z.Bottom,label:t,connectable:n=!0,isValidSourcePos:o,data:s}){const i=s.label??t;return[typeof i!="string"&&i?Ae(i):Ae(xe,[i]),Ae(Re,{type:"source",position:e,connectable:n,isValidConnection:o})]};to.props=["sourcePosition","label","isValidSourcePos","connectable","data"];to.inheritAttrs=!1;to.compatConfig={MODE:3};const id=to,rd=["transform"],ld=["width","height","x","y","rx","ry"],ad=["y"],cd={name:"EdgeText",compatConfig:{MODE:3}},ud=Pe({...cd,props:{x:{},y:{},label:{},labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(e){const t=ge({x:0,y:0,width:0,height:0}),n=ge(null),o=W(()=>`translate(${e.x-t.value.width/2} ${e.y-t.value.height/2})`);dt(s),De([()=>e.x,()=>e.y,n,()=>e.label],s);function s(){if(!n.value)return;const i=n.value.getBBox();(i.width!==t.value.width||i.height!==t.value.height)&&(t.value=i)}return(i,r)=>($(),O("g",{transform:o.value,class:"vue-flow__edge-textwrapper"},[i.labelShowBg?($(),O("rect",{key:0,class:"vue-flow__edge-textbg",width:`${t.value.width+2*i.labelBgPadding[0]}px`,height:`${t.value.height+2*i.labelBgPadding[1]}px`,x:-i.labelBgPadding[0],y:-i.labelBgPadding[1],style:Ye(i.labelBgStyle),rx:i.labelBgBorderRadius,ry:i.labelBgBorderRadius},null,12,ld)):we("",!0),d("text",Nt(i.$attrs,{ref_key:"el",ref:n,class:"vue-flow__edge-text",y:t.value.height/2,dy:"0.3em",style:i.labelStyle}),[ct(i.$slots,"default",{},()=>[typeof i.label!="string"?($(),Ie(or(i.label),{key:0})):($(),O(xe,{key:1},[We(V(i.label),1)],64))])],16,ad)],8,rd))}}),dd=["id","d","marker-end","marker-start"],fd=["d","stroke-width"],gd={name:"BaseEdge",inheritAttrs:!1,compatConfig:{MODE:3}},no=Pe({...gd,props:{id:{},labelX:{},labelY:{},path:{},label:{},markerStart:{},markerEnd:{},interactionWidth:{default:20},labelStyle:{},labelShowBg:{type:Boolean},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{}},setup(e,{expose:t}){const n=ge(null),o=ge(null),s=ge(null),i=nr();return t({pathEl:n,interactionEl:o,labelEl:s}),(r,l)=>($(),O(xe,null,[d("path",Nt(M(i),{id:r.id,ref_key:"pathEl",ref:n,d:r.path,class:"vue-flow__edge-path","marker-end":r.markerEnd,"marker-start":r.markerStart}),null,16,dd),r.interactionWidth?($(),O("path",{key:0,ref_key:"interactionEl",ref:o,fill:"none",d:r.path,"stroke-width":r.interactionWidth,"stroke-opacity":0,class:"vue-flow__edge-interaction"},null,8,fd)):we("",!0),r.label&&r.labelX&&r.labelY?($(),Ie(ud,{key:1,ref_key:"labelEl",ref:s,x:r.labelX,y:r.labelY,label:r.label,"label-show-bg":r.labelShowBg,"label-bg-style":r.labelBgStyle,"label-bg-padding":r.labelBgPadding,"label-bg-border-radius":r.labelBgBorderRadius,"label-style":r.labelStyle},null,8,["x","y","label","label-show-bg","label-bg-style","label-bg-padding","label-bg-border-radius","label-style"])):we("",!0)],64))}});function Vi({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,l=o<t?o+r:o-r;return[i,l,s,r]}function Fi({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:l}){const a=e*.125+s*.375+r*.375+n*.125,c=t*.125+i*.375+l*.375+o*.125,u=Math.abs(a-e),p=Math.abs(c-t);return[a,c,u,p]}function Sn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ts({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){let r,l;switch(e){case Z.Left:r=t-Sn(t-o,i),l=n;break;case Z.Right:r=t+Sn(o-t,i),l=n;break;case Z.Top:r=t,l=n-Sn(n-s,i);break;case Z.Bottom:r=t,l=n+Sn(s-n,i);break}return[r,l]}function Hi(e){const{sourceX:t,sourceY:n,sourcePosition:o=Z.Bottom,targetX:s,targetY:i,targetPosition:r=Z.Top,curvature:l=.25}=e,[a,c]=Ts({pos:o,x1:t,y1:n,x2:s,y2:i,c:l}),[u,p]=Ts({pos:r,x1:s,y1:i,x2:t,y2:n,c:l}),[f,m,S,g]=Fi({sourceX:t,sourceY:n,targetX:s,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:p});return[`M${t},${n} C${a},${c} ${u},${p} ${s},${i}`,f,m,S,g]}function Ms({pos:e,x1:t,y1:n,x2:o,y2:s}){let i,r;switch(e){case Z.Left:case Z.Right:i=.5*(t+o),r=n;break;case Z.Top:case Z.Bottom:i=t,r=.5*(n+s);break}return[i,r]}function Gi(e){const{sourceX:t,sourceY:n,sourcePosition:o=Z.Bottom,targetX:s,targetY:i,targetPosition:r=Z.Top}=e,[l,a]=Ms({pos:o,x1:t,y1:n,x2:s,y2:i}),[c,u]=Ms({pos:r,x1:s,y1:i,x2:t,y2:n}),[p,f,m,S]=Fi({sourceX:t,sourceY:n,targetX:s,targetY:i,sourceControlX:l,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${t},${n} C${l},${a} ${c},${u} ${s},${i}`,p,f,m,S]}const Ds={[Z.Left]:{x:-1,y:0},[Z.Right]:{x:1,y:0},[Z.Top]:{x:0,y:-1},[Z.Bottom]:{x:0,y:1}};function pd({source:e,sourcePosition:t=Z.Bottom,target:n}){return t===Z.Left||t===Z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1}}function As(e,t){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function hd({source:e,sourcePosition:t=Z.Bottom,target:n,targetPosition:o=Z.Top,center:s,offset:i}){const r=Ds[t],l=Ds[o],a={x:e.x+r.x*i,y:e.y+r.y*i},c={x:n.x+l.x*i,y:n.y+l.y*i},u=pd({source:a,sourcePosition:t,target:c}),p=u.x!==0?"x":"y",f=u[p];let m,S,g;const h={x:0,y:0},C={x:0,y:0},[P,k,y,I]=Vi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[p]*l[p]===-1){S=s.x??P,g=s.y??k;const K=[{x:S,y:a.y},{x:S,y:c.y}],F=[{x:a.x,y:g},{x:c.x,y:g}];r[p]===f?m=p==="x"?K:F:m=p==="x"?F:K}else{const K=[{x:a.x,y:c.y}],F=[{x:c.x,y:a.y}];if(p==="x"?m=r.x===f?F:K:m=r.y===f?K:F,t===o){const le=Math.abs(e[p]-n[p]);if(le<=i){const b=Math.min(i-1,i-le);r[p]===f?h[p]=(a[p]>e[p]?-1:1)*b:C[p]=(c[p]>n[p]?-1:1)*b}}if(t!==o){const le=p==="x"?"y":"x",b=r[p]===l[le],B=a[le]>c[le],T=a[le]<c[le];(r[p]===1&&(!b&&B||b&&T)||r[p]!==1&&(!b&&T||b&&B))&&(m=p==="x"?K:F)}const re={x:a.x+h.x,y:a.y+h.y},ne={x:c.x+C.x,y:c.y+C.y},D=Math.max(Math.abs(re.x-m[0].x),Math.abs(ne.x-m[0].x)),E=Math.max(Math.abs(re.y-m[0].y),Math.abs(ne.y-m[0].y));D>=E?(S=(re.x+ne.x)/2,g=m[0].y):(S=m[0].x,g=(re.y+ne.y)/2)}return[[e,{x:a.x+h.x,y:a.y+h.y},...m,{x:c.x+C.x,y:c.y+C.y},n],S,g,y,I]}function md(e,t,n,o){const s=Math.min(As(e,t)/2,As(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+s*c},${r}Q ${i},${r} ${i},${r+s*u}`}const l=e.x<n.x?1:-1,a=e.y<n.y?-1:1;return`L ${i},${r+s*a}Q ${i},${r} ${i+s*l},${r}`}function Ao(e){const{sourceX:t,sourceY:n,sourcePosition:o=Z.Bottom,targetX:s,targetY:i,targetPosition:r=Z.Top,borderRadius:l=5,centerX:a,centerY:c,offset:u=20}=e,[p,f,m,S,g]=hd({source:{x:t,y:n},sourcePosition:o,target:{x:s,y:i},targetPosition:r,center:{x:a,y:c},offset:u});return[p.reduce((C,P,k)=>{let y;return k>0&&k<p.length-1?y=md(p[k-1],P,p[k+1],l):y=`${k===0?"M":"L"}${P.x} ${P.y}`,C+=y,C},""),f,m,S,g]}function vd(e){const{sourceX:t,sourceY:n,targetX:o,targetY:s}=e,[i,r,l,a]=Vi({sourceX:t,sourceY:n,targetX:o,targetY:s});return[`M ${t},${n}L ${o},${s}`,i,r,l,a]}const yd=Pe({name:"StraightEdge",props:["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,s]=vd(e);return Ae(no,{path:n,labelX:o,labelY:s,...t,...e})}}}),wd=yd,xd=Pe({name:"SmoothStepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,s]=Ao({...e,sourcePosition:e.sourcePosition??Z.Bottom,targetPosition:e.targetPosition??Z.Top});return Ae(no,{path:n,labelX:o,labelY:s,...t,...e})}}}),Yi=xd,_d=Pe({name:"StepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],setup(e,{attrs:t}){return()=>Ae(Yi,{...e,...t,borderRadius:0})}}),bd=_d,Ed=Pe({name:"BezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,s]=Hi({...e,sourcePosition:e.sourcePosition??Z.Bottom,targetPosition:e.targetPosition??Z.Top});return Ae(no,{path:n,labelX:o,labelY:s,...t,...e})}}}),kd=Ed,Sd=Pe({name:"SimpleBezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,s]=Gi({...e,sourcePosition:e.sourcePosition??Z.Bottom,targetPosition:e.targetPosition??Z.Top});return Ae(no,{path:n,labelX:o,labelY:s,...t,...e})}}}),Nd=Sd,Cd={input:id,default:od,output:sd},$d={default:kd,straight:wd,step:bd,smoothstep:Yi,simplebezier:Nd};function Id(e,t,n){const o=W(()=>g=>t.value.get(g)),s=W(()=>g=>n.value.get(g)),i=W(()=>{const g={...$d,...e.edgeTypes},h=Object.keys(g);for(const C of e.edges)C.type&&!h.includes(C.type)&&(g[C.type]=C.type);return g}),r=W(()=>{const g={...Cd,...e.nodeTypes},h=Object.keys(g);for(const C of e.nodes)C.type&&!h.includes(C.type)&&(g[C.type]=C.type);return g}),l=W(()=>e.onlyRenderVisibleElements?Si(e.nodes,{x:0,y:0,width:e.dimensions.width,height:e.dimensions.height},e.viewport,!0):e.nodes),a=W(()=>{if(e.onlyRenderVisibleElements){const g=[];for(const h of e.edges){const C=t.value.get(h.source),P=t.value.get(h.target);Su({sourcePos:C.computedPosition||{x:0,y:0},targetPos:P.computedPosition||{x:0,y:0},sourceWidth:C.dimensions.width,sourceHeight:C.dimensions.height,targetWidth:P.dimensions.width,targetHeight:P.dimensions.height,width:e.dimensions.width,height:e.dimensions.height,viewport:e.viewport})&&g.push(h)}return g}return e.edges}),c=W(()=>[...l.value,...a.value]),u=W(()=>{const g=[];for(const h of e.nodes)h.selected&&g.push(h);return g}),p=W(()=>{const g=[];for(const h of e.edges)h.selected&&g.push(h);return g}),f=W(()=>[...u.value,...p.value]),m=W(()=>{const g=[];for(const h of e.nodes)h.dimensions.width&&h.dimensions.height&&h.handleBounds!==void 0&&g.push(h);return g}),S=W(()=>l.value.length>0&&m.value.length===l.value.length);return{getNode:o,getEdge:s,getElements:c,getEdgeTypes:i,getNodeTypes:r,getEdges:a,getNodes:l,getSelectedElements:f,getSelectedNodes:u,getSelectedEdges:p,getNodesInitialized:m,areNodesInitialized:S}}class $t{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){var t;const n=(t=qt())==null?void 0:t.appContext.app,o=n?.config.globalProperties.$vueFlowStorage??$t.instance;return $t.instance=o??new $t,n&&(n.config.globalProperties.$vueFlowStorage=$t.instance),$t.instance}set(t,n){return this.flows.set(t,n)}get(t){return this.flows.get(t)}remove(t){return this.flows.delete(t)}create(t,n){const o=Li(),s=ji(o),i={};for(const[f,m]of Object.entries(s.hooks)){const S=`on${f.charAt(0).toUpperCase()+f.slice(1)}`;i[S]=m.on}const r={};for(const[f,m]of Object.entries(s.hooks))r[f]=m.trigger;const l=W(()=>{const f=new Map;for(const m of s.nodes)f.set(m.id,m);return f}),a=W(()=>{const f=new Map;for(const m of s.edges)f.set(m.id,m);return f}),c=Id(s,l,a),u=ed(s,l,a);u.setState({...s,...n});const p={...i,...c,...u,...br(s),nodeLookup:l,edgeLookup:a,emits:r,id:t,vueFlowVersion:"1.46.5",$destroy:()=>{this.remove(t)}};return this.set(t,p),p}getId(){return`vue-flow-${this.currentId++}`}}function Be(e){const t=$t.getInstance(),n=Rs(),o=typeof e=="object",s=o?e:{id:e},i=s.id,r=i??n?.vueFlowId;let l;if(n){const a=Zt(Is,null);typeof a<"u"&&a!==null&&(!r||a.id===r)&&(l=a)}if(l||r&&(l=t.get(r)),!l||r&&l.id!==r){const a=i??t.getId(),c=t.create(a,s);l=c,(n??zs(!0)).run(()=>{De(c.applyDefault,(p,f,m)=>{const S=h=>{c.applyNodeChanges(h)},g=h=>{c.applyEdgeChanges(h)};p?(c.onNodesChange(S),c.onEdgesChange(g)):(c.hooks.value.nodesChange.off(S),c.hooks.value.edgesChange.off(g)),m(()=>{c.hooks.value.nodesChange.off(S),c.hooks.value.edgesChange.off(g)})},{immediate:!0}),an(()=>{if(l){const p=t.get(l.id);p?p.$destroy():jn(`No store instance found for id ${l.id} in storage.`)}})})}else o&&l.setState(s);if(n&&(Gt(Is,l),n.vueFlowId=l.id),o){const a=qt();a?.type.name!=="VueFlow"&&l.emits.error(new Ge(He.USEVUEFLOW_OPTIONS))}return l}function Td(e){const{emits:t,dimensions:n}=Be();let o;dt(()=>{const s=()=>{var i,r;if(!e.value||!(((r=(i=e.value).checkVisibility)==null?void 0:r.call(i))??!0))return;const l=qn(e.value);(l.width===0||l.height===0)&&t.error(new Ge(He.MISSING_VIEWPORT_DIMENSIONS)),n.value={width:l.width||500,height:l.height||500}};s(),window.addEventListener("resize",s),e.value&&(o=new ResizeObserver(()=>s()),o.observe(e.value)),Bs(()=>{window.removeEventListener("resize",s),o&&e.value&&o.unobserve(e.value)})})}const Md={name:"UserSelection",compatConfig:{MODE:3}},Dd=Pe({...Md,props:{userSelectionRect:{}},setup(e){return(t,n)=>($(),O("div",{class:"vue-flow__selection vue-flow__container",style:Ye({width:`${t.userSelectionRect.width}px`,height:`${t.userSelectionRect.height}px`,transform:`translate(${t.userSelectionRect.x}px, ${t.userSelectionRect.y}px)`})},null,4))}}),Ad=["tabIndex"],Pd={name:"NodesSelection",compatConfig:{MODE:3}},Od=Pe({...Pd,setup(e){const{emits:t,viewport:n,getSelectedNodes:o,noPanClassName:s,disableKeyboardA11y:i,userSelectionActive:r}=Be(),l=Bi(),a=ge(null),c=Oi({el:a,onStart(S){t.selectionDragStart(S),t.nodeDragStart(S)},onDrag(S){t.selectionDrag(S),t.nodeDrag(S)},onStop(S){t.selectionDragStop(S),t.nodeDragStop(S)}});dt(()=>{var S;i.value||(S=a.value)==null||S.focus({preventScroll:!0})});const u=W(()=>ki(o.value)),p=W(()=>({width:`${u.value.width}px`,height:`${u.value.height}px`,top:`${u.value.y}px`,left:`${u.value.x}px`}));function f(S){t.selectionContextMenu({event:S,nodes:o.value})}function m(S){i||Ht[S.key]&&(S.preventDefault(),l({x:Ht[S.key].x,y:Ht[S.key].y},S.shiftKey))}return(S,g)=>!M(r)&&u.value.width&&u.value.height?($(),O("div",{key:0,class:ye(["vue-flow__nodesselection vue-flow__container",M(s)]),style:Ye({transform:`translate(${M(n).x}px,${M(n).y}px) scale(${M(n).zoom})`})},[d("div",{ref_key:"el",ref:a,class:ye([{dragging:M(c)},"vue-flow__nodesselection-rect"]),style:Ye(p.value),tabIndex:M(i)?void 0:-1,onContextmenu:f,onKeydown:m},null,46,Ad)],6)):we("",!0)}});function Rd(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}const zd={name:"Pane",compatConfig:{MODE:3}},Bd=Pe({...zd,props:{isSelecting:{type:Boolean},selectionKeyPressed:{type:Boolean}},setup(e){const{vueFlowRef:t,nodes:n,viewport:o,emits:s,userSelectionActive:i,removeSelectedElements:r,userSelectionRect:l,elementsSelectable:a,nodesSelectionActive:c,getSelectedEdges:u,getSelectedNodes:p,removeNodes:f,removeEdges:m,selectionMode:S,deleteKeyCode:g,multiSelectionKeyCode:h,multiSelectionActive:C,edgeLookup:P,nodeLookup:k,connectionLookup:y,defaultEdgeOptions:I,connectionStartHandle:U}=Be(),K=ge(null),F=ge(new Set),re=ge(new Set),ne=ge(),D=ze(()=>a.value&&(e.isSelecting||i.value)),E=ze(()=>U.value!==null);let le=!1,b=!1;const B=ln(g,{actInsideInputWithModifier:!1}),T=ln(h);De(B,ee=>{ee&&(f(p.value),m(u.value),c.value=!1)}),De(T,ee=>{C.value=ee});function L(ee,ce){return ae=>{ae.target===ce&&ee?.(ae)}}function H(ee){if(le||E.value){le=!1;return}s.paneClick(ee),r(),c.value=!1}function J(ee){ee.preventDefault(),ee.stopPropagation(),s.paneContextMenu(ee)}function X(ee){s.paneScroll(ee)}function se(ee){var ce,ae,he;if(ne.value=(ce=t.value)==null?void 0:ce.getBoundingClientRect(),!a.value||!e.isSelecting||ee.button!==0||ee.target!==K.value||!ne.value)return;(he=(ae=ee.target)==null?void 0:ae.setPointerCapture)==null||he.call(ae,ee.pointerId);const{x:ke,y:_e}=Rd(ee,ne.value);b=!0,le=!1,r(),l.value={width:0,height:0,startX:ke,startY:_e,x:ke,y:_e},s.selectionStart(ee)}function de(ee){var ce;if(!ne.value||!l.value)return;le=!0;const{x:ae,y:he}=at(ee,ne.value),{startX:ke=0,startY:_e=0}=l.value,Ce={startX:ke,startY:_e,x:ae<ke?ae:ke,y:he<_e?he:_e,width:Math.abs(ae-ke),height:Math.abs(he-_e)},Te=F.value,pe=re.value;F.value=new Set(Si(n.value,Ce,o.value,S.value===Ho.Partial,!0).map(w=>w.id)),re.value=new Set;const Ee=((ce=I.value)==null?void 0:ce.selectable)??!0;for(const w of F.value){const v=y.value.get(w);if(v)for(const{edgeId:_}of v.values()){const x=P.value.get(_);x&&(x.selectable??Ee)&&re.value.add(_)}}if(!$s(Te,F.value)){const w=bt(k.value,F.value,!0);s.nodesChange(w)}if(!$s(pe,re.value)){const w=bt(P.value,re.value);s.edgesChange(w)}l.value=Ce,i.value=!0,c.value=!1}function me(ee){var ce;ee.button!==0||!b||((ce=ee.target)==null||ce.releasePointerCapture(ee.pointerId),!i.value&&l.value&&ee.target===K.value&&H(ee),i.value=!1,l.value=null,c.value=F.value.size>0,s.selectionEnd(ee),e.selectionKeyPressed&&(le=!1),b=!1)}return(ee,ce)=>($(),O("div",{ref_key:"container",ref:K,class:ye(["vue-flow__pane vue-flow__container",{selection:ee.isSelecting}]),onClick:ce[0]||(ce[0]=ae=>D.value?void 0:L(H,K.value)(ae)),onContextmenu:ce[1]||(ce[1]=ae=>L(J,K.value)(ae)),onWheelPassive:ce[2]||(ce[2]=ae=>L(X,K.value)(ae)),onPointerenter:ce[3]||(ce[3]=ae=>D.value?void 0:M(s).paneMouseEnter(ae)),onPointerdown:ce[4]||(ce[4]=ae=>D.value?se(ae):M(s).paneMouseMove(ae)),onPointermove:ce[5]||(ce[5]=ae=>D.value?de(ae):M(s).paneMouseMove(ae)),onPointerup:ce[6]||(ce[6]=ae=>D.value?me(ae):void 0),onPointerleave:ce[7]||(ce[7]=ae=>M(s).paneMouseLeave(ae))},[ct(ee.$slots,"default"),M(i)&&M(l)?($(),Ie(Dd,{key:0,"user-selection-rect":M(l)},null,8,["user-selection-rect"])):we("",!0),M(c)&&M(p).length?($(),Ie(Od,{key:1})):we("",!0)],34))}}),Ld={name:"Transform",compatConfig:{MODE:3}},Vd=Pe({...Ld,setup(e){const{viewport:t,fitViewOnInit:n,fitViewOnInitDone:o}=Be(),s=W(()=>n.value?!o.value:!1),i=W(()=>`translate(${t.value.x}px,${t.value.y}px) scale(${t.value.zoom})`);return(r,l)=>($(),O("div",{class:"vue-flow__transformationpane vue-flow__container",style:Ye({transform:i.value,opacity:s.value?0:void 0})},[ct(r.$slots,"default")],4))}}),Fd={name:"Viewport",compatConfig:{MODE:3}},Hd=Pe({...Fd,setup(e){const{minZoom:t,maxZoom:n,defaultViewport:o,translateExtent:s,zoomActivationKeyCode:i,selectionKeyCode:r,panActivationKeyCode:l,panOnScroll:a,panOnScrollMode:c,panOnScrollSpeed:u,panOnDrag:p,zoomOnDoubleClick:f,zoomOnPinch:m,zoomOnScroll:S,preventScrolling:g,noWheelClassName:h,noPanClassName:C,emits:P,connectionStartHandle:k,userSelectionActive:y,paneDragging:I,d3Zoom:U,d3Selection:K,d3ZoomHandler:F,viewport:re,viewportRef:ne,paneClickDistance:D}=Be();Td(ne);const E=An(!1),le=An(!1);let b=null,B=!1,T=0,L={x:0,y:0,zoom:0};const H=ln(l),J=ln(r),X=ln(i),se=ze(()=>(!J.value||J.value&&r.value===!0)&&(H.value||p.value)),de=ze(()=>H.value||a.value),me=ze(()=>J.value||r.value===!0&&se.value!==!0),ee=ze(()=>k.value!==null);dt(()=>{if(!ne.value){jn("Viewport element is missing");return}const _e=ne.value,Ce=_e.getBoundingClientRect(),Te=ru().clickDistance(D.value).scaleExtent([t.value,n.value]).translateExtent(s.value),pe=tt(_e).call(Te),Ee=pe.on("wheel.zoom"),w=Ut.translate(o.value.x??0,o.value.y??0).scale(Pt(o.value.zoom??1,t.value,n.value)),v=[[0,0],[Ce.width,Ce.height]],_=Te.constrain()(w,v,s.value);Te.transform(pe,_),Te.wheelDelta(ps),U.value=Te,K.value=pe,F.value=Ee,re.value={x:_.x,y:_.y,zoom:_.k},Te.on("start",x=>{var R;if(!x.sourceEvent)return null;T=x.sourceEvent.button,E.value=!0;const Q=he(x.transform);((R=x.sourceEvent)==null?void 0:R.type)==="mousedown"&&(I.value=!0),L=Q,P.viewportChangeStart(Q),P.moveStart({event:x,flowTransform:Q})}),Te.on("end",x=>{if(!x.sourceEvent)return null;if(E.value=!1,I.value=!1,ce(se.value,T??0)&&!B&&P.paneContextMenu(x.sourceEvent),B=!1,ae(L,x.transform)){const R=he(x.transform);L=R,P.viewportChangeEnd(R),P.moveEnd({event:x,flowTransform:R})}}),Te.filter(x=>{var R;const Q=X.value||S.value,oe=m.value&&x.ctrlKey,ie=x.button,ue=x.type==="wheel";if(ie===1&&x.type==="mousedown"&&(ke(x,"vue-flow__node")||ke(x,"vue-flow__edge")))return!0;if(!se.value&&!Q&&!de.value&&!f.value&&!m.value||y.value||ee.value&&!ue||!f.value&&x.type==="dblclick"||ke(x,h.value)&&ue||ke(x,C.value)&&(!ue||de.value&&ue&&!X.value)||!m.value&&x.ctrlKey&&ue||!Q&&!de.value&&!oe&&ue)return!1;if(!m&&x.type==="touchstart"&&((R=x.touches)==null?void 0:R.length)>1)return x.preventDefault(),!1;if(!se.value&&(x.type==="mousedown"||x.type==="touchstart")||r.value===!0&&Array.isArray(p.value)&&p.value.includes(0)&&ie===0||Array.isArray(p.value)&&!p.value.includes(ie)&&(x.type==="mousedown"||x.type==="touchstart"))return!1;const ve=Array.isArray(p.value)&&p.value.includes(ie)||r.value===!0&&Array.isArray(p.value)&&!p.value.includes(0)||!ie||ie<=1;return(!x.ctrlKey||H.value||ue)&&ve}),De([y,se],()=>{y.value&&!E.value?Te.on("zoom",null):y.value||Te.on("zoom",x=>{re.value={x:x.transform.x,y:x.transform.y,zoom:x.transform.k};const R=he(x.transform);B=ce(se.value,T??0),P.viewportChange(R),P.move({event:x,flowTransform:R})})},{immediate:!0}),De([y,de,c,X,m,g,h],()=>{de.value&&!X.value&&!y.value?pe.on("wheel.zoom",x=>{if(ke(x,h.value))return!1;const R=X.value||S.value,Q=m.value&&x.ctrlKey;if(!(!g.value||de.value||R||Q))return!1;x.preventDefault(),x.stopImmediatePropagation();const ie=pe.property("__zoom").k||1,ue=Gn();if(!H.value&&x.ctrlKey&&m.value&&ue){const Qe=rt(x),oo=ps(x),A=ie*2**oo;Te.scaleTo(pe,A,Qe,x);return}const ve=x.deltaMode===1?20:1;let Se=c.value===rn.Vertical?0:x.deltaX*ve,$e=c.value===rn.Horizontal?0:x.deltaY*ve;!ue&&x.shiftKey&&c.value!==rn.Vertical&&!Se&&$e&&(Se=$e,$e=0),Te.translateBy(pe,-(Se/ie)*u.value,-($e/ie)*u.value);const Xe=he(pe.property("__zoom"));b&&clearTimeout(b),le.value?(P.move({event:x,flowTransform:Xe}),P.viewportChange(Xe),b=setTimeout(()=>{P.moveEnd({event:x,flowTransform:Xe}),P.viewportChangeEnd(Xe),le.value=!1},150)):(le.value=!0,P.moveStart({event:x,flowTransform:Xe}),P.viewportChangeStart(Xe))},{passive:!1}):typeof Ee<"u"&&pe.on("wheel.zoom",function(x,R){const Q=!g.value&&x.type==="wheel"&&!x.ctrlKey,oe=X.value||S.value,ie=m.value&&x.ctrlKey;if(!oe&&!a.value&&!ie&&x.type==="wheel"||Q||ke(x,h.value))return null;x.preventDefault(),Ee.call(this,x,R)},{passive:!1})},{immediate:!0})});function ce(_e,Ce){return Ce===2&&Array.isArray(_e)&&_e.includes(2)}function ae(_e,Ce){return _e.x!==Ce.x&&!Number.isNaN(Ce.x)||_e.y!==Ce.y&&!Number.isNaN(Ce.y)||_e.zoom!==Ce.k&&!Number.isNaN(Ce.k)}function he(_e){return{x:_e.x,y:_e.y,zoom:_e.k}}function ke(_e,Ce){return _e.target.closest(`.${Ce}`)}return(_e,Ce)=>($(),O("div",{ref_key:"viewportRef",ref:ne,class:"vue-flow__viewport vue-flow__container"},[j(Bd,{"is-selecting":me.value,"selection-key-pressed":M(J),class:ye({connecting:ee.value,dragging:M(I),draggable:M(p)===!0||Array.isArray(M(p))&&M(p).includes(0)})},{default:qe(()=>[j(Vd,null,{default:qe(()=>[ct(_e.$slots,"default")]),_:3})]),_:3},8,["is-selecting","selection-key-pressed","class"])],512))}}),Gd=["id"],Yd=["id"],Wd=["id"],Ud={name:"A11yDescriptions",compatConfig:{MODE:3}},Xd=Pe({...Ud,setup(e){const{id:t,disableKeyboardA11y:n,ariaLiveMessage:o}=Be();return(s,i)=>($(),O(xe,null,[d("div",{id:`${M(mi)}-${M(t)}`,style:{display:"none"}}," Press enter or space to select a node. "+V(M(n)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,Gd),d("div",{id:`${M(vi)}-${M(t)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,Yd),M(n)?we("",!0):($(),O("div",{key:0,id:`${M(fu)}-${M(t)}`,"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)","clip-path":"inset(100%)"}},V(M(o)),9,Wd))],64))}});function Zd(){const e=Be();De(()=>e.viewportHelper.value.viewportInitialized,t=>{t&&setTimeout(()=>{e.emits.init(e),e.emits.paneReady(e)},1)})}function qd(e,t,n){return n===Z.Left?e-t:n===Z.Right?e+t:e}function Kd(e,t,n){return n===Z.Top?e-t:n===Z.Bottom?e+t:e}const Wo=function({radius:e=10,centerX:t=0,centerY:n=0,position:o=Z.Top,type:s}){return Ae("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${s}`,cx:qd(t,e,o),cy:Kd(n,e,o),r:e,stroke:"transparent",fill:"transparent"})};Wo.props=["radius","centerX","centerY","position","type"];Wo.compatConfig={MODE:3};const Ps=Wo,jd=Pe({name:"Edge",compatConfig:{MODE:3},props:["id"],setup(e){const{id:t,addSelectedEdges:n,connectionMode:o,edgeUpdaterRadius:s,emits:i,nodesSelectionActive:r,noPanClassName:l,getEdgeTypes:a,removeSelectedEdges:c,findEdge:u,findNode:p,isValidConnection:f,multiSelectionActive:m,disableKeyboardA11y:S,elementsSelectable:g,edgesUpdatable:h,edgesFocusable:C,hooks:P}=Be(),k=W(()=>u(e.id)),{emit:y,on:I}=Fu(k.value,i),U=Zt(Jn),K=qt(),F=ge(!1),re=ge(!1),ne=ge(""),D=ge(null),E=ge("source"),le=ge(null),b=ze(()=>typeof k.value.selectable>"u"?g.value:k.value.selectable),B=ze(()=>typeof k.value.updatable>"u"?h.value:k.value.updatable),T=ze(()=>typeof k.value.focusable>"u"?C.value:k.value.focusable);Gt(Bu,e.id),Gt(Lu,le);const L=W(()=>k.value.class instanceof Function?k.value.class(k.value):k.value.class),H=W(()=>k.value.style instanceof Function?k.value.style(k.value):k.value.style),J=W(()=>{const v=k.value.type||"default",_=U?.[`edge-${v}`];if(_)return _;let x=k.value.template??a.value[v];if(typeof x=="string"&&K){const R=Object.keys(K.appContext.components);R&&R.includes(v)&&(x=Et(v,!1))}return x&&typeof x!="string"?x:(i.error(new Ge(He.EDGE_TYPE_MISSING,x)),!1)}),{handlePointerDown:X}=Ri({nodeId:ne,handleId:D,type:E,isValidConnection:f,edgeUpdaterType:E,onEdgeUpdate:me,onEdgeUpdateEnd:ee});return()=>{const v=p(k.value.source),_=p(k.value.target),x="pathOptions"in k.value?k.value.pathOptions:{};if(!v&&!_)return i.error(new Ge(He.EDGE_SOURCE_TARGET_MISSING,k.value.id,k.value.source,k.value.target)),null;if(!v)return i.error(new Ge(He.EDGE_SOURCE_MISSING,k.value.id,k.value.source)),null;if(!_)return i.error(new Ge(He.EDGE_TARGET_MISSING,k.value.id,k.value.target)),null;if(!k.value||k.value.hidden||v.hidden||_.hidden)return null;let R;o.value===kt.Strict?R=v.handleBounds.source:R=[...v.handleBounds.source||[],...v.handleBounds.target||[]];const Q=bs(R,k.value.sourceHandle);let oe;o.value===kt.Strict?oe=_.handleBounds.target:oe=[..._.handleBounds.target||[],..._.handleBounds.source||[]];const ie=bs(oe,k.value.targetHandle),ue=Q?.position||Z.Bottom,ve=ie?.position||Z.Top,{x:Se,y:$e}=Xt(v,Q,ue),{x:Xe,y:Qe}=Xt(_,ie,ve);return k.value.sourceX=Se,k.value.sourceY=$e,k.value.targetX=Xe,k.value.targetY=Qe,Ae("g",{ref:le,key:e.id,"data-id":e.id,class:["vue-flow__edge",`vue-flow__edge-${J.value===!1?"default":k.value.type||"default"}`,l.value,L.value,{updating:F.value,selected:k.value.selected,animated:k.value.animated,inactive:!b.value&&!P.value.edgeClick.hasListeners()}],tabIndex:T.value?0:void 0,"aria-label":k.value.ariaLabel===null?void 0:k.value.ariaLabel??`Edge from ${k.value.source} to ${k.value.target}`,"aria-describedby":T.value?`${vi}-${t}`:void 0,"aria-roledescription":"edge",role:T.value?"group":"img",...k.value.domAttributes,onClick:ae,onContextmenu:he,onDblclick:ke,onMouseenter:_e,onMousemove:Ce,onMouseleave:Te,onKeyDown:T.value?w:void 0},[re.value?null:Ae(J.value===!1?a.value.default:J.value,{id:e.id,sourceNode:v,targetNode:_,source:k.value.source,target:k.value.target,type:k.value.type,updatable:B.value,selected:k.value.selected,animated:k.value.animated,label:k.value.label,labelStyle:k.value.labelStyle,labelShowBg:k.value.labelShowBg,labelBgStyle:k.value.labelBgStyle,labelBgPadding:k.value.labelBgPadding,labelBgBorderRadius:k.value.labelBgBorderRadius,data:k.value.data,events:{...k.value.events,...I},style:H.value,markerStart:`url('#${pn(k.value.markerStart,t)}')`,markerEnd:`url('#${pn(k.value.markerEnd,t)}')`,sourcePosition:ue,targetPosition:ve,sourceX:Se,sourceY:$e,targetX:Xe,targetY:Qe,sourceHandleId:k.value.sourceHandle,targetHandleId:k.value.targetHandle,interactionWidth:k.value.interactionWidth,...x}),[B.value==="source"||B.value===!0?[Ae("g",{onMousedown:pe,onMouseenter:se,onMouseout:de},Ae(Ps,{position:ue,centerX:Se,centerY:$e,radius:s.value,type:"source","data-type":"source"}))]:null,B.value==="target"||B.value===!0?[Ae("g",{onMousedown:Ee,onMouseenter:se,onMouseout:de},Ae(Ps,{position:ve,centerX:Xe,centerY:Qe,radius:s.value,type:"target","data-type":"target"}))]:null]])};function se(){F.value=!0}function de(){F.value=!1}function me(v,_){y.update({event:v,edge:k.value,connection:_})}function ee(v){y.updateEnd({event:v,edge:k.value}),re.value=!1}function ce(v,_){v.button===0&&(re.value=!0,ne.value=_?k.value.target:k.value.source,D.value=(_?k.value.targetHandle:k.value.sourceHandle)??null,E.value=_?"target":"source",y.updateStart({event:v,edge:k.value}),X(v))}function ae(v){var _;const x={event:v,edge:k.value};b.value&&(r.value=!1,k.value.selected&&m.value?(c([k.value]),(_=le.value)==null||_.blur()):n([k.value])),y.click(x)}function he(v){y.contextMenu({event:v,edge:k.value})}function ke(v){y.doubleClick({event:v,edge:k.value})}function _e(v){y.mouseEnter({event:v,edge:k.value})}function Ce(v){y.mouseMove({event:v,edge:k.value})}function Te(v){y.mouseLeave({event:v,edge:k.value})}function pe(v){ce(v,!0)}function Ee(v){ce(v,!1)}function w(v){var _;!S.value&&yi.includes(v.key)&&b.value&&(v.key==="Escape"?((_=le.value)==null||_.blur(),c([u(e.id)])):n([u(e.id)]))}}}),Jd=jd,Qd=Pe({name:"ConnectionLine",compatConfig:{MODE:3},setup(){var e;const{id:t,connectionMode:n,connectionStartHandle:o,connectionEndHandle:s,connectionPosition:i,connectionLineType:r,connectionLineStyle:l,connectionLineOptions:a,connectionStatus:c,viewport:u,findNode:p}=Be(),f=(e=Zt(Jn))==null?void 0:e["connection-line"],m=W(()=>{var P;return p((P=o.value)==null?void 0:P.nodeId)}),S=W(()=>{var P;return p((P=s.value)==null?void 0:P.nodeId)??null}),g=W(()=>({x:(i.value.x-u.value.x)/u.value.zoom,y:(i.value.y-u.value.y)/u.value.zoom})),h=W(()=>a.value.markerStart?`url(#${pn(a.value.markerStart,t)})`:""),C=W(()=>a.value.markerEnd?`url(#${pn(a.value.markerEnd,t)})`:"");return()=>{var P,k,y;if(!m.value||!o.value)return null;const I=o.value.id,U=o.value.type,K=m.value.handleBounds;let F=K?.[U]??[];if(n.value===kt.Loose){const H=K?.[U==="source"?"target":"source"]??[];F=[...F,...H]}if(!F)return null;const re=(I?F.find(H=>H.id===I):F[0])??null,ne=re?.position??Z.Top,{x:D,y:E}=Xt(m.value,re,ne);let le=null;S.value&&(n.value===kt.Strict?le=((P=S.value.handleBounds[U==="source"?"target":"source"])==null?void 0:P.find(H=>{var J;return H.id===((J=s.value)==null?void 0:J.id)}))||null:le=((k=[...S.value.handleBounds.source??[],...S.value.handleBounds.target??[]])==null?void 0:k.find(H=>{var J;return H.id===((J=s.value)==null?void 0:J.id)}))||null);const b=((y=s.value)==null?void 0:y.position)??(ne?Mo[ne]:null);if(!ne||!b)return null;const B=r.value??a.value.type??Ct.Bezier;let T="";const L={sourceX:D,sourceY:E,sourcePosition:ne,targetX:g.value.x,targetY:g.value.y,targetPosition:b};return B===Ct.Bezier?[T]=Hi(L):B===Ct.Step?[T]=Ao({...L,borderRadius:0}):B===Ct.SmoothStep?[T]=Ao(L):B===Ct.SimpleBezier?[T]=Gi(L):T=`M${D},${E} ${g.value.x},${g.value.y}`,Ae("svg",{class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},Ae("g",{class:"vue-flow__connection"},f?Ae(f,{sourceX:D,sourceY:E,sourcePosition:ne,targetX:g.value.x,targetY:g.value.y,targetPosition:b,sourceNode:m.value,sourceHandle:re,targetNode:S.value,targetHandle:le,markerEnd:C.value,markerStart:h.value,connectionStatus:c.value}):Ae("path",{d:T,class:[a.value.class,c.value,"vue-flow__connection-path"],style:{...l.value,...a.value.style},"marker-end":C.value,"marker-start":h.value})))}}}),ef=Qd,tf=["id","markerWidth","markerHeight","markerUnits","orient"],nf={name:"MarkerType",compatConfig:{MODE:3}},of=Pe({...nf,props:{id:{},type:{},color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(e){return(t,n)=>($(),O("marker",{id:t.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${t.width}`,markerHeight:`${t.height}`,markerUnits:t.markerUnits,orient:t.orient},[t.type===M($o).ArrowClosed?($(),O("polyline",{key:0,style:Ye({stroke:t.color,fill:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",points:"-5,-4 0,0 -5,4 -5,-4"},null,4)):we("",!0),t.type===M($o).Arrow?($(),O("polyline",{key:1,style:Ye({stroke:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",fill:"none",points:"-5,-4 0,0 -5,4"},null,4)):we("",!0)],8,tf))}}),sf={class:"vue-flow__marker vue-flow__container","aria-hidden":"true"},rf={name:"MarkerDefinitions",compatConfig:{MODE:3}},lf=Pe({...rf,setup(e){const{id:t,edges:n,connectionLineOptions:o,defaultMarkerColor:s}=Be(),i=W(()=>{const r=new Set,l=[],a=c=>{if(c){const u=pn(c,t);r.has(u)||(typeof c=="object"?l.push({...c,id:u,color:c.color||s.value}):l.push({id:u,color:s.value,type:c}),r.add(u))}};for(const c of[o.value.markerEnd,o.value.markerStart])a(c);for(const c of n.value)for(const u of[c.markerStart,c.markerEnd])a(u);return l.sort((c,u)=>c.id.localeCompare(u.id))});return(r,l)=>($(),O("svg",sf,[d("defs",null,[($(!0),O(xe,null,Me(i.value,a=>($(),Ie(of,{id:a.id,key:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,"stroke-width":a.strokeWidth,orient:a.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))])]))}}),af={name:"Edges",compatConfig:{MODE:3}},cf=Pe({...af,setup(e){const{findNode:t,getEdges:n,elevateEdgesOnSelect:o}=Be();return(s,i)=>($(),O(xe,null,[j(lf),($(!0),O(xe,null,Me(M(n),r=>($(),O("svg",{key:r.id,class:"vue-flow__edges vue-flow__container",style:Ye({zIndex:M(Nu)(r,M(t),M(o))})},[j(M(Jd),{id:r.id},null,8,["id"])],4))),128)),j(M(ef))],64))}}),uf=Pe({name:"Node",compatConfig:{MODE:3},props:["id","resizeObserver"],setup(e){const{id:t,noPanClassName:n,selectNodesOnDrag:o,nodesSelectionActive:s,multiSelectionActive:i,emits:r,removeSelectedNodes:l,addSelectedNodes:a,updateNodeDimensions:c,onUpdateNodeInternals:u,getNodeTypes:p,nodeExtent:f,elevateNodesOnSelect:m,disableKeyboardA11y:S,ariaLiveMessage:g,snapToGrid:h,snapGrid:C,nodeDragThreshold:P,nodesDraggable:k,elementsSelectable:y,nodesConnectable:I,nodesFocusable:U,hooks:K}=Be(),F=ge(null);Gt(Pi,F),Gt(Ai,e.id);const re=Zt(Jn),ne=qt(),D=Bi(),{node:E,parentNode:le}=zi(e.id),{emit:b,on:B}=Wu(E,r),T=ze(()=>typeof E.draggable>"u"?k.value:E.draggable),L=ze(()=>typeof E.selectable>"u"?y.value:E.selectable),H=ze(()=>typeof E.connectable>"u"?I.value:E.connectable),J=ze(()=>typeof E.focusable>"u"?U.value:E.focusable),X=W(()=>L.value||T.value||K.value.nodeClick.hasListeners()||K.value.nodeDoubleClick.hasListeners()||K.value.nodeMouseEnter.hasListeners()||K.value.nodeMouseMove.hasListeners()||K.value.nodeMouseLeave.hasListeners()),se=ze(()=>!!E.dimensions.width&&!!E.dimensions.height),de=W(()=>{const _=E.type||"default",x=re?.[`node-${_}`];if(x)return x;let R=E.template||p.value[_];if(typeof R=="string"&&ne){const Q=Object.keys(ne.appContext.components);Q&&Q.includes(_)&&(R=Et(_,!1))}return R&&typeof R!="string"?R:(r.error(new Ge(He.NODE_TYPE_MISSING,R)),!1)}),me=Oi({id:e.id,el:F,disabled:()=>!T.value,selectable:L,dragHandle:()=>E.dragHandle,onStart(_){b.dragStart(_)},onDrag(_){b.drag(_)},onStop(_){b.dragStop(_)},onClick(_){w(_)}}),ee=W(()=>E.class instanceof Function?E.class(E):E.class),ce=W(()=>{const _=(E.style instanceof Function?E.style(E):E.style)||{},x=E.width instanceof Function?E.width(E):E.width,R=E.height instanceof Function?E.height(E):E.height;return!_.width&&x&&(_.width=typeof x=="string"?x:`${x}px`),!_.height&&R&&(_.height=typeof R=="string"?R:`${R}px`),_}),ae=ze(()=>Number(E.zIndex??ce.value.zIndex??0));return u(_=>{(_.includes(e.id)||!_.length)&&ke()}),dt(()=>{De(()=>E.hidden,(_=!1,x,R)=>{!_&&F.value&&(e.resizeObserver.observe(F.value),R(()=>{F.value&&e.resizeObserver.unobserve(F.value)}))},{immediate:!0,flush:"post"})}),De([()=>E.type,()=>E.sourcePosition,()=>E.targetPosition],()=>{ot(()=>{c([{id:e.id,nodeElement:F.value,forceUpdate:!0}])})}),De([()=>E.position.x,()=>E.position.y,()=>{var _;return(_=le.value)==null?void 0:_.computedPosition.x},()=>{var _;return(_=le.value)==null?void 0:_.computedPosition.y},()=>{var _;return(_=le.value)==null?void 0:_.computedPosition.z},ae,()=>E.selected,()=>E.dimensions.height,()=>E.dimensions.width,()=>{var _;return(_=le.value)==null?void 0:_.dimensions.height},()=>{var _;return(_=le.value)==null?void 0:_.dimensions.width}],([_,x,R,Q,oe,ie])=>{const ue={x:_,y:x,z:ie+(m.value&&E.selected?1e3:0)};typeof R<"u"&&typeof Q<"u"?E.computedPosition=xu({x:R,y:Q,z:oe},ue):E.computedPosition=ue},{flush:"post",immediate:!0}),De([()=>E.extent,f],([_,x],[R,Q])=>{(_!==R||x!==Q)&&he()}),E.extent==="parent"||typeof E.extent=="object"&&"range"in E.extent&&E.extent.range==="parent"?wo(()=>se).toBe(!0).then(he):he(),()=>E.hidden?null:Ae("div",{ref:F,"data-id":E.id,class:["vue-flow__node",`vue-flow__node-${de.value===!1?"default":E.type||"default"}`,{[n.value]:T.value,dragging:me?.value,draggable:T.value,selected:E.selected,selectable:L.value,parent:E.isParent},ee.value],style:{visibility:se.value?"visible":"hidden",zIndex:E.computedPosition.z??ae.value,transform:`translate(${E.computedPosition.x}px,${E.computedPosition.y}px)`,pointerEvents:X.value?"all":"none",...ce.value},tabIndex:J.value?0:void 0,role:J.value?"group":void 0,"aria-describedby":S.value?void 0:`${mi}-${t}`,"aria-label":E.ariaLabel,"aria-roledescription":"node",...E.domAttributes,onMouseenter:_e,onMousemove:Ce,onMouseleave:Te,onContextmenu:pe,onClick:w,onDblclick:Ee,onKeydown:v},[Ae(de.value===!1?p.value.default:de.value,{id:E.id,type:E.type,data:E.data,events:{...E.events,...B},selected:E.selected,resizing:E.resizing,dragging:me.value,connectable:H.value,position:E.computedPosition,dimensions:E.dimensions,isValidTargetPos:E.isValidTargetPos,isValidSourcePos:E.isValidSourcePos,parent:E.parentNode,parentNodeId:E.parentNode,zIndex:E.computedPosition.z??ae.value,targetPosition:E.targetPosition,sourcePosition:E.sourcePosition,label:E.label,dragHandle:E.dragHandle,onUpdateNodeInternals:ke})]);function he(){const _=E.computedPosition,{computedPosition:x,position:R}=Go(E,h.value?Kn(_,C.value):_,r.error,f.value,le.value);(E.computedPosition.x!==x.x||E.computedPosition.y!==x.y)&&(E.computedPosition={...E.computedPosition,...x}),(E.position.x!==R.x||E.position.y!==R.y)&&(E.position=R)}function ke(){F.value&&c([{id:e.id,nodeElement:F.value,forceUpdate:!0}])}function _e(_){me?.value||b.mouseEnter({event:_,node:E})}function Ce(_){me?.value||b.mouseMove({event:_,node:E})}function Te(_){me?.value||b.mouseLeave({event:_,node:E})}function pe(_){return b.contextMenu({event:_,node:E})}function Ee(_){return b.doubleClick({event:_,node:E})}function w(_){L.value&&(!o.value||!T.value||P.value>0)&&Do(E,i.value,a,l,s,!1,F.value),b.click({event:_,node:E})}function v(_){if(!(Io(_)||S.value))if(yi.includes(_.key)&&L.value){const x=_.key==="Escape";Do(E,i.value,a,l,s,x,F.value)}else T.value&&E.selected&&Ht[_.key]&&(_.preventDefault(),g.value=`Moved selected node ${_.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~E.position.x}, y: ${~~E.position.y}`,D({x:Ht[_.key].x,y:Ht[_.key].y},_.shiftKey))}}}),df=uf;function ff(e={includeHiddenNodes:!1}){const{nodes:t}=Be();return W(()=>{if(t.value.length===0)return!1;for(const n of t.value)if((e.includeHiddenNodes||!n.hidden)&&(n?.handleBounds===void 0||n.dimensions.width===0||n.dimensions.height===0))return!1;return!0})}const gf={class:"vue-flow__nodes vue-flow__container"},pf={name:"Nodes",compatConfig:{MODE:3}},hf=Pe({...pf,setup(e){const{getNodes:t,updateNodeDimensions:n,emits:o}=Be(),s=ff(),i=ge();return De(s,r=>{r&&ot(()=>{o.nodesInitialized(t.value)})},{immediate:!0}),dt(()=>{i.value=new ResizeObserver(r=>{const l=r.map(a=>({id:a.target.getAttribute("data-id"),nodeElement:a.target,forceUpdate:!0}));ot(()=>n(l))})}),Bs(()=>{var r;return(r=i.value)==null?void 0:r.disconnect()}),(r,l)=>($(),O("div",gf,[i.value?($(!0),O(xe,{key:0},Me(M(t),(a,c,u,p)=>{const f=[a.id];if(p&&p.key===a.id&&Qi(p,f))return p;const m=($(),Ie(M(df),{id:a.id,key:a.id,"resize-observer":i.value},null,8,["id","resize-observer"]));return m.memo=f,m},l,0),128)):we("",!0)]))}});function mf(){const{emits:e}=Be();dt(()=>{if(Di()){const t=document.querySelector(".vue-flow__pane");t&&window.getComputedStyle(t).zIndex!=="1"&&e.error(new Ge(He.MISSING_STYLES))}})}const vf=d("div",{class:"vue-flow__edge-labels"},null,-1),yf={name:"VueFlow",compatConfig:{MODE:3}},wf=Pe({...yf,props:{id:{},modelValue:{},nodes:{},edges:{},edgeTypes:{},nodeTypes:{},connectionMode:{},connectionLineType:{},connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:{},isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:{default:void 0},selectionKeyCode:{type:[Boolean,null],default:void 0},multiSelectionKeyCode:{default:void 0},zoomActivationKeyCode:{default:void 0},panActivationKeyCode:{default:void 0},snapToGrid:{type:Boolean,default:void 0},snapGrid:{},onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},nodeDragThreshold:{},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:{},maxZoom:{},defaultViewport:{},translateExtent:{},nodeExtent:{},defaultMarkerColor:{},zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:{},panOnScrollMode:{},paneClickDistance:{},zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:{},edgeUpdaterRadius:{},fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:{},noWheelClassName:{},noPanClassName:{},defaultEdgeOptions:{},elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},autoPanSpeed:{}},emits:["nodesChange","edgesChange","nodesInitialized","paneReady","init","updateNodeInternals","error","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeUpdate","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdateEnd","nodeContextMenu","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeDoubleClick","nodeClick","nodeDragStart","nodeDrag","nodeDragStop","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","update:modelValue","update:nodes","update:edges"],setup(e,{expose:t,emit:n}){const o=e,s=Zi(),i=io(o,"modelValue",n),r=io(o,"nodes",n),l=io(o,"edges",n),a=Be(o),c=qu({modelValue:i,nodes:r,edges:l},o,a);return ju(n,a.hooks),Zd(),mf(),Gt(Jn,s),qi(c),t(a),(u,p)=>($(),O("div",{ref:M(a).vueFlowRef,class:"vue-flow"},[j(Hd,null,{default:qe(()=>[j(cf),vf,j(hf),ct(u.$slots,"zoom-pane")]),_:3}),ct(u.$slots,"default"),j(Xd)],512))}});var yt=(e=>(e.Lines="lines",e.Dots="dots",e))(yt||{});const Wi=function({dimensions:e,size:t,color:n}){return Ae("path",{stroke:n,"stroke-width":t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})},Ui=function({radius:e,color:t}){return Ae("circle",{cx:e,cy:e,r:e,fill:t})};yt.Lines+"",yt.Dots+"";const xf={[yt.Dots]:"#81818a",[yt.Lines]:"#eee"},_f=["id","x","y","width","height","patternTransform"],bf={key:2,height:"100",width:"100"},Ef=["fill"],kf=["x","y","fill"],Sf={name:"Background",compatConfig:{MODE:3}},Nf=Pe({...Sf,props:{id:{},variant:{default:()=>yt.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:{},color:{},bgColor:{},height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:0}},setup(e){const{id:t,viewport:n}=Be(),o=W(()=>{const r=n.value.zoom,[l,a]=Array.isArray(e.gap)?e.gap:[e.gap,e.gap],c=[l*r||1,a*r||1],u=e.size*r,[p,f]=Array.isArray(e.offset)?e.offset:[e.offset,e.offset],m=[p*r||1+c[0]/2,f*r||1+c[1]/2];return{scaledGap:c,offset:m,size:u}}),s=ze(()=>`pattern-${t}${e.id?`-${e.id}`:""}`),i=ze(()=>e.color||e.patternColor||xf[e.variant||yt.Dots]);return(r,l)=>($(),O("svg",{class:"vue-flow__background vue-flow__container",style:Ye({height:`${r.height>100?100:r.height}%`,width:`${r.width>100?100:r.width}%`})},[ct(r.$slots,"pattern-container",{id:s.value},()=>[d("pattern",{id:s.value,x:M(n).x%o.value.scaledGap[0],y:M(n).y%o.value.scaledGap[1],width:o.value.scaledGap[0],height:o.value.scaledGap[1],patternTransform:`translate(-${o.value.offset[0]},-${o.value.offset[1]})`,patternUnits:"userSpaceOnUse"},[ct(r.$slots,"pattern",{},()=>[r.variant===M(yt).Lines?($(),Ie(M(Wi),{key:0,size:r.lineWidth,color:i.value,dimensions:o.value.scaledGap},null,8,["size","color","dimensions"])):r.variant===M(yt).Dots?($(),Ie(M(Ui),{key:1,color:i.value,radius:o.value.size/2},null,8,["color","radius"])):we("",!0),r.bgColor?($(),O("svg",bf,[d("rect",{width:"100%",height:"100%",fill:r.bgColor},null,8,Ef)])):we("",!0)])],8,_f)]),d("rect",{x:r.x,y:r.y,width:"100%",height:"100%",fill:`url(#${s.value})`},null,8,kf),ct(r.$slots,"default",{id:s.value})],4))}}),Cf={class:"ultra-card-wrapper"},$f={class:"ribbon-text"},If={class:"card-content"},Tf={class:"text-content"},Mf={class:"card-title"},Df={class:"tech-strip"},Af={class:"tech-dots"},Pf={class:"tech-type"},Of={key:0,class:"tech-badge"},Rf=Pe({__name:"UltraModernCard",props:{data:{},selected:{type:Boolean}},setup(e){const t=e,n=W(()=>{const g=t.data.nodeType||"",h=t.data.type||"",C=t.data.label.toLowerCase();return h==="tool"||g.includes("toolWorkflow")||g.includes("dateTimeTool")||g.includes("vectorStoreQdrant")||g.includes("embeddingsOpenAi")||g.includes("lmChatOpenAi")||g.includes("outputParser")||C==="info ordini"||C==="date & time"||C==="parcelapp"||C==="formatta risposta"||C.includes("retriever")||C.includes("memory")||C.includes("buffer")}),o=W(()=>{const g=t.data.nodeType||"",h=t.data.type||"",C=t.data.label.toLowerCase(),P=h==="ai"&&g.includes("langchain.agent");return P&&console.log("🤖 AI Agent detected:",C,"type:",h,"nodeType:",g),P}),s=W(()=>{const g=t.data.type,h=t.data.nodeType||"",C=t.data.label.toLowerCase();return g==="trigger"||h.includes("trigger")?"trigger":g==="ai"||h.includes("agent")||h.includes("openai")?"ai":g==="storage"||h.includes("database")||h.includes("vector")?"storage":h.includes("if")||h.includes("switch")?"logic":h.includes("http")||h.includes("webhook")?"integration":h.includes("code")||h.includes("function")?"transform":C.includes("email")||C.includes("slack")?"communication":"process"}),i=W(()=>({trigger:"carbon:flash",ai:"carbon:watson-machine-learning",storage:"carbon:db2-database",logic:"carbon:decision-tree",integration:"carbon:api",transform:"carbon:transform",communication:"carbon:email",process:"carbon:flow"})[s.value]||"carbon:circle-solid"),r=W(()=>{const g=t.data.label.toLowerCase(),h=t.data.nodeType||"";return h.includes("postgres")||g.includes("postgres")?"simple-icons:postgresql":h.includes("mysql")||g.includes("mysql")?"simple-icons:mysql":h.includes("mongodb")||g.includes("mongo")?"simple-icons:mongodb":h.includes("redis")||g.includes("redis")?"simple-icons:redis":h.includes("supabase")||g.includes("supabase")?"simple-icons:supabase":h==="n8n-nodes-base.microsoftOutlook"||h==="n8n-nodes-base.microsoftOutlookTrigger"||h.includes("microsoftOutlook")||h.includes("outlook")||g.includes("outlook")||g.includes("mail")&&(g.includes("ordini")||g.includes("email"))?"vscode-icons:file-type-outlook":h.includes("telegram")||g.includes("telegram")?"simple-icons:telegram":h.includes("slack")||g.includes("slack")?"simple-icons:slack":h.includes("gmail")||g.includes("gmail")?"simple-icons:gmail":h.includes("discord")||g.includes("discord")?"simple-icons:discord":h.includes("whatsapp")||g.includes("whatsapp")?"simple-icons:whatsapp":h.includes("langchain.agent")||h==="ai"&&nodeType.includes("agent")||g.includes("agent")||g.includes("assistente")||g.includes("milena")?"fluent:brain-circuit-20-regular":h.includes("openai")||g.includes("openai")||g.includes("gpt")?"simple-icons:openai":h.includes("anthropic")||g.includes("claude")?"simple-icons:anthropic":h.includes("langchain")?"carbon:flow-data":h.includes("google")||g.includes("google")?"simple-icons:google":h.includes("aws")||g.includes("aws")?"simple-icons:amazonaws":h.includes("azure")||g.includes("azure")?"simple-icons:microsoftazure":h.includes("github")||g.includes("github")?"simple-icons:github":h.includes("gitlab")||g.includes("gitlab")?"simple-icons:gitlab":h.includes("docker")||g.includes("docker")?"simple-icons:docker":h.includes("kubernetes")||g.includes("kubernetes")?"simple-icons:kubernetes":h.includes("git")||g.includes("git")?"simple-icons:git":h.includes("twitter")||g.includes("twitter")?"simple-icons:x":h.includes("facebook")||g.includes("facebook")?"simple-icons:facebook":h.includes("instagram")||g.includes("instagram")?"simple-icons:instagram":h.includes("linkedin")||g.includes("linkedin")?"simple-icons:linkedin":h.includes("stripe")||g.includes("stripe")?"simple-icons:stripe":h.includes("paypal")||g.includes("paypal")?"simple-icons:paypal":h.includes("shopify")||g.includes("shopify")?"simple-icons:shopify":h.includes("wordpress")||g.includes("wordpress")?"simple-icons:wordpress":h.includes("excel")||g.includes("excel")?"vscode-icons:file-type-excel":h.includes("csv")||g.includes("csv")?"vscode-icons:file-type-csv":h.includes("json")||g.includes("json")?"vscode-icons:file-type-json":h.includes("xml")||g.includes("xml")?"vscode-icons:file-type-xml":h.includes("pdf")||g.includes("pdf")?"vscode-icons:file-type-pdf":h.includes("n8n-nodes-base.spreadsheetFile")?"vscode-icons:file-type-excel":h.includes("n8n-nodes-base.googleSheets")?"simple-icons:googlesheets":h.includes("n8n-nodes-base.googleDrive")?"simple-icons:googledrive":h.includes("n8n-nodes-base.notion")?"simple-icons:notion":h.includes("n8n-nodes-base.airtable")?"simple-icons:airtable":h.includes("n8n-nodes-base.trello")?"simple-icons:trello":h.includes("n8n-nodes-base.jira")?"simple-icons:jira":h.includes("n8n-nodes-base.asana")?"simple-icons:asana":h.includes("n8n-nodes-base.monday")?"simple-icons:mondaydotcom":h.includes("n8n-nodes-base.clickup")?"simple-icons:clickup":h.includes("n8n-nodes-base.hubspot")?"simple-icons:hubspot":h.includes("n8n-nodes-base.salesforce")?"simple-icons:salesforce":h.includes("n8n-nodes-base.zendesk")?"simple-icons:zendesk":h.includes("n8n-nodes-base.twilio")?"simple-icons:twilio":h.includes("n8n-nodes-base.sendgrid")?"simple-icons:sendgrid":h.includes("n8n-nodes-base.mailchimp")?"simple-icons:mailchimp":h.includes("n8n-nodes-base.calendly")?"simple-icons:calendly":h.includes("n8n-nodes-base.zoom")?"simple-icons:zoom":h.includes("n8n-nodes-base.teams")?"simple-icons:microsoftteams":h.includes("n8n-nodes-base.dropbox")?"simple-icons:dropbox":h.includes("n8n-nodes-base.box")?"simple-icons:box":h.includes("n8n-nodes-base.onedrive")?"simple-icons:microsoftonedrive":h.includes("webhook")?"carbon:webhook":h.includes("schedule")||h.includes("cron")?"carbon:alarm":h.includes("httpRequest")?"carbon:http":h.includes("n8n-nodes-base.code")?"carbon:code":h.includes("n8n-nodes-base.function")?"carbon:function":h.includes("n8n-nodes-base.if")?"carbon:decision-tree":h.includes("n8n-nodes-base.switch")?"carbon:flow-switch":h.includes("n8n-nodes-base.merge")?"carbon:join-inner":h.includes("n8n-nodes-base.wait")?"carbon:hourglass":h.includes("n8n-nodes-base.set")?"carbon:settings-adjust":h.includes("n8n-nodes-base.splitInBatches")?"carbon:batch-job":h.includes("email")?"carbon:email":i.value}),l=W(()=>{const g=t.data.label,h={Webhook:"Data Receiver","Schedule Trigger":"Scheduled Process","Manual Trigger":"Manual Start",OpenAI:"AI Processing","Chat Model":"AI Conversation",Agent:"Smart Assistant",Postgres:"Database Operations","Vector Store":"Knowledge Store","HTTP Request":"API Call",If:"Decision Logic",Switch:"Multi-Path Router",Code:"Custom Processing",Function:"Data Transform"};for(const[C,P]of Object.entries(h))if(g.includes(C))return P;return g});W(()=>({trigger:"Initiates business process",ai:"Intelligent processing",storage:"Data persistence layer",logic:"Business rule evaluation",integration:"External system bridge",transform:"Data manipulation",communication:"Message handling",process:"Business operation"})[s.value]||"Processing node");const a=W(()=>({trigger:"PROCESS START",ai:"INTELLIGENCE",storage:"DATA LAYER",logic:"DECISION",integration:"INTEGRATION",transform:"TRANSFORM",communication:"MESSAGING",process:"OPERATION"})[s.value]||"PROCESS");W(()=>({trigger:"ASYNC",ai:"ML/AI",storage:"CRUD",logic:"CONDITIONAL",integration:"REST/API",transform:"COMPUTE",communication:"SMTP/WEBHOOK",process:"SYNC"})[s.value]||"PROCESS");const c=W(()=>{const g={trigger:"linear-gradient(135deg, #2f855a, #276749)",ai:"linear-gradient(135deg, #553c9a, #434190)",storage:"linear-gradient(135deg, #2b6cb0, #2c5282)",logic:"linear-gradient(135deg, #4a5568, #2d3748)",integration:"linear-gradient(135deg, #742a2a, #63171b)",transform:"linear-gradient(135deg, #234e52, #1a4044)",communication:"linear-gradient(135deg, #744210, #5f370e)",process:"linear-gradient(135deg, #2d3748, #1a202c)"};return g[s.value]||g.process}),u=W(()=>{const g={trigger:"#276749",ai:"#434190",storage:"#2c5282",logic:"#2d3748",integration:"#63171b",transform:"#1a4044",communication:"#5f370e",process:"#1a202c"}[s.value]||"#1a202c";return`radial-gradient(circle, ${g}22, ${g}11)`});W(()=>t.data.inputs||["input"]),W(()=>t.data.outputs||["output"]);const p=W(()=>t.data.status==="active"),f=W(()=>t.data.status==="error");W(()=>t.data.status||"idle"),W(()=>s.value!=="trigger"),W(()=>t.data.executionCount),W(()=>t.data.successRate),W(()=>t.data.avgTime);const m=W(()=>{const g=t.data.nodeType||"",h=t.data.label.toLowerCase(),C=t.data.type||"";return g.includes("trigger")||g.includes("webhook")||g.includes("wait")||g.includes("cron")||g.includes("schedule")||C==="trigger"?"ASYNC":g.includes("n8n-nodes-base.code")||g.includes("n8n-nodes-base.function")||g.includes("javascript")||g.includes("python")||h.includes("code")||h.includes("function")?"CODE":g.includes("langchain")||g.includes("openai")||g.includes("ai")||C==="ai"||C==="tool"?"AI":g.includes("postgres")||g.includes("mysql")||g.includes("mongo")||g.includes("redis")||g.includes("supabase")||C==="storage"?"DB":g.includes("httpRequest")||g.includes("webhook")||g.includes("api")||h.includes("http")?"API":g.includes("n8n-nodes-base.if")||g.includes("switch")||h.includes("if")?"LOGIC":"SYNC"}),S=W(()=>{const g=t.data.nodeType||"";return t.data.label.toLowerCase(),g.includes("n8n-nodes-base.code")?"</>":g.includes("n8n-nodes-base.function")?"f(x)":g.includes("javascript")?"JS":g.includes("python")?"PY":g.includes("langchain.agent")?"AI":g.includes("openai")||g.includes("gpt")?"GPT":g.includes("embeddings")?"↗️":g.includes("postgres")?"PG":g.includes("mysql")?"SQL":g.includes("qdrant")||g.includes("vectorStore")?"VEC":g.includes("telegram")?"TG":g.includes("gmail")||g.includes("email")?"✉️":g.includes("slack")?"SK":g.includes("n8n-nodes-base.if")?"IF":g.includes("switch")?"⇄":g.includes("merge")?"⊕":g.includes("cron")?"⏰":g.includes("wait")?"⏸":null});return(g,h)=>($(),O("div",Cf,[d("div",{class:ye(["ultra-card",`card-${s.value}`,{"card-ai-wide":o.value,"card-tool-narrow":n.value,"card-running":p.value,"card-executing":g.data.isExecuting||g.data.status==="executing","card-error":f.value,"card-selected":g.selected}])},[d("div",{class:"card-ribbon",style:Ye({background:c.value})},[d("span",$f,V(a.value),1)],4),d("div",If,[d("div",{class:"icon-container",style:Ye({background:u.value})},[j(M(be),{icon:r.value,class:"main-icon"},null,8,["icon"]),h[0]||(h[0]=d("div",{class:"icon-pulse"},null,-1))],4),d("div",Tf,[d("h3",Mf,V(l.value),1)])]),d("div",Df,[d("div",Af,[($(),O(xe,null,Me(3,C=>d("span",{key:C,class:"tech-dot"})),64))]),d("span",Pf,V(m.value),1),S.value?($(),O("div",Of,[d("span",null,V(S.value),1)])):we("",!0)])],2),o.value?($(),O(xe,{key:0},[j(M(Re),{type:"target",position:M(Z).Left,id:"left",class:"ultra-handle handle-main"},null,8,["position"]),j(M(Re),{type:"source",position:M(Z).Right,id:"right",class:"ultra-handle handle-main"},null,8,["position"]),($(),O(xe,null,Me(4,C=>j(M(Re),{key:`tool-out-${C}`,type:"source",position:M(Z).Bottom,id:`tool-${C-1}`,class:"ultra-handle handle-tool",style:Ye({left:`${20+(C-1)*20}%`})},null,8,["position","id","style"])),64))],64)):n.value?($(),O(xe,{key:1},[j(M(Re),{type:"target",position:M(Z).Top,id:"top",class:"ultra-handle handle-tool-input"},null,8,["position"]),j(M(Re),{type:"source",position:M(Z).Bottom,id:"bottom",class:"ultra-handle handle-tool-output"},null,8,["position"])],64)):s.value==="storage"?($(),O(xe,{key:2},[j(M(Re),{type:"target",position:M(Z).Top,id:"top",class:"ultra-handle handle-data"},null,8,["position"]),j(M(Re),{type:"source",position:M(Z).Bottom,id:"bottom",class:"ultra-handle handle-data"},null,8,["position"])],64)):s.value==="trigger"?($(),Ie(M(Re),{key:3,type:"source",position:M(Z).Right,id:"right",class:"ultra-handle handle-trigger"},null,8,["position"])):($(),O(xe,{key:4},[j(M(Re),{type:"target",position:M(Z).Left,id:"left",class:"ultra-handle handle-standard"},null,8,["position"]),j(M(Re),{type:"source",position:M(Z).Right,id:"right",class:"ultra-handle handle-standard"},null,8,["position"])],64))]))}}),Os=Yn(Rf,[["__scopeId","data-v-0f20d1c8"]]),zf={class:"w-full max-w-6xl max-h-[90vh] bg-surface border border-border rounded-xl shadow-2xl overflow-hidden"},Bf={class:"flex items-center justify-between p-6 border-b border-border"},Lf={class:"flex items-center gap-4"},Vf={class:"p-3 bg-primary/10 border border-primary/30 rounded-lg"},Ff={class:"text-xl font-semibold text-text"},Hf={class:"flex items-center gap-3 mt-1"},Gf={class:"text-sm text-text-muted"},Yf={key:0,class:"px-2 py-1 bg-blue-500/10 border border-blue-500/30 text-blue-400 rounded text-xs font-medium"},Wf={class:"flex items-center gap-2"},Uf=["disabled","title"],Xf={key:0,class:"flex items-center justify-center p-12"},Zf={key:1,class:"p-6"},qf={class:"text-sm text-text-secondary mt-2"},Kf={class:"mt-4 flex gap-2"},jf={key:2},Jf={class:"flex items-center gap-1 p-2 border-b border-border bg-gray-900/50"},Qf=["onClick"],eg={class:"overflow-y-auto",style:{"max-height":"calc(90vh - 200px)"}},tg={key:0,class:"p-6 space-y-6"},ng={key:0,class:"control-card p-6 border-blue-500/30"},og={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},sg={class:"space-y-3"},ig={class:"text-text text-sm whitespace-pre-wrap"},rg={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},lg={class:"control-card p-4"},ag={class:"flex items-center justify-between mb-2"},cg={class:"text-base font-bold text-text"},ug={class:"control-card p-4"},dg={class:"flex items-center justify-between mb-2"},fg={class:"text-base font-bold text-text"},gg={class:"control-card p-4"},pg={class:"flex items-center justify-between mb-2"},hg={class:"text-base font-bold text-primary"},mg={class:"control-card p-4"},vg={class:"flex items-center justify-between mb-2"},yg={class:"text-base font-bold text-text"},wg={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},xg={class:"control-card p-6"},_g={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},bg={class:"space-y-3"},Eg={class:"flex justify-between"},kg={class:"text-text"},Sg={class:"flex justify-between"},Ng={class:"text-text"},Cg={class:"flex justify-between"},$g={class:"text-text"},Ig={class:"flex justify-between"},Tg={class:"flex justify-between"},Mg={class:"control-card p-6"},Dg={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Ag={class:"space-y-3"},Pg={class:"flex justify-between"},Og={class:"text-primary font-bold"},Rg={class:"flex justify-between"},zg={class:"text-red-400 font-bold"},Bg={class:"flex justify-between"},Lg={class:"text-purple-400 font-bold"},Vg={class:"flex justify-between"},Fg={class:"text-orange-400 font-bold"},Hg={class:"flex justify-between"},Gg={class:"text-yellow-400"},Yg={key:1,class:"p-6 space-y-6"},Wg={class:"control-card p-6"},Ug={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Xg={class:"space-y-3"},Zg={key:0,class:"text-text-secondary text-center py-4"},qg={class:"flex items-center gap-3"},Kg={class:"text-text text-sm"},jg={class:"text-xs text-text-muted"},Jg={class:"text-right"},Qg={class:"text-text text-sm"},ep={key:2,class:"p-6 space-y-6"},tp={key:0,class:"control-card p-6 border-purple-500/30"},np={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},op={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},sp={class:"flex items-start justify-between mb-2"},ip={class:"text-text font-medium"},rp={class:"space-y-1 text-sm"},lp={class:"text-text-muted"},ap={class:"text-purple-300"},cp={key:0,class:"text-text-muted"},up={class:"text-purple-300"},dp={key:1,class:"mt-2"},fp={class:"flex flex-wrap gap-1"},gp={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},pp={class:"control-card p-6"},hp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},mp={key:0,class:"space-y-3"},vp={class:"flex-1"},yp={class:"text-text font-medium"},wp={class:"text-xs text-text-muted"},xp={key:1,class:"text-text-secondary text-center py-4"},_p={class:"control-card p-6"},bp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Ep={class:"space-y-3"},kp={key:0,class:"flex items-center justify-between p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg"},Sp={class:"flex items-center gap-2"},Np={class:"text-text text-sm"},Cp={class:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs font-bold"},$p={class:"control-card p-6"},Ip={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Tp={key:0,class:"space-y-3"},Mp={class:"flex-1"},Dp={class:"text-text font-medium"},Ap={class:"text-xs text-text-muted"},Pp={key:1,class:"text-text-secondary text-center py-4"},Op={key:3,class:"p-6 space-y-6"},Rp={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},zp={class:"control-card p-6"},Bp={class:"flex items-center justify-between mb-4"},Lp={class:"text-base font-bold text-text"},Vp={class:"control-card p-6"},Fp={class:"flex items-center justify-between mb-4"},Hp={class:"text-base font-bold text-text"},Gp={class:"control-card p-6"},Yp={class:"flex items-center justify-between mb-4"},Wp={class:"text-base font-bold text-text"},Up={key:0,class:"control-card p-6"},Xp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Zp={class:"space-y-3"},qp={class:"flex items-start justify-between"},Kp={class:"flex-1"},jp={class:"text-red-400 font-medium"},Jp={class:"text-xs text-text-muted mt-1"},Qp={class:"text-xs text-text-secondary"},eh={key:4,class:"p-6"},th={class:"control-card p-6"},nh={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},oh={class:"space-y-4"},sh={class:"flex-shrink-0 mt-1"},ih={key:0,class:"w-8 h-8 bg-primary/10 border border-primary/30 rounded-full flex items-center justify-center"},rh={key:1,class:"w-8 h-8 bg-red-500/10 border border-red-500/30 rounded-full flex items-center justify-center"},lh={key:2,class:"w-8 h-8 bg-yellow-500/10 border border-yellow-500/30 rounded-full flex items-center justify-center"},ah={class:"flex-1 pb-4 border-l-2 border-border pl-4 -ml-4"},ch={class:"flex items-center justify-between mb-1"},uh={class:"text-text font-medium"},dh={class:"text-xs text-text-secondary"},fh={class:"text-sm text-text-muted"},gh={key:0,class:"text-sm text-red-400 mt-1"},ph=Pe({__name:"WorkflowDetailModal",props:{workflow:{},show:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const n=e,o=Ls(),s=ge(!1),i=ge(null),r=ge("overview"),l=ge([]),a=ge({totalNodes:0,nodesByType:{},triggers:[],outputs:[],aiAgents:[],tools:[],subWorkflows:[],connections:[]}),c=ge({total:0,successful:0,failed:0,averageDuration:0,recentExecutions:[]}),u=ge({minExecutionTime:0,avgExecutionTime:0,maxExecutionTime:0,errorRate:0,commonErrors:[]}),p=[{id:"overview",label:"Overview",icon:"lucide:info"},{id:"executions",label:"Executions",icon:"lucide:activity"},{id:"nodes",label:"Nodes",icon:"lucide:layers"},{id:"performance",label:"Performance",icon:"lucide:trending-up"},{id:"activity",label:"Activity",icon:"lucide:clock"}],f=async()=>{s.value=!0,i.value=null;try{console.log("🔄 [MODAL DEBUG] Loading workflow details for:",n.workflow.id,{modalShow:n.show,workflowName:n.workflow.name,callStack:new Error().stack?.split(`
`)[1]?.trim()});const y=await et.getProcessDetails(n.workflow.id);console.log("✅ Workflow details loaded:",y.data),y.data.businessDescription&&(l.value=Array.isArray(y.data.businessDescription)?y.data.businessDescription:[y.data.businessDescription]),a.value={totalNodes:y.data.nodeCount||0,nodesByType:y.data.nodesByType||{},triggers:y.data.triggers||[],outputs:y.data.outputs||[],aiAgents:y.data.aiAgents||[],tools:y.data.tools||[],subWorkflows:y.data.subWorkflows||[],connections:y.data.connections||[]},c.value={total:y.data.totalExecutions||n.workflow.execution_count||0,successful:y.data.successfulExecutions||0,failed:y.data.failedExecutions||0,averageDuration:y.data.avgDuration||0,recentExecutions:y.data.recentExecutions||[]},u.value={minExecutionTime:y.data.minExecutionTime||0,avgExecutionTime:y.data.avgExecutionTime||0,maxExecutionTime:y.data.maxExecutionTime||0,errorRate:y.data.errorRate||0,commonErrors:y.data.commonErrors||[]},await m()}catch(y){console.error("❌ Failed to load workflow details:",y),i.value=y}finally{s.value=!1}},m=async()=>{try{const y=await et.getProcessDetails(n.workflow.id);y?.data?.stickyNotes?.length>0&&(l.value=y.data.stickyNotes.map(I=>I.content).filter(Boolean),console.log("✅ Business description loaded from sticky notes:",l.value.length))}catch(y){console.warn("⚠️ Could not load sticky notes:",y)}},S=y=>y<1e3?`${y}ms`:y<6e4?`${(y/1e3).toFixed(1)}s`:`${(y/6e4).toFixed(1)}min`,g=y=>new Date(y).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{navigator.clipboard.writeText(y),o.showToast("Success","ID copiato negli appunti","success")},C=()=>{const y=JSON.stringify(n.workflow,null,2),I="data:application/json;charset=utf-8,"+encodeURIComponent(y),U=`workflow-${n.workflow.name}-${Date.now()}.json`,K=document.createElement("a");K.setAttribute("href",I),K.setAttribute("download",U),K.click(),o.showToast("Success","Workflow esportato","success")},P=async()=>{console.log("🔄 Force refresh requested for workflow",n.workflow.id),await f(),o.showToast("Success","Dati aggiornati dal backend","success")},k=()=>{f()};return De(()=>n.show,y=>{console.log("🔍 [MODAL DEBUG] Show prop changed:",{newShow:y,oldShow:!y,workflowId:n.workflow?.id,workflowName:n.workflow?.name}),y&&(console.log("📊 [MODAL DEBUG] Modal opened for workflow:",n.workflow.name),f(),r.value="overview")}),dt(()=>{console.log("🎬 [MODAL DEBUG] Modal mounted:",{show:n.show,workflowId:n.workflow?.id,workflowName:n.workflow?.name}),n.show&&(console.log("📊 [MODAL DEBUG] Modal mounted and showing - loading details"),f())}),(y,I)=>{const U=Et("Info"),K=Et("Activity"),F=Et("AlertTriangle"),re=Et("XCircle"),ne=Et("CheckCircle");return $(),Ie(ir,{to:"body"},[y.show?($(),O("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:I[3]||(I[3]=rr(D=>y.$emit("close"),["self"]))},[d("div",zf,[d("div",Bf,[d("div",Lf,[d("div",Vf,[j(M(be),{icon:"lucide:git-branch",class:"h-6 w-6 text-primary"})]),d("div",null,[d("h2",Ff,V(y.workflow.name),1),d("div",Hf,[d("span",Gf,"ID: "+V(y.workflow.id),1),d("span",{class:ye(["px-2 py-1 rounded text-xs font-medium",y.workflow.active?"bg-primary/10 border border-primary/30 text-primary":"bg-yellow-500/10 border border-yellow-500/30 text-yellow-400"])},V(y.workflow.active?"Active":"Inactive"),3),y.workflow.has_webhook?($(),O("span",Yf,' Icon icon="lucide:webhook" ')):we("",!0)])])]),d("div",Wf,[d("button",{onClick:I[0]||(I[0]=D=>h(y.workflow.id)),class:"p-2 text-text-muted hover:text-primary transition-colors",title:"Copy ID"},[j(M(be),{icon:"lucide:copy",class:"h-4 w-4"})]),d("button",{onClick:C,class:"p-2 text-text-muted hover:text-primary transition-colors",title:"Export JSON"},[j(M(be),{icon:"lucide:download",class:"h-4 w-4"})]),d("button",{onClick:P,disabled:s.value,class:"p-2 text-text-muted hover:text-primary disabled:text-gray-600 transition-colors",title:s.value?"Refreshing...":"Force Refresh from n8n"},[j(M(be),{icon:"lucide:refresh-cw",class:ye(["h-4 w-4",{"animate-spin":s.value}])},null,8,["class"])],8,Uf),d("button",{onClick:I[1]||(I[1]=D=>y.$emit("close")),class:"p-2 text-text-muted hover:text-red-400 transition-colors"},[j(M(be),{icon:"lucide:x",class:"h-5 w-5"})])])]),s.value?($(),O("div",Xf,[...I[4]||(I[4]=[d("div",{class:"text-center"},[d("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),d("p",{class:"mt-4 text-text-muted"},"Caricamento dettagli workflow...")],-1)])])):i.value?($(),O("div",Zf,[I[5]||(I[5]=d("div",{class:"flex items-center justify-between mb-4"},[d("h2",{class:"text-lg font-semibold text-error"},"Errore nel caricamento")],-1)),I[6]||(I[6]=d("p",{class:"text-text-muted"},"Impossibile caricare i dettagli del workflow. Riprova più tardi.",-1)),d("p",qf,V(i.value.message||"Errore sconosciuto"),1),d("div",Kf,[d("button",{onClick:k,class:"btn-control-primary"},"Riprova"),d("button",{onClick:I[2]||(I[2]=D=>y.$emit("close")),class:"btn-control"},"Chiudi")])])):($(),O("div",jf,[d("div",Jf,[($(),O(xe,null,Me(p,D=>d("button",{key:D.id,onClick:E=>r.value=D.id,class:ye(["flex items-center gap-2 px-4 py-2 rounded-md text-sm transition-all",r.value===D.id?"bg-primary text-white":"text-text-secondary hover:bg-surface hover:text-text"])},[j(M(be),{icon:D.icon,class:"h-4 w-4"},null,8,["icon"]),We(" "+V(D.label),1)],10,Qf)),64))]),d("div",eg,[r.value==="overview"?($(),O("div",tg,[l.value?($(),O("div",ng,[d("h3",og,[j(M(be),{icon:"lucide:info",class:"h-5 w-5 text-blue-400"}),I[7]||(I[7]=We(" Business Description ",-1))]),d("div",sg,[($(!0),O(xe,null,Me(l.value,(D,E)=>($(),O("div",{key:E,class:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg"},[j(M(be),{icon:"lucide:file-text",class:"h-4 w-4 text-yellow-400 float-left mr-2 mt-1"}),d("div",ig,V(D),1)]))),128))])])):we("",!0),d("div",rg,[d("div",lg,[d("div",ag,[I[8]||(I[8]=d("span",{class:"text-sm text-text-muted"},"Total Nodes",-1)),j(M(be),{icon:"lucide:box",class:"h-4 w-4 text-gray-600"})]),d("p",cg,V(a.value.totalNodes||y.workflow.node_count||0),1)]),d("div",ug,[d("div",dg,[I[9]||(I[9]=d("span",{class:"text-sm text-text-muted"},"Total Executions",-1)),j(M(be),{icon:"lucide:play",class:"h-4 w-4 text-gray-600"})]),d("p",fg,V(c.value.total||y.workflow.execution_count||0),1)]),d("div",gg,[d("div",pg,[I[10]||(I[10]=d("span",{class:"text-sm text-text-muted"},"Success Rate",-1)),j(M(be),{icon:"lucide:check-circle",class:"h-4 w-4 text-gray-600"})]),d("p",hg,V(c.value.total>0?`${(c.value.successful/c.value.total*100).toFixed(1)}%`:"N/A"),1)]),d("div",mg,[d("div",vg,[I[11]||(I[11]=d("span",{class:"text-sm text-text-muted"},"Avg Duration",-1)),j(M(be),{icon:"lucide:clock",class:"h-4 w-4 text-gray-600"})]),d("p",yg,V(S(c.value.averageDuration)),1)])]),d("div",wg,[d("div",xg,[d("h3",_g,[j(U,{class:"h-5 w-5 text-primary"}),I[12]||(I[12]=We(" Workflow Information ",-1))]),d("div",bg,[d("div",Eg,[I[13]||(I[13]=d("span",{class:"text-text-muted"},"Created",-1)),d("span",kg,V(g(y.workflow.created_at)),1)]),d("div",Sg,[I[14]||(I[14]=d("span",{class:"text-text-muted"},"Updated",-1)),d("span",Ng,V(g(y.workflow.updated_at)),1)]),d("div",Cg,[I[15]||(I[15]=d("span",{class:"text-text-muted"},"Last Execution",-1)),d("span",$g,V(y.workflow.last_execution?g(y.workflow.last_execution):"Never"),1)]),d("div",Ig,[I[16]||(I[16]=d("span",{class:"text-text-muted"},'Icon icon="lucide:webhook"',-1)),d("span",{class:ye(y.workflow.has_webhook?"text-primary":"text-text-secondary")},V(y.workflow.has_webhook?"Enabled":"Disabled"),3)]),d("div",Tg,[I[17]||(I[17]=d("span",{class:"text-text-muted"},"Archived",-1)),d("span",{class:ye(y.workflow.is_archived?"text-yellow-400":"text-text-secondary")},V(y.workflow.is_archived?"Yes":"No"),3)])])]),d("div",Mg,[d("h3",Dg,[j(M(be),{icon:"lucide:activity",class:"h-5 w-5 text-blue-400"}),I[18]||(I[18]=We(" Quick Stats ",-1))]),d("div",Ag,[d("div",Pg,[I[19]||(I[19]=d("span",{class:"text-text-muted"},"Successful Runs",-1)),d("span",Og,V(c.value.successful),1)]),d("div",Rg,[I[20]||(I[20]=d("span",{class:"text-text-muted"},"Failed Runs",-1)),d("span",zg,V(c.value.failed),1)]),d("div",Bg,[I[21]||(I[21]=d("span",{class:"text-text-muted"},"AI Agents",-1)),d("span",Lg,V(a.value.aiAgents?.length||0),1)]),d("div",Vg,[I[22]||(I[22]=d("span",{class:"text-text-muted"},"Tools",-1)),d("span",Fg,V(a.value.tools?.length||0),1)]),d("div",Hg,[I[23]||(I[23]=d("span",{class:"text-text-muted"},"Error Rate",-1)),d("span",Gg,V(u.value.errorRate||0)+"%",1)])])])])])):we("",!0),r.value==="executions"?($(),O("div",Yg,[d("div",Wg,[d("h3",Ug,[j(M(be),{icon:"lucide:clock",class:"h-5 w-5 text-blue-400"}),I[24]||(I[24]=We(" Recent Executions ",-1))]),d("div",Xg,[c.value.recentExecutions?.length===0?($(),O("div",Zg," No recent executions ")):($(!0),O(xe,{key:1},Me(c.value.recentExecutions||[],(D,E)=>($(),O("div",{key:D.id||E,class:"flex items-center justify-between p-3 bg-surface rounded-lg"},[d("div",qg,[D.status==="success"?($(),Ie(M(be),{key:0,icon:"lucide:check-circle",class:"h-4 w-4 text-primary"})):D.status==="error"?($(),Ie(M(be),{key:1,icon:"lucide:x-circle",class:"h-4 w-4 text-red-400"})):($(),Ie(M(be),{key:2,icon:"lucide:alert-triangle",class:"h-4 w-4 text-yellow-400"})),d("div",null,[d("p",Kg,"Execution #"+V(D.id),1),d("p",jg,V(g(D.started_at)),1)])]),d("div",Jg,[d("p",Qg,V(S(D.duration_ms||0)),1),d("p",{class:ye(["text-xs",D.status==="success"?"text-primary":D.status==="error"?"text-red-400":"text-yellow-400"])},V(D.status),3)])]))),128))])])])):we("",!0),r.value==="nodes"?($(),O("div",ep,[a.value.aiAgents?.length>0?($(),O("div",tp,[d("h3",np,[j(M(be),{icon:"lucide:brain",class:"h-5 w-5 text-purple-400"}),We(" AI Agents ("+V(a.value.aiAgents.length)+") ",1)]),d("div",op,[($(!0),O(xe,null,Me(a.value.aiAgents,(D,E)=>($(),O("div",{key:E,class:"p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg"},[d("div",sp,[d("h4",ip,V(D.name),1),j(M(be),{icon:"lucide:brain",class:"h-5 w-5 text-purple-400"})]),d("div",rp,[d("p",lp,[I[25]||(I[25]=We("Type: ",-1)),d("span",ap,V(D.type),1)]),D.model!=="unknown"?($(),O("p",cp,[I[26]||(I[26]=We(" Model: ",-1)),d("span",up,V(D.model),1)])):we("",!0),D.connectedTools?.length>0?($(),O("div",dp,[I[27]||(I[27]=d("p",{class:"text-text-muted mb-1"},"Connected Tools:",-1)),d("div",fp,[($(!0),O(xe,null,Me(D.connectedTools,(le,b)=>($(),O("span",{key:b,class:"px-2 py-1 bg-purple-500/20 text-purple-300 rounded text-xs"},V(le),1))),128))])])):we("",!0)])]))),128))])])):we("",!0),d("div",gp,[d("div",pp,[d("h3",hp,[j(M(be),{icon:"lucide:zap",class:"h-5 w-5 text-yellow-400"}),I[28]||(I[28]=We(" Triggers ",-1))]),a.value.triggers?.length>0?($(),O("div",mp,[($(!0),O(xe,null,Me(a.value.triggers,(D,E)=>($(),O("div",{key:E,class:"flex items-center gap-3 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg"},[j(M(be),{icon:"lucide:webhook",class:"h-5 w-5 text-yellow-400"}),d("div",vp,[d("p",yp,V(D.name),1),d("p",wp,V(D.type),1)])]))),128))])):($(),O("p",xp,"No triggers"))]),d("div",_p,[d("h3",bp,[j(M(be),{icon:"lucide:layers",class:"h-5 w-5 text-blue-400"}),I[29]||(I[29]=We(" Processing ",-1))]),d("div",Ep,[($(!0),O(xe,null,Me(Object.entries(a.value.nodesByType||{}),([D,E])=>($(),O(xe,{key:D},[D!=="Triggers"&&D!=="Output/Response"?($(),O("div",kp,[d("div",Sp,[j(M(be),{icon:"lucide:package",class:"h-4 w-4 text-blue-400"}),d("span",Np,V(D),1)]),d("span",Cp,V(E),1)])):we("",!0)],64))),128))])]),d("div",$p,[d("h3",Ip,[j(M(be),{icon:"lucide:external-link",class:"h-5 w-5 text-primary"}),I[30]||(I[30]=We(" Outputs ",-1))]),a.value.outputs?.length>0?($(),O("div",Tp,[($(!0),O(xe,null,Me(a.value.outputs,(D,E)=>($(),O("div",{key:E,class:"flex items-center gap-3 p-3 bg-primary/10 border border-primary/30 rounded-lg"},[j(M(be),{icon:"lucide:send",class:"h-5 w-5 text-primary"}),d("div",Mp,[d("p",Dp,V(D.name),1),d("p",Ap,V(D.type),1)])]))),128))])):($(),O("p",Pp,"No outputs"))])])])):we("",!0),r.value==="performance"?($(),O("div",Op,[d("div",Rp,[d("div",zp,[d("div",Bp,[I[31]||(I[31]=d("span",{class:"text-sm text-text-muted"},"Min Execution Time",-1)),j(M(be),{icon:"lucide:trending-up",class:"h-4 w-4 text-primary"})]),d("p",Lp,V(S(u.value.minExecutionTime||0)),1)]),d("div",Vp,[d("div",Fp,[I[32]||(I[32]=d("span",{class:"text-sm text-text-muted"},"Average Time",-1)),j(K,{class:"h-4 w-4 text-blue-400"})]),d("p",Hp,V(S(u.value.avgExecutionTime||0)),1)]),d("div",Gp,[d("div",Yp,[I[33]||(I[33]=d("span",{class:"text-sm text-text-muted"},"Max Execution Time",-1)),j(F,{class:"h-4 w-4 text-red-400"})]),d("p",Wp,V(S(u.value.maxExecutionTime||0)),1)])]),u.value.commonErrors?.length>0?($(),O("div",Up,[d("h3",Xp,[j(re,{class:"h-5 w-5 text-red-400"}),I[34]||(I[34]=We(" Common Errors ",-1))]),d("div",Zp,[($(!0),O(xe,null,Me(u.value.commonErrors,(D,E)=>($(),O("div",{key:E,class:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg"},[d("div",qp,[d("div",Kp,[d("p",jp,V(D.message),1),d("p",Jp,"Occurred "+V(D.count)+" times",1)]),d("span",Qp,V(D.lastOccurred),1)])]))),128))])])):we("",!0)])):we("",!0),r.value==="activity"?($(),O("div",eh,[d("div",th,[d("h3",nh,[j(M(be),{icon:"lucide:clock",class:"h-5 w-5 text-blue-400"}),I[35]||(I[35]=We(" Recent Activity Timeline ",-1))]),d("div",oh,[($(!0),O(xe,null,Me((c.value.recentExecutions||[]).slice(0,20),(D,E)=>($(),O("div",{key:D.id||E,class:"flex items-start gap-4"},[d("div",sh,[D.status==="success"?($(),O("div",ih,[j(ne,{class:"h-4 w-4 text-primary"})])):D.status==="error"?($(),O("div",rh,[j(re,{class:"h-4 w-4 text-red-400"})])):($(),O("div",lh,[j(M(be),{icon:"lucide:clock",class:"h-4 w-4 text-yellow-400"})]))]),d("div",ah,[d("div",ch,[d("p",uh," Execution "+V(D.status==="success"?"completed":D.status==="error"?"failed":"started"),1),d("span",dh,V(g(D.started_at)),1)]),d("p",fh," Duration: "+V(S(D.duration_ms||0)),1),D.error_message?($(),O("p",gh,V(D.error_message),1)):we("",!0)])]))),128))])])])):we("",!0)])]))])])):we("",!0)])}}}),hh=Yn(ph,[["__scopeId","data-v-ced19fdf"]]),mh=["title"],vh=["title"],yh={class:"placeholder-text"},wh=Pe({__name:"N8nIcon",props:{nodeType:{},className:{}},setup(e){const t=e,n={"n8n-nodes-base.cron":{icon:"mdi:timer-outline",category:"schedule_triggers",shape:"diamond"},"n8n-nodes-base.scheduleTrigger":{icon:"mdi:calendar-clock",category:"schedule_triggers",shape:"diamond"},"n8n-nodes-base.webhook":{icon:"mdi:webhook",category:"webhook_triggers",shape:"diamond"},"n8n-nodes-base.formTrigger":{icon:"mdi:form-select",category:"webhook_triggers",shape:"diamond"},"n8n-nodes-base.gmailTrigger":{icon:"simple-icons:gmail",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.microsoftOutlookTrigger":{icon:"simple-icons:microsoftoutlook",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.emailReadImap":{icon:"mdi:email-receive-outline",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.telegramTrigger":{icon:"simple-icons:telegram",category:"social_triggers",shape:"diamond"},"n8n-nodes-base.whatsAppTrigger":{icon:"simple-icons:whatsapp",category:"social_triggers",shape:"diamond"},"n8n-nodes-base.manualTrigger":{icon:"mdi:play-circle",category:"workflow_triggers",shape:"diamond"},"n8n-nodes-base.executeWorkflowTrigger":{icon:"mdi:play-circle",category:"workflow_triggers",shape:"diamond"},"@n8n/n8n-nodes-langchain.chatTrigger":{icon:"mdi:chat-outline",category:"ai_triggers",shape:"diamond"},"n8n-nodes-base.activeCampaignTrigger":{icon:"mdi:email-newsletter",category:"marketing_triggers",shape:"diamond"},"n8n-nodes-base.set":{icon:"mdi:pencil-circle",category:"data_processing"},"n8n-nodes-base.filter":{icon:"mdi:filter-outline",category:"data_processing"},"n8n-nodes-base.sort":{icon:"mdi:sort-variant",category:"data_processing"},"n8n-nodes-base.limit":{icon:"mdi:numeric",category:"data_processing"},"n8n-nodes-base.splitInBatches":{icon:"mdi:format-list-bulleted",category:"data_processing"},"n8n-nodes-base.splitOut":{icon:"mdi:call-split",category:"data_processing"},"n8n-nodes-base.telegram":{icon:"simple-icons:telegram",category:"communication",shape:"circle"},"n8n-nodes-base.whatsApp":{icon:"simple-icons:whatsapp",category:"communication",shape:"circle"},"n8n-nodes-base.slack":{icon:"simple-icons:slack",category:"communication",shape:"circle"},"n8n-nodes-base.gmail":{icon:"simple-icons:gmail",category:"communication",shape:"circle"},"n8n-nodes-base.microsoftOutlook":{icon:"simple-icons:microsoftoutlook",category:"communication",shape:"circle"},"n8n-nodes-base.emailSend":{icon:"mdi:email-send-outline",category:"communication",shape:"circle"},"n8n-nodes-base.postgres":{icon:"simple-icons:postgresql",category:"databases"},"n8n-nodes-base.supabase":{icon:"simple-icons:supabase",category:"databases"},"n8n-nodes-base.googleSheets":{icon:"simple-icons:googlesheets",category:"databases"},"n8n-nodes-base.googleDrive":{icon:"simple-icons:googledrive",category:"file_operations"},"n8n-nodes-base.extractFromFile":{icon:"mdi:file-document-outline",category:"file_operations"},"n8n-nodes-base.httpRequest":{icon:"mdi:web",category:"http_api"},"n8n-nodes-base.httpRequestTool":{icon:"mdi:api",category:"http_api"},"n8n-nodes-base.respondToWebhook":{icon:"mdi:webhook",category:"http_api"},"n8n-nodes-base.code":{icon:"mdi:code-braces",category:"code"},"n8n-nodes-base.function":{icon:"mdi:function",category:"code"},"n8n-nodes-base.if":{icon:"mdi:help-rhombus-outline",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.switch":{icon:"mdi:electric-switch",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.merge":{icon:"mdi:merge",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.wait":{icon:"mdi:timer-sand",category:"workflow_control",shape:"circle"},"n8n-nodes-base.executeWorkflow":{icon:"mdi:play-circle-outline",category:"workflow_control",shape:"circle"},"n8n-nodes-base.debug":{icon:"mdi:bug-outline",category:"logging_monitoring"},"n8n-nodes-base.noOp":{icon:"mdi:minus-circle-outline",category:"utilities"},"n8n-nodes-base.stickyNote":{icon:"mdi:note-text-outline",category:"utilities"},"n8n-nodes-base.html":{icon:"mdi:language-html5",category:"parsers"},"n8n-nodes-base.markdown":{icon:"simple-icons:markdown",category:"parsers"},"n8n-nodes-base.dateTimeTool":{icon:"mdi:calendar-clock",category:"parsers"},"n8n-nodes-base.googleCalendar":{icon:"simple-icons:googlecalendar",category:"calendar_scheduling"},"n8n-nodes-base.openAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.agent":{icon:"mdi:robot-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.lmChatOpenAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.embeddingsOpenAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.openAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.lmChatGoogleGemini":{icon:"simple-icons:google",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chainLlm":{icon:"mdi:brain",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chainSummarization":{icon:"mdi:format-list-text",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.textClassifier":{icon:"mdi:text-box-check-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter":{icon:"mdi:format-text-wrapping-clip",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.memoryBufferWindow":{icon:"mdi:memory",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.memoryPostgresChat":{icon:"simple-icons:postgresql",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStoreQdrant":{icon:"mdi:database-search",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStorePinecone":{icon:"mdi:pine-tree",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStoreSupabase":{icon:"simple-icons:supabase",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.retrieverVectorStore":{icon:"mdi:database-arrow-down",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.rerankerCohere":{icon:"mdi:sort-ascending",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.outputParserStructured":{icon:"mdi:code-braces",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.documentDefaultDataLoader":{icon:"mdi:file-upload-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chatTrigger":{icon:"mdi:chat-outline",category:"triggers"},"@n8n/n8n-nodes-langchain.toolSerpApi":{icon:"mdi:google",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolCalculator":{icon:"mdi:calculator",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolVectorStore":{icon:"mdi:database-search-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolWorkflow":{icon:"mdi:workflow",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolHttpRequest":{icon:"mdi:web",category:"http_api",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolConvertToFile":{icon:"mdi:file-document-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.mcpClientTool":{icon:"mdi:connection",category:"ai_ml",shape:"rectangle"},"n8n-nodes-base.xml":{icon:"mdi:code-tags",category:"parsers"},"n8n-nodes-base.json":{icon:"mdi:code-json",category:"parsers"},"n8n-nodes-base.csv":{icon:"mdi:file-delimited-outline",category:"parsers"},"n8n-nodes-base.yaml":{icon:"mdi:file-code-outline",category:"parsers"},"n8n-nodes-base.javascript":{icon:"vscode-icons:file-type-js-official",category:"code"},"n8n-nodes-base.typescript":{icon:"vscode-icons:file-type-typescript-official",category:"code"},"n8n-nodes-base.python":{icon:"vscode-icons:file-type-python",category:"code"},"n8n-nodes-base.start":{icon:"mdi:play-circle",category:"utilities"},"n8n-nodes-base.itemLists":{icon:"mdi:format-list-bulleted",category:"utilities"},"n8n-nodes-base.database":{icon:"vscode-icons:file-type-sql",category:"utilities"}},o={triggers:"#4F709C",data_processing:"#5F8A5F",communication:"#B8860B",ai_ml:"#6B46C1",databases:"#C2793D",http_api:"#B91C1C",code:"#A855F7",utilities:"#64748B",parsers:"#8B5A2B",cloud_services:"#0284C7",media_processing:"#DC2626",file_operations:"#7C3AED",calendar_scheduling:"#059669",business_intelligence:"#D97706",order_management:"#1D4ED8",notification_systems:"#DC2626",authentication:"#374151",workflow_control:"#6366F1",logging_monitoring:"#6B7280",document_processing:"#92400E",schedule_triggers:"#2563EB",webhook_triggers:"#DC2626",email_triggers:"#F59E0B",social_triggers:"#10B981",workflow_triggers:"#8B5CF6",ai_triggers:"#EC4899",marketing_triggers:"#F97316"},s=W(()=>n[t.nodeType]||null),i=W(()=>s.value?.icon||null),r=W(()=>{const u=s.value?.category||"utilities";return o[u]||o.utilities}),l=W(()=>s.value?.shape||"rectangle"),a=W(()=>`shape-${l.value}`),c=W(()=>{const u=t.nodeType.split(".");return u[u.length-1].substring(0,3).toUpperCase()});return(u,p)=>($(),O("div",{class:ye(["node-icon",[u.className,a.value]]),title:`Shape: ${l.value}, Type: ${u.nodeType}`},[i.value?($(),Ie(M(be),{key:0,icon:i.value,width:48,height:48,class:"icon-styled",style:Ye({color:r.value})},null,8,["icon","style"])):($(),O("div",{key:1,class:"placeholder-icon",title:`Iconify mapping needed: ${u.nodeType}`},[d("span",yh,V(c.value),1)],8,vh))],10,mh))}}),en=Yn(wh,[["__scopeId","data-v-92bfb441"]]),xh={class:"h-[calc(100vh-4rem)] overflow-auto"},_h={class:"grid grid-cols-6 gap-3 mb-3"},bh={class:"p-2"},Eh={class:"flex items-center justify-between mb-1"},kh={class:"text-lg font-bold text-text"},Sh={class:"p-2"},Nh={class:"flex items-center justify-between mb-1"},Ch={class:"text-lg font-bold text-text"},$h={class:"p-2"},Ih={class:"flex items-center justify-between mb-1"},Th={class:"text-lg font-bold text-cyan-500"},Mh={class:"p-2"},Dh={class:"flex items-center justify-between mb-1"},Ah={class:"text-lg font-bold text-warning"},Ph={class:"p-2"},Oh={class:"flex items-center justify-between mb-1"},Rh={class:"text-lg font-bold text-text"},zh={class:"p-2"},Bh={class:"flex items-center justify-between mb-1"},Lh={class:"text-lg font-bold text-blue-500"},Vh={class:"flex gap-4 h-[calc(100%-4rem)]"},Fh={class:"p-3 border-b border-border flex items-center justify-between"},Hh={key:0,class:"text-xs font-bold text-text"},Gh={key:0,class:"p-4 overflow-y-auto h-full"},Yh={class:"flex items-center justify-between mb-3"},Wh={class:"text-xs text-text-muted"},Uh={class:"space-y-1.5"},Xh=["onClick"],Zh={class:"flex items-center gap-2 mb-1"},qh=["title"],Kh={class:"text-xs text-text-muted pl-3.5"},jh={key:1,class:"p-2 overflow-y-auto h-full"},Jh={class:"space-y-2"},Qh=["onClick","title"],em={class:"flex-1 premium-glass rounded-lg overflow-hidden"},tm={class:"bg-surface/30 border-b border-border px-4 py-3 flex items-center justify-between"},nm={class:"flex items-center gap-3"},om={class:"text-sm font-bold text-white"},sm={key:0,class:"flex items-center gap-3 text-xs text-text-muted mt-1"},im={class:"flex items-center gap-1"},rm={class:"flex items-center gap-2"},lm=["disabled"],am={class:"flex items-center gap-4"},cm={key:0,class:"flex items-center gap-2 text-xs"},um={class:"text-gray-300 font-medium"},dm={class:"flex items-center gap-2"},fm={class:"text-xs text-text-muted"},gm=["disabled"],pm={class:"relative h-full"},hm={key:0,class:"absolute bottom-32 left-1/2 transform -translate-x-1/2 z-50 flex gap-2"},mm=["disabled"],vm={class:"absolute bottom-32 left-4 flex flex-row gap-2 z-50"},ym={class:"absolute bottom-4 left-16 right-4 z-50"},wm={key:0,class:"bg-gray-800 border border-gray-600 border-t-0 rounded-b-lg shadow-lg",style:{"max-height":"200px"}},xm={class:"p-4 overflow-y-auto",style:{"max-height":"180px"}},_m={key:0,class:"text-center py-6"},bm={key:1,class:"space-y-2"},Em={class:"text-gray-500 shrink-0 font-mono"},km={class:"text-gray-200"},Sm={class:"premium-ai-icon"},Nm={class:"premium-ai-content"},Cm={class:"premium-ai-name"},$m={key:0,class:"premium-ai-connections"},Im={key:1,class:"premium-node-wrapper"},Tm={class:"premium-trigger-icon"},Mm={class:"premium-external-label"},Dm={key:2,class:"premium-node-wrapper"},Am={class:"premium-tool-icon"},Pm={class:"premium-external-label"},Om={style:{display:"flex","align-items":"center",width:"100%",height:"100%",padding:"0 8px"}},Rm={style:{width:"32px",height:"32px","margin-right":"10px","flex-shrink":"0"}},zm={style:{color:"#ffffff !important","font-size":"13px !important","font-weight":"600 !important","text-shadow":"0 1px 2px rgba(0, 0, 0, 0.8) !important","white-space":"nowrap !important",overflow:"hidden !important","text-overflow":"ellipsis !important",flex:"1"}},Bm={key:4,class:"premium-node-wrapper"},Lm={class:"premium-process-icon"},Vm={class:"premium-external-label"},Fm={key:1,class:"absolute inset-0 flex items-center justify-center"},Hm={class:"text-center"},Gm={class:"p-4"},Ym={class:"space-y-3"},Wm={class:"text-base font-semibold text-text"},Um={key:0,class:"mb-2 text-xs text-text-muted"},Xm={key:1,class:"border border-border rounded-lg overflow-hidden"},Zm={class:"w-full text-sm"},qm={class:"px-3 py-2"},Km={class:"flex items-center gap-2"},jm={class:"px-3 py-2 text-text-muted font-mono text-xs"},Jm={class:"px-3 py-2 text-text-muted text-xs"},Qm={class:"px-3 py-2 text-text-muted text-xs"},ev={key:2,class:"mt-4 flex items-center justify-between pt-4 border-t border-border"},tv={class:"text-sm text-text-muted"},nv={class:"flex items-center gap-2"},ov=["disabled"],sv={class:"flex items-center gap-1"},iv=["onClick"],rv={key:0,class:"text-text-muted px-2"},lv=["disabled"],av={key:3,class:"text-center py-8"},cv={class:"p-6"},uv={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},dv={class:"control-card p-4"},fv={class:"flex items-center justify-between mb-2"},gv={class:"text-lg font-bold text-text"},pv={class:"control-card p-4"},hv={class:"flex items-center justify-between mb-2"},mv={class:"text-lg font-bold text-cyan-500"},vv={class:"control-card p-4"},yv={class:"flex items-center justify-between mb-2"},wv={class:"text-lg font-bold text-text"},xv="client_simulation_a",Lt=20,_v=Pe({__name:"WorkflowCommandCenter",setup(e){const t=lr();Ls();const n=ar(),o=W(()=>n.user?.role==="viewer"),s=W(()=>!o.value),i=cr();console.log("🔔 Custom notification system initialized");const r=ge(!1),l=ge(!1),a=ge(!1),c=ge([{timestamp:"23:32:15",level:"INFO",message:"Workflow execution started"},{timestamp:"23:32:16",level:"DEBUG",message:"Processing node: Schedule Trigger"},{timestamp:"23:32:17",level:"SUCCESS",message:"AI Agent completed successfully"}]),u=ge([]),p=ge(null),f=ge(null),m=ge(""),S=ge(null),g=ge(null);let h=null;const C=ge(!1),P=ge(!1),k=ge(!1),y=ge(null),I=ge(null),U=ge(null),K=[{id:"executions",label:"Executions",icon:"lucide:play"},{id:"stats",label:"Statistics",icon:"lucide:trending-up"}],F=ge(1),re=W(()=>U.value?.executions?Math.ceil(U.value.executions.length/Lt):1),ne=W(()=>{if(!U.value?.executions)return[];const A=(F.value-1)*Lt,N=A+Lt;return U.value.executions.slice(A,N)}),D=ge([]),{fitView:E,zoomIn:le,zoomOut:b,setViewport:B,getViewport:T}=Be(),L={enterprise:Os,custom:Os},H=W(()=>u.value.length),J=W(()=>u.value.filter(A=>A.is_active).length);W(()=>Math.round(100-me.value)),W(()=>D.value.filter(A=>!A.source)),W(()=>D.value.filter(A=>A.source));const X=(A,N)=>!1,se=W(()=>f.value?.kpis?.totalExecutions!==void 0?f.value.kpis.totalExecutions:p.value?.overview?.totalExecutions||0),de=W(()=>{if(f.value?.kpis?.failedExecutions!==void 0)return f.value.kpis.failedExecutions;const A=se.value,N=p.value?.overview?.successRate||100;return Math.round(A*(1-N/100))}),me=W(()=>f.value?.kpis?.failureRate!==void 0?f.value.kpis.failureRate:(100-(p.value?.overview?.successRate||100)).toFixed(1)),ee=W(()=>f.value?.kpis?.timeSavedHours!==void 0?f.value.kpis.timeSavedHours:p.value?.businessImpact?.timeSavedHours||0),ce=W(()=>{if(f.value?.kpis?.avgRunTime!==void 0){const N=f.value.kpis.avgRunTime;return N<1?N.toFixed(2)+"s":N<60?N.toFixed(1)+"s":(N/60).toFixed(1)+"m"}const A=p.value?.overview?.avgDurationSeconds||0;return A>0?(A/60).toFixed(1):"0.0"}),ae=async()=>{r.value=!0;const A=m.value;try{console.log("🔄 Loading ALL REAL workflow data for Command Center...");const[N,fe]=await Promise.all([et.getProcesses({_t:Date.now(),refresh:!0}),et.getAnalytics({_t:Date.now()})]);console.log("✅ REAL workflows loaded:",N.data?.length||0),console.log("📋 Raw data preview:",N.data?.slice(0,3));const z=(N.data||[]).sort((G,q)=>G.is_active!==q.is_active?G.is_active?-1:1:G.process_name.localeCompare(q.process_name));u.value=z,console.log("🔄 Set realWorkflows to:",u.value.length,"items (sorted: active first)"),console.log("📊 Active workflows:",u.value.filter(G=>G.is_active).map(G=>G.process_name)),p.value=fe,console.log("✅ REAL analytics loaded:",{totalExecutions:p.value.overview?.totalExecutions,successRate:p.value.overview?.successRate,avgDuration:p.value.overview?.avgDurationSeconds}),console.log("✅ Workflows loaded, manual selection required")}catch(N){console.error("❌ Failed to fetch workflows:",N),console.error("🔍 Error details:",N.stack);const fe=N.message?.includes("fetch")?"Cannot connect to backend server. Is it running on port 3001?":`API Error: ${N.message}`;i.error(fe),u.value=[]}finally{if(r.value=!1,u.value.length>0)if(A){const N=u.value.find(fe=>fe.id===A);N?(console.log("🔄 Re-selecting previous workflow:",N.process_name),await he(N)):(console.log("🎯 Previous workflow not found, selecting first:",u.value[0].process_name),await he(u.value[0]))}else console.log("🎯 Auto-selecting first workflow after refresh:",u.value[0].process_name),await he(u.value[0])}},he=async A=>{console.log("🔘 [FORCE TEST] CLICK DETECTED - selectWorkflow called with:",{workflowName:A.process_name,workflowId:A.id,currentSelectedId:m.value}),m.value=A.id,S.value=A,console.log("✅ Workflow selected:",A.name,"ID:",A.id),await Promise.all([ke(A.id),_e(A)])},ke=async A=>{try{console.log("📊 Loading statistics for workflow:",A);const N=await dr(`/api/business/workflow/${A}/full-stats`,{params:{days:30}});f.value=N,console.log("✅ Workflow stats loaded:",{totalExecutions:N.kpis?.totalExecutions,failureRate:N.kpis?.failureRate,avgRunTime:N.kpis?.avgRunTime})}catch(N){console.error("❌ Error loading workflow statistics:",N),f.value=null}},_e=async A=>{try{h&&(console.log("🚫 Cancelling previous workflow request"),h.abort()),h=new AbortController,console.log("🔍 Loading REAL structure for:",A.process_name,"with ID:",A.id),console.log("📡 Fetching details with OFETCH for workflow:",A.id);const N=await et.getProcessDetails(A.id,{_t:Date.now(),forceRefresh:!0});g.value=N.data,console.log("✅ REAL workflow structure loaded for",A.process_name,":",N.data.nodeCount,"nodes"),Ce(N.data,A)}catch(N){if(N.name==="AbortError"){console.log("🚫 Request cancelled for",A.process_name);return}console.error("❌ Failed to load workflow structure for",A.process_name,":",N),console.error("🔄 Falling back to enhanced flow"),Te(A)}console.log("✅ Workflow structure loading completed")},Ce=(A,N)=>{const fe=A.processSteps||[],z=A.processFlow||[];console.log("🔧 Creating flow from REAL data:",fe.length,"steps",z.length,"connections");const G=new Map;z.forEach(Y=>{G.has(Y.from)||G.set(Y.from,{inputs:[],outputs:[]});const Ze=G.get(Y.from);Ze.outputs.includes(Y.type)||Ze.outputs.push(Y.type),G.has(Y.to)||G.set(Y.to,{inputs:[],outputs:[]});const Le=G.get(Y.to);Le.inputs.includes(Y.type)||Le.inputs.push(Y.type)});const q=fe.filter(Y=>!Y.nodeType.includes("stickyNote")).map((Y,Ze)=>{const Le=G.get(Y.stepName)||{inputs:["main"],outputs:["main"]};return{id:Y.stepName,type:"enterprise",position:{x:(Y.position[0]||0)*1.8,y:(Y.position[1]||0)*1.6},data:{label:Y.stepName,status:N.is_active?"success":"inactive",type:Xe(Y.nodeType,Y.stepName),nodeType:Y.nodeType||"unknown-node",isExecuting:!1,inputs:Le.inputs.length>0?Le.inputs:["main"],outputs:Le.outputs.length>0?Le.outputs:["main"],executionCount:f.totalExecutions||Math.floor(Math.random()*100)+10,successRate:f.kpis?.successRate||Math.floor(Math.random()*20)+80,avgTime:f.kpis?.avgDuration?(f.kpis.avgDuration/1e3).toFixed(1):(Math.random()*2+.5).toFixed(1)}}}),Oe=z.map((Y,Ze)=>{const Le=Y.type==="main",so=Y.type.startsWith("ai_"),Xi=fe.find(Ve=>Ve.stepName===Y.from),gt=fe.find(Ve=>Ve.stepName===Y.to),Ot=Xe(Xi?.nodeType||"",Y.from),Kt=Xe(gt?.nodeType||"",Y.to);let pt="right",it="left",vn=!1;if(Ot==="storage")pt="bottom";else if(Ot==="tool")pt="bottom";else if(Ot==="ai")if(vn=Kt==="tool"||gt?.stepName?.toLowerCase().includes("ordini")||gt?.stepName?.toLowerCase().includes("date")||gt?.stepName?.toLowerCase().includes("parcel")||gt?.stepName?.toLowerCase().includes("formatta")||gt?.stepName?.toLowerCase().includes("clean data")||gt?.nodeType&&gt.nodeType.includes("langchain.tool"),Le&&!vn)pt="right";else if(vn){const Ve=Y.to.toLowerCase(),Ue=gt?.stepName?.toLowerCase()||"";let Je=0;Ve.includes("clean")||Ve.includes("data")||Ue.includes("clean")||Ue.includes("data")||Ve.includes("info")||Ve.includes("ordini")||Ue.includes("info")||Ue.includes("ordini")?Je=0:Ve.includes("date")||Ve.includes("time")||Ue.includes("date")||Ue.includes("time")?Je=1:Ve.includes("parcel")||Ve.includes("app")||Ue.includes("parcel")||Ue.includes("app")?Je=2:Ve.includes("formatta")||Ve.includes("risposta")||Ue.includes("formatta")||Ue.includes("risposta")?Je=3:Ve.includes("openai")||Ve.includes("chat")||Ue.includes("openai")||Ue.includes("chat")?Je=0:Ve.includes("qdrant")||Ue.includes("qdrant")?Je=1:Ve.includes("embedding")||Ue.includes("embedding")?Je=2:Je=Math.abs(Y.to.charCodeAt(0)+Y.to.charCodeAt(1))%4,pt=`tool-${Je}`,console.log(`🔧 Tool connection: ${Y.from} -> ${Y.to} (${Ue}) using handle: ${pt}`)}else pt="right";else pt="right";if(Kt==="storage")Ot==="ai"&&!Le?it="top":Ot==="tool"||Y.from.toLowerCase().includes("embedding")?it="bottom":it="top";else if(Kt==="tool")it="top";else if(Kt==="ai")if(Le)it="left";else if(so){const Ve=G.get(Y.to)||{inputs:[],outputs:[]},Je=[...Ve.inputs.filter(jt=>jt!=="main"),...Ve.outputs.filter(jt=>jt!=="main")].findIndex(jt=>jt===Y.type);it=`tool-${Math.max(0,Je)}`}else it="left";else it="left";return console.log(`🔗 Edge ${Y.from}->${Y.to}: type=${Y.type}, source=${Ot}, target=${Kt}, handles=${pt}->${it}, isMain=${Le}, isConnectionToTool=${vn||!1}`),{id:`edge-${Ze}`,source:Y.from,target:Y.to,type:"smoothstep",animated:N.is_active&&Le,style:{stroke:Le?"#10b981":so?"#667eea":"#3b82f6",strokeWidth:Le?3:2,strokeDasharray:Le?"none":"5 5",opacity:Le?1:.7,strokeLinecap:"round",strokeLinejoin:"round",filter:Le?"drop-shadow(0 0 3px rgba(16, 185, 129, 0.5))":"none"},sourceHandle:pt,targetHandle:it,className:Le?"main-edge":"secondary-edge",markerEnd:Le?{type:"arrowclosed",width:20,height:20,color:"#10b981"}:void 0}});console.log("✅ Created nodes with handles:",q.map(Y=>`ID:${Y.id} Label:${Y.data.label} type=${Y.data.type} nodeType=${Y.data.nodeType} inputs=${JSON.stringify(Y.data.inputs)} outputs=${JSON.stringify(Y.data.outputs)}`)),console.log("🔗 Created edges:",Oe.map(Y=>`${Y.source}->${Y.target} (${Y.sourceHandle}->${Y.targetHandle}) color=${Y.style.stroke}`)),console.log("🔢 Nodes count:",q.length,"Edges count:",Oe.length),D.value=[...q,...Oe],console.log("🎯 FlowElements final:",D.value.length,"elements"),ot(()=>{B({x:0,y:0,zoom:.5}),setTimeout(()=>{E({duration:0,padding:.2}),console.log("🎯 Forced fit applied with viewport reset")},50)})},Te=A=>{console.log("🔧 Creating enhanced flow for:",A.process_name);const N=A.process_name.toLowerCase();let fe=[];N.includes("grab")||N.includes("track")?fe=["Data Source","Extract","Process","AI Analysis","Store","Notify"]:N.includes("chatbot")?fe=["Webhook","Parse","Intent","AI Response","Reply","Log"]:N.includes("customer")||N.includes("service")?fe=["Request","Classify","Route","AI Process","Respond","Update"]:fe=["Trigger","Process","Execute","Complete"];const z=fe.map((q,Oe)=>({id:q,type:"enterprise",position:{x:Oe*280,y:50},data:{label:q,status:A.is_active?"success":"inactive",type:Oe===0?"trigger":Oe===fe.length-1?"storage":"process"}})),G=[];for(let q=0;q<fe.length-1;q++)G.push({id:`e${q}`,source:fe[q],target:fe[q+1],type:"default",animated:A.is_active,style:{stroke:"#10b981",strokeWidth:1},sourceHandle:"right",targetHandle:"left"});D.value=[...z,...G],ot(()=>{B({x:0,y:0,zoom:.5}),setTimeout(()=>{E({duration:0,padding:.2}),console.log("🎯 Forced fit applied for enhanced flow")},50)})},pe=()=>{const A=T();B({...A,zoom:Math.min(A.zoom*1.2,3)},{duration:300})},Ee=()=>{const A=T();B({...A,zoom:Math.max(A.zoom*.8,.2)},{duration:300})},w=()=>{P.value=!0},v=()=>{C.value=!1,y.value=null},_=()=>{P.value=!1},x=()=>{k.value=!1,y.value=null,U.value=null,I.value=null},R=ge(!1),Q=ge(null),oe=ge(new Set),ie=(A,N)=>{const fe=`http://localhost:3001/api/business/processes/${A}/execution-stream?executionId=${N}`;console.log("🔗 Connecting to SSE for active execution:",fe);const z=new EventSource(fe);return z.onopen=()=>{console.log("✅ SSE Connection opened")},z.onmessage=G=>{const q=JSON.parse(G.data);if(console.log("🔄 SSE Event received:",q),q.type==="nodeExecuteBefore"){const Oe=D.value.filter(Y=>!Y.source).map(Y=>({id:Y.id,name:Y.data?.stepName,type:Y.type}));console.log("📋 Current flowElements nodes:",Oe),console.log("🎯 Looking for nodeId:",q.nodeId)}switch(q.type){case"nodeExecuteBefore":console.log(`🟠 Node ${q.nodeName} (${q.nodeId}) starting execution`);let Oe=!1;D.value=D.value.map(Y=>Y.id===q.nodeName?(console.log(`✅ Found matching node by name: ${Y.id}, setting isExecuting=true`),Oe=!0,{...Y,data:{...Y.data,isExecuting:!0}}):Y),Oe||console.warn(`⚠️ Node ${q.nodeName} not found in flowElements! Available nodes:`,D.value.filter(Y=>!Y.source).map(Y=>Y.id));break;case"nodeExecuteAfter":console.log(`⚫ Node ${q.nodeName} (${q.nodeId}) finished execution`),D.value=D.value.map(Y=>Y.id===q.nodeName?(console.log(`✅ Found matching node by name: ${Y.id}, setting isExecuting=false`),{...Y,data:{...Y.data,isExecuting:!1}}):Y);break;case"workflowExecuteAfter":console.log("🏁 Workflow completed, waiting for last animation to finish..."),setTimeout(()=>{R.value=!1,oe.value.clear(),D.value=D.value.map(Y=>({...Y,data:{...Y.data,isExecuting:!1}})),console.log("✅ Workflow completed - toast will be shown by polling with duration"),setTimeout(async()=>{await loadWorkflowDetails(m.value),await $e(m.value)},1e3)},300),z.close();break;case"error":R.value=!1,oe.value.clear(),z.close(),i.error(`Errore Esecuzione: ${q.message}`);break}},z.onerror=G=>{console.error("❌ SSE connection error:",G),z.close(),R.value=!1,oe.value.clear(),D.value=D.value.map(q=>({...q,data:{...q.data,isExecuting:!1}}))},z},ue=async()=>{if(!S.value||!m.value){i.error("Seleziona un workflow da eseguire");return}if(R.value)return;const A=S.value.process_name||"Unknown";R.value=!0,console.log("🎯 Showing start notification..."),i.success(`Il workflow "${A}" è stato avviato correttamente`);try{console.log(`🚀 Executing workflow ${m.value}...`),console.log("📞 Calling businessAPI.executeWorkflow...");const N=await et.executeWorkflow(m.value);if(console.log("✅ Workflow execution result:",N),N.success&&N.data.executionStarted){Q.value=N.data.executionId,console.log(`🔗 Connecting SSE with real executionId: ${N.data.executionId}`);const fe=ie(m.value,N.data.executionId);console.log(`🚀 Workflow "${A}" started`),f.value&&f.value.kpis&&(f.value.kpis.totalExecutions=(f.value.kpis.totalExecutions||0)+1,f.value.kpis.runningExecutions=(f.value.kpis.runningExecutions||0)+1);let z=0;const G=30,q=setInterval(async()=>{z++;try{const Oe=await et.getExecutionStatus(N.data.executionId);if(Oe.success&&Oe.data.isFinished){if(clearInterval(q),R.value=!1,Q.value=null,f.value&&f.value.kpis&&(f.value.kpis.runningExecutions=Math.max(0,(f.value.kpis.runningExecutions||0)-1)),Oe.data.status==="success"){if(i.success(`Il workflow "${A}" è stato eseguito con successo in ${Math.round(Oe.data.duration/1e3)}s`),f.value&&f.value.kpis){f.value.kpis.successfulExecutions=(f.value.kpis.successfulExecutions||0)+1;const Y=f.value.kpis.totalExecutions||1,Ze=f.value.kpis.successfulExecutions||0;f.value.kpis.successRate=Math.round(Ze/Y*100)}}else if(Oe.data.status==="error"&&Oe.data.errorInfo){const Y=Oe.data.errorInfo.errors.map(Ze=>`${Ze.nodeName}: ${Ze.error.message}`).join(`
`);if(i.error(`Il workflow "${A}" ha riscontrato errori: ${Y}`),f.value&&f.value.kpis){f.value.kpis.failedExecutions=(f.value.kpis.failedExecutions||0)+1;const Ze=f.value.kpis.totalExecutions||1,Le=f.value.kpis.successfulExecutions||0;f.value.kpis.successRate=Math.round(Le/Ze*100)}}else if(i.error(`Il workflow "${A}" è stato interrotto`),f.value&&f.value.kpis){f.value.kpis.failedExecutions=(f.value.kpis.failedExecutions||0)+1;const Y=f.value.kpis.totalExecutions||1,Ze=f.value.kpis.successfulExecutions||0;f.value.kpis.successRate=Math.round(Ze/Y*100)}fetchRealWorkflows(),m.value&&await ke(m.value)}z>=G&&(clearInterval(q),R.value=!1,Q.value=null,i.info(`Il workflow "${A}" è ancora in esecuzione dopo 30s`))}catch(Oe){console.error("Error polling execution status:",Oe)}},1e3)}else R.value=!1,Q.value=null,i.error(N.data?.n8nApiResult?.error||`Impossibile eseguire il workflow "${A}"`)}catch(N){console.error("❌ Failed to execute workflow:",N),R.value=!1,Q.value=null,i.error(`Impossibile eseguire il workflow "${A}". ${N.message}`)}},ve=async()=>{if(!m.value||!Q.value){i.error("Nessuna esecuzione da fermare");return}const A=S.value?.process_name||"Unknown";try{console.log(`🛑 Stopping workflow ${m.value}, execution ${Q.value}...`);const N=await et.stopWorkflow(m.value);console.log("✅ Workflow stop result:",N),N.success?i.success(`Il workflow "${A}" è stato fermato con successo`):i.error(N.data?.n8nApiResult?.error||`Impossibile fermare il workflow "${A}"`)}catch(N){console.error("❌ Failed to stop workflow:",N),i.error(`Impossibile fermare il workflow "${A}". ${N.message}`)}finally{R.value=!1,Q.value=null}},Se=async()=>{if(console.log("🚀 toggleWorkflowStatus called!"),console.log("📊 selectedWorkflowData:",S.value),console.log("📊 selectedWorkflowId:",m.value),!S.value||!m.value){console.log("❌ No workflow selected for toggle - EARLY RETURN");return}console.log("📊 Current workflow data:",S.value);const A=S.value.is_active||!1,N=!A;console.log(`🔄 Will toggle workflow ${m.value} from ${A} to ${N}`);try{console.log("🔄 Doing optimistic update..."),S.value.is_active=N;const fe=u.value.findIndex(G=>G.id===m.value);fe!==-1&&(u.value[fe].is_active=N,console.log("✅ Updated workflow in list"));const z=await et.toggleWorkflow(m.value,N);console.log("✅ Workflow status updated:",z),z.success?z.data?.n8nApiResult?.error?i.success(`${z.data.workflowName} è stato ${N?"attivato":"disattivato"} localmente`):i.success(`${z.data.workflowName} è stato ${N?"attivato":"disattivato"} con successo`):i.error("Impossibile aggiornare lo stato del workflow")}catch(fe){console.error("❌ Failed to toggle workflow:",fe),S.value.is_active=A;const z=u.value.findIndex(G=>G.id===m.value);z!==-1&&(u.value[z].is_active=A),i.error(`Impossibile ${N?"attivare":"disattivare"} il workflow. ${fe.message}`)}},$e=async()=>{if(!y.value?.id)return;I.value=null,F.value=1;const A=performance.now();try{console.log("🔄 Loading executions for workflow:",y.value.id);const N=await et.getProcessExecutionsForWorkflow(y.value.id),fe=performance.now()-A;console.log(`✅ Executions loaded in ${fe.toFixed(0)}ms:`,N.data),U.value={...N.data,loading:!1}}catch(N){console.error("❌ Failed to load executions:",N),I.value=N.message,U.value={executions:[],totalExecutions:0,successRate:0,avgDuration:0,loading:!1}}},Xe=(A,N)=>A==="@n8n/n8n-nodes-langchain.agent"?"ai":A.includes("vectorstore")||A.includes("vectorStore")?"storage":A.includes("@n8n/n8n-nodes-langchain.lmChat")||A.includes("@n8n/n8n-nodes-langchain.embeddings")?"tool":A.includes("@n8n/n8n-nodes-langchain.openAi")?"agent":A.includes("@n8n/n8n-nodes-langchain.tool")||A.includes("@n8n/n8n-nodes-langchain.memory")||A.includes("@n8n/n8n-nodes-langchain.output")||A.includes("@n8n/n8n-nodes-langchain.reranker")||A.includes("@n8n/n8n-nodes-langchain.retriever")||A==="n8n-nodes-base.dateTimeTool"?"tool":A.toLowerCase().includes("trigger")?"trigger":"process",Qe=(A,N="")=>{if(!A||A==="undefined"||A==="null")return{nodeType:"",fallback:"Settings",size:"w-5 h-5"};if(N.toUpperCase().includes("UPSERT")&&N.toUpperCase().includes("SUPABASE"))return{nodeType:"UPSERT_SUPABASE_OVERRIDE",fallback:"Database",size:"w-5 h-5"};if(N.toUpperCase().includes("CALCULATOR"))return{nodeType:"CALCULATOR_TOOL_OVERRIDE",fallback:"Calculator",size:"w-5 h-5"};if(N.toUpperCase().includes("MCP")&&!N.toUpperCase().includes("SUPABASE"))return{nodeType:"MCP_CLIENT_OVERRIDE",fallback:"Zap",size:"w-5 h-5"};if(A==="n8n-nodes-base.set")return{nodeType:"n8n-nodes-base.set",fallback:"Edit",size:"w-5 h-5"};const fe={nodeType:A,fallback:"Settings",size:"w-5 h-5"};return A?.includes("code")?fe.fallback="Code":A?.includes("httpRequest")||N.toLowerCase().includes("scarica")?fe.fallback="Globe":A?.includes("function")?fe.fallback="Zap":A?.includes("webhook")?fe.fallback="Link":A?.includes("email")||A?.includes("outlook")||A?.includes("gmail")?fe.fallback="Mail":A?.includes("googleDrive")||A?.includes("file")?fe.fallback="FileText":A?.includes("scheduleTrigger")||A?.includes("intervalTrigger")||A?.includes("cronTrigger")?fe.fallback="Clock":A?.includes("executeWorkflowTrigger")?fe.fallback="GitBranch":A?.includes("manualTrigger")?fe.fallback="PlayCircle":A?.includes("trigger")?fe.fallback="Play":A?.includes("agent")?fe.fallback="Bot":A?.includes("database")||A?.includes("supabase")||A?.includes("vectorStore")?fe.fallback="Database":A?.includes("telegram")&&(fe.fallback="MessageSquare"),fe},oo=A=>{switch(A){case"SUCCESS":return"text-cyan-500 font-semibold";case"INFO":return"text-blue-400 font-semibold";case"DEBUG":return"text-gray-400 font-semibold";case"WARN":return"text-yellow-400 font-semibold";case"ERROR":return"text-red-400 font-semibold";default:return"text-gray-400 font-semibold"}};return De(S,(A,N)=>{console.log("🔍 [DEBUG] selectedWorkflowData changed:",{newData:A?.process_name,oldData:N?.process_name,newId:A?.id,oldId:N?.id,stackTrace:new Error().stack?.split(`
`)[2]?.trim()})}),dt(async()=>{console.log("🚀 WorkflowCommandCenter mounted, loading data...");try{await ae(),console.log("📊 Final state:",{workflows:u.value.length,totalExecutions:se.value,activeWorkflows:J.value});const A=t.query.workflowId;if(A&&u.value.length>0){console.log("🎯 URL workflowId detected:",A);const N=u.value.find(fe=>fe.id===A);if(N){console.log("✅ Found workflow from URL, selecting:",N.process_name),await he(N);return}else console.log("❌ Workflow from URL not found, falling back to first")}u.value.length>0&&!m.value&&(console.log("🎯 Auto-selecting first workflow:",u.value[0].process_name),await he(u.value[0]))}catch(A){console.error("❌ ERROR in onMounted:",A),console.error("❌ Error stack:",A.stack);try{console.log("🔄 Trying alternative data load...");const N=await et.getProcesses({_t:Date.now()});console.log("🔧 Alternative data:",N);const fe=(N.data||[]).sort((z,G)=>z.is_active!==G.is_active?z.is_active?-1:1:z.process_name.localeCompare(G.process_name));u.value=fe,console.log("🔧 Alternative workflows set:",u.value.length,"(sorted)"),u.value.length>0&&!m.value&&(console.log("🎯 Auto-selecting first workflow (fallback):",u.value[0].process_name),await he(u.value[0]))}catch(N){console.error("❌ Alternative load also failed:",N)}}}),(A,N)=>{const fe=Et("GitBranch");return $(),Ie(ur,null,{default:qe(()=>[d("div",xh,[d("div",_h,[j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",bh,[d("div",Eh,[d("p",kh,V(se.value.toLocaleString()),1),j(M(zt),{value:"Totali",severity:"info",class:"text-xs badge-white-text"})]),N[7]||(N[7]=d("p",{class:"text-xs text-text-muted"},"Prod. executions • Last 7 days",-1))])]),_:1}),j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",Sh,[d("div",Nh,[d("p",Ch,V(de.value),1),j(M(zt),{value:"Fallite",severity:"danger",class:"text-xs badge-white-text"})]),N[8]||(N[8]=d("p",{class:"text-xs text-text-muted"},"Failed prod. executions • Last 7 days",-1))])]),_:1}),j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",$h,[d("div",Ih,[d("p",Th,V(Math.round(100-me.value))+"%",1),j(M(zt),{value:"SUCCESS",severity:"info",class:"text-xs badge-white-text"})]),N[9]||(N[9]=d("p",{class:"text-xs text-text-muted"},"Tasso Successo • Last 7 days",-1))])]),_:1}),j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",Mh,[d("div",Dh,[d("p",Ah,V(ee.value)+"h",1),j(M(zt),{value:"SAVED",severity:"warning",class:"text-xs badge-white-text"})]),N[10]||(N[10]=d("p",{class:"text-xs text-text-muted"},"Time saved • Last 7 days",-1))])]),_:1}),j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",Ph,[d("div",Oh,[d("p",Rh,V(ce.value),1),j(M(zt),{value:"AVG",severity:"info",class:"text-xs badge-white-text"})]),N[11]||(N[11]=d("p",{class:"text-xs text-text-muted"},"Run time (avg.) • Last 7 days",-1))])]),_:1}),j(M(Rt),{class:"premium-glass premium-hover-lift"},{content:qe(()=>[d("div",zh,[d("div",Bh,[d("p",Lh,V(J.value)+"/"+V(H.value),1),j(M(zt),{value:"SYSTEM",severity:"info",class:"text-xs badge-white-text"})]),N[12]||(N[12]=d("p",{class:"text-xs text-text-muted"},"Active workflows • System status",-1))])]),_:1})]),d("div",Vh,[d("div",{class:ye([l.value?"w-12":"w-48","premium-glass rounded-lg overflow-hidden transition-all duration-300 flex-shrink-0"])},[d("div",Fh,[l.value?we("",!0):($(),O("h3",Hh,"BUSINESS PROCESSES")),d("button",{onClick:N[0]||(N[0]=z=>l.value=!l.value),class:"p-1 text-text-muted hover:text-text transition-colors"},[j(M(be),{icon:"lucide:chevron-left",class:ye([{"rotate-180":l.value},"w-4 h-4 transition-transform"])},null,8,["class"])])]),l.value?($(),O("div",jh,[d("div",Jh,[($(!0),O(xe,null,Me(u.value,z=>($(),O("div",{key:z.id,onClick:G=>he(z),class:ye(["w-8 h-8 rounded-md cursor-pointer transition-all flex items-center justify-center",m.value===z.id?"bg-primary/20 border border-primary/50":"bg-surface/50 hover:bg-surface"]),title:z.process_name},[d("div",{class:ye(["w-2 h-2 rounded-full",z.is_active?"bg-primary":"bg-text-muted"])},null,2)],10,Qh))),128))])])):($(),O("div",Gh,[d("div",Yh,[d("span",Wh,V(J.value)+"/"+V(H.value)+" active",1)]),d("div",Uh,[($(!0),O(xe,null,Me(u.value,z=>($(),O("div",{key:z.id,onClick:G=>he(z),class:ye(["p-2 rounded-md cursor-pointer transition-all text-xs",m.value===z.id?"selected-workflow":"bg-surface/50 hover:bg-surface border border-transparent hover:border-border"])},[d("div",Zh,[d("div",{class:ye(["w-1.5 h-1.5 rounded-full",z.is_active?"bg-primary animate-pulse":"bg-text-muted"])},null,2),d("span",{class:"font-medium text-text truncate flex-1 max-w-32",title:z.process_name},V(z.process_name),9,qh)]),d("div",Kh,V(z.executions_today)+" today ",1)],10,Xh))),128))])]))],2),d("div",em,[d("div",tm,[d("div",nm,[d("div",null,[d("div",om,V(S.value?.process_name||"Select a workflow to visualize"),1),f.value?($(),O("div",sm,[d("span",null,V(f.value.kpis?.totalExecutions||0)+" executions",1),N[13]||(N[13]=d("span",null,"•",-1)),d("span",im,[d("div",{style:Ye({width:"6px",height:"6px",borderRadius:"50%",backgroundColor:(f.value.kpis?.successRate||0)>=80?"#10b981":"#ef4444"})},null,4),We(" "+V(f.value.kpis?.successRate||0)+"% success ",1)]),N[14]||(N[14]=d("span",null,"•",-1)),d("span",null,V(f.value.kpis?.avgRunTime?Math.round(f.value.kpis.avgRunTime)+"ms":"N/A")+" avg",1)])):we("",!0)])]),d("div",rm,[d("button",{onClick:w,disabled:!m.value,class:"group px-5 py-2.5 text-sm font-medium rounded-lg flex items-center gap-2 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-emerald-500/10 via-emerald-600/10 to-emerald-500/10 hover:from-emerald-500/20 hover:via-emerald-600/20 hover:to-emerald-500/20 border border-emerald-500/30 hover:border-emerald-500/50 backdrop-blur-xl hover:shadow-[0_0_20px_rgba(16,185,129,0.15)] hover:scale-[1.02]"},[j(M(be),{icon:"lucide:bar-chart-3",class:"w-4 h-4 text-emerald-400 group-hover:text-emerald-300 transition-colors"}),N[15]||(N[15]=d("span",{class:"text-emerald-400 group-hover:text-emerald-300 transition-colors"},"Business Analytics",-1))],8,lm)]),d("div",am,[f.value?.kpis?.last24hExecutions?($(),O("div",cm,[N[16]||(N[16]=d("div",{class:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"},null,-1)),d("span",um,V(f.value.kpis.last24hExecutions)+" runs today",1)])):we("",!0),f.value?.kpis?.efficiencyScore?($(),O("span",{key:1,class:ye(["px-2 py-1 rounded text-xs font-medium",f.value.kpis.efficiencyScore>=80?"bg-green-500/20 text-green-300 border border-green-500/30":f.value.kpis.efficiencyScore>=60?"bg-yellow-500/20 text-yellow-300 border border-yellow-500/30":"bg-red-500/20 text-red-300 border border-red-500/30"])},V(f.value.kpis.efficiencyScore)+"% efficiency ",3)):we("",!0),d("div",dm,[d("span",fm,V(S.value?.is_active?"Active":"Inactive"),1),s.value?($(),O("button",{key:0,onClick:Se,disabled:!m.value,class:ye(["relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",S.value?.is_active?"bg-primary":"bg-gray-600"])},[d("span",{class:ye(["inline-block h-3 w-3 transform rounded-full bg-white transition-transform",S.value?.is_active?"translate-x-5":"translate-x-1"])},null,2)],10,gm)):we("",!0)])])]),d("div",pm,[m.value?($(),Ie(M(wf),{key:0,modelValue:D.value,"onUpdate:modelValue":N[3]||(N[3]=z=>D.value=z),"node-types":L,"default-viewport":{zoom:1,x:0,y:0},"min-zoom":.2,"max-zoom":3,"connection-line-type":"default",class:"workflow-flow h-full workflow-transition"},{"node-custom":qe(({data:z})=>[z.type==="ai"?($(),O("div",{key:0,class:ye(["premium-ai-node",[z.status==="success"?"premium-ai-active":"premium-ai-inactive"]])},[($(!0),O(xe,null,Me((z.inputs||[]).filter(G=>G==="main"),(G,q)=>($(),Ie(M(Re),{key:"main-input-"+q,id:"input-"+q,type:"target",position:M(Z).Left,style:{top:"50%",transform:"translateY(-50%)"},class:ye(`premium-handle-ai-main ${X(z.id,"input-"+q)?"handle-connected":"handle-disconnected"}`),title:`Main Input: ${G}`},null,8,["id","position","class","title"]))),128)),($(!0),O(xe,null,Me((z.outputs||[]).filter(G=>G==="main"),(G,q)=>($(),Ie(M(Re),{key:"main-output-"+q,id:"output-"+q,type:"source",position:M(Z).Right,style:{top:"50%",transform:"translateY(-50%)"},class:ye(["premium-handle-ai-main",X(z.id,"output-"+q)?"handle-connected":"handle-disconnected"]),title:`Main Output: ${G}`},null,8,["id","position","class","title"]))),128)),($(!0),O(xe,null,Me([...(z.inputs||[]).filter(G=>G!=="main"),...(z.outputs||[]).filter(G=>G!=="main")],(G,q)=>($(),Ie(M(Re),{key:"tool-"+q,id:"tool-"+q,type:(z.inputs||[]).includes(G)?"target":"source",position:M(Z).Bottom,style:Ye({left:G.length>1?`${20+q*(140/Math.max([...(z.inputs||[]).filter(Oe=>Oe!=="main"),...(z.outputs||[]).filter(Oe=>Oe!=="main")].length-1,1))}px`:"50%",transform:"translateX(-50%)"}),class:ye(["premium-handle-ai-tool",X(z.id,"tool-"+q)?"handle-connected":"handle-disconnected"]),title:`AI Tool: ${G}`},null,8,["id","type","position","style","class","title"]))),128)),d("div",Sm,[j(en,Nt(Qe(z.nodeType,z.label),{size:"w-16 h-16"}),null,16)]),d("div",Nm,[d("div",Cm,V(z.label),1),z.outputs?.length>1?($(),O("div",$m,V(z.outputs.length)+" outputs ",1)):we("",!0)]),d("div",{class:ye(["premium-ai-status",z.status==="success"?"premium-status-ai-active":"premium-status-ai-inactive"])},null,2)],2)):z.type==="trigger"?($(),O("div",Im,[d("div",{class:ye(["premium-trigger-node",[z.status==="success"?"premium-trigger-active":"premium-trigger-inactive"]])},[($(!0),O(xe,null,Me(z.outputs||["main"],(G,q)=>($(),Ie(M(Re),{key:"output-"+q,id:"output-"+q,type:"source",position:M(Z).Right,style:Ye({top:z.outputs?.length>1?`${15+q*20}px`:"50%",transform:"translateY(-50%)"}),class:ye(["premium-handle-trigger",X(z.id,"output-"+q)?"handle-connected":"handle-disconnected"])},null,8,["id","position","style","class"]))),128)),d("div",Tm,[j(en,Nt(Qe(z.nodeType,z.label),{size:"w-12 h-12"}),null,16)])],2),d("div",Mm,V(z.label),1)])):z.type==="tool"?($(),O("div",Dm,[d("div",{class:ye(["premium-tool-node",[z.status==="success"?"premium-tool-active":"premium-tool-inactive"]])},[($(!0),O(xe,null,Me(z.inputs||["main"],(G,q)=>($(),Ie(M(Re),{key:"input-"+q,id:"input-"+q,type:"target",position:M(Z).Bottom,style:{left:"50%",transform:"translateX(-50%)"},class:ye(["premium-handle-tool-bottom",X(z.id,"input-"+q)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),($(!0),O(xe,null,Me(z.outputs||["main"],(G,q)=>($(),Ie(M(Re),{key:"output-"+q,id:"output-"+q,type:"source",position:M(Z).Top,style:{left:"50%",transform:"translateX(-50%)"},class:ye(["premium-handle-tool-top",X(z.id,"output-"+q)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),d("div",Am,[j(en,Nt(Qe(z.nodeType,z.label),{size:"w-12 h-12"}),null,16)])],2),d("div",Pm,V(z.label),1)])):z.type==="storage"?($(),O("div",{key:3,class:ye(["premium-storage-node",[z.status==="success"?"premium-storage-active":"premium-storage-inactive"]])},[($(!0),O(xe,null,Me((z.inputs||["main"]).filter(G=>G==="main"),(G,q)=>($(),Ie(M(Re),{key:"input-"+q,id:"input-"+q,type:"target",position:M(Z).Top,style:{left:"50%",transform:"translateX(-50%)"},class:ye(["premium-handle-storage",X(z.id,"input-"+q)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),($(!0),O(xe,null,Me((z.inputs||[]).filter(G=>G!=="main"),(G,q)=>($(),Ie(M(Re),{key:"tool-input-"+q,id:"tool-"+q,type:"target",position:M(Z).Bottom,style:{left:"50%",transform:"translateX(-50%)"},class:ye(["premium-handle-storage",X(z.id,"tool-"+q)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),d("div",Om,[d("div",Rm,[j(en,Nt(Qe(z.nodeType,z.label),{size:"w-8 h-8"}),null,16)]),d("div",zm,V(z.label),1)])],2)):($(),O("div",Bm,[d("div",{class:ye(["premium-process-node",[z.status==="success"?"premium-process-active":"premium-process-inactive"]])},[($(!0),O(xe,null,Me(z.inputs||["main"],(G,q)=>($(),Ie(M(Re),{key:"input-"+q,id:"input-"+q,type:"target",position:M(Z).Left,style:Ye({top:z.inputs?.length>1?`${15+q*20}px`:"50%",transform:"translateY(-50%)"}),class:ye("premium-handle-process handle-disconnected")},null,8,["id","position","style"]))),128)),($(!0),O(xe,null,Me(z.outputs||["main"],(G,q)=>($(),Ie(M(Re),{key:"output-"+q,id:"output-"+q,type:"source",position:M(Z).Right,style:Ye({top:z.outputs?.length>1?`${15+q*20}px`:"50%",transform:"translateY(-50%)"}),class:ye("premium-handle-process handle-disconnected")},null,8,["id","position","style"]))),128)),d("div",Lm,[j(en,Nt(Qe(z.nodeType,z.label),{size:"w-12 h-12"}),null,16)])],2),d("div",Vm,V(z.label),1)]))]),default:qe(()=>[j(M(Nf),{"pattern-color":"#4b5563",size:2,variant:"dots",gap:20,style:{backgroundColor:"#0a0a0a"}}),s.value?($(),O("div",hm,[R.value?($(),O("button",{key:1,onClick:ve,class:"px-4 py-2 bg-red-700 border border-red-600 text-white rounded transition-colors shadow-lg flex items-center gap-2 hover:bg-red-600",title:"Stop Workflow"},[j(M(be),{icon:"lucide:square",class:"w-4 h-4"}),N[18]||(N[18]=We(" Stop ",-1))])):($(),O("button",{key:0,onClick:ue,disabled:!m.value,class:ye(["px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded transition-colors shadow-lg flex items-center gap-2","hover:bg-gray-700",m.value?"":"opacity-50 cursor-not-allowed"]),title:"Execute Workflow"},[j(M(be),{icon:"lucide:play",class:"w-4 h-4"}),N[17]||(N[17]=We(" Execute Now ",-1))],10,mm))])):we("",!0),d("div",vm,[d("button",{onClick:N[1]||(N[1]=()=>M(E)({duration:600,padding:.15})),class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center shadow-lg",title:"Fit View"},[...N[19]||(N[19]=[d("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[d("path",{d:"M5 5h4v2H7v2H5V5zm10 0h4v4h-2V7h-2V5zM7 15v2h2v2H5v-4h2zm8 2v-2h2v4h-4v-2h2z"})],-1)])]),d("button",{onClick:pe,class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center text-lg font-bold shadow-lg",title:"Zoom In"}," + "),d("button",{onClick:Ee,class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center text-lg font-bold shadow-lg",title:"Zoom Out"}," − ")]),d("div",ym,[d("button",{onClick:N[2]||(N[2]=z=>a.value=!a.value),class:"bg-gray-800 border border-gray-600 text-white px-4 py-2 rounded-t-lg shadow-lg hover:bg-gray-700 transition-colors flex items-center gap-2"},[N[21]||(N[21]=d("span",{class:"text-sm font-medium"},"Logs",-1)),N[22]||(N[22]=d("div",{class:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"},null,-1)),($(),O("svg",{class:ye(["w-4 h-4 text-gray-400 transition-transform",{"rotate-180":a.value}]),fill:"currentColor",viewBox:"0 0 20 20"},[...N[20]||(N[20]=[d("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])],2))]),a.value?($(),O("div",wm,[d("div",xm,[c.value.length===0?($(),O("div",_m,[...N[23]||(N[23]=[d("p",{class:"text-gray-400 text-sm"},"Nothing to display yet. Execute the workflow to see execution logs.",-1)])])):($(),O("div",bm,[($(!0),O(xe,null,Me(c.value,(z,G)=>($(),O("div",{key:G,class:"flex items-start gap-3 text-sm"},[d("span",Em,V(z.timestamp),1),d("span",{class:ye([oo(z.level),"shrink-0 min-w-[60px]"])},V(z.level),3),d("span",km,V(z.message),1)]))),128))]))])])):we("",!0)])]),_:1},8,["modelValue"])):($(),O("div",Fm,[d("div",Hm,[j(fe,{class:"w-16 h-16 text-text-muted mx-auto mb-4"}),N[24]||(N[24]=d("h3",{class:"text-lg font-semibold text-text mb-2"},"Select a Process",-1)),N[25]||(N[25]=d("p",{class:"text-text-muted"},"Choose a workflow from the list to visualize its structure",-1))])]))])])]),y.value?($(),Ie(hh,{key:0,workflow:y.value,show:C.value,onClose:v},null,8,["workflow","show"])):we("",!0),m.value&&P.value?($(),Ie(fr,{key:1,"workflow-id":m.value,"tenant-id":xv,show:P.value,onClose:_},null,8,["workflow-id","show"])):we("",!0),y.value?($(),Ie(gr,{key:2,show:k.value,title:`Process Executions: ${y.value.process_name}`,subtitle:`ID: ${y.value.id}`,"header-icon":"lucide:play",tabs:K,"default-tab":"executions","is-loading":U.value?.loading||!1,error:I.value,data:U.value,onClose:x,onRefresh:$e,onRetry:$e},{executions:qe(({data:z})=>[d("div",Gm,[d("div",Ym,[d("h3",Wm,"Recent Executions (Page "+V(F.value)+"/"+V(re.value)+")",1),z?.executions?.length>0?($(),O("div",Um," Showing the "+V(z.executions.length)+" most recent executions ",1)):we("",!0),ne.value.length>0?($(),O("div",Xm,[d("table",Zm,[N[26]||(N[26]=d("thead",{class:"bg-surface-hover border-b border-border"},[d("tr",null,[d("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Status"),d("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"ID"),d("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Started"),d("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Duration")])],-1)),d("tbody",null,[($(!0),O(xe,null,Me(ne.value,(G,q)=>($(),O("tr",{key:G.id||q,class:"border-b border-border/50 hover:bg-surface-hover/30"},[d("td",qm,[d("div",Km,[G.finished&&!G.error?($(),Ie(M(be),{key:0,icon:"lucide:check-circle",class:"h-4 w-4 text-cyan-500"})):G.error?($(),Ie(M(be),{key:1,icon:"lucide:x-circle",class:"h-4 w-4 text-red-400"})):($(),Ie(M(be),{key:2,icon:"lucide:clock",class:"h-4 w-4 text-yellow-400"})),d("span",{class:ye(["text-xs font-medium",G.finished&&!G.error?"text-cyan-500":G.error?"text-red-400":"text-yellow-400"])},V(G.finished&&!G.error?"Success":G.error?"Failed":"Running"),3)])]),d("td",jm," #"+V(G.id),1),d("td",Jm,V(A.formatDate(G.startedAt)),1),d("td",Qm,V(A.formatDuration(G.execution_time||0)),1)]))),128))])])])):we("",!0),z?.executions?.length>Lt?($(),O("div",ev,[d("div",tv," Showing "+V((F.value-1)*Lt+1)+" - "+V(Math.min(F.value*Lt,z.executions.length))+" of "+V(z.executions.length),1),d("div",nv,[d("button",{onClick:N[4]||(N[4]=G=>F.value=Math.max(1,F.value-1)),disabled:F.value===1,class:"px-3 py-1 text-xs bg-surface border border-border rounded hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ov),d("div",sv,[($(!0),O(xe,null,Me(Math.min(5,re.value),G=>($(),O("button",{key:G,onClick:q=>F.value=G,class:ye(["w-8 h-8 text-xs rounded transition-colors",F.value===G?"bg-primary text-white":"bg-surface border border-border hover:bg-surface-hover"])},V(G),11,iv))),128)),re.value>5?($(),O("span",rv,"...")):we("",!0),re.value>5?($(),O("button",{key:1,onClick:N[5]||(N[5]=G=>F.value=re.value),class:ye(["w-8 h-8 text-xs rounded transition-colors",F.value===re.value?"bg-primary text-white":"bg-surface border border-border hover:bg-surface-hover"])},V(re.value),3)):we("",!0)]),d("button",{onClick:N[6]||(N[6]=G=>F.value=Math.min(re.value,F.value+1)),disabled:F.value===re.value,class:"px-3 py-1 text-xs bg-surface border border-border rounded hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,lv)])])):z?.executions?.length?we("",!0):($(),O("div",av,[j(M(be),{icon:"lucide:play",class:"w-12 h-12 text-text-muted mx-auto mb-4"}),N[27]||(N[27]=d("p",{class:"text-text-muted"},"No executions found for this process",-1))]))])])]),stats:qe(({data:z})=>[d("div",cv,[d("div",uv,[d("div",dv,[d("div",fv,[N[28]||(N[28]=d("span",{class:"text-sm text-text-muted"},"Total Executions",-1)),j(M(be),{icon:"lucide:play",class:"h-4 w-4 text-gray-600"})]),d("p",gv,V(z?.totalExecutions||0),1)]),d("div",pv,[d("div",hv,[N[29]||(N[29]=d("span",{class:"text-sm text-text-muted"},"Success Rate",-1)),j(M(be),{icon:"lucide:check-circle",class:"h-4 w-4 text-gray-600"})]),d("p",mv,V(z?.successRate?`${z.successRate.toFixed(1)}%`:"N/A"),1)]),d("div",vv,[d("div",yv,[N[30]||(N[30]=d("span",{class:"text-sm text-text-muted"},"Avg Duration",-1)),j(M(be),{icon:"lucide:clock",class:"h-4 w-4 text-gray-600"})]),d("p",wv,V(A.formatDuration(z?.avgDuration||0)),1)])])])]),_:1},8,["show","title","subtitle","is-loading","error","data"])):we("",!0)])]),_:1})}}}),$v=Yn(_v,[["__scopeId","data-v-afc95c05"]]);export{$v as default};
//# sourceMappingURL=WorkflowCommandCenter-D57t71jZ.js.map
