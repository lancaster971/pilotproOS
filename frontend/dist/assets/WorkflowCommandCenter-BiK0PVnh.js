import{d as Pe,C as Oi,D as qt,E as Ri,G as Me,H as Xs,b as Zs,c as O,e as $,m as q,I as lt,y as Xe,f as u,k as T,J as Be,r as he,q as W,o as ct,n as ve,K as qs,L as hn,M as Ks,N as Cn,O as js,F as xe,z as Te,A as We,P as et,Q as zi,g as ye,R as Js,j as $e,S as An,t as V,T as Po,U as Qs,V as er,W as Yt,X as Et,Y as De,Z as Ce,$ as tr,p as $t,a0 as nr,l as Ye,a1 as sn,a2 as or,a3 as Bi,a4 as ir,w as sr,a5 as rr,u as lr}from"./index-Dtu06-oO.js";import{I as Ee}from"./iconify-BAXUVM_a.js";import{M as ar}from"./MainLayout-C-wHnsEA.js";import{_ as Yn}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as Bt,a as Ct}from"./index-CHYdIJI6.js";import{b as je,$ as cr}from"./api-client-Dy4MoU83.js";import{_ as ur,D as dr}from"./TimelineModal.vue_vue_type_script_setup_true_lang-D0DUcXE3.js";import{useAuthStore as fr}from"./auth-Ckyanyq3.js";import"./settings-BXrMLSgp.js";function Wn(e){return Oi()?(Cn(e),!0):!1}function mt(e){return typeof e=="function"?e():T(e)}const pr=typeof window<"u"&&typeof document<"u",gr=e=>typeof e<"u",hr=Object.prototype.toString,mr=e=>hr.call(e)==="[object Object]",vr=()=>{};function yr(e,t){function n(...o){return new Promise((i,s)=>{Promise.resolve(e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})).then(i).catch(s)})}return n}const Li=e=>e();function wr(e=Li){const t=he(!0);function n(){t.value=!1}function o(){t.value=!0}const i=(...s)=>{t.value&&e(...s)};return{isActive:or(t),pause:n,resume:o,eventFilter:i}}function Uo(e,t=!1,n="Timeout"){return new Promise((o,i)=>{setTimeout(t?()=>i(n):o,e)})}function xr(e,t,n={}){const{eventFilter:o=Li,...i}=n;return Me(e,yr(o,t),i)}function Lt(e,t,n={}){const{eventFilter:o,...i}=n,{eventFilter:s,pause:r,resume:l,isActive:a}=wr(o);return{stop:xr(e,t,{...i,eventFilter:s}),pause:r,resume:l,isActive:a}}function _r(e,t={}){if(!Po(e))return Qs(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const o in e.value)n[o]=er(()=>({get(){return e.value[o]},set(i){var s;if((s=mt(t.replaceRef))!=null?s:!0)if(Array.isArray(e.value)){const l=[...e.value];l[o]=i,e.value=l}else{const l={...e.value,[o]:i};Object.setPrototypeOf(l,Object.getPrototypeOf(e.value)),e.value=l}else e.value[o]=i}}));return n}function yo(e,t=!1){function n(p,{flush:y="sync",deep:m=!1,timeout:E,throwOnTimeout:f}={}){let h=null;const P=[new Promise(k=>{h=Me(e,w=>{p(w)!==t&&(h?.(),k(w))},{flush:y,deep:m,immediate:!0})})];return E!=null&&P.push(Uo(E,f).then(()=>mt(e)).finally(()=>h?.())),Promise.race(P)}function o(p,y){if(!Po(p))return n(w=>w===p,y);const{flush:m="sync",deep:E=!1,timeout:f,throwOnTimeout:h}=y??{};let C=null;const k=[new Promise(w=>{C=Me([e,p],([S,j])=>{t!==(S===j)&&(C?.(),w(S))},{flush:m,deep:E,immediate:!0})})];return f!=null&&k.push(Uo(f,h).then(()=>mt(e)).finally(()=>(C?.(),mt(e)))),Promise.race(k)}function i(p){return n(y=>!!y,p)}function s(p){return o(null,p)}function r(p){return o(void 0,p)}function l(p){return n(Number.isNaN,p)}function a(p,y){return n(m=>{const E=Array.from(m);return E.includes(p)||E.includes(mt(p))},y)}function c(p){return d(1,p)}function d(p=1,y){let m=-1;return n(()=>(m+=1,m>=p),y)}return Array.isArray(mt(e))?{toMatch:n,toContains:a,changed:c,changedTimes:d,get not(){return yo(e,!t)}}:{toMatch:n,toBe:o,toBeTruthy:i,toBeNull:s,toBeNaN:l,toBeUndefined:r,changed:c,changedTimes:d,get not(){return yo(e,!t)}}}function wo(e){return yo(e)}function br(e){var t;const n=mt(e);return(t=n?.$el)!=null?t:n}const Vi=pr?window:void 0;function Fi(...e){let t,n,o,i;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,o,i]=e,t=Vi):[t,n,o,i]=e,!t)return vr;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const s=[],r=()=>{s.forEach(d=>d()),s.length=0},l=(d,p,y,m)=>(d.addEventListener(p,y,m),()=>d.removeEventListener(p,y,m)),a=Me(()=>[br(t),mt(i)],([d,p])=>{if(r(),!d)return;const y=mr(p)?{...p}:p;s.push(...n.flatMap(m=>o.map(E=>l(d,m,E,y))))},{immediate:!0,flush:"post"}),c=()=>{a(),r()};return Wn(c),c}function Er(e){return typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0}function Xo(...e){let t,n,o={};e.length===3?(t=e[0],n=e[1],o=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,n=e[0],o=e[1]):(t=e[0],n=e[1]):(t=!0,n=e[0]);const{target:i=Vi,eventName:s="keydown",passive:r=!1,dedupe:l=!1}=o,a=Er(t);return Fi(i,s,d=>{d.repeat&&mt(l)||a(d)&&n(d)},r)}function kr(e){return JSON.parse(JSON.stringify(e))}function so(e,t,n,o={}){var i,s,r;const{clone:l=!1,passive:a=!1,eventName:c,deep:d=!1,defaultValue:p,shouldEmit:y}=o,m=hn(),E=n||m?.emit||((i=m?.$emit)==null?void 0:i.bind(m))||((r=(s=m?.proxy)==null?void 0:s.$emit)==null?void 0:r.bind(m?.proxy));let f=c;t||(t="modelValue"),f=f||`update:${t.toString()}`;const h=k=>l?typeof l=="function"?l(k):kr(k):k,C=()=>gr(e[t])?h(e[t]):p,P=k=>{y?y(k)&&E(f,k):E(f,k)};if(a){const k=C(),w=he(k);let S=!1;return Me(()=>e[t],j=>{S||(S=!0,w.value=h(j),et(()=>S=!1))}),Me(w,j=>{!S&&(j!==e[t]||d)&&P(j)},{deep:d}),w}else return W({get(){return C()},set(k){P(k)}})}var Sr={value:()=>{}};function Un(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new $n(n)}function $n(e){this._=e}function Nr(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",i=n.indexOf(".");if(i>=0&&(o=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}$n.prototype=Un.prototype={constructor:$n,on:function(e,t){var n=this._,o=Nr(e+"",n),i,s=-1,r=o.length;if(arguments.length<2){for(;++s<r;)if((i=(e=o[s]).type)&&(i=Cr(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<r;)if(i=(e=o[s]).type)n[i]=Zo(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Zo(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $n(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),o=0,i,s;o<i;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,i=s.length;o<i;++o)s[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],i=0,s=o.length;i<s;++i)o[i].value.apply(t,n)}};function Cr(e,t){for(var n=0,o=e.length,i;n<o;++n)if((i=e[n]).name===t)return i.value}function Zo(e,t,n){for(var o=0,i=e.length;o<i;++o)if(e[o].name===t){e[o]=Sr,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var xo="http://www.w3.org/1999/xhtml";const qo={svg:"http://www.w3.org/2000/svg",xhtml:xo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),qo.hasOwnProperty(t)?{space:qo[t],local:e}:e}function $r(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xo&&t.documentElement.namespaceURI===xo?t.createElement(e):t.createElementNS(n,e)}}function Ir(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Hi(e){var t=Xn(e);return(t.local?Ir:$r)(t)}function Tr(){}function Oo(e){return e==null?Tr:function(){return this.querySelector(e)}}function Mr(e){typeof e!="function"&&(e=Oo(e));for(var t=this._groups,n=t.length,o=new Array(n),i=0;i<n;++i)for(var s=t[i],r=s.length,l=o[i]=new Array(r),a,c,d=0;d<r;++d)(a=s[d])&&(c=e.call(a,a.__data__,d,s))&&("__data__"in a&&(c.__data__=a.__data__),l[d]=c);return new qe(o,this._parents)}function Dr(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ar(){return[]}function Gi(e){return e==null?Ar:function(){return this.querySelectorAll(e)}}function Pr(e){return function(){return Dr(e.apply(this,arguments))}}function Or(e){typeof e=="function"?e=Pr(e):e=Gi(e);for(var t=this._groups,n=t.length,o=[],i=[],s=0;s<n;++s)for(var r=t[s],l=r.length,a,c=0;c<l;++c)(a=r[c])&&(o.push(e.call(a,a.__data__,c,r)),i.push(a));return new qe(o,i)}function Yi(e){return function(){return this.matches(e)}}function Wi(e){return function(t){return t.matches(e)}}var Rr=Array.prototype.find;function zr(e){return function(){return Rr.call(this.children,e)}}function Br(){return this.firstElementChild}function Lr(e){return this.select(e==null?Br:zr(typeof e=="function"?e:Wi(e)))}var Vr=Array.prototype.filter;function Fr(){return Array.from(this.children)}function Hr(e){return function(){return Vr.call(this.children,e)}}function Gr(e){return this.selectAll(e==null?Fr:Hr(typeof e=="function"?e:Wi(e)))}function Yr(e){typeof e!="function"&&(e=Yi(e));for(var t=this._groups,n=t.length,o=new Array(n),i=0;i<n;++i)for(var s=t[i],r=s.length,l=o[i]=[],a,c=0;c<r;++c)(a=s[c])&&e.call(a,a.__data__,c,s)&&l.push(a);return new qe(o,this._parents)}function Ui(e){return new Array(e.length)}function Wr(){return new qe(this._enter||this._groups.map(Ui),this._parents)}function Pn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Pn.prototype={constructor:Pn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ur(e){return function(){return e}}function Xr(e,t,n,o,i,s){for(var r=0,l,a=t.length,c=s.length;r<c;++r)(l=t[r])?(l.__data__=s[r],o[r]=l):n[r]=new Pn(e,s[r]);for(;r<a;++r)(l=t[r])&&(i[r]=l)}function Zr(e,t,n,o,i,s,r){var l,a,c=new Map,d=t.length,p=s.length,y=new Array(d),m;for(l=0;l<d;++l)(a=t[l])&&(y[l]=m=r.call(a,a.__data__,l,t)+"",c.has(m)?i[l]=a:c.set(m,a));for(l=0;l<p;++l)m=r.call(e,s[l],l,s)+"",(a=c.get(m))?(o[l]=a,a.__data__=s[l],c.delete(m)):n[l]=new Pn(e,s[l]);for(l=0;l<d;++l)(a=t[l])&&c.get(y[l])===a&&(i[l]=a)}function qr(e){return e.__data__}function Kr(e,t){if(!arguments.length)return Array.from(this,qr);var n=t?Zr:Xr,o=this._parents,i=this._groups;typeof e!="function"&&(e=Ur(e));for(var s=i.length,r=new Array(s),l=new Array(s),a=new Array(s),c=0;c<s;++c){var d=o[c],p=i[c],y=p.length,m=jr(e.call(d,d&&d.__data__,c,o)),E=m.length,f=l[c]=new Array(E),h=r[c]=new Array(E),C=a[c]=new Array(y);n(d,p,f,h,C,m,t);for(var P=0,k=0,w,S;P<E;++P)if(w=f[P]){for(P>=k&&(k=P+1);!(S=h[k])&&++k<E;);w._next=S||null}}return r=new qe(r,o),r._enter=l,r._exit=a,r}function jr(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jr(){return new qe(this._exit||this._groups.map(Ui),this._parents)}function Qr(e,t,n){var o=this.enter(),i=this,s=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),o&&i?o.merge(i).order():i}function el(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,i=n.length,s=o.length,r=Math.min(i,s),l=new Array(i),a=0;a<r;++a)for(var c=n[a],d=o[a],p=c.length,y=l[a]=new Array(p),m,E=0;E<p;++E)(m=c[E]||d[E])&&(y[E]=m);for(;a<i;++a)l[a]=n[a];return new qe(l,this._parents)}function tl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],i=o.length-1,s=o[i],r;--i>=0;)(r=o[i])&&(s&&r.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(r,s),s=r);return this}function nl(e){e||(e=ol);function t(p,y){return p&&y?e(p.__data__,y.__data__):!p-!y}for(var n=this._groups,o=n.length,i=new Array(o),s=0;s<o;++s){for(var r=n[s],l=r.length,a=i[s]=new Array(l),c,d=0;d<l;++d)(c=r[d])&&(a[d]=c);a.sort(t)}return new qe(i,this._parents).order()}function ol(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function il(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function sl(){return Array.from(this)}function rl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],i=0,s=o.length;i<s;++i){var r=o[i];if(r)return r}return null}function ll(){let e=0;for(const t of this)++e;return e}function al(){return!this.node()}function cl(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var i=t[n],s=0,r=i.length,l;s<r;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function ul(e){return function(){this.removeAttribute(e)}}function dl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function fl(e,t){return function(){this.setAttribute(e,t)}}function pl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function gl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function hl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ml(e,t){var n=Xn(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?dl:ul:typeof t=="function"?n.local?hl:gl:n.local?pl:fl)(n,t))}function Xi(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function vl(e){return function(){this.style.removeProperty(e)}}function yl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wl(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function xl(e,t,n){return arguments.length>1?this.each((t==null?vl:typeof t=="function"?wl:yl)(e,t,n??"")):Wt(this.node(),e)}function Wt(e,t){return e.style.getPropertyValue(t)||Xi(e).getComputedStyle(e,null).getPropertyValue(t)}function _l(e){return function(){delete this[e]}}function bl(e,t){return function(){this[e]=t}}function El(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function kl(e,t){return arguments.length>1?this.each((t==null?_l:typeof t=="function"?El:bl)(e,t)):this.node()[e]}function Zi(e){return e.trim().split(/^|\s+/)}function Ro(e){return e.classList||new qi(e)}function qi(e){this._node=e,this._names=Zi(e.getAttribute("class")||"")}qi.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ki(e,t){for(var n=Ro(e),o=-1,i=t.length;++o<i;)n.add(t[o])}function ji(e,t){for(var n=Ro(e),o=-1,i=t.length;++o<i;)n.remove(t[o])}function Sl(e){return function(){Ki(this,e)}}function Nl(e){return function(){ji(this,e)}}function Cl(e,t){return function(){(t.apply(this,arguments)?Ki:ji)(this,e)}}function $l(e,t){var n=Zi(e+"");if(arguments.length<2){for(var o=Ro(this.node()),i=-1,s=n.length;++i<s;)if(!o.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Cl:t?Sl:Nl)(n,t))}function Il(){this.textContent=""}function Tl(e){return function(){this.textContent=e}}function Ml(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Dl(e){return arguments.length?this.each(e==null?Il:(typeof e=="function"?Ml:Tl)(e)):this.node().textContent}function Al(){this.innerHTML=""}function Pl(e){return function(){this.innerHTML=e}}function Ol(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rl(e){return arguments.length?this.each(e==null?Al:(typeof e=="function"?Ol:Pl)(e)):this.node().innerHTML}function zl(){this.nextSibling&&this.parentNode.appendChild(this)}function Bl(){return this.each(zl)}function Ll(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Vl(){return this.each(Ll)}function Fl(e){var t=typeof e=="function"?e:Hi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Hl(){return null}function Gl(e,t){var n=typeof e=="function"?e:Hi(e),o=t==null?Hl:typeof t=="function"?t:Oo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Yl(){var e=this.parentNode;e&&e.removeChild(this)}function Wl(){return this.each(Yl)}function Ul(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Xl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Zl(e){return this.select(e?Xl:Ul)}function ql(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Kl(e){return function(t){e.call(this,t,this.__data__)}}function jl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Jl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++o]=s;++o?t.length=o:delete this.__on}}}function Ql(e,t,n){return function(){var o=this.__on,i,s=Kl(t);if(o){for(var r=0,l=o.length;r<l;++r)if((i=o[r]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},o?o.push(i):this.__on=[i]}}function ea(e,t,n){var o=jl(e+""),i,s=o.length,r;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,c=l.length,d;a<c;++a)for(i=0,d=l[a];i<s;++i)if((r=o[i]).type===d.type&&r.name===d.name)return d.value}return}for(l=t?Ql:Jl,i=0;i<s;++i)this.each(l(o[i],t,n));return this}function Ji(e,t,n){var o=Xi(e),i=o.CustomEvent;typeof i=="function"?i=new i(t,n):(i=o.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ta(e,t){return function(){return Ji(this,e,t)}}function na(e,t){return function(){return Ji(this,e,t.apply(this,arguments))}}function oa(e,t){return this.each((typeof t=="function"?na:ta)(e,t))}function*ia(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],i=0,s=o.length,r;i<s;++i)(r=o[i])&&(yield r)}var Qi=[null];function qe(e,t){this._groups=e,this._parents=t}function mn(){return new qe([[document.documentElement]],Qi)}function sa(){return this}qe.prototype=mn.prototype={constructor:qe,select:Mr,selectAll:Or,selectChild:Lr,selectChildren:Gr,filter:Yr,data:Kr,enter:Wr,exit:Jr,join:Qr,merge:el,selection:sa,order:tl,sort:nl,call:il,nodes:sl,node:rl,size:ll,empty:al,each:cl,attr:ml,style:xl,property:kl,classed:$l,text:Dl,html:Rl,raise:Bl,lower:Vl,append:Fl,insert:Gl,remove:Wl,clone:Zl,datum:ql,on:ea,dispatch:oa,[Symbol.iterator]:ia};function Je(e){return typeof e=="string"?new qe([[document.querySelector(e)]],[document.documentElement]):new qe([[e]],Qi)}function ra(e){let t;for(;t=e.sourceEvent;)e=t;return e}function it(e,t){if(e=ra(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const la={passive:!1},cn={capture:!0,passive:!1};function ro(e){e.stopImmediatePropagation()}function Ft(e){e.preventDefault(),e.stopImmediatePropagation()}function es(e){var t=e.document.documentElement,n=Je(e).on("dragstart.drag",Ft,cn);"onselectstart"in t?n.on("selectstart.drag",Ft,cn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ts(e,t){var n=e.document.documentElement,o=Je(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ft,cn),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const wn=e=>()=>e;function _o(e,{sourceEvent:t,subject:n,target:o,identifier:i,active:s,x:r,y:l,dx:a,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}_o.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function aa(e){return!e.ctrlKey&&!e.button}function ca(){return this.parentNode}function ua(e,t){return t??{x:e.x,y:e.y}}function da(){return navigator.maxTouchPoints||"ontouchstart"in this}function fa(){var e=aa,t=ca,n=ua,o=da,i={},s=Un("start","drag","end"),r=0,l,a,c,d,p=0;function y(w){w.on("mousedown.drag",m).filter(o).on("touchstart.drag",h).on("touchmove.drag",C,la).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(w,S){if(!(d||!e.call(this,w,S))){var j=k(this,t.call(this,w,S),w,S,"mouse");j&&(Je(w.view).on("mousemove.drag",E,cn).on("mouseup.drag",f,cn),es(w.view),ro(w),c=!1,l=w.clientX,a=w.clientY,j("start",w))}}function E(w){if(Ft(w),!c){var S=w.clientX-l,j=w.clientY-a;c=S*S+j*j>p}i.mouse("drag",w)}function f(w){Je(w.view).on("mousemove.drag mouseup.drag",null),ts(w.view,c),Ft(w),i.mouse("end",w)}function h(w,S){if(e.call(this,w,S)){var j=w.changedTouches,Y=t.call(this,w,S),J=j.length,ee,ie;for(ee=0;ee<J;++ee)(ie=k(this,Y,w,S,j[ee].identifier,j[ee]))&&(ro(w),ie("start",w,j[ee]))}}function C(w){var S=w.changedTouches,j=S.length,Y,J;for(Y=0;Y<j;++Y)(J=i[S[Y].identifier])&&(Ft(w),J("drag",w,S[Y]))}function P(w){var S=w.changedTouches,j=S.length,Y,J;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),Y=0;Y<j;++Y)(J=i[S[Y].identifier])&&(ro(w),J("end",w,S[Y]))}function k(w,S,j,Y,J,ee){var ie=s.copy(),D=it(ee||j,S),_,se,b;if((b=n.call(w,new _o("beforestart",{sourceEvent:j,target:y,identifier:J,active:r,x:D[0],y:D[1],dx:0,dy:0,dispatch:ie}),Y))!=null)return _=b.x-D[0]||0,se=b.y-D[1]||0,function B(I,L,H){var Q=D,K;switch(I){case"start":i[J]=B,K=r++;break;case"end":delete i[J],--r;case"drag":D=it(H||L,S),K=r;break}ie.call(I,w,new _o(I,{sourceEvent:L,subject:b,target:y,identifier:J,active:K,x:D[0]+_,y:D[1]+se,dx:D[0]-Q[0],dy:D[1]-Q[1],dispatch:ie}),Y)}}return y.filter=function(w){return arguments.length?(e=typeof w=="function"?w:wn(!!w),y):e},y.container=function(w){return arguments.length?(t=typeof w=="function"?w:wn(w),y):t},y.subject=function(w){return arguments.length?(n=typeof w=="function"?w:wn(w),y):n},y.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:wn(!!w),y):o},y.on=function(){var w=s.on.apply(s,arguments);return w===s?y:w},y.clickDistance=function(w){return arguments.length?(p=(w=+w)*w,y):Math.sqrt(p)},y}function zo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ns(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function vn(){}var un=.7,On=1/un,Ht="\\s*([+-]?\\d+)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",at="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pa=/^#([0-9a-f]{3,8})$/,ga=new RegExp(`^rgb\\(${Ht},${Ht},${Ht}\\)$`),ha=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),ma=new RegExp(`^rgba\\(${Ht},${Ht},${Ht},${dn}\\)$`),va=new RegExp(`^rgba\\(${at},${at},${at},${dn}\\)$`),ya=new RegExp(`^hsl\\(${dn},${at},${at}\\)$`),wa=new RegExp(`^hsla\\(${dn},${at},${at},${dn}\\)$`),Ko={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};zo(vn,Pt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:jo,formatHex:jo,formatHex8:xa,formatHsl:_a,formatRgb:Jo,toString:Jo});function jo(){return this.rgb().formatHex()}function xa(){return this.rgb().formatHex8()}function _a(){return os(this).formatHsl()}function Jo(){return this.rgb().formatRgb()}function Pt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pa.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Qo(t):n===3?new Ze(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?xn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?xn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ga.exec(e))?new Ze(t[1],t[2],t[3],1):(t=ha.exec(e))?new Ze(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ma.exec(e))?xn(t[1],t[2],t[3],t[4]):(t=va.exec(e))?xn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ya.exec(e))?ni(t[1],t[2]/100,t[3]/100,1):(t=wa.exec(e))?ni(t[1],t[2]/100,t[3]/100,t[4]):Ko.hasOwnProperty(e)?Qo(Ko[e]):e==="transparent"?new Ze(NaN,NaN,NaN,0):null}function Qo(e){return new Ze(e>>16&255,e>>8&255,e&255,1)}function xn(e,t,n,o){return o<=0&&(e=t=n=NaN),new Ze(e,t,n,o)}function ba(e){return e instanceof vn||(e=Pt(e)),e?(e=e.rgb(),new Ze(e.r,e.g,e.b,e.opacity)):new Ze}function bo(e,t,n,o){return arguments.length===1?ba(e):new Ze(e,t,n,o??1)}function Ze(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}zo(Ze,bo,ns(vn,{brighter(e){return e=e==null?On:Math.pow(On,e),new Ze(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new Ze(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ze(Dt(this.r),Dt(this.g),Dt(this.b),Rn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ei,formatHex:ei,formatHex8:Ea,formatRgb:ti,toString:ti}));function ei(){return`#${Mt(this.r)}${Mt(this.g)}${Mt(this.b)}`}function Ea(){return`#${Mt(this.r)}${Mt(this.g)}${Mt(this.b)}${Mt((isNaN(this.opacity)?1:this.opacity)*255)}`}function ti(){const e=Rn(this.opacity);return`${e===1?"rgb(":"rgba("}${Dt(this.r)}, ${Dt(this.g)}, ${Dt(this.b)}${e===1?")":`, ${e})`}`}function Rn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Dt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Mt(e){return e=Dt(e),(e<16?"0":"")+e.toString(16)}function ni(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Qe(e,t,n,o)}function os(e){if(e instanceof Qe)return new Qe(e.h,e.s,e.l,e.opacity);if(e instanceof vn||(e=Pt(e)),!e)return new Qe;if(e instanceof Qe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,i=Math.min(t,n,o),s=Math.max(t,n,o),r=NaN,l=s-i,a=(s+i)/2;return l?(t===s?r=(n-o)/l+(n<o)*6:n===s?r=(o-t)/l+2:r=(t-n)/l+4,l/=a<.5?s+i:2-s-i,r*=60):l=a>0&&a<1?0:r,new Qe(r,l,a,e.opacity)}function ka(e,t,n,o){return arguments.length===1?os(e):new Qe(e,t,n,o??1)}function Qe(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}zo(Qe,ka,ns(vn,{brighter(e){return e=e==null?On:Math.pow(On,e),new Qe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new Qe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,i=2*n-o;return new Ze(lo(e>=240?e-240:e+120,i,o),lo(e,i,o),lo(e<120?e+240:e-120,i,o),this.opacity)},clamp(){return new Qe(oi(this.h),_n(this.s),_n(this.l),Rn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Rn(this.opacity);return`${e===1?"hsl(":"hsla("}${oi(this.h)}, ${_n(this.s)*100}%, ${_n(this.l)*100}%${e===1?")":`, ${e})`}`}}));function oi(e){return e=(e||0)%360,e<0?e+360:e}function _n(e){return Math.max(0,Math.min(1,e||0))}function lo(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Bo=e=>()=>e;function Sa(e,t){return function(n){return e+n*t}}function Na(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function Ca(e){return(e=+e)==1?is:function(t,n){return n-t?Na(t,n,e):Bo(isNaN(t)?n:t)}}function is(e,t){var n=t-e;return n?Sa(e,n):Bo(isNaN(e)?t:e)}const zn=function e(t){var n=Ca(t);function o(i,s){var r=n((i=bo(i)).r,(s=bo(s)).r),l=n(i.g,s.g),a=n(i.b,s.b),c=is(i.opacity,s.opacity);return function(d){return i.r=r(d),i.g=l(d),i.b=a(d),i.opacity=c(d),i+""}}return o.gamma=e,o}(1);function $a(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),i;return function(s){for(i=0;i<n;++i)o[i]=e[i]*(1-s)+t[i]*s;return o}}function Ia(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ta(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,i=new Array(o),s=new Array(n),r;for(r=0;r<o;++r)i[r]=rn(e[r],t[r]);for(;r<n;++r)s[r]=t[r];return function(l){for(r=0;r<o;++r)s[r]=i[r](l);return s}}function Ma(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function st(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Da(e,t){var n={},o={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=rn(e[i],t[i]):o[i]=t[i];return function(s){for(i in n)o[i]=n[i](s);return o}}var Eo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ao=new RegExp(Eo.source,"g");function Aa(e){return function(){return e}}function Pa(e){return function(t){return e(t)+""}}function ss(e,t){var n=Eo.lastIndex=ao.lastIndex=0,o,i,s,r=-1,l=[],a=[];for(e=e+"",t=t+"";(o=Eo.exec(e))&&(i=ao.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),l[r]?l[r]+=s:l[++r]=s),(o=o[0])===(i=i[0])?l[r]?l[r]+=i:l[++r]=i:(l[++r]=null,a.push({i:r,x:st(o,i)})),n=ao.lastIndex;return n<t.length&&(s=t.slice(n),l[r]?l[r]+=s:l[++r]=s),l.length<2?a[0]?Pa(a[0].x):Aa(t):(t=a.length,function(c){for(var d=0,p;d<t;++d)l[(p=a[d]).i]=p.x(c);return l.join("")})}function rn(e,t){var n=typeof t,o;return t==null||n==="boolean"?Bo(t):(n==="number"?st:n==="string"?(o=Pt(t))?(t=o,zn):ss:t instanceof Pt?zn:t instanceof Date?Ma:Ia(t)?$a:Array.isArray(t)?Ta:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Da:st)(e,t)}var ii=180/Math.PI,ko={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function rs(e,t,n,o,i,s){var r,l,a;return(r=Math.sqrt(e*e+t*t))&&(e/=r,t/=r),(a=e*n+t*o)&&(n-=e*a,o-=t*a),(l=Math.sqrt(n*n+o*o))&&(n/=l,o/=l,a/=l),e*o<t*n&&(e=-e,t=-t,a=-a,r=-r),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*ii,skewX:Math.atan(a)*ii,scaleX:r,scaleY:l}}var bn;function Oa(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ko:rs(t.a,t.b,t.c,t.d,t.e,t.f)}function Ra(e){return e==null||(bn||(bn=document.createElementNS("http://www.w3.org/2000/svg","g")),bn.setAttribute("transform",e),!(e=bn.transform.baseVal.consolidate()))?ko:(e=e.matrix,rs(e.a,e.b,e.c,e.d,e.e,e.f))}function ls(e,t,n,o){function i(c){return c.length?c.pop()+" ":""}function s(c,d,p,y,m,E){if(c!==p||d!==y){var f=m.push("translate(",null,t,null,n);E.push({i:f-4,x:st(c,p)},{i:f-2,x:st(d,y)})}else(p||y)&&m.push("translate("+p+t+y+n)}function r(c,d,p,y){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),y.push({i:p.push(i(p)+"rotate(",null,o)-2,x:st(c,d)})):d&&p.push(i(p)+"rotate("+d+o)}function l(c,d,p,y){c!==d?y.push({i:p.push(i(p)+"skewX(",null,o)-2,x:st(c,d)}):d&&p.push(i(p)+"skewX("+d+o)}function a(c,d,p,y,m,E){if(c!==p||d!==y){var f=m.push(i(m)+"scale(",null,",",null,")");E.push({i:f-4,x:st(c,p)},{i:f-2,x:st(d,y)})}else(p!==1||y!==1)&&m.push(i(m)+"scale("+p+","+y+")")}return function(c,d){var p=[],y=[];return c=e(c),d=e(d),s(c.translateX,c.translateY,d.translateX,d.translateY,p,y),r(c.rotate,d.rotate,p,y),l(c.skewX,d.skewX,p,y),a(c.scaleX,c.scaleY,d.scaleX,d.scaleY,p,y),c=d=null,function(m){for(var E=-1,f=y.length,h;++E<f;)p[(h=y[E]).i]=h.x(m);return p.join("")}}}var za=ls(Oa,"px, ","px)","deg)"),Ba=ls(Ra,", ",")",")"),La=1e-12;function si(e){return((e=Math.exp(e))+1/e)/2}function Va(e){return((e=Math.exp(e))-1/e)/2}function Fa(e){return((e=Math.exp(2*e))-1)/(e+1)}const In=function e(t,n,o){function i(s,r){var l=s[0],a=s[1],c=s[2],d=r[0],p=r[1],y=r[2],m=d-l,E=p-a,f=m*m+E*E,h,C;if(f<La)C=Math.log(y/c)/t,h=function(Y){return[l+Y*m,a+Y*E,c*Math.exp(t*Y*C)]};else{var P=Math.sqrt(f),k=(y*y-c*c+o*f)/(2*c*n*P),w=(y*y-c*c-o*f)/(2*y*n*P),S=Math.log(Math.sqrt(k*k+1)-k),j=Math.log(Math.sqrt(w*w+1)-w);C=(j-S)/t,h=function(Y){var J=Y*C,ee=si(S),ie=c/(n*P)*(ee*Fa(t*J+S)-Va(S));return[l+ie*m,a+ie*E,c*ee/si(t*J+S)]}}return h.duration=C*1e3*t/Math.SQRT2,h}return i.rho=function(s){var r=Math.max(.001,+s),l=r*r,a=l*l;return e(r,l,a)},i}(Math.SQRT2,2,4);var Ut=0,tn=0,Jt=0,as=1e3,Bn,nn,Ln=0,Ot=0,Zn=0,fn=typeof performance=="object"&&performance.now?performance:Date,cs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Lo(){return Ot||(cs(Ha),Ot=fn.now()+Zn)}function Ha(){Ot=0}function Vn(){this._call=this._time=this._next=null}Vn.prototype=us.prototype={constructor:Vn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Lo():+n)+(t==null?0:+t),!this._next&&nn!==this&&(nn?nn._next=this:Bn=this,nn=this),this._call=e,this._time=n,So()},stop:function(){this._call&&(this._call=null,this._time=1/0,So())}};function us(e,t,n){var o=new Vn;return o.restart(e,t,n),o}function Ga(){Lo(),++Ut;for(var e=Bn,t;e;)(t=Ot-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ut}function ri(){Ot=(Ln=fn.now())+Zn,Ut=tn=0;try{Ga()}finally{Ut=0,Wa(),Ot=0}}function Ya(){var e=fn.now(),t=e-Ln;t>as&&(Zn-=t,Ln=e)}function Wa(){for(var e,t=Bn,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bn=n);nn=e,So(o)}function So(e){if(!Ut){tn&&(tn=clearTimeout(tn));var t=e-Ot;t>24?(e<1/0&&(tn=setTimeout(ri,e-fn.now()-Zn)),Jt&&(Jt=clearInterval(Jt))):(Jt||(Ln=fn.now(),Jt=setInterval(Ya,as)),Ut=1,cs(ri))}}function li(e,t,n){var o=new Vn;return t=t==null?0:+t,o.restart(i=>{o.stop(),e(i+t)},t,n),o}var Ua=Un("start","end","cancel","interrupt"),Xa=[],ds=0,ai=1,No=2,Tn=3,ci=4,Co=5,Mn=6;function qn(e,t,n,o,i,s){var r=e.__transition;if(!r)e.__transition={};else if(n in r)return;Za(e,n,{name:t,index:o,group:i,on:Ua,tween:Xa,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ds})}function Vo(e,t){var n=tt(e,t);if(n.state>ds)throw new Error("too late; already scheduled");return n}function ut(e,t){var n=tt(e,t);if(n.state>Tn)throw new Error("too late; already running");return n}function tt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Za(e,t,n){var o=e.__transition,i;o[t]=n,n.timer=us(s,0,n.time);function s(c){n.state=ai,n.timer.restart(r,n.delay,n.time),n.delay<=c&&r(c-n.delay)}function r(c){var d,p,y,m;if(n.state!==ai)return a();for(d in o)if(m=o[d],m.name===n.name){if(m.state===Tn)return li(r);m.state===ci?(m.state=Mn,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete o[d]):+d<t&&(m.state=Mn,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete o[d])}if(li(function(){n.state===Tn&&(n.state=ci,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=No,n.on.call("start",e,e.__data__,n.index,n.group),n.state===No){for(n.state=Tn,i=new Array(y=n.tween.length),d=0,p=-1;d<y;++d)(m=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(i[++p]=m);i.length=p+1}}function l(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(a),n.state=Co,1),p=-1,y=i.length;++p<y;)i[p].call(e,d);n.state===Co&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){n.state=Mn,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function Dn(e,t){var n=e.__transition,o,i,s=!0,r;if(n){t=t==null?null:t+"";for(r in n){if((o=n[r]).name!==t){s=!1;continue}i=o.state>No&&o.state<Co,o.state=Mn,o.timer.stop(),o.on.call(i?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[r]}s&&delete e.__transition}}function qa(e){return this.each(function(){Dn(this,e)})}function Ka(e,t){var n,o;return function(){var i=ut(this,e),s=i.tween;if(s!==n){o=n=s;for(var r=0,l=o.length;r<l;++r)if(o[r].name===t){o=o.slice(),o.splice(r,1);break}}i.tween=o}}function ja(e,t,n){var o,i;if(typeof n!="function")throw new Error;return function(){var s=ut(this,e),r=s.tween;if(r!==o){i=(o=r).slice();for(var l={name:t,value:n},a=0,c=i.length;a<c;++a)if(i[a].name===t){i[a]=l;break}a===c&&i.push(l)}s.tween=i}}function Ja(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=tt(this.node(),n).tween,i=0,s=o.length,r;i<s;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((t==null?Ka:ja)(n,e,t))}function Fo(e,t,n){var o=e._id;return e.each(function(){var i=ut(this,o);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return tt(i,o).value[t]}}function fs(e,t){var n;return(typeof t=="number"?st:t instanceof Pt?zn:(n=Pt(t))?(t=n,zn):ss)(e,t)}function Qa(e){return function(){this.removeAttribute(e)}}function ec(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tc(e,t,n){var o,i=n+"",s;return function(){var r=this.getAttribute(e);return r===i?null:r===o?s:s=t(o=r,n)}}function nc(e,t,n){var o,i=n+"",s;return function(){var r=this.getAttributeNS(e.space,e.local);return r===i?null:r===o?s:s=t(o=r,n)}}function oc(e,t,n){var o,i,s;return function(){var r,l=n(this),a;return l==null?void this.removeAttribute(e):(r=this.getAttribute(e),a=l+"",r===a?null:r===o&&a===i?s:(i=a,s=t(o=r,l)))}}function ic(e,t,n){var o,i,s;return function(){var r,l=n(this),a;return l==null?void this.removeAttributeNS(e.space,e.local):(r=this.getAttributeNS(e.space,e.local),a=l+"",r===a?null:r===o&&a===i?s:(i=a,s=t(o=r,l)))}}function sc(e,t){var n=Xn(e),o=n==="transform"?Ba:fs;return this.attrTween(e,typeof t=="function"?(n.local?ic:oc)(n,o,Fo(this,"attr."+e,t)):t==null?(n.local?ec:Qa)(n):(n.local?nc:tc)(n,o,t))}function rc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function lc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ac(e,t){var n,o;function i(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&lc(e,s)),n}return i._value=t,i}function cc(e,t){var n,o;function i(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&rc(e,s)),n}return i._value=t,i}function uc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Xn(e);return this.tween(n,(o.local?ac:cc)(o,t))}function dc(e,t){return function(){Vo(this,e).delay=+t.apply(this,arguments)}}function fc(e,t){return t=+t,function(){Vo(this,e).delay=t}}function pc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dc:fc)(t,e)):tt(this.node(),t).delay}function gc(e,t){return function(){ut(this,e).duration=+t.apply(this,arguments)}}function hc(e,t){return t=+t,function(){ut(this,e).duration=t}}function mc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gc:hc)(t,e)):tt(this.node(),t).duration}function vc(e,t){if(typeof t!="function")throw new Error;return function(){ut(this,e).ease=t}}function yc(e){var t=this._id;return arguments.length?this.each(vc(t,e)):tt(this.node(),t).ease}function wc(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ut(this,e).ease=n}}function xc(e){if(typeof e!="function")throw new Error;return this.each(wc(this._id,e))}function _c(e){typeof e!="function"&&(e=Yi(e));for(var t=this._groups,n=t.length,o=new Array(n),i=0;i<n;++i)for(var s=t[i],r=s.length,l=o[i]=[],a,c=0;c<r;++c)(a=s[c])&&e.call(a,a.__data__,c,s)&&l.push(a);return new wt(o,this._parents,this._name,this._id)}function bc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,i=n.length,s=Math.min(o,i),r=new Array(o),l=0;l<s;++l)for(var a=t[l],c=n[l],d=a.length,p=r[l]=new Array(d),y,m=0;m<d;++m)(y=a[m]||c[m])&&(p[m]=y);for(;l<o;++l)r[l]=t[l];return new wt(r,this._parents,this._name,this._id)}function Ec(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function kc(e,t,n){var o,i,s=Ec(t)?Vo:ut;return function(){var r=s(this,e),l=r.on;l!==o&&(i=(o=l).copy()).on(t,n),r.on=i}}function Sc(e,t){var n=this._id;return arguments.length<2?tt(this.node(),n).on.on(e):this.each(kc(n,e,t))}function Nc(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Cc(){return this.on("end.remove",Nc(this._id))}function $c(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Oo(e));for(var o=this._groups,i=o.length,s=new Array(i),r=0;r<i;++r)for(var l=o[r],a=l.length,c=s[r]=new Array(a),d,p,y=0;y<a;++y)(d=l[y])&&(p=e.call(d,d.__data__,y,l))&&("__data__"in d&&(p.__data__=d.__data__),c[y]=p,qn(c[y],t,n,y,c,tt(d,n)));return new wt(s,this._parents,t,n)}function Ic(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gi(e));for(var o=this._groups,i=o.length,s=[],r=[],l=0;l<i;++l)for(var a=o[l],c=a.length,d,p=0;p<c;++p)if(d=a[p]){for(var y=e.call(d,d.__data__,p,a),m,E=tt(d,n),f=0,h=y.length;f<h;++f)(m=y[f])&&qn(m,t,n,f,y,E);s.push(y),r.push(d)}return new wt(s,r,t,n)}var Tc=mn.prototype.constructor;function Mc(){return new Tc(this._groups,this._parents)}function Dc(e,t){var n,o,i;return function(){var s=Wt(this,e),r=(this.style.removeProperty(e),Wt(this,e));return s===r?null:s===n&&r===o?i:i=t(n=s,o=r)}}function ps(e){return function(){this.style.removeProperty(e)}}function Ac(e,t,n){var o,i=n+"",s;return function(){var r=Wt(this,e);return r===i?null:r===o?s:s=t(o=r,n)}}function Pc(e,t,n){var o,i,s;return function(){var r=Wt(this,e),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(e),Wt(this,e))),r===a?null:r===o&&a===i?s:(i=a,s=t(o=r,l))}}function Oc(e,t){var n,o,i,s="style."+t,r="end."+s,l;return function(){var a=ut(this,e),c=a.on,d=a.value[s]==null?l||(l=ps(t)):void 0;(c!==n||i!==d)&&(o=(n=c).copy()).on(r,i=d),a.on=o}}function Rc(e,t,n){var o=(e+="")=="transform"?za:fs;return t==null?this.styleTween(e,Dc(e,o)).on("end.style."+e,ps(e)):typeof t=="function"?this.styleTween(e,Pc(e,o,Fo(this,"style."+e,t))).each(Oc(this._id,e)):this.styleTween(e,Ac(e,o,t),n).on("end.style."+e,null)}function zc(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function Bc(e,t,n){var o,i;function s(){var r=t.apply(this,arguments);return r!==i&&(o=(i=r)&&zc(e,r,n)),o}return s._value=t,s}function Lc(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Bc(e,t,n??""))}function Vc(e){return function(){this.textContent=e}}function Fc(e){return function(){var t=e(this);this.textContent=t??""}}function Hc(e){return this.tween("text",typeof e=="function"?Fc(Fo(this,"text",e)):Vc(e==null?"":e+""))}function Gc(e){return function(t){this.textContent=e.call(this,t)}}function Yc(e){var t,n;function o(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&Gc(i)),t}return o._value=e,o}function Wc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Yc(e))}function Uc(){for(var e=this._name,t=this._id,n=gs(),o=this._groups,i=o.length,s=0;s<i;++s)for(var r=o[s],l=r.length,a,c=0;c<l;++c)if(a=r[c]){var d=tt(a,t);qn(a,e,n,c,r,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new wt(o,this._parents,e,n)}function Xc(){var e,t,n=this,o=n._id,i=n.size();return new Promise(function(s,r){var l={value:r},a={value:function(){--i===0&&s()}};n.each(function(){var c=ut(this,o),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(a)),c.on=t}),i===0&&s()})}var Zc=0;function wt(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function gs(){return++Zc}var ht=mn.prototype;wt.prototype={constructor:wt,select:$c,selectAll:Ic,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:_c,merge:bc,selection:Mc,transition:Uc,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:Sc,attr:sc,attrTween:uc,style:Rc,styleTween:Lc,text:Hc,textTween:Wc,remove:Cc,tween:Ja,delay:pc,duration:mc,ease:yc,easeVarying:xc,end:Xc,[Symbol.iterator]:ht[Symbol.iterator]};function qc(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Kc={time:null,delay:0,duration:250,ease:qc};function jc(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Jc(e){var t,n;e instanceof wt?(t=e._id,e=e._name):(t=gs(),(n=Kc).time=Lo(),e=e==null?null:e+"");for(var o=this._groups,i=o.length,s=0;s<i;++s)for(var r=o[s],l=r.length,a,c=0;c<l;++c)(a=r[c])&&qn(a,e,t,c,r,n||jc(a,t));return new wt(o,this._parents,e,t)}mn.prototype.interrupt=qa;mn.prototype.transition=Jc;const En=e=>()=>e;function Qc(e,{sourceEvent:t,target:n,transform:o,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:i}})}function vt(e,t,n){this.k=e,this.x=t,this.y=n}vt.prototype={constructor:vt,scale:function(e){return e===1?this:new vt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Xt=new vt(1,0,0);vt.prototype;function co(e){e.stopImmediatePropagation()}function Qt(e){e.preventDefault(),e.stopImmediatePropagation()}function eu(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ui(){return this.__zoom||Xt}function nu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ou(){return navigator.maxTouchPoints||"ontouchstart"in this}function iu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],r=e.invertY(t[1][1])-n[1][1];return e.translate(i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i),r>s?(s+r)/2:Math.min(0,s)||Math.max(0,r))}function su(){var e=eu,t=tu,n=iu,o=nu,i=ou,s=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],l=250,a=In,c=Un("start","zoom","end"),d,p,y,m=500,E=150,f=0,h=10;function C(b){b.property("__zoom",ui).on("wheel.zoom",J,{passive:!1}).on("mousedown.zoom",ee).on("dblclick.zoom",ie).filter(i).on("touchstart.zoom",D).on("touchmove.zoom",_).on("touchend.zoom touchcancel.zoom",se).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}C.transform=function(b,B,I,L){var H=b.selection?b.selection():b;H.property("__zoom",ui),b!==H?S(b,B,I,L):H.interrupt().each(function(){j(this,arguments).event(L).start().zoom(null,typeof B=="function"?B.apply(this,arguments):B).end()})},C.scaleBy=function(b,B,I,L){C.scaleTo(b,function(){var H=this.__zoom.k,Q=typeof B=="function"?B.apply(this,arguments):B;return H*Q},I,L)},C.scaleTo=function(b,B,I,L){C.transform(b,function(){var H=t.apply(this,arguments),Q=this.__zoom,K=I==null?w(H):typeof I=="function"?I.apply(this,arguments):I,ne=Q.invert(K),fe=typeof B=="function"?B.apply(this,arguments):B;return n(k(P(Q,fe),K,ne),H,r)},I,L)},C.translateBy=function(b,B,I,L){C.transform(b,function(){return n(this.__zoom.translate(typeof B=="function"?B.apply(this,arguments):B,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),r)},null,L)},C.translateTo=function(b,B,I,L,H){C.transform(b,function(){var Q=t.apply(this,arguments),K=this.__zoom,ne=L==null?w(Q):typeof L=="function"?L.apply(this,arguments):L;return n(Xt.translate(ne[0],ne[1]).scale(K.k).translate(typeof B=="function"?-B.apply(this,arguments):-B,typeof I=="function"?-I.apply(this,arguments):-I),Q,r)},L,H)};function P(b,B){return B=Math.max(s[0],Math.min(s[1],B)),B===b.k?b:new vt(B,b.x,b.y)}function k(b,B,I){var L=B[0]-I[0]*b.k,H=B[1]-I[1]*b.k;return L===b.x&&H===b.y?b:new vt(b.k,L,H)}function w(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function S(b,B,I,L){b.on("start.zoom",function(){j(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(L).end()}).tween("zoom",function(){var H=this,Q=arguments,K=j(H,Q).event(L),ne=t.apply(H,Q),fe=I==null?w(ne):typeof I=="function"?I.apply(H,Q):I,me=Math.max(ne[1][0]-ne[0][0],ne[1][1]-ne[0][1]),te=H.__zoom,ce=typeof B=="function"?B.apply(H,Q):B,re=a(te.invert(fe).concat(me/te.k),ce.invert(fe).concat(me/ce.k));return function(_e){if(_e===1)_e=ce;else{var ue=re(_e),ke=me/ue[2];_e=new vt(ke,fe[0]-ue[0]*ke,fe[1]-ue[1]*ke)}K.zoom(null,_e)}})}function j(b,B,I){return!I&&b.__zooming||new Y(b,B)}function Y(b,B){this.that=b,this.args=B,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,B),this.taps=0}Y.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,B){return this.mouse&&b!=="mouse"&&(this.mouse[1]=B.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=B.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=B.invert(this.touch1[0])),this.that.__zoom=B,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var B=Je(this.that).datum();c.call(b,this.that,new Qc(b,{sourceEvent:this.sourceEvent,target:C,transform:this.that.__zoom,dispatch:c}),B)}};function J(b,...B){if(!e.apply(this,arguments))return;var I=j(this,B).event(b),L=this.__zoom,H=Math.max(s[0],Math.min(s[1],L.k*Math.pow(2,o.apply(this,arguments)))),Q=it(b);if(I.wheel)(I.mouse[0][0]!==Q[0]||I.mouse[0][1]!==Q[1])&&(I.mouse[1]=L.invert(I.mouse[0]=Q)),clearTimeout(I.wheel);else{if(L.k===H)return;I.mouse=[Q,L.invert(Q)],Dn(this),I.start()}Qt(b),I.wheel=setTimeout(K,E),I.zoom("mouse",n(k(P(L,H),I.mouse[0],I.mouse[1]),I.extent,r));function K(){I.wheel=null,I.end()}}function ee(b,...B){if(y||!e.apply(this,arguments))return;var I=b.currentTarget,L=j(this,B,!0).event(b),H=Je(b.view).on("mousemove.zoom",fe,!0).on("mouseup.zoom",me,!0),Q=it(b,I),K=b.clientX,ne=b.clientY;es(b.view),co(b),L.mouse=[Q,this.__zoom.invert(Q)],Dn(this),L.start();function fe(te){if(Qt(te),!L.moved){var ce=te.clientX-K,re=te.clientY-ne;L.moved=ce*ce+re*re>f}L.event(te).zoom("mouse",n(k(L.that.__zoom,L.mouse[0]=it(te,I),L.mouse[1]),L.extent,r))}function me(te){H.on("mousemove.zoom mouseup.zoom",null),ts(te.view,L.moved),Qt(te),L.event(te).end()}}function ie(b,...B){if(e.apply(this,arguments)){var I=this.__zoom,L=it(b.changedTouches?b.changedTouches[0]:b,this),H=I.invert(L),Q=I.k*(b.shiftKey?.5:2),K=n(k(P(I,Q),L,H),t.apply(this,B),r);Qt(b),l>0?Je(this).transition().duration(l).call(S,K,L,b):Je(this).call(C.transform,K,L,b)}}function D(b,...B){if(e.apply(this,arguments)){var I=b.touches,L=I.length,H=j(this,B,b.changedTouches.length===L).event(b),Q,K,ne,fe;for(co(b),K=0;K<L;++K)ne=I[K],fe=it(ne,this),fe=[fe,this.__zoom.invert(fe),ne.identifier],H.touch0?!H.touch1&&H.touch0[2]!==fe[2]&&(H.touch1=fe,H.taps=0):(H.touch0=fe,Q=!0,H.taps=1+!!d);d&&(d=clearTimeout(d)),Q&&(H.taps<2&&(p=fe[0],d=setTimeout(function(){d=null},m)),Dn(this),H.start())}}function _(b,...B){if(this.__zooming){var I=j(this,B).event(b),L=b.changedTouches,H=L.length,Q,K,ne,fe;for(Qt(b),Q=0;Q<H;++Q)K=L[Q],ne=it(K,this),I.touch0&&I.touch0[2]===K.identifier?I.touch0[0]=ne:I.touch1&&I.touch1[2]===K.identifier&&(I.touch1[0]=ne);if(K=I.that.__zoom,I.touch1){var me=I.touch0[0],te=I.touch0[1],ce=I.touch1[0],re=I.touch1[1],_e=(_e=ce[0]-me[0])*_e+(_e=ce[1]-me[1])*_e,ue=(ue=re[0]-te[0])*ue+(ue=re[1]-te[1])*ue;K=P(K,Math.sqrt(_e/ue)),ne=[(me[0]+ce[0])/2,(me[1]+ce[1])/2],fe=[(te[0]+re[0])/2,(te[1]+re[1])/2]}else if(I.touch0)ne=I.touch0[0],fe=I.touch0[1];else return;I.zoom("touch",n(k(K,ne,fe),I.extent,r))}}function se(b,...B){if(this.__zooming){var I=j(this,B).event(b),L=b.changedTouches,H=L.length,Q,K;for(co(b),y&&clearTimeout(y),y=setTimeout(function(){y=null},m),Q=0;Q<H;++Q)K=L[Q],I.touch0&&I.touch0[2]===K.identifier?delete I.touch0:I.touch1&&I.touch1[2]===K.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(K=it(K,this),Math.hypot(p[0]-K[0],p[1]-K[1])<h)){var ne=Je(this).on("dblclick.zoom");ne&&ne.apply(this,arguments)}}}return C.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:En(+b),C):o},C.filter=function(b){return arguments.length?(e=typeof b=="function"?b:En(!!b),C):e},C.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:En(!!b),C):i},C.extent=function(b){return arguments.length?(t=typeof b=="function"?b:En([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),C):t},C.scaleExtent=function(b){return arguments.length?(s[0]=+b[0],s[1]=+b[1],C):[s[0],s[1]]},C.translateExtent=function(b){return arguments.length?(r[0][0]=+b[0][0],r[1][0]=+b[1][0],r[0][1]=+b[0][1],r[1][1]=+b[1][1],C):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},C.constrain=function(b){return arguments.length?(n=b,C):n},C.duration=function(b){return arguments.length?(l=+b,C):l},C.interpolate=function(b){return arguments.length?(a=b,C):a},C.on=function(){var b=c.on.apply(c,arguments);return b===c?C:b},C.clickDistance=function(b){return arguments.length?(f=(b=+b)*b,C):Math.sqrt(f)},C.tapDistance=function(b){return arguments.length?(h=+b,C):h},C}var X=(e=>(e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom",e))(X||{}),Ho=(e=>(e.Partial="partial",e.Full="full",e))(Ho||{}),It=(e=>(e.Bezier="default",e.SimpleBezier="simple-bezier",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e))(It||{}),kt=(e=>(e.Strict="strict",e.Loose="loose",e))(kt||{}),$o=(e=>(e.Arrow="arrow",e.ArrowClosed="arrowclosed",e))($o||{}),ln=(e=>(e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal",e))(ln||{});const ru=["INPUT","SELECT","TEXTAREA"],lu=typeof document<"u"?document:null;function Io(e){var t,n;const o=((n=(t=e.composedPath)==null?void 0:t.call(e))==null?void 0:n[0])||e.target,i=typeof o?.hasAttribute=="function"?o.hasAttribute("contenteditable"):!1,s=typeof o?.closest=="function"?o.closest(".nokey"):null;return ru.includes(o?.nodeName)||i||!!s}function au(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function di(e,t,n,o){const i=t.replace("+",`
`).replace(`

`,`
+`).split(`
`).map(r=>r.trim().toLowerCase());if(i.length===1)return e.toLowerCase()===t.toLowerCase();o||n.add(e.toLowerCase());const s=i.every((r,l)=>n.has(r)&&Array.from(n.values())[l]===i[l]);return o&&n.delete(e.toLowerCase()),s}function cu(e,t){return n=>{if(!n.code&&!n.key)return!1;const o=uu(n.code,e);return Array.isArray(e)?e.some(i=>di(n[o],i,t,n.type==="keyup")):di(n[o],e,t,n.type==="keyup")}}function uu(e,t){return t.includes(e)?"code":"key"}function an(e,t){const n=W(()=>Ce(t?.target)??lu),o=An(Ce(e)===!0);let i=!1;const s=new Set;let r=a(Ce(e));Me(()=>Ce(e),(c,d)=>{typeof d=="boolean"&&typeof c!="boolean"&&l(),r=a(c)},{immediate:!0}),Fi(["blur","contextmenu"],l),Xo((...c)=>r(...c),c=>{var d,p;const y=Ce(t?.actInsideInputWithModifier)??!0,m=Ce(t?.preventDefault)??!1;if(i=au(c),(!i||i&&!y)&&Io(c))return;const f=((p=(d=c.composedPath)==null?void 0:d.call(c))==null?void 0:p[0])||c.target,h=f?.nodeName==="BUTTON"||f?.nodeName==="A";!m&&(i||!h)&&c.preventDefault(),o.value=!0},{eventName:"keydown",target:n}),Xo((...c)=>r(...c),c=>{const d=Ce(t?.actInsideInputWithModifier)??!0;if(o.value){if((!i||i&&!d)&&Io(c))return;i=!1,o.value=!1}},{eventName:"keyup",target:n});function l(){i=!1,s.clear(),o.value=Ce(e)===!0}function a(c){return c===null?(l(),()=>!1):typeof c=="boolean"?(l(),o.value=c,()=>!1):Array.isArray(c)||typeof c=="string"?cu(c,s):c}return o}const hs="vue-flow__node-desc",ms="vue-flow__edge-desc",du="vue-flow__aria-live",vs=["Enter"," ","Escape"],Gt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Fn(e){return{...e.computedPosition||{x:0,y:0},width:e.dimensions.width||0,height:e.dimensions.height||0}}function Hn(e,t){const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)}function Kn(e){return{width:e.offsetWidth,height:e.offsetHeight}}function Rt(e,t=0,n=1){return Math.min(Math.max(e,t),n)}function ys(e,t){return{x:Rt(e.x,t[0][0],t[1][0]),y:Rt(e.y,t[0][1],t[1][1])}}function fi(e){const t=e.getRootNode();return"elementFromPoint"in t?t:window.document}function St(e){return e&&typeof e=="object"&&"id"in e&&"source"in e&&"target"in e}function At(e){return e&&typeof e=="object"&&"id"in e&&"position"in e&&!St(e)}function on(e){return At(e)&&"computedPosition"in e}function kn(e){return!Number.isNaN(e)&&Number.isFinite(e)}function fu(e){return kn(e.width)&&kn(e.height)&&kn(e.x)&&kn(e.y)}function pu(e,t,n){const o={id:e.id.toString(),type:e.type??"default",dimensions:sn({width:0,height:0}),computedPosition:sn({z:0,...e.position}),handleBounds:{source:[],target:[]},draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,isParent:!1,position:{x:0,y:0},data:Ve(e.data)?e.data:{},events:sn(Ve(e.events)?e.events:{})};return Object.assign(t??o,e,{id:e.id.toString(),parentNode:n})}function ws(e,t,n){var o,i;const s={id:e.id.toString(),type:e.type??t?.type??"default",source:e.source.toString(),target:e.target.toString(),sourceHandle:(o=e.sourceHandle)==null?void 0:o.toString(),targetHandle:(i=e.targetHandle)==null?void 0:i.toString(),updatable:e.updatable??n?.updatable,selectable:e.selectable??n?.selectable,focusable:e.focusable??n?.focusable,data:Ve(e.data)?e.data:{},events:sn(Ve(e.events)?e.events:{}),label:e.label??"",interactionWidth:e.interactionWidth??n?.interactionWidth,...n??{}};return Object.assign(t??s,e,{id:e.id.toString()})}function xs(e,t,n,o){const i=typeof e=="string"?e:e.id,s=new Set,r=o==="source"?"target":"source";for(const l of n)l[r]===i&&s.add(l[o]);return t.filter(l=>s.has(l.id))}function gu(...e){if(e.length===3){const[s,r,l]=e;return xs(s,r,l,"target")}const[t,n]=e,o=typeof t=="string"?t:t.id;return n.filter(s=>St(s)&&s.source===o).map(s=>n.find(r=>At(r)&&r.id===s.target))}function hu(...e){if(e.length===3){const[s,r,l]=e;return xs(s,r,l,"source")}const[t,n]=e,o=typeof t=="string"?t:t.id;return n.filter(s=>St(s)&&s.target===o).map(s=>n.find(r=>At(r)&&r.id===s.source))}function _s({source:e,sourceHandle:t,target:n,targetHandle:o}){return`vueflow__edge-${e}${t??""}-${n}${o??""}`}function mu(e,t){return t.some(n=>St(n)&&n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle))}function To({x:e,y:t},{x:n,y:o,zoom:i}){return{x:e*i+n,y:t*i+o}}function pn({x:e,y:t},{x:n,y:o,zoom:i},s=!1,r=[1,1]){const l={x:(e-n)/i,y:(t-o)/i};return s?jn(l,r):l}function vu(e,t){return{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}}function bs({x:e,y:t,width:n,height:o}){return{x:e,y:t,x2:e+n,y2:t+o}}function yu({x:e,y:t,x2:n,y2:o}){return{x:e,y:t,width:n-e,height:o-t}}function Es(e){let t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,x2:Number.NEGATIVE_INFINITY,y2:Number.NEGATIVE_INFINITY};for(let n=0;n<e.length;n++){const o=e[n];t=vu(t,bs({...o.computedPosition,...o.dimensions}))}return yu(t)}function ks(e,t,n={x:0,y:0,zoom:1},o=!1,i=!1){const s={...pn(t,n),width:t.width/n.zoom,height:t.height/n.zoom},r=[];for(const l of e){const{dimensions:a,selectable:c=!0,hidden:d=!1}=l,p=a.width??l.width??null,y=a.height??l.height??null;if(i&&!c||d)continue;const m=Hn(s,Fn(l)),E=p===null||y===null,f=o&&m>0,h=(p??0)*(y??0);(E||f||m>=h||l.dragging)&&r.push(l)}return r}function Ss(e,t){const n=new Set;if(typeof e=="string")n.add(e);else if(e.length>=1)for(const o of e)n.add(o.id);return t.filter(o=>n.has(o.source)||n.has(o.target))}function pi(e,t,n,o,i,s=.1,r={x:0,y:0}){const l=t/(e.width*(1+s)),a=n/(e.height*(1+s)),c=Math.min(l,a),d=Rt(c,o,i),p=e.x+e.width/2,y=e.y+e.height/2,m=t/2-p*d+(r.x??0),E=n/2-y*d+(r.y??0);return{x:m,y:E,zoom:d}}function wu(e,t){return{x:t.x+e.x,y:t.y+e.y,z:(e.z>t.z?e.z:t.z)+1}}function Ns(e,t){if(!e.parentNode)return!1;const n=t(e.parentNode);return n?n.selected?!0:Ns(n,t):!1}function gn(e,t){return typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`}function gi(e){const t=e.ctrlKey&&Gn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t}function hi(e,t,n){return e<t?Rt(Math.abs(e-t),1,t)/t:e>n?-Rt(Math.abs(e-n),1,t)/t:0}function Cs(e,t,n=15,o=40){const i=hi(e.x,o,t.width-o)*n,s=hi(e.y,o,t.height-o)*n;return[i,s]}function uo(e,t){if(t){const n=e.position.x+e.dimensions.width-t.dimensions.width,o=e.position.y+e.dimensions.height-t.dimensions.height;if(n>0||o>0||e.position.x<0||e.position.y<0){let i={};if(typeof t.style=="function"?i={...t.style(t)}:t.style&&(i={...t.style}),i.width=i.width??`${t.dimensions.width}px`,i.height=i.height??`${t.dimensions.height}px`,n>0)if(typeof i.width=="string"){const s=Number(i.width.replace("px",""));i.width=`${s+n}px`}else i.width+=n;if(o>0)if(typeof i.height=="string"){const s=Number(i.height.replace("px",""));i.height=`${s+o}px`}else i.height+=o;if(e.position.x<0){const s=Math.abs(e.position.x);if(t.position.x=t.position.x-s,typeof i.width=="string"){const r=Number(i.width.replace("px",""));i.width=`${r+s}px`}else i.width+=s;e.position.x=0}if(e.position.y<0){const s=Math.abs(e.position.y);if(t.position.y=t.position.y-s,typeof i.height=="string"){const r=Number(i.height.replace("px",""));i.height=`${r+s}px`}else i.height+=s;e.position.y=0}t.dimensions.width=Number(i.width.toString().replace("px","")),t.dimensions.height=Number(i.height.toString().replace("px","")),typeof t.style=="function"?t.style=s=>{const r=t.style;return{...r(s),...i}}:t.style={...t.style,...i}}}}function mi(e,t){var n,o;const i=e.filter(r=>r.type==="add"||r.type==="remove");for(const r of i)if(r.type==="add")t.findIndex(a=>a.id===r.item.id)===-1&&t.push(r.item);else if(r.type==="remove"){const l=t.findIndex(a=>a.id===r.id);l!==-1&&t.splice(l,1)}const s=t.map(r=>r.id);for(const r of t)for(const l of e)if(l.id===r.id)switch(l.type){case"select":r.selected=l.selected;break;case"position":if(on(r)&&(typeof l.position<"u"&&(r.position=l.position),typeof l.dragging<"u"&&(r.dragging=l.dragging),r.expandParent&&r.parentNode)){const a=t[s.indexOf(r.parentNode)];a&&on(a)&&uo(r,a)}break;case"dimensions":if(on(r)&&(typeof l.dimensions<"u"&&(r.dimensions=l.dimensions),typeof l.updateStyle<"u"&&l.updateStyle&&(r.style={...r.style||{},width:`${(n=l.dimensions)==null?void 0:n.width}px`,height:`${(o=l.dimensions)==null?void 0:o.height}px`}),typeof l.resizing<"u"&&(r.resizing=l.resizing),r.expandParent&&r.parentNode)){const a=t[s.indexOf(r.parentNode)];a&&on(a)&&(!!a.dimensions.width&&!!a.dimensions.height?uo(r,a):et(()=>{uo(r,a)}))}break}return t}function _t(e,t){return{id:e,type:"select",selected:t}}function vi(e){return{item:e,type:"add"}}function yi(e){return{id:e,type:"remove"}}function wi(e,t,n,o,i){return{id:e,source:t,target:n,sourceHandle:o||null,targetHandle:i||null,type:"remove"}}function bt(e,t=new Set,n=!1){const o=[];for(const[i,s]of e){const r=t.has(i);!(s.selected===void 0&&!r)&&s.selected!==r&&(n&&(s.selected=r),o.push(_t(s.id,r)))}return o}function oe(e){const t=new Set;let n=!1;const o=()=>t.size>0;e&&(n=!0,t.add(e));const i=l=>{t.delete(l)};return{on:l=>{e&&n&&t.delete(e),t.add(l);const a=()=>{i(l),e&&n&&t.add(e)};return Wn(a),{off:a}},off:i,trigger:l=>Promise.all(Array.from(t).map(a=>a(l))),hasListeners:o,fns:t}}function xi(e,t,n){let o=e;do{if(o&&o.matches(t))return!0;if(o===n)return!1;o=o.parentElement}while(o);return!1}function xu(e,t,n,o,i){var s,r;const l=[];for(const a of e)(a.selected||a.id===i)&&(!a.parentNode||!Ns(a,o))&&(a.draggable||t&&typeof a.draggable>"u")&&l.push(sn({id:a.id,position:a.position||{x:0,y:0},distance:{x:n.x-((s=a.computedPosition)==null?void 0:s.x)||0,y:n.y-((r=a.computedPosition)==null?void 0:r.y)||0},from:a.computedPosition,extent:a.extent,parentNode:a.parentNode,dimensions:a.dimensions,expandParent:a.expandParent}));return l}function fo({id:e,dragItems:t,findNode:n}){const o=[];for(const i of t){const s=n(i.id);s&&o.push(s)}return[e?o.find(i=>i.id===e):o[0],o]}function $s(e){if(Array.isArray(e))switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e;default:return[0,0,0,0]}return[e,e,e,e]}function _u(e,t,n){const[o,i,s,r]=typeof e!="string"?$s(e.padding):[0,0,0,0];return n&&typeof n.computedPosition.x<"u"&&typeof n.computedPosition.y<"u"&&typeof n.dimensions.width<"u"&&typeof n.dimensions.height<"u"?[[n.computedPosition.x+r,n.computedPosition.y+o],[n.computedPosition.x+n.dimensions.width-i,n.computedPosition.y+n.dimensions.height-s]]:!1}function bu(e,t,n,o){let i=e.extent||n;if((i==="parent"||!Array.isArray(i)&&i?.range==="parent")&&!e.expandParent)if(e.parentNode&&o&&e.dimensions.width&&e.dimensions.height){const s=_u(i,e,o);s&&(i=s)}else t(new Ge(Fe.NODE_EXTENT_INVALID,e.id)),i=n;else if(Array.isArray(i)){const s=o?.computedPosition.x||0,r=o?.computedPosition.y||0;i=[[i[0][0]+s,i[0][1]+r],[i[1][0]+s,i[1][1]+r]]}else if(i!=="parent"&&i?.range&&Array.isArray(i.range)){const[s,r,l,a]=$s(i.padding),c=o?.computedPosition.x||0,d=o?.computedPosition.y||0;i=[[i.range[0][0]+c+a,i.range[0][1]+d+s],[i.range[1][0]+c-r,i.range[1][1]+d-l]]}return i==="parent"?[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]]:i}function Eu({width:e,height:t},n){return[n[0],[n[1][0]-(e||0),n[1][1]-(t||0)]]}function Go(e,t,n,o,i){const s=Eu(e.dimensions,bu(e,n,o,i)),r=ys(t,s);return{position:{x:r.x-(i?.computedPosition.x||0),y:r.y-(i?.computedPosition.y||0)},computedPosition:r}}function Zt(e,t,n=X.Left,o=!1){const i=(t?.x??0)+e.computedPosition.x,s=(t?.y??0)+e.computedPosition.y,{width:r,height:l}=t??Cu(e);if(o)return{x:i+r/2,y:s+l/2};switch(t?.position??n){case X.Top:return{x:i+r/2,y:s};case X.Right:return{x:i+r,y:s+l/2};case X.Bottom:return{x:i+r/2,y:s+l};case X.Left:return{x:i,y:s+l/2}}}function _i(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ku({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:i,targetHeight:s,width:r,height:l,viewport:a}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+o,t.y+s)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=bs({x:(0-a.x)/a.zoom,y:(0-a.y)/a.zoom,width:r/a.zoom,height:l/a.zoom}),p=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),y=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(p*y)>0}function Su(e,t,n=!1){const o=typeof e.zIndex=="number";let i=o?e.zIndex:0;const s=t(e.source),r=t(e.target);return!s||!r?0:(n&&(i=o?e.zIndex:Math.max(s.computedPosition.z||0,r.computedPosition.z||0)),i)}var Fe=(e=>(e.MISSING_STYLES="MISSING_STYLES",e.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",e.NODE_INVALID="NODE_INVALID",e.NODE_NOT_FOUND="NODE_NOT_FOUND",e.NODE_MISSING_PARENT="NODE_MISSING_PARENT",e.NODE_TYPE_MISSING="NODE_TYPE_MISSING",e.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",e.EDGE_INVALID="EDGE_INVALID",e.EDGE_NOT_FOUND="EDGE_NOT_FOUND",e.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",e.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",e.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",e.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",e.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",e.EDGE_ORPHANED="EDGE_ORPHANED",e.USEVUEFLOW_OPTIONS="USEVUEFLOW_OPTIONS",e))(Fe||{});const bi={MISSING_STYLES:()=>"It seems that you haven't loaded the necessary styles. Please import '@vue-flow/core/dist/style.css' to ensure that the graph is rendered correctly",MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_INVALID:e=>`Node is invalid
Node: ${e}`,NODE_NOT_FOUND:e=>`Node not found
Node: ${e}`,NODE_MISSING_PARENT:(e,t)=>`Node is missing a parent
Node: ${e}
Parent: ${t}`,NODE_TYPE_MISSING:e=>`Node type is missing
Type: ${e}`,NODE_EXTENT_INVALID:e=>`Only child nodes can use a parent extent
Node: ${e}`,EDGE_INVALID:e=>`An edge needs a source and a target
Edge: ${e}`,EDGE_SOURCE_MISSING:(e,t)=>`Edge source is missing
Edge: ${e} 
Source: ${t}`,EDGE_TARGET_MISSING:(e,t)=>`Edge target is missing
Edge: ${e} 
Target: ${t}`,EDGE_TYPE_MISSING:e=>`Edge type is missing
Type: ${e}`,EDGE_SOURCE_TARGET_SAME:(e,t,n)=>`Edge source and target are the same
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_SOURCE_TARGET_MISSING:(e,t,n)=>`Edge source or target is missing
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_ORPHANED:e=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${e}`,EDGE_NOT_FOUND:e=>`Edge not found
Edge: ${e}`,USEVUEFLOW_OPTIONS:()=>"The options parameter is deprecated and will be removed in the next major version. Please use the id parameter instead"};class Ge extends Error{constructor(t,...n){var o;super((o=bi[t])==null?void 0:o.call(bi,...n)),this.name="VueFlowError",this.code=t,this.args=n}}function Yo(e){return"clientX"in e}function Nu(e){return"sourceEvent"in e}function rt(e,t){const n=Yo(e);let o,i;return n?(o=e.clientX,i=e.clientY):"touches"in e&&e.touches.length>0?(o=e.touches[0].clientX,i=e.touches[0].clientY):"changedTouches"in e&&e.changedTouches.length>0?(o=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY):(o=0,i=0),{x:o-(t?.left??0),y:i-(t?.top??0)}}const Gn=()=>{var e;return typeof navigator<"u"&&((e=navigator?.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Cu(e){var t,n;return{width:((t=e.dimensions)==null?void 0:t.width)??e.width??0,height:((n=e.dimensions)==null?void 0:n.height)??e.height??0}}function jn(e,t=[1,1]){return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}}const $u=()=>!0;function po(e){e?.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function Iu(e,t,n){const o=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())Hn(i,Fn(s))>0&&o.push(s);return o}const Tu=250;function Mu(e,t,n,o){var i,s;let r=[],l=Number.POSITIVE_INFINITY;const a=Iu(e,n,t+Tu);for(const c of a){const d=[...((i=c.handleBounds)==null?void 0:i.source)??[],...((s=c.handleBounds)==null?void 0:s.target)??[]];for(const p of d){if(o.nodeId===p.nodeId&&o.type===p.type&&o.id===p.id)continue;const{x:y,y:m}=Zt(c,p,p.position,!0),E=Math.sqrt((y-e.x)**2+(m-e.y)**2);E>t||(E<l?(r=[{...p,x:y,y:m}],l=E):E===l&&r.push({...p,x:y,y:m}))}}if(!r.length)return null;if(r.length>1){const c=o.type==="source"?"target":"source";return r.find(d=>d.type===c)??r[0]}return r[0]}function Ei(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:i,fromType:s,doc:r,lib:l,flowId:a,isValidConnection:c=$u},d,p,y){const m=s==="target",E=t?r.querySelector(`.${l}-flow__handle[data-id="${a}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:f,y:h}=rt(e),C=r.elementFromPoint(f,h),P=C?.classList.contains(`${l}-flow__handle`)?C:E,k={handleDomNode:P,isValid:!1,connection:null,toHandle:null};if(P){const w=Is(void 0,P),S=P.getAttribute("data-nodeid"),j=P.getAttribute("data-handleid"),Y=P.classList.contains("connectable"),J=P.classList.contains("connectableend");if(!S||!w)return k;const ee={source:m?S:o,sourceHandle:m?j:i,target:m?o:S,targetHandle:m?i:j};k.connection=ee;const D=Y&&J&&(n===kt.Strict?m&&w==="source"||!m&&w==="target":S!==o||j!==i);k.isValid=D&&c(ee,{nodes:p,edges:d,sourceNode:y(ee.source),targetNode:y(ee.target)}),k.toHandle=t}return k}function Is(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Du(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Au(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}function Pu(e,t,n,o,i,s=!1){var r,l,a;const c=o.get(e);if(!c)return null;const d=i===kt.Strict?(r=c.handleBounds)==null?void 0:r[t]:[...((l=c.handleBounds)==null?void 0:l.source)??[],...((a=c.handleBounds)==null?void 0:a.target)??[]],p=(n?d?.find(y=>y.id===n):d?.[0])??null;return p&&s?{...p,...Zt(c,p,p.position,!0)}:p}const Mo={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top},Ou=["production","prod"];function Jn(e,...t){Ts()&&console.warn(`[Vue Flow]: ${e}`,...t)}function Ts(){return!Ou.includes("production")}function ki(e,t,n,o,i){const s=t.querySelectorAll(`.vue-flow__handle.${e}`);return s?.length?Array.from(s).map(r=>{const l=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),type:e,nodeId:i,position:r.getAttribute("data-handlepos"),x:(l.left-n.left)/o,y:(l.top-n.top)/o,...Kn(r)}}):null}function Do(e,t,n,o,i,s=!1,r){i.value=!1,e.selected?(s||e.selected&&t)&&(o([e]),et(()=>{r.blur()})):n([e])}function Ve(e){return typeof T(e)<"u"}function Ru(e,t,n,o){if(!e||!e.source||!e.target)return n(new Ge(Fe.EDGE_INVALID,e?.id??"[ID UNKNOWN]")),!1;let i;return St(e)?i=e:i={...e,id:_s(e)},i=ws(i,void 0,o),mu(i,t)?!1:i}function zu(e,t,n,o,i){if(!t.source||!t.target)return i(new Ge(Fe.EDGE_INVALID,e.id)),!1;if(!n)return i(new Ge(Fe.EDGE_NOT_FOUND,e.id)),!1;const{id:s,...r}=e;return{...r,id:o?_s(t):s,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}}function Si(e,t,n){const o={},i=[];for(let s=0;s<e.length;++s){const r=e[s];if(!At(r)){n(new Ge(Fe.NODE_INVALID,r?.id)||`[ID UNKNOWN|INDEX ${s}]`);continue}const l=pu(r,t(r.id),r.parentNode);r.parentNode&&(o[r.parentNode]=!0),i[s]=l}for(const s of i){const r=t(s.parentNode)||i.find(l=>l.id===s.parentNode);s.parentNode&&!r&&n(new Ge(Fe.NODE_MISSING_PARENT,s.id,s.parentNode)),(s.parentNode||o[s.id])&&(o[s.id]&&(s.isParent=!0),r&&(r.isParent=!0))}return i}function Ni(e,t,n,o,i,s){let r=i;const l=o.get(r)||new Map;o.set(r,l.set(n,t)),r=`${i}-${e}`;const a=o.get(r)||new Map;if(o.set(r,a.set(n,t)),s){r=`${i}-${e}-${s}`;const c=o.get(r)||new Map;o.set(r,c.set(n,t))}}function go(e,t,n){e.clear();for(const o of n){const{source:i,target:s,sourceHandle:r=null,targetHandle:l=null}=o,a={edgeId:o.id,source:i,target:s,sourceHandle:r,targetHandle:l},c=`${i}-${r}--${s}-${l}`,d=`${s}-${l}--${i}-${r}`;Ni("source",a,d,e,i,r),Ni("target",a,c,e,s,l)}}function Ci(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ho(e,t,n,o,i,s,r,l){const a=[];for(const c of e){const d=St(c)?c:Ru(c,l,i,s);if(!d)continue;const p=n(d.source),y=n(d.target);if(!p||!y){i(new Ge(Fe.EDGE_SOURCE_TARGET_MISSING,d.id,d.source,d.target));continue}if(!p){i(new Ge(Fe.EDGE_SOURCE_MISSING,d.id,d.source));continue}if(!y){i(new Ge(Fe.EDGE_TARGET_MISSING,d.id,d.target));continue}if(t&&!t(d,{edges:l,nodes:r,sourceNode:p,targetNode:y})){i(new Ge(Fe.EDGE_INVALID,d.id));continue}const m=o(d.id);a.push({...ws(d,m,s),sourceNode:p,targetNode:y})}return a}const $i=Symbol("vueFlow"),Ms=Symbol("nodeId"),Ds=Symbol("nodeRef"),Bu=Symbol("edgeId"),Lu=Symbol("edgeRef"),Qn=Symbol("slots");function As(e){const{vueFlowRef:t,snapToGrid:n,snapGrid:o,noDragClassName:i,nodes:s,nodeExtent:r,nodeDragThreshold:l,viewport:a,autoPanOnNodeDrag:c,autoPanSpeed:d,nodesDraggable:p,panBy:y,findNode:m,multiSelectionActive:E,nodesSelectionActive:f,selectNodesOnDrag:h,removeSelectedElements:C,addSelectedNodes:P,updateNodePositions:k,emits:w}=Re(),{onStart:S,onDrag:j,onStop:Y,onClick:J,el:ee,disabled:ie,id:D,selectable:_,dragHandle:se}=e,b=An(!1);let B=[],I,L=null,H={x:void 0,y:void 0},Q={x:0,y:0},K=null,ne=!1,fe=0,me=!1;const te=Hu(),ce=({x:pe,y:Se})=>{H={x:pe,y:Se};let be=!1;if(B=B.map(x=>{const v={x:pe-x.distance.x,y:Se-x.distance.y},{computedPosition:g}=Go(x,n.value?jn(v,o.value):v,w.error,r.value,x.parentNode?m(x.parentNode):void 0);return be=be||x.position.x!==g.x||x.position.y!==g.y,x.position=g,x}),!!be&&(k(B,!0,!0),b.value=!0,K)){const[x,v]=fo({id:D,dragItems:B,findNode:m});j({event:K,node:x,nodes:v})}},re=()=>{if(!L)return;const[pe,Se]=Cs(Q,L,d.value);if(pe!==0||Se!==0){const be={x:(H.x??0)-pe/a.value.zoom,y:(H.y??0)-Se/a.value.zoom};y({x:pe,y:Se})&&ce(be)}fe=requestAnimationFrame(re)},_e=(pe,Se)=>{ne=!0;const be=m(D);!h.value&&!E.value&&be&&(be.selected||C()),be&&Ce(_)&&h.value&&Do(be,E.value,P,C,f,!1,Se);const x=te(pe.sourceEvent);if(H=x,B=xu(s.value,p.value,x,m,D),B.length){const[v,g]=fo({id:D,dragItems:B,findNode:m});S({event:pe.sourceEvent,node:v,nodes:g})}},ue=(pe,Se)=>{var be;pe.sourceEvent.type==="touchmove"&&pe.sourceEvent.touches.length>1||(l.value===0&&_e(pe,Se),H=te(pe.sourceEvent),L=((be=t.value)==null?void 0:be.getBoundingClientRect())||null,Q=rt(pe.sourceEvent,L))},ke=(pe,Se)=>{const be=te(pe.sourceEvent);if(!me&&ne&&c.value&&(me=!0,re()),!ne){const x=be.xSnapped-(H.x??0),v=be.ySnapped-(H.y??0);Math.sqrt(x*x+v*v)>l.value&&_e(pe,Se)}(H.x!==be.xSnapped||H.y!==be.ySnapped)&&B.length&&ne&&(K=pe.sourceEvent,Q=rt(pe.sourceEvent,L),ce(be))},Ie=pe=>{let Se=!1;if(!ne&&!b.value&&!E.value){const be=pe.sourceEvent,x=te(be),v=x.xSnapped-(H.x??0),g=x.ySnapped-(H.y??0),M=Math.sqrt(v*v+g*g);M!==0&&M<=l.value&&(J?.(be),Se=!0)}if(B.length&&!Se){k(B,!1,!1);const[be,x]=fo({id:D,dragItems:B,findNode:m});Y({event:pe.sourceEvent,node:be,nodes:x})}B=[],b.value=!1,me=!1,ne=!1,H={x:void 0,y:void 0},cancelAnimationFrame(fe)};return Me([()=>Ce(ie),ee],([pe,Se],be,x)=>{if(Se){const v=Je(Se);pe||(I=fa().on("start",g=>ue(g,Se)).on("drag",g=>ke(g,Se)).on("end",g=>Ie(g)).filter(g=>{const M=g.target,z=Ce(se);return!g.button&&(!i.value||!xi(M,`.${i.value}`,Se)&&(!z||xi(M,z,Se)))}),v.call(I)),x(()=>{v.on(".drag",null),I&&(I.on("start",null),I.on("drag",null),I.on("end",null))})}}),b}function Vu(){return{doubleClick:oe(),click:oe(),mouseEnter:oe(),mouseMove:oe(),mouseLeave:oe(),contextMenu:oe(),updateStart:oe(),update:oe(),updateEnd:oe()}}function Fu(e,t){const n=Vu();return n.doubleClick.on(o=>{var i,s;t.edgeDoubleClick(o),(s=(i=e.events)==null?void 0:i.doubleClick)==null||s.call(i,o)}),n.click.on(o=>{var i,s;t.edgeClick(o),(s=(i=e.events)==null?void 0:i.click)==null||s.call(i,o)}),n.mouseEnter.on(o=>{var i,s;t.edgeMouseEnter(o),(s=(i=e.events)==null?void 0:i.mouseEnter)==null||s.call(i,o)}),n.mouseMove.on(o=>{var i,s;t.edgeMouseMove(o),(s=(i=e.events)==null?void 0:i.mouseMove)==null||s.call(i,o)}),n.mouseLeave.on(o=>{var i,s;t.edgeMouseLeave(o),(s=(i=e.events)==null?void 0:i.mouseLeave)==null||s.call(i,o)}),n.contextMenu.on(o=>{var i,s;t.edgeContextMenu(o),(s=(i=e.events)==null?void 0:i.contextMenu)==null||s.call(i,o)}),n.updateStart.on(o=>{var i,s;t.edgeUpdateStart(o),(s=(i=e.events)==null?void 0:i.updateStart)==null||s.call(i,o)}),n.update.on(o=>{var i,s;t.edgeUpdate(o),(s=(i=e.events)==null?void 0:i.update)==null||s.call(i,o)}),n.updateEnd.on(o=>{var i,s;t.edgeUpdateEnd(o),(s=(i=e.events)==null?void 0:i.updateEnd)==null||s.call(i,o)}),Object.entries(n).reduce((o,[i,s])=>(o.emit[i]=s.trigger,o.on[i]=s.on,o),{emit:{},on:{}})}function Hu(){const{viewport:e,snapGrid:t,snapToGrid:n,vueFlowRef:o}=Re();return i=>{var s;const r=((s=o.value)==null?void 0:s.getBoundingClientRect())??{left:0,top:0},l=Nu(i)?i.sourceEvent:i,{x:a,y:c}=rt(l,r),d=pn({x:a,y:c},e.value),{x:p,y}=n.value?jn(d,t.value):d;return{xSnapped:p,ySnapped:y,...d}}}function Sn(){return!0}function Ps({handleId:e,nodeId:t,type:n,isValidConnection:o,edgeUpdaterType:i,onEdgeUpdate:s,onEdgeUpdateEnd:r}){const{id:l,vueFlowRef:a,connectionMode:c,connectionRadius:d,connectOnClick:p,connectionClickStartHandle:y,nodesConnectable:m,autoPanOnConnect:E,autoPanSpeed:f,findNode:h,panBy:C,startConnection:P,updateConnection:k,endConnection:w,emits:S,viewport:j,edges:Y,nodes:J,isValidConnection:ee,nodeLookup:ie}=Re();let D=null,_=!1,se=null;function b(I){var L;const H=Ce(n)==="target",Q=Yo(I),K=fi(I.target),ne=I.currentTarget;if(ne&&(Q&&I.button===0||!Q)){let fe=function(ge){x=rt(ge,pe),re=Mu(pn(x,j.value,!1,[1,1]),d.value,ie.value,M),v||(g(),v=!0);const we=Ei(ge,{handle:re,connectionMode:c.value,fromNodeId:Ce(t),fromHandleId:Ce(e),fromType:H?"target":"source",isValidConnection:ce,doc:K,lib:"vue",flowId:l,nodeLookup:ie.value},Y.value,J.value,h);se=we.handleDomNode,D=we.connection,_=Au(!!re,we.isValid);const Ne={...ae,isValid:_,to:we.toHandle&&_?To({x:we.toHandle.x,y:we.toHandle.y},j.value):x,toHandle:we.toHandle,toPosition:_&&we.toHandle?we.toHandle.position:Mo[M.position],toNode:we.toHandle?ie.value.get(we.toHandle.nodeId):null};if(!(_&&re&&ae?.toHandle&&Ne.toHandle&&ae.toHandle.type===Ne.toHandle.type&&ae.toHandle.nodeId===Ne.toHandle.nodeId&&ae.toHandle.id===Ne.toHandle.id&&ae.to.x===Ne.to.x&&ae.to.y===Ne.to.y)){if(k(re&&_?To({x:re.x,y:re.y},j.value):x,we.toHandle,Du(!!re,_)),ae=Ne,!re&&!_&&!se)return po(be);D&&D.source!==D.target&&se&&(po(be),be=se,se.classList.add("connecting","vue-flow__handle-connecting"),se.classList.toggle("valid",!!_),se.classList.toggle("vue-flow__handle-valid",!!_))}},me=function(ge){(re||se)&&D&&_&&(s?s(ge,D):S.connect(D)),S.connectEnd(ge),i&&r?.(ge),po(be),cancelAnimationFrame(_e),w(ge),v=!1,_=!1,D=null,se=null,K.removeEventListener("mousemove",fe),K.removeEventListener("mouseup",me),K.removeEventListener("touchmove",fe),K.removeEventListener("touchend",me)};const te=h(Ce(t));let ce=Ce(o)||ee.value||Sn;!ce&&te&&(ce=(H?te.isValidSourcePos:te.isValidTargetPos)||Sn);let re,_e=0;const{x:ue,y:ke}=rt(I),Ie=Is(Ce(i),ne),pe=(L=a.value)==null?void 0:L.getBoundingClientRect();if(!pe||!Ie)return;const Se=Pu(Ce(t),Ie,Ce(e),ie.value,c.value);if(!Se)return;let be,x=rt(I,pe),v=!1;const g=()=>{if(!E.value)return;const[ge,we]=Cs(x,pe,f.value);C({x:ge,y:we}),_e=requestAnimationFrame(g)},M={...Se,nodeId:Ce(t),type:Ie,position:Se.position},z=ie.value.get(Ce(t)),U={inProgress:!0,isValid:null,from:Zt(z,M,X.Left,!0),fromHandle:M,fromPosition:M.position,fromNode:z,to:x,toHandle:null,toPosition:Mo[M.position],toNode:null};P({nodeId:Ce(t),id:Ce(e),type:Ie,position:ne?.getAttribute("data-handlepos")||X.Top,...x},{x:ue-pe.left,y:ke-pe.top}),S.connectStart({event:I,nodeId:Ce(t),handleId:Ce(e),handleType:Ie});let ae=U;K.addEventListener("mousemove",fe),K.addEventListener("mouseup",me),K.addEventListener("touchmove",fe),K.addEventListener("touchend",me)}}function B(I){var L,H;if(!p.value)return;const Q=Ce(n)==="target";if(!y.value){S.clickConnectStart({event:I,nodeId:Ce(t),handleId:Ce(e)}),P({nodeId:Ce(t),type:Ce(n),id:Ce(e),position:X.Top,...rt(I)},void 0,!0);return}let K=Ce(o)||ee.value||Sn;const ne=h(Ce(t));if(!K&&ne&&(K=(Q?ne.isValidSourcePos:ne.isValidTargetPos)||Sn),ne&&(typeof ne.connectable>"u"?m.value:ne.connectable)===!1)return;const fe=fi(I.target),me=Ei(I,{handle:{nodeId:Ce(t),id:Ce(e),type:Ce(n),position:X.Top,...rt(I)},connectionMode:c.value,fromNodeId:y.value.nodeId,fromHandleId:y.value.id??null,fromType:y.value.type,isValidConnection:K,doc:fe,lib:"vue",flowId:l,nodeLookup:ie.value},Y.value,J.value,h),te=((L=me.connection)==null?void 0:L.source)===((H=me.connection)==null?void 0:H.target);me.isValid&&me.connection&&!te&&S.connect(me.connection),S.clickConnectEnd(I),w(I,!0)}return{handlePointerDown:b,handleClick:B}}function Gu(){return qt(Ms,"")}function Os(e){const t=e??Gu()??"",n=qt(Ds,he(null)),{findNode:o,edges:i,emits:s}=Re(),r=o(t);return r||s.error(new Ge(Fe.NODE_NOT_FOUND,t)),{id:t,nodeEl:n,node:r,parentNode:W(()=>o(r.parentNode)),connectedEdges:W(()=>Ss([r],i.value))}}function Yu(){return{doubleClick:oe(),click:oe(),mouseEnter:oe(),mouseMove:oe(),mouseLeave:oe(),contextMenu:oe(),dragStart:oe(),drag:oe(),dragStop:oe()}}function Wu(e,t){const n=Yu();return n.doubleClick.on(o=>{var i,s;t.nodeDoubleClick(o),(s=(i=e.events)==null?void 0:i.doubleClick)==null||s.call(i,o)}),n.click.on(o=>{var i,s;t.nodeClick(o),(s=(i=e.events)==null?void 0:i.click)==null||s.call(i,o)}),n.mouseEnter.on(o=>{var i,s;t.nodeMouseEnter(o),(s=(i=e.events)==null?void 0:i.mouseEnter)==null||s.call(i,o)}),n.mouseMove.on(o=>{var i,s;t.nodeMouseMove(o),(s=(i=e.events)==null?void 0:i.mouseMove)==null||s.call(i,o)}),n.mouseLeave.on(o=>{var i,s;t.nodeMouseLeave(o),(s=(i=e.events)==null?void 0:i.mouseLeave)==null||s.call(i,o)}),n.contextMenu.on(o=>{var i,s;t.nodeContextMenu(o),(s=(i=e.events)==null?void 0:i.contextMenu)==null||s.call(i,o)}),n.dragStart.on(o=>{var i,s;t.nodeDragStart(o),(s=(i=e.events)==null?void 0:i.dragStart)==null||s.call(i,o)}),n.drag.on(o=>{var i,s;t.nodeDrag(o),(s=(i=e.events)==null?void 0:i.drag)==null||s.call(i,o)}),n.dragStop.on(o=>{var i,s;t.nodeDragStop(o),(s=(i=e.events)==null?void 0:i.dragStop)==null||s.call(i,o)}),Object.entries(n).reduce((o,[i,s])=>(o.emit[i]=s.trigger,o.on[i]=s.on,o),{emit:{},on:{}})}function Rs(){const{getSelectedNodes:e,nodeExtent:t,updateNodePositions:n,findNode:o,snapGrid:i,snapToGrid:s,nodesDraggable:r,emits:l}=Re();return(a,c=!1)=>{const d=s.value?i.value[0]:5,p=s.value?i.value[1]:5,y=c?4:1,m=a.x*d*y,E=a.y*p*y,f=[];for(const h of e.value)if(h.draggable||r&&typeof h.draggable>"u"){const C={x:h.computedPosition.x+m,y:h.computedPosition.y+E},{computedPosition:P}=Go(h,C,l.error,t.value,h.parentNode?o(h.parentNode):void 0);f.push({id:h.id,position:P,from:h.position,distance:{x:a.x,y:a.y},dimensions:h.dimensions})}n(f,!0,!1)}}const mo=.1,Uu=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2;function xt(){return Jn("Viewport not initialized yet."),Promise.resolve(!1)}const Xu={zoomIn:xt,zoomOut:xt,zoomTo:xt,fitView:xt,setCenter:xt,fitBounds:xt,project:e=>e,screenToFlowCoordinate:e=>e,flowToScreenCoordinate:e=>e,setViewport:xt,setTransform:xt,getViewport:()=>({x:0,y:0,zoom:1}),getTransform:()=>({x:0,y:0,zoom:1}),viewportInitialized:!1};function Zu(e){function t(o,i){return new Promise(s=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(i?.interpolate==="linear"?rn:In).scaleBy(vo(e.d3Selection,i?.duration,i?.ease,()=>{s(!0)}),o):s(!1)})}function n(o,i,s,r){return new Promise(l=>{var a;const{x:c,y:d}=ys({x:-o,y:-i},e.translateExtent),p=Xt.translate(-c,-d).scale(s);e.d3Selection&&e.d3Zoom?(a=e.d3Zoom)==null||a.interpolate(r?.interpolate==="linear"?rn:In).transform(vo(e.d3Selection,r?.duration,r?.ease,()=>{l(!0)}),p):l(!1)})}return W(()=>e.d3Zoom&&e.d3Selection&&e.dimensions.width&&e.dimensions.height?{viewportInitialized:!0,zoomIn:i=>t(1.2,i),zoomOut:i=>t(1/1.2,i),zoomTo:(i,s)=>new Promise(r=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(s?.interpolate==="linear"?rn:In).scaleTo(vo(e.d3Selection,s?.duration,s?.ease,()=>{r(!0)}),i):r(!1)}),setViewport:(i,s)=>n(i.x,i.y,i.zoom,s),setTransform:(i,s)=>n(i.x,i.y,i.zoom,s),getViewport:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),getTransform:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),fitView:(i={padding:mo,includeHiddenNodes:!1,duration:0})=>{var s,r;const l=[];for(const y of e.nodes)y.dimensions.width&&y.dimensions.height&&(i?.includeHiddenNodes||!y.hidden)&&(!((s=i.nodes)!=null&&s.length)||(r=i.nodes)!=null&&r.length&&i.nodes.includes(y.id))&&l.push(y);if(!l.length)return Promise.resolve(!1);const a=Es(l),{x:c,y:d,zoom:p}=pi(a,e.dimensions.width,e.dimensions.height,i.minZoom??e.minZoom,i.maxZoom??e.maxZoom,i.padding??mo,i.offset);return n(c,d,p,i)},setCenter:(i,s,r)=>{const l=typeof r?.zoom<"u"?r.zoom:e.maxZoom,a=e.dimensions.width/2-i*l,c=e.dimensions.height/2-s*l;return n(a,c,l,r)},fitBounds:(i,s={padding:mo})=>{const{x:r,y:l,zoom:a}=pi(i,e.dimensions.width,e.dimensions.height,e.minZoom,e.maxZoom,s.padding);return n(r,l,a,s)},project:i=>pn(i,e.viewport,e.snapToGrid,e.snapGrid),screenToFlowCoordinate:i=>{if(e.vueFlowRef){const{x:s,y:r}=e.vueFlowRef.getBoundingClientRect(),l={x:i.x-s,y:i.y-r};return pn(l,e.viewport,e.snapToGrid,e.snapGrid)}return{x:0,y:0}},flowToScreenCoordinate:i=>{if(e.vueFlowRef){const{x:s,y:r}=e.vueFlowRef.getBoundingClientRect(),l={x:i.x+s,y:i.y+r};return To(l,e.viewport)}return{x:0,y:0}}}:Xu)}function vo(e,t=0,n=Uu,o=()=>{}){const i=typeof t=="number"&&t>0;return i||o(),i?e.transition().duration(t).ease(n).on("end",o):e}function qu(e,t,n){const o=Ri(!0);return o.run(()=>{const i=()=>{o.run(()=>{let f,h,C=!!(n.nodes.value.length||n.edges.value.length);f=Lt([e.modelValue,()=>{var P,k;return(k=(P=e.modelValue)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setElements(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Lt([n.nodes,n.edges,()=>n.edges.value.length,()=>n.nodes.value.length],([P,k])=>{var w;(w=e.modelValue)!=null&&w.value&&Array.isArray(e.modelValue.value)&&(f?.pause(),e.modelValue.value=[...P,...k],et(()=>{f?.resume()}))},{immediate:C}),Cn(()=>{f?.stop(),h?.stop()})})},s=()=>{o.run(()=>{let f,h,C=!!n.nodes.value.length;f=Lt([e.nodes,()=>{var P,k;return(k=(P=e.nodes)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setNodes(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Lt([n.nodes,()=>n.nodes.value.length],([P])=>{var k;(k=e.nodes)!=null&&k.value&&Array.isArray(e.nodes.value)&&(f?.pause(),e.nodes.value=[...P],et(()=>{f?.resume()}))},{immediate:C}),Cn(()=>{f?.stop(),h?.stop()})})},r=()=>{o.run(()=>{let f,h,C=!!n.edges.value.length;f=Lt([e.edges,()=>{var P,k;return(k=(P=e.edges)==null?void 0:P.value)==null?void 0:k.length}],([P])=>{P&&Array.isArray(P)&&(h?.pause(),n.setEdges(P),!h&&!C&&P.length?C=!0:h?.resume())}),h=Lt([n.edges,()=>n.edges.value.length],([P])=>{var k;(k=e.edges)!=null&&k.value&&Array.isArray(e.edges.value)&&(f?.pause(),e.edges.value=[...P],et(()=>{f?.resume()}))},{immediate:C}),Cn(()=>{f?.stop(),h?.stop()})})},l=()=>{o.run(()=>{Me(()=>t.maxZoom,()=>{t.maxZoom&&Ve(t.maxZoom)&&n.setMaxZoom(t.maxZoom)},{immediate:!0})})},a=()=>{o.run(()=>{Me(()=>t.minZoom,()=>{t.minZoom&&Ve(t.minZoom)&&n.setMinZoom(t.minZoom)},{immediate:!0})})},c=()=>{o.run(()=>{Me(()=>t.translateExtent,()=>{t.translateExtent&&Ve(t.translateExtent)&&n.setTranslateExtent(t.translateExtent)},{immediate:!0})})},d=()=>{o.run(()=>{Me(()=>t.nodeExtent,()=>{t.nodeExtent&&Ve(t.nodeExtent)&&n.setNodeExtent(t.nodeExtent)},{immediate:!0})})},p=()=>{o.run(()=>{Me(()=>t.applyDefault,()=>{Ve(t.applyDefault)&&(n.applyDefault.value=t.applyDefault)},{immediate:!0})})},y=()=>{o.run(()=>{const f=async h=>{let C=h;typeof t.autoConnect=="function"&&(C=await t.autoConnect(h)),C!==!1&&n.addEdges([C])};Me(()=>t.autoConnect,()=>{Ve(t.autoConnect)&&(n.autoConnect.value=t.autoConnect)},{immediate:!0}),Me(n.autoConnect,(h,C,P)=>{h?n.onConnect(f):n.hooks.value.connect.off(f),P(()=>{n.hooks.value.connect.off(f)})},{immediate:!0})})},m=()=>{const f=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];for(const h of Object.keys(t)){const C=h;if(!f.includes(C)){const P=Be(()=>t[C]),k=n[C];Po(k)&&o.run(()=>{Me(P,w=>{Ve(w)&&(k.value=w)},{immediate:!0})})}}};(()=>{i(),s(),r(),a(),l(),c(),d(),p(),y(),m()})()}),()=>o.stop()}function Ku(){return{edgesChange:oe(),nodesChange:oe(),nodeDoubleClick:oe(),nodeClick:oe(),nodeMouseEnter:oe(),nodeMouseMove:oe(),nodeMouseLeave:oe(),nodeContextMenu:oe(),nodeDragStart:oe(),nodeDrag:oe(),nodeDragStop:oe(),nodesInitialized:oe(),miniMapNodeClick:oe(),miniMapNodeDoubleClick:oe(),miniMapNodeMouseEnter:oe(),miniMapNodeMouseMove:oe(),miniMapNodeMouseLeave:oe(),connect:oe(),connectStart:oe(),connectEnd:oe(),clickConnectStart:oe(),clickConnectEnd:oe(),paneReady:oe(),init:oe(),move:oe(),moveStart:oe(),moveEnd:oe(),selectionDragStart:oe(),selectionDrag:oe(),selectionDragStop:oe(),selectionContextMenu:oe(),selectionStart:oe(),selectionEnd:oe(),viewportChangeStart:oe(),viewportChange:oe(),viewportChangeEnd:oe(),paneScroll:oe(),paneClick:oe(),paneContextMenu:oe(),paneMouseEnter:oe(),paneMouseMove:oe(),paneMouseLeave:oe(),edgeContextMenu:oe(),edgeMouseEnter:oe(),edgeMouseMove:oe(),edgeMouseLeave:oe(),edgeDoubleClick:oe(),edgeClick:oe(),edgeUpdateStart:oe(),edgeUpdate:oe(),edgeUpdateEnd:oe(),updateNodeInternals:oe(),error:oe(e=>Jn(e.message))}}function ju(e,t){js(()=>{for(const[n,o]of Object.entries(t.value)){const i=s=>{e(n,s)};o.fns.add(i),Wn(()=>{o.off(i)})}})}function zs(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],connectionLookup:new Map,nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:Ho.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:ln.Free,paneClickDistance:0,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:It.Bezier,style:{}},connectionMode:kt.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:Number.NaN,y:Number.NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,nodeDragThreshold:1,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:Gn()?"Meta":"Control",zoomActivationKeyCode:Gn()?"Meta":"Control",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:Ku(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,fitViewOnInitDone:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,autoPanSpeed:15,disableKeyboardA11y:!1,ariaLiveMessage:""}}const Ju=["id","vueFlowRef","viewportRef","initialized","modelValue","nodes","edges","maxZoom","minZoom","translateExtent","hooks","defaultEdgeOptions"];function Qu(e,t,n){const o=Zu(e),i=x=>{const v=x??[];e.hooks.updateNodeInternals.trigger(v)},s=x=>hu(x,e.nodes,e.edges),r=x=>gu(x,e.nodes,e.edges),l=x=>Ss(x,e.edges),a=({id:x,type:v,nodeId:g})=>{var M;const z=x?`-${v}-${x}`:`-${v}`;return Array.from(((M=e.connectionLookup.get(`${g}${z}`))==null?void 0:M.values())??[])},c=x=>{if(x)return t.value.get(x)},d=x=>{if(x)return n.value.get(x)},p=(x,v,g)=>{var M,z;const le=[];for(const U of x){const ae={id:U.id,type:"position",dragging:g,from:U.from};if(v&&(ae.position=U.position,U.parentNode)){const ge=c(U.parentNode);ae.position={x:ae.position.x-(((M=ge?.computedPosition)==null?void 0:M.x)??0),y:ae.position.y-(((z=ge?.computedPosition)==null?void 0:z.y)??0)}}le.push(ae)}le?.length&&e.hooks.nodesChange.trigger(le)},y=x=>{if(!e.vueFlowRef)return;const v=e.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!v)return;const g=window.getComputedStyle(v),{m22:M}=new window.DOMMatrixReadOnly(g.transform),z=[];for(const le of x){const U=le,ae=c(U.id);if(ae){const ge=Kn(U.nodeElement);if(!!(ge.width&&ge.height&&(ae.dimensions.width!==ge.width||ae.dimensions.height!==ge.height||U.forceUpdate))){const Ne=U.nodeElement.getBoundingClientRect();ae.dimensions=ge,ae.handleBounds.source=ki("source",U.nodeElement,Ne,M,ae.id),ae.handleBounds.target=ki("target",U.nodeElement,Ne,M,ae.id),z.push({id:ae.id,type:"dimensions",dimensions:ge})}}}!e.fitViewOnInitDone&&e.fitViewOnInit&&o.value.fitView().then(()=>{e.fitViewOnInitDone=!0}),z.length&&e.hooks.nodesChange.trigger(z)},m=(x,v)=>{const g=new Set,M=new Set;for(const U of x)At(U)?g.add(U.id):St(U)&&M.add(U.id);const z=bt(t.value,g,!0),le=bt(n.value,M);if(e.multiSelectionActive){for(const U of g)z.push(_t(U,v));for(const U of M)le.push(_t(U,v))}z.length&&e.hooks.nodesChange.trigger(z),le.length&&e.hooks.edgesChange.trigger(le)},E=x=>{if(e.multiSelectionActive){const v=x.map(g=>_t(g.id,!0));e.hooks.nodesChange.trigger(v);return}e.hooks.nodesChange.trigger(bt(t.value,new Set(x.map(v=>v.id)),!0)),e.hooks.edgesChange.trigger(bt(n.value))},f=x=>{if(e.multiSelectionActive){const v=x.map(g=>_t(g.id,!0));e.hooks.edgesChange.trigger(v);return}e.hooks.edgesChange.trigger(bt(n.value,new Set(x.map(v=>v.id)))),e.hooks.nodesChange.trigger(bt(t.value,new Set,!0))},h=x=>{m(x,!0)},C=x=>{const g=(x||e.nodes).map(M=>(M.selected=!1,_t(M.id,!1)));e.hooks.nodesChange.trigger(g)},P=x=>{const g=(x||e.edges).map(M=>(M.selected=!1,_t(M.id,!1)));e.hooks.edgesChange.trigger(g)},k=x=>{if(!x||!x.length)return m([],!1);const v=x.reduce((g,M)=>{const z=_t(M.id,!1);return At(M)?g.nodes.push(z):g.edges.push(z),g},{nodes:[],edges:[]});v.nodes.length&&e.hooks.nodesChange.trigger(v.nodes),v.edges.length&&e.hooks.edgesChange.trigger(v.edges)},w=x=>{var v;(v=e.d3Zoom)==null||v.scaleExtent([x,e.maxZoom]),e.minZoom=x},S=x=>{var v;(v=e.d3Zoom)==null||v.scaleExtent([e.minZoom,x]),e.maxZoom=x},j=x=>{var v;(v=e.d3Zoom)==null||v.translateExtent(x),e.translateExtent=x},Y=x=>{e.nodeExtent=x,i()},J=x=>{var v;(v=e.d3Zoom)==null||v.clickDistance(x)},ee=x=>{e.nodesDraggable=x,e.nodesConnectable=x,e.elementsSelectable=x},ie=x=>{const v=x instanceof Function?x(e.nodes):x;!e.initialized&&!v.length||(e.nodes=Si(v,c,e.hooks.error.trigger))},D=x=>{const v=x instanceof Function?x(e.edges):x;if(!e.initialized&&!v.length)return;const g=ho(v,e.isValidConnection,c,d,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);go(e.connectionLookup,n.value,g),e.edges=g},_=x=>{const v=x instanceof Function?x([...e.nodes,...e.edges]):x;!e.initialized&&!v.length||(ie(v.filter(At)),D(v.filter(St)))},se=x=>{let v=x instanceof Function?x(e.nodes):x;v=Array.isArray(v)?v:[v];const g=Si(v,c,e.hooks.error.trigger),M=[];for(const z of g)M.push(vi(z));M.length&&e.hooks.nodesChange.trigger(M)},b=x=>{let v=x instanceof Function?x(e.edges):x;v=Array.isArray(v)?v:[v];const g=ho(v,e.isValidConnection,c,d,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges),M=[];for(const z of g)M.push(vi(z));M.length&&e.hooks.edgesChange.trigger(M)},B=(x,v=!0,g=!1)=>{const M=x instanceof Function?x(e.nodes):x,z=Array.isArray(M)?M:[M],le=[],U=[];function ae(we){const Ne=l(we);for(const Ae of Ne)(!Ve(Ae.deletable)||Ae.deletable)&&U.push(wi(Ae.id,Ae.source,Ae.target,Ae.sourceHandle,Ae.targetHandle))}function ge(we){const Ne=[];for(const Ae of e.nodes)Ae.parentNode===we&&Ne.push(Ae);if(Ne.length){for(const Ae of Ne)le.push(yi(Ae.id));v&&ae(Ne);for(const Ae of Ne)ge(Ae.id)}}for(const we of z){const Ne=typeof we=="string"?c(we):we;Ne&&(Ve(Ne.deletable)&&!Ne.deletable||(le.push(yi(Ne.id)),v&&ae([Ne]),g&&ge(Ne.id)))}U.length&&e.hooks.edgesChange.trigger(U),le.length&&e.hooks.nodesChange.trigger(le)},I=x=>{const v=x instanceof Function?x(e.edges):x,g=Array.isArray(v)?v:[v],M=[];for(const z of g){const le=typeof z=="string"?d(z):z;le&&(Ve(le.deletable)&&!le.deletable||M.push(wi(typeof z=="string"?z:z.id,le.source,le.target,le.sourceHandle,le.targetHandle)))}e.hooks.edgesChange.trigger(M)},L=(x,v,g=!0)=>{const M=d(x.id);if(!M)return!1;const z=e.edges.indexOf(M),le=zu(x,v,M,g,e.hooks.error.trigger);if(le){const[U]=ho([le],e.isValidConnection,c,d,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);return e.edges=e.edges.map((ae,ge)=>ge===z?U:ae),go(e.connectionLookup,n.value,[U]),U}return!1},H=(x,v,g={replace:!1})=>{const M=d(x);if(!M)return;const z=typeof v=="function"?v(M):v;M.data=g.replace?z:{...M.data,...z}},Q=x=>mi(x,e.nodes),K=x=>{const v=mi(x,e.edges);return go(e.connectionLookup,n.value,v),v},ne=(x,v,g={replace:!1})=>{const M=c(x);if(!M)return;const z=typeof v=="function"?v(M):v;g.replace?e.nodes.splice(e.nodes.indexOf(M),1,z):Object.assign(M,z)},fe=(x,v,g={replace:!1})=>{const M=c(x);if(!M)return;const z=typeof v=="function"?v(M):v;M.data=g.replace?z:{...M.data,...z}},me=(x,v,g=!1)=>{g?e.connectionClickStartHandle=x:e.connectionStartHandle=x,e.connectionEndHandle=null,e.connectionStatus=null,v&&(e.connectionPosition=v)},te=(x,v=null,g=null)=>{e.connectionStartHandle&&(e.connectionPosition=x,e.connectionEndHandle=v,e.connectionStatus=g)},ce=(x,v)=>{e.connectionPosition={x:Number.NaN,y:Number.NaN},e.connectionEndHandle=null,e.connectionStatus=null,v?e.connectionClickStartHandle=null:e.connectionStartHandle=null},re=x=>{const v=fu(x),g=v?null:on(x)?x:c(x.id);return!v&&!g?[null,null,v]:[v?x:Fn(g),g,v]},_e=(x,v=!0,g=e.nodes)=>{const[M,z,le]=re(x);if(!M)return[];const U=[];for(const ae of g||e.nodes){if(!le&&(ae.id===z.id||!ae.computedPosition))continue;const ge=Fn(ae),we=Hn(ge,M);(v&&we>0||we>=ge.width*ge.height||we>=Number(M.width)*Number(M.height))&&U.push(ae)}return U},ue=(x,v,g=!0)=>{const[M]=re(x);if(!M)return!1;const z=Hn(M,v);return g&&z>0||z>=Number(M.width)*Number(M.height)},ke=x=>{const{viewport:v,dimensions:g,d3Zoom:M,d3Selection:z,translateExtent:le}=e;if(!M||!z||!x.x&&!x.y)return!1;const U=Xt.translate(v.x+x.x,v.y+x.y).scale(v.zoom),ae=[[0,0],[g.width,g.height]],ge=M.constrain()(U,ae,le),we=e.viewport.x!==ge.x||e.viewport.y!==ge.y||e.viewport.zoom!==ge.k;return M.transform(z,ge),we},Ie=x=>{const v=x instanceof Function?x(e):x,g=["d3Zoom","d3Selection","d3ZoomHandler","viewportRef","vueFlowRef","dimensions","hooks"];Ve(v.defaultEdgeOptions)&&(e.defaultEdgeOptions=v.defaultEdgeOptions);const M=v.modelValue||v.nodes||v.edges?[]:void 0;M&&(v.modelValue&&M.push(...v.modelValue),v.nodes&&M.push(...v.nodes),v.edges&&M.push(...v.edges),_(M));const z=()=>{Ve(v.maxZoom)&&S(v.maxZoom),Ve(v.minZoom)&&w(v.minZoom),Ve(v.translateExtent)&&j(v.translateExtent)};for(const le of Object.keys(v)){const U=le,ae=v[U];![...Ju,...g].includes(U)&&Ve(ae)&&(e[U]=ae)}wo(()=>e.d3Zoom).not.toBeNull().then(z),e.initialized||(e.initialized=!0)};return{updateNodePositions:p,updateNodeDimensions:y,setElements:_,setNodes:ie,setEdges:D,addNodes:se,addEdges:b,removeNodes:B,removeEdges:I,findNode:c,findEdge:d,updateEdge:L,updateEdgeData:H,updateNode:ne,updateNodeData:fe,applyEdgeChanges:K,applyNodeChanges:Q,addSelectedElements:h,addSelectedNodes:E,addSelectedEdges:f,setMinZoom:w,setMaxZoom:S,setTranslateExtent:j,setNodeExtent:Y,setPaneClickDistance:J,removeSelectedElements:k,removeSelectedNodes:C,removeSelectedEdges:P,startConnection:me,updateConnection:te,endConnection:ce,setInteractive:ee,setState:Ie,getIntersectingNodes:_e,getIncomers:s,getOutgoers:r,getConnectedEdges:l,getHandleConnections:a,isNodeIntersecting:ue,panBy:ke,fitView:x=>o.value.fitView(x),zoomIn:x=>o.value.zoomIn(x),zoomOut:x=>o.value.zoomOut(x),zoomTo:(x,v)=>o.value.zoomTo(x,v),setViewport:(x,v)=>o.value.setViewport(x,v),setTransform:(x,v)=>o.value.setTransform(x,v),getViewport:()=>o.value.getViewport(),getTransform:()=>o.value.getTransform(),setCenter:(x,v,g)=>o.value.setCenter(x,v,g),fitBounds:(x,v)=>o.value.fitBounds(x,v),project:x=>o.value.project(x),screenToFlowCoordinate:x=>o.value.screenToFlowCoordinate(x),flowToScreenCoordinate:x=>o.value.flowToScreenCoordinate(x),toObject:()=>{const x=[],v=[];for(const g of e.nodes){const{computedPosition:M,handleBounds:z,selected:le,dimensions:U,isParent:ae,resizing:ge,dragging:we,events:Ne,...Ae}=g;x.push(Ae)}for(const g of e.edges){const{selected:M,sourceNode:z,targetNode:le,events:U,...ae}=g;v.push(ae)}return JSON.parse(JSON.stringify({nodes:x,edges:v,position:[e.viewport.x,e.viewport.y],zoom:e.viewport.zoom,viewport:e.viewport}))},fromObject:x=>new Promise(v=>{const{nodes:g,edges:M,position:z,zoom:le,viewport:U}=x;if(g&&ie(g),M&&D(M),U?.x&&U?.y||z){const ae=U?.x||z[0],ge=U?.y||z[1],we=U?.zoom||le||e.viewport.zoom;return wo(()=>o.value.viewportInitialized).toBe(!0).then(()=>{o.value.setViewport({x:ae,y:ge,zoom:we}).then(()=>{v(!0)})})}else v(!0)}),updateNodeInternals:i,viewportHelper:o,$reset:()=>{const x=zs();if(e.edges=[],e.nodes=[],e.d3Zoom&&e.d3Selection){const v=Xt.translate(x.defaultViewport.x??0,x.defaultViewport.y??0).scale(Rt(x.defaultViewport.zoom??1,x.minZoom,x.maxZoom)),g=e.viewportRef.getBoundingClientRect(),M=[[0,0],[g.width,g.height]],z=e.d3Zoom.constrain()(v,M,x.translateExtent);e.d3Zoom.transform(e.d3Selection,z)}Ie(x)},$destroy:()=>{}}}const ed=["data-id","data-handleid","data-nodeid","data-handlepos"],td={name:"Handle",compatConfig:{MODE:3}},Oe=Pe({...td,props:{id:{default:null},type:{},position:{default:()=>X.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,Number,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(e,{expose:t}){const n=qs(e,["position","connectable","connectableStart","connectableEnd","id"]),o=Be(()=>n.type??"source"),i=Be(()=>n.isValidConnection??null),{id:s,connectionStartHandle:r,connectionClickStartHandle:l,connectionEndHandle:a,vueFlowRef:c,nodesConnectable:d,noDragClassName:p,noPanClassName:y}=Re(),{id:m,node:E,nodeEl:f,connectedEdges:h}=Os(),C=he(),P=Be(()=>typeof e.connectableStart<"u"?e.connectableStart:!0),k=Be(()=>typeof e.connectableEnd<"u"?e.connectableEnd:!0),w=Be(()=>{var D,_,se,b,B,I;return((D=r.value)==null?void 0:D.nodeId)===m&&((_=r.value)==null?void 0:_.id)===e.id&&((se=r.value)==null?void 0:se.type)===o.value||((b=a.value)==null?void 0:b.nodeId)===m&&((B=a.value)==null?void 0:B.id)===e.id&&((I=a.value)==null?void 0:I.type)===o.value}),S=Be(()=>{var D,_,se;return((D=l.value)==null?void 0:D.nodeId)===m&&((_=l.value)==null?void 0:_.id)===e.id&&((se=l.value)==null?void 0:se.type)===o.value}),{handlePointerDown:j,handleClick:Y}=Ps({nodeId:m,handleId:e.id,isValidConnection:i,type:o}),J=W(()=>typeof e.connectable=="string"&&e.connectable==="single"?!h.value.some(D=>{const _=D[`${o.value}Handle`];return D[o.value]!==m?!1:_?_===e.id:!0}):typeof e.connectable=="number"?h.value.filter(D=>{const _=D[`${o.value}Handle`];return D[o.value]!==m?!1:_?_===e.id:!0}).length<e.connectable:typeof e.connectable=="function"?e.connectable(E,h.value):Ve(e.connectable)?e.connectable:d.value);ct(()=>{var D;if(!E.dimensions.width||!E.dimensions.height)return;const _=(D=E.handleBounds[o.value])==null?void 0:D.find(Q=>Q.id===e.id);if(!c.value||_)return;const se=c.value.querySelector(".vue-flow__transformationpane");if(!f.value||!C.value||!se||!e.id)return;const b=f.value.getBoundingClientRect(),B=C.value.getBoundingClientRect(),I=window.getComputedStyle(se),{m22:L}=new window.DOMMatrixReadOnly(I.transform),H={id:e.id,position:e.position,x:(B.left-b.left)/L,y:(B.top-b.top)/L,type:o.value,nodeId:m,...Kn(C.value)};E.handleBounds[o.value]=[...E.handleBounds[o.value]??[],H]});function ee(D){const _=Yo(D);J.value&&P.value&&(_&&D.button===0||!_)&&j(D)}function ie(D){!m||!l.value&&!P.value||J.value&&Y(D)}return t({handleClick:Y,handlePointerDown:j,onClick:ie,onPointerDown:ee}),(D,_)=>($(),O("div",{ref_key:"handle",ref:C,"data-id":`${T(s)}-${T(m)}-${e.id}-${o.value}`,"data-handleid":e.id,"data-nodeid":T(m),"data-handlepos":D.position,class:ve(["vue-flow__handle",[`vue-flow__handle-${D.position}`,`vue-flow__handle-${e.id}`,T(p),T(y),o.value,{connectable:J.value,connecting:S.value,connectablestart:P.value,connectableend:k.value,connectionindicator:J.value&&(P.value&&!w.value||k.value&&w.value)}]]),onMousedown:ee,onTouchstartPassive:ee,onClick:ie},[lt(D.$slots,"default",{id:D.id})],42,ed))}}),eo=function({sourcePosition:e=X.Bottom,targetPosition:t=X.Top,label:n,connectable:o=!0,isValidTargetPos:i,isValidSourcePos:s,data:r}){const l=r.label??n;return[De(Oe,{type:"target",position:t,connectable:o,isValidConnection:i}),typeof l!="string"&&l?De(l):De(xe,[l]),De(Oe,{type:"source",position:e,connectable:o,isValidConnection:s})]};eo.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable","data"];eo.inheritAttrs=!1;eo.compatConfig={MODE:3};const nd=eo,to=function({targetPosition:e=X.Top,label:t,connectable:n=!0,isValidTargetPos:o,data:i}){const s=i.label??t;return[De(Oe,{type:"target",position:e,connectable:n,isValidConnection:o}),typeof s!="string"&&s?De(s):De(xe,[s])]};to.props=["targetPosition","label","isValidTargetPos","connectable","data"];to.inheritAttrs=!1;to.compatConfig={MODE:3};const od=to,no=function({sourcePosition:e=X.Bottom,label:t,connectable:n=!0,isValidSourcePos:o,data:i}){const s=i.label??t;return[typeof s!="string"&&s?De(s):De(xe,[s]),De(Oe,{type:"source",position:e,connectable:n,isValidConnection:o})]};no.props=["sourcePosition","label","isValidSourcePos","connectable","data"];no.inheritAttrs=!1;no.compatConfig={MODE:3};const id=no,sd=["transform"],rd=["width","height","x","y","rx","ry"],ld=["y"],ad={name:"EdgeText",compatConfig:{MODE:3}},cd=Pe({...ad,props:{x:{},y:{},label:{},labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(e){const t=he({x:0,y:0,width:0,height:0}),n=he(null),o=W(()=>`translate(${e.x-t.value.width/2} ${e.y-t.value.height/2})`);ct(i),Me([()=>e.x,()=>e.y,n,()=>e.label],i);function i(){if(!n.value)return;const s=n.value.getBBox();(s.width!==t.value.width||s.height!==t.value.height)&&(t.value=s)}return(s,r)=>($(),O("g",{transform:o.value,class:"vue-flow__edge-textwrapper"},[s.labelShowBg?($(),O("rect",{key:0,class:"vue-flow__edge-textbg",width:`${t.value.width+2*s.labelBgPadding[0]}px`,height:`${t.value.height+2*s.labelBgPadding[1]}px`,x:-s.labelBgPadding[0],y:-s.labelBgPadding[1],style:We(s.labelBgStyle),rx:s.labelBgBorderRadius,ry:s.labelBgBorderRadius},null,12,rd)):ye("",!0),u("text",$t(s.$attrs,{ref_key:"el",ref:n,class:"vue-flow__edge-text",y:t.value.height/2,dy:"0.3em",style:s.labelStyle}),[lt(s.$slots,"default",{},()=>[typeof s.label!="string"?($(),$e(nr(s.label),{key:0})):($(),O(xe,{key:1},[Ye(V(s.label),1)],64))])],16,ld)],8,sd))}}),ud=["id","d","marker-end","marker-start"],dd=["d","stroke-width"],fd={name:"BaseEdge",inheritAttrs:!1,compatConfig:{MODE:3}},oo=Pe({...fd,props:{id:{},labelX:{},labelY:{},path:{},label:{},markerStart:{},markerEnd:{},interactionWidth:{default:20},labelStyle:{},labelShowBg:{type:Boolean},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{}},setup(e,{expose:t}){const n=he(null),o=he(null),i=he(null),s=tr();return t({pathEl:n,interactionEl:o,labelEl:i}),(r,l)=>($(),O(xe,null,[u("path",$t(T(s),{id:r.id,ref_key:"pathEl",ref:n,d:r.path,class:"vue-flow__edge-path","marker-end":r.markerEnd,"marker-start":r.markerStart}),null,16,ud),r.interactionWidth?($(),O("path",{key:0,ref_key:"interactionEl",ref:o,fill:"none",d:r.path,"stroke-width":r.interactionWidth,"stroke-opacity":0,class:"vue-flow__edge-interaction"},null,8,dd)):ye("",!0),r.label&&r.labelX&&r.labelY?($(),$e(cd,{key:1,ref_key:"labelEl",ref:i,x:r.labelX,y:r.labelY,label:r.label,"label-show-bg":r.labelShowBg,"label-bg-style":r.labelBgStyle,"label-bg-padding":r.labelBgPadding,"label-bg-border-radius":r.labelBgBorderRadius,"label-style":r.labelStyle},null,8,["x","y","label","label-show-bg","label-bg-style","label-bg-padding","label-bg-border-radius","label-style"])):ye("",!0)],64))}});function Bs({sourceX:e,sourceY:t,targetX:n,targetY:o}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,r=Math.abs(o-t)/2,l=o<t?o+r:o-r;return[s,l,i,r]}function Ls({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:i,sourceControlY:s,targetControlX:r,targetControlY:l}){const a=e*.125+i*.375+r*.375+n*.125,c=t*.125+s*.375+l*.375+o*.125,d=Math.abs(a-e),p=Math.abs(c-t);return[a,c,d,p]}function Nn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ii({pos:e,x1:t,y1:n,x2:o,y2:i,c:s}){let r,l;switch(e){case X.Left:r=t-Nn(t-o,s),l=n;break;case X.Right:r=t+Nn(o-t,s),l=n;break;case X.Top:r=t,l=n-Nn(n-i,s);break;case X.Bottom:r=t,l=n+Nn(i-n,s);break}return[r,l]}function Vs(e){const{sourceX:t,sourceY:n,sourcePosition:o=X.Bottom,targetX:i,targetY:s,targetPosition:r=X.Top,curvature:l=.25}=e,[a,c]=Ii({pos:o,x1:t,y1:n,x2:i,y2:s,c:l}),[d,p]=Ii({pos:r,x1:i,y1:s,x2:t,y2:n,c:l}),[y,m,E,f]=Ls({sourceX:t,sourceY:n,targetX:i,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:d,targetControlY:p});return[`M${t},${n} C${a},${c} ${d},${p} ${i},${s}`,y,m,E,f]}function Ti({pos:e,x1:t,y1:n,x2:o,y2:i}){let s,r;switch(e){case X.Left:case X.Right:s=.5*(t+o),r=n;break;case X.Top:case X.Bottom:s=t,r=.5*(n+i);break}return[s,r]}function Fs(e){const{sourceX:t,sourceY:n,sourcePosition:o=X.Bottom,targetX:i,targetY:s,targetPosition:r=X.Top}=e,[l,a]=Ti({pos:o,x1:t,y1:n,x2:i,y2:s}),[c,d]=Ti({pos:r,x1:i,y1:s,x2:t,y2:n}),[p,y,m,E]=Ls({sourceX:t,sourceY:n,targetX:i,targetY:s,sourceControlX:l,sourceControlY:a,targetControlX:c,targetControlY:d});return[`M${t},${n} C${l},${a} ${c},${d} ${i},${s}`,p,y,m,E]}const Mi={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}};function pd({source:e,sourcePosition:t=X.Bottom,target:n}){return t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1}}function Di(e,t){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function gd({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:o=X.Top,center:i,offset:s}){const r=Mi[t],l=Mi[o],a={x:e.x+r.x*s,y:e.y+r.y*s},c={x:n.x+l.x*s,y:n.y+l.y*s},d=pd({source:a,sourcePosition:t,target:c}),p=d.x!==0?"x":"y",y=d[p];let m,E,f;const h={x:0,y:0},C={x:0,y:0},[P,k,w,S]=Bs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[p]*l[p]===-1){E=i.x??P,f=i.y??k;const Y=[{x:E,y:a.y},{x:E,y:c.y}],J=[{x:a.x,y:f},{x:c.x,y:f}];r[p]===y?m=p==="x"?Y:J:m=p==="x"?J:Y}else{const Y=[{x:a.x,y:c.y}],J=[{x:c.x,y:a.y}];if(p==="x"?m=r.x===y?J:Y:m=r.y===y?Y:J,t===o){const se=Math.abs(e[p]-n[p]);if(se<=s){const b=Math.min(s-1,s-se);r[p]===y?h[p]=(a[p]>e[p]?-1:1)*b:C[p]=(c[p]>n[p]?-1:1)*b}}if(t!==o){const se=p==="x"?"y":"x",b=r[p]===l[se],B=a[se]>c[se],I=a[se]<c[se];(r[p]===1&&(!b&&B||b&&I)||r[p]!==1&&(!b&&I||b&&B))&&(m=p==="x"?Y:J)}const ee={x:a.x+h.x,y:a.y+h.y},ie={x:c.x+C.x,y:c.y+C.y},D=Math.max(Math.abs(ee.x-m[0].x),Math.abs(ie.x-m[0].x)),_=Math.max(Math.abs(ee.y-m[0].y),Math.abs(ie.y-m[0].y));D>=_?(E=(ee.x+ie.x)/2,f=m[0].y):(E=m[0].x,f=(ee.y+ie.y)/2)}return[[e,{x:a.x+h.x,y:a.y+h.y},...m,{x:c.x+C.x,y:c.y+C.y},n],E,f,w,S]}function hd(e,t,n,o){const i=Math.min(Di(e,t)/2,Di(t,n)/2,o),{x:s,y:r}=t;if(e.x===s&&s===n.x||e.y===r&&r===n.y)return`L${s} ${r}`;if(e.y===r){const c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+i*c},${r}Q ${s},${r} ${s},${r+i*d}`}const l=e.x<n.x?1:-1,a=e.y<n.y?-1:1;return`L ${s},${r+i*a}Q ${s},${r} ${s+i*l},${r}`}function Ao(e){const{sourceX:t,sourceY:n,sourcePosition:o=X.Bottom,targetX:i,targetY:s,targetPosition:r=X.Top,borderRadius:l=5,centerX:a,centerY:c,offset:d=20}=e,[p,y,m,E,f]=gd({source:{x:t,y:n},sourcePosition:o,target:{x:i,y:s},targetPosition:r,center:{x:a,y:c},offset:d});return[p.reduce((C,P,k)=>{let w;return k>0&&k<p.length-1?w=hd(p[k-1],P,p[k+1],l):w=`${k===0?"M":"L"}${P.x} ${P.y}`,C+=w,C},""),y,m,E,f]}function md(e){const{sourceX:t,sourceY:n,targetX:o,targetY:i}=e,[s,r,l,a]=Bs({sourceX:t,sourceY:n,targetX:o,targetY:i});return[`M ${t},${n}L ${o},${i}`,s,r,l,a]}const vd=Pe({name:"StraightEdge",props:["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,i]=md(e);return De(oo,{path:n,labelX:o,labelY:i,...t,...e})}}}),yd=vd,wd=Pe({name:"SmoothStepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,i]=Ao({...e,sourcePosition:e.sourcePosition??X.Bottom,targetPosition:e.targetPosition??X.Top});return De(oo,{path:n,labelX:o,labelY:i,...t,...e})}}}),Hs=wd,xd=Pe({name:"StepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],setup(e,{attrs:t}){return()=>De(Hs,{...e,...t,borderRadius:0})}}),_d=xd,bd=Pe({name:"BezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,i]=Vs({...e,sourcePosition:e.sourcePosition??X.Bottom,targetPosition:e.targetPosition??X.Top});return De(oo,{path:n,labelX:o,labelY:i,...t,...e})}}}),Ed=bd,kd=Pe({name:"SimpleBezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{const[n,o,i]=Fs({...e,sourcePosition:e.sourcePosition??X.Bottom,targetPosition:e.targetPosition??X.Top});return De(oo,{path:n,labelX:o,labelY:i,...t,...e})}}}),Sd=kd,Nd={input:id,default:nd,output:od},Cd={default:Ed,straight:yd,step:_d,smoothstep:Hs,simplebezier:Sd};function $d(e,t,n){const o=W(()=>f=>t.value.get(f)),i=W(()=>f=>n.value.get(f)),s=W(()=>{const f={...Cd,...e.edgeTypes},h=Object.keys(f);for(const C of e.edges)C.type&&!h.includes(C.type)&&(f[C.type]=C.type);return f}),r=W(()=>{const f={...Nd,...e.nodeTypes},h=Object.keys(f);for(const C of e.nodes)C.type&&!h.includes(C.type)&&(f[C.type]=C.type);return f}),l=W(()=>e.onlyRenderVisibleElements?ks(e.nodes,{x:0,y:0,width:e.dimensions.width,height:e.dimensions.height},e.viewport,!0):e.nodes),a=W(()=>{if(e.onlyRenderVisibleElements){const f=[];for(const h of e.edges){const C=t.value.get(h.source),P=t.value.get(h.target);ku({sourcePos:C.computedPosition||{x:0,y:0},targetPos:P.computedPosition||{x:0,y:0},sourceWidth:C.dimensions.width,sourceHeight:C.dimensions.height,targetWidth:P.dimensions.width,targetHeight:P.dimensions.height,width:e.dimensions.width,height:e.dimensions.height,viewport:e.viewport})&&f.push(h)}return f}return e.edges}),c=W(()=>[...l.value,...a.value]),d=W(()=>{const f=[];for(const h of e.nodes)h.selected&&f.push(h);return f}),p=W(()=>{const f=[];for(const h of e.edges)h.selected&&f.push(h);return f}),y=W(()=>[...d.value,...p.value]),m=W(()=>{const f=[];for(const h of e.nodes)h.dimensions.width&&h.dimensions.height&&h.handleBounds!==void 0&&f.push(h);return f}),E=W(()=>l.value.length>0&&m.value.length===l.value.length);return{getNode:o,getEdge:i,getElements:c,getEdgeTypes:s,getNodeTypes:r,getEdges:a,getNodes:l,getSelectedElements:y,getSelectedNodes:d,getSelectedEdges:p,getNodesInitialized:m,areNodesInitialized:E}}class Tt{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){var t;const n=(t=hn())==null?void 0:t.appContext.app,o=n?.config.globalProperties.$vueFlowStorage??Tt.instance;return Tt.instance=o??new Tt,n&&(n.config.globalProperties.$vueFlowStorage=Tt.instance),Tt.instance}set(t,n){return this.flows.set(t,n)}get(t){return this.flows.get(t)}remove(t){return this.flows.delete(t)}create(t,n){const o=zs(),i=Ks(o),s={};for(const[y,m]of Object.entries(i.hooks)){const E=`on${y.charAt(0).toUpperCase()+y.slice(1)}`;s[E]=m.on}const r={};for(const[y,m]of Object.entries(i.hooks))r[y]=m.trigger;const l=W(()=>{const y=new Map;for(const m of i.nodes)y.set(m.id,m);return y}),a=W(()=>{const y=new Map;for(const m of i.edges)y.set(m.id,m);return y}),c=$d(i,l,a),d=Qu(i,l,a);d.setState({...i,...n});const p={...s,...c,...d,..._r(i),nodeLookup:l,edgeLookup:a,emits:r,id:t,vueFlowVersion:"1.46.0",$destroy:()=>{this.remove(t)}};return this.set(t,p),p}getId(){return`vue-flow-${this.currentId++}`}}function Re(e){const t=Tt.getInstance(),n=Oi(),o=typeof e=="object",i=o?e:{id:e},s=i.id,r=s??n?.vueFlowId;let l;if(n){const a=qt($i,null);typeof a<"u"&&a!==null&&(!r||a.id===r)&&(l=a)}if(l||r&&(l=t.get(r)),!l||r&&l.id!==r){const a=s??t.getId(),c=t.create(a,i);l=c,(n??Ri(!0)).run(()=>{Me(c.applyDefault,(p,y,m)=>{const E=h=>{c.applyNodeChanges(h)},f=h=>{c.applyEdgeChanges(h)};p?(c.onNodesChange(E),c.onEdgesChange(f)):(c.hooks.value.nodesChange.off(E),c.hooks.value.edgesChange.off(f)),m(()=>{c.hooks.value.nodesChange.off(E),c.hooks.value.edgesChange.off(f)})},{immediate:!0}),Wn(()=>{if(l){const p=t.get(l.id);p?p.$destroy():Jn(`No store instance found for id ${l.id} in storage.`)}})})}else o&&l.setState(i);if(n&&(Yt($i,l),n.vueFlowId=l.id),o){const a=hn();a?.type.name!=="VueFlow"&&l.emits.error(new Ge(Fe.USEVUEFLOW_OPTIONS))}return l}function Id(e){const{emits:t,dimensions:n}=Re();let o;ct(()=>{const i=e.value,s=()=>{if(!i)return;const r=Kn(i);(r.width===0||r.height===0)&&t.error(new Ge(Fe.MISSING_VIEWPORT_DIMENSIONS)),n.value={width:r.width||500,height:r.height||500}};s(),window.addEventListener("resize",s),i&&(o=new ResizeObserver(()=>s()),o.observe(i)),zi(()=>{window.removeEventListener("resize",s),o&&i&&o.unobserve(i)})})}const Td={name:"UserSelection",compatConfig:{MODE:3}},Md=Pe({...Td,props:{userSelectionRect:{}},setup(e){return(t,n)=>($(),O("div",{class:"vue-flow__selection vue-flow__container",style:We({width:`${t.userSelectionRect.width}px`,height:`${t.userSelectionRect.height}px`,transform:`translate(${t.userSelectionRect.x}px, ${t.userSelectionRect.y}px)`})},null,4))}}),Dd=["tabIndex"],Ad={name:"NodesSelection",compatConfig:{MODE:3}},Pd=Pe({...Ad,setup(e){const{emits:t,viewport:n,getSelectedNodes:o,noPanClassName:i,disableKeyboardA11y:s,userSelectionActive:r}=Re(),l=Rs(),a=he(null),c=As({el:a,onStart(E){t.selectionDragStart(E),t.nodeDragStart(E)},onDrag(E){t.selectionDrag(E),t.nodeDrag(E)},onStop(E){t.selectionDragStop(E),t.nodeDragStop(E)}});ct(()=>{var E;s.value||(E=a.value)==null||E.focus({preventScroll:!0})});const d=W(()=>Es(o.value)),p=W(()=>({width:`${d.value.width}px`,height:`${d.value.height}px`,top:`${d.value.y}px`,left:`${d.value.x}px`}));function y(E){t.selectionContextMenu({event:E,nodes:o.value})}function m(E){s||Gt[E.key]&&(E.preventDefault(),l({x:Gt[E.key].x,y:Gt[E.key].y},E.shiftKey))}return(E,f)=>!T(r)&&d.value.width&&d.value.height?($(),O("div",{key:0,class:ve(["vue-flow__nodesselection vue-flow__container",T(i)]),style:We({transform:`translate(${T(n).x}px,${T(n).y}px) scale(${T(n).zoom})`})},[u("div",{ref_key:"el",ref:a,class:ve([{dragging:T(c)},"vue-flow__nodesselection-rect"]),style:We(p.value),tabIndex:T(s)?void 0:-1,onContextmenu:y,onKeydown:m},null,46,Dd)],6)):ye("",!0)}});function Od(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}const Rd={name:"Pane",compatConfig:{MODE:3}},zd=Pe({...Rd,props:{isSelecting:{type:Boolean},selectionKeyPressed:{type:Boolean}},setup(e){const{vueFlowRef:t,nodes:n,viewport:o,emits:i,userSelectionActive:s,removeSelectedElements:r,userSelectionRect:l,elementsSelectable:a,nodesSelectionActive:c,getSelectedEdges:d,getSelectedNodes:p,removeNodes:y,removeEdges:m,selectionMode:E,deleteKeyCode:f,multiSelectionKeyCode:h,multiSelectionActive:C,edgeLookup:P,nodeLookup:k,connectionLookup:w,defaultEdgeOptions:S,connectionStartHandle:j}=Re(),Y=he(null),J=he(new Set),ee=he(new Set),ie=he(),D=Be(()=>a.value&&(e.isSelecting||s.value)),_=Be(()=>j.value!==null);let se=!1,b=!1;const B=an(f,{actInsideInputWithModifier:!1}),I=an(h);Me(B,te=>{te&&(y(p.value),m(d.value),c.value=!1)}),Me(I,te=>{C.value=te});function L(te,ce){return re=>{re.target===ce&&te?.(re)}}function H(te){if(se||_.value){se=!1;return}i.paneClick(te),r(),c.value=!1}function Q(te){te.preventDefault(),te.stopPropagation(),i.paneContextMenu(te)}function K(te){i.paneScroll(te)}function ne(te){var ce,re,_e;if(ie.value=(ce=t.value)==null?void 0:ce.getBoundingClientRect(),!a.value||!e.isSelecting||te.button!==0||te.target!==Y.value||!ie.value)return;(_e=(re=te.target)==null?void 0:re.setPointerCapture)==null||_e.call(re,te.pointerId);const{x:ue,y:ke}=Od(te,ie.value);b=!0,se=!1,r(),l.value={width:0,height:0,startX:ue,startY:ke,x:ue,y:ke},i.selectionStart(te)}function fe(te){var ce;if(!ie.value||!l.value)return;se=!0;const{x:re,y:_e}=rt(te,ie.value),{startX:ue=0,startY:ke=0}=l.value,Ie={startX:ue,startY:ke,x:re<ue?re:ue,y:_e<ke?_e:ke,width:Math.abs(re-ue),height:Math.abs(_e-ke)},pe=J.value,Se=ee.value;J.value=new Set(ks(n.value,Ie,o.value,E.value===Ho.Partial,!0).map(x=>x.id)),ee.value=new Set;const be=((ce=S.value)==null?void 0:ce.selectable)??!0;for(const x of J.value){const v=w.value.get(x);if(v)for(const{edgeId:g}of v.values()){const M=P.value.get(g);M&&(M.selectable??be)&&ee.value.add(g)}}if(!Ci(pe,J.value)){const x=bt(k.value,J.value,!0);i.nodesChange(x)}if(!Ci(Se,ee.value)){const x=bt(P.value,ee.value);i.edgesChange(x)}l.value=Ie,s.value=!0,c.value=!1}function me(te){var ce;te.button!==0||!b||((ce=te.target)==null||ce.releasePointerCapture(te.pointerId),!s.value&&l.value&&te.target===Y.value&&H(te),s.value=!1,l.value=null,c.value=J.value.size>0,i.selectionEnd(te),e.selectionKeyPressed&&(se=!1),b=!1)}return(te,ce)=>($(),O("div",{ref_key:"container",ref:Y,class:ve(["vue-flow__pane vue-flow__container",{selection:te.isSelecting}]),onClick:ce[0]||(ce[0]=re=>D.value?void 0:L(H,Y.value)(re)),onContextmenu:ce[1]||(ce[1]=re=>L(Q,Y.value)(re)),onWheelPassive:ce[2]||(ce[2]=re=>L(K,Y.value)(re)),onPointerenter:ce[3]||(ce[3]=re=>D.value?void 0:T(i).paneMouseEnter(re)),onPointerdown:ce[4]||(ce[4]=re=>D.value?ne(re):T(i).paneMouseMove(re)),onPointermove:ce[5]||(ce[5]=re=>D.value?fe(re):T(i).paneMouseMove(re)),onPointerup:ce[6]||(ce[6]=re=>D.value?me(re):void 0),onPointerleave:ce[7]||(ce[7]=re=>T(i).paneMouseLeave(re))},[lt(te.$slots,"default"),T(s)&&T(l)?($(),$e(Md,{key:0,"user-selection-rect":T(l)},null,8,["user-selection-rect"])):ye("",!0),T(c)&&T(p).length?($(),$e(Pd,{key:1})):ye("",!0)],34))}}),Bd={name:"Transform",compatConfig:{MODE:3}},Ld=Pe({...Bd,setup(e){const{viewport:t,fitViewOnInit:n,fitViewOnInitDone:o}=Re(),i=W(()=>n.value?!o.value:!1),s=W(()=>`translate(${t.value.x}px,${t.value.y}px) scale(${t.value.zoom})`);return(r,l)=>($(),O("div",{class:"vue-flow__transformationpane vue-flow__container",style:We({transform:s.value,opacity:i.value?0:void 0})},[lt(r.$slots,"default")],4))}}),Vd={name:"Viewport",compatConfig:{MODE:3}},Fd=Pe({...Vd,setup(e){const{minZoom:t,maxZoom:n,defaultViewport:o,translateExtent:i,zoomActivationKeyCode:s,selectionKeyCode:r,panActivationKeyCode:l,panOnScroll:a,panOnScrollMode:c,panOnScrollSpeed:d,panOnDrag:p,zoomOnDoubleClick:y,zoomOnPinch:m,zoomOnScroll:E,preventScrolling:f,noWheelClassName:h,noPanClassName:C,emits:P,connectionStartHandle:k,userSelectionActive:w,paneDragging:S,d3Zoom:j,d3Selection:Y,d3ZoomHandler:J,viewport:ee,viewportRef:ie,paneClickDistance:D}=Re();Id(ie);const _=An(!1),se=An(!1);let b=null,B=!1,I=0,L={x:0,y:0,zoom:0};const H=an(l),Q=an(r),K=an(s),ne=Be(()=>(!Q.value||Q.value&&r.value===!0)&&(H.value||p.value)),fe=Be(()=>H.value||a.value),me=Be(()=>Q.value||r.value===!0&&ne.value!==!0);ct(()=>{if(!ie.value){Jn("Viewport element is missing");return}const ue=ie.value,ke=ue.getBoundingClientRect(),Ie=su().clickDistance(D.value).scaleExtent([t.value,n.value]).translateExtent(i.value),pe=Je(ue).call(Ie),Se=pe.on("wheel.zoom"),be=Xt.translate(o.value.x??0,o.value.y??0).scale(Rt(o.value.zoom??1,t.value,n.value)),x=[[0,0],[ke.width,ke.height]],v=Ie.constrain()(be,x,i.value);Ie.transform(pe,v),Ie.wheelDelta(gi),j.value=Ie,Y.value=pe,J.value=Se,ee.value={x:v.x,y:v.y,zoom:v.k},Ie.on("start",g=>{var M;if(!g.sourceEvent)return null;I=g.sourceEvent.button,_.value=!0;const z=re(g.transform);((M=g.sourceEvent)==null?void 0:M.type)==="mousedown"&&(S.value=!0),L=z,P.viewportChangeStart(z),P.moveStart({event:g,flowTransform:z})}),Ie.on("end",g=>{if(!g.sourceEvent)return null;if(_.value=!1,S.value=!1,te(ne.value,I??0)&&!B&&P.paneContextMenu(g.sourceEvent),B=!1,ce(L,g.transform)){const M=re(g.transform);L=M,P.viewportChangeEnd(M),P.moveEnd({event:g,flowTransform:M})}}),Ie.filter(g=>{var M;const z=K.value||E.value,le=m.value&&g.ctrlKey,U=g.button;if(U===1&&g.type==="mousedown"&&(_e(g,"vue-flow__node")||_e(g,"vue-flow__edge")))return!0;if(!ne.value&&!z&&!fe.value&&!y.value&&!m.value||w.value||!y.value&&g.type==="dblclick"||_e(g,h.value)&&g.type==="wheel"||_e(g,C.value)&&(g.type!=="wheel"||fe.value&&g.type==="wheel"&&!K.value)||!m.value&&g.ctrlKey&&g.type==="wheel"||!z&&!fe.value&&!le&&g.type==="wheel")return!1;if(!m&&g.type==="touchstart"&&((M=g.touches)==null?void 0:M.length)>1)return g.preventDefault(),!1;if(!ne.value&&(g.type==="mousedown"||g.type==="touchstart")||r.value===!0&&Array.isArray(p.value)&&p.value.includes(0)&&U===0||Array.isArray(p.value)&&!p.value.includes(U)&&(g.type==="mousedown"||g.type==="touchstart"))return!1;const ae=Array.isArray(p.value)&&p.value.includes(U)||r.value===!0&&Array.isArray(p.value)&&!p.value.includes(0)||!U||U<=1;return(!g.ctrlKey||H.value||g.type==="wheel")&&ae}),Me([w,ne],()=>{w.value&&!_.value?Ie.on("zoom",null):w.value||Ie.on("zoom",g=>{ee.value={x:g.transform.x,y:g.transform.y,zoom:g.transform.k};const M=re(g.transform);B=te(ne.value,I??0),P.viewportChange(M),P.move({event:g,flowTransform:M})})},{immediate:!0}),Me([w,fe,c,K,m,f,h],()=>{fe.value&&!K.value&&!w.value?pe.on("wheel.zoom",g=>{if(_e(g,h.value))return!1;const M=K.value||E.value,z=m.value&&g.ctrlKey;if(!(!f.value||fe.value||M||z))return!1;g.preventDefault(),g.stopImmediatePropagation();const U=pe.property("__zoom").k||1,ae=Gn();if(!H.value&&g.ctrlKey&&m.value&&ae){const dt=it(g),ft=gi(g),Nt=U*2**ft;Ie.scaleTo(pe,Nt,dt,g);return}const ge=g.deltaMode===1?20:1;let we=c.value===ln.Vertical?0:g.deltaX*ge,Ne=c.value===ln.Horizontal?0:g.deltaY*ge;!ae&&g.shiftKey&&c.value!==ln.Vertical&&!we&&Ne&&(we=Ne,Ne=0),Ie.translateBy(pe,-(we/U)*d.value,-(Ne/U)*d.value);const Ae=re(pe.property("__zoom"));b&&clearTimeout(b),se.value?(P.move({event:g,flowTransform:Ae}),P.viewportChange(Ae),b=setTimeout(()=>{P.moveEnd({event:g,flowTransform:Ae}),P.viewportChangeEnd(Ae),se.value=!1},150)):(se.value=!0,P.moveStart({event:g,flowTransform:Ae}),P.viewportChangeStart(Ae))},{passive:!1}):typeof Se<"u"&&pe.on("wheel.zoom",function(g,M){const z=!f.value&&g.type==="wheel"&&!g.ctrlKey,le=K.value||E.value,U=m.value&&g.ctrlKey;if(!le&&!a.value&&!U&&g.type==="wheel"||z||_e(g,h.value))return null;g.preventDefault(),Se.call(this,g,M)},{passive:!1})},{immediate:!0})});function te(ue,ke){return ke===2&&Array.isArray(ue)&&ue.includes(2)}function ce(ue,ke){return ue.x!==ke.x&&!Number.isNaN(ke.x)||ue.y!==ke.y&&!Number.isNaN(ke.y)||ue.zoom!==ke.k&&!Number.isNaN(ke.k)}function re(ue){return{x:ue.x,y:ue.y,zoom:ue.k}}function _e(ue,ke){return ue.target.closest(`.${ke}`)}return(ue,ke)=>($(),O("div",{ref_key:"viewportRef",ref:ie,class:"vue-flow__viewport vue-flow__container"},[q(zd,{"is-selecting":me.value,"selection-key-pressed":T(Q),class:ve({connecting:!!T(k),dragging:T(S),draggable:T(p)===!0||Array.isArray(T(p))&&T(p).includes(0)})},{default:Xe(()=>[q(Ld,null,{default:Xe(()=>[lt(ue.$slots,"default")]),_:3})]),_:3},8,["is-selecting","selection-key-pressed","class"])],512))}}),Hd=["id"],Gd=["id"],Yd=["id"],Wd={name:"A11yDescriptions",compatConfig:{MODE:3}},Ud=Pe({...Wd,setup(e){const{id:t,disableKeyboardA11y:n,ariaLiveMessage:o}=Re();return(i,s)=>($(),O(xe,null,[u("div",{id:`${T(hs)}-${T(t)}`,style:{display:"none"}}," Press enter or space to select a node. "+V(T(n)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,Hd),u("div",{id:`${T(ms)}-${T(t)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,Gd),T(n)?ye("",!0):($(),O("div",{key:0,id:`${T(du)}-${T(t)}`,"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)","clip-path":"inset(100%)"}},V(T(o)),9,Yd))],64))}});function Xd(){const e=Re();Me(()=>e.viewportHelper.value.viewportInitialized,t=>{t&&setTimeout(()=>{e.emits.init(e),e.emits.paneReady(e)},1)})}function Zd(e,t,n){return n===X.Left?e-t:n===X.Right?e+t:e}function qd(e,t,n){return n===X.Top?e-t:n===X.Bottom?e+t:e}const Wo=function({radius:e=10,centerX:t=0,centerY:n=0,position:o=X.Top,type:i}){return De("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${i}`,cx:Zd(t,e,o),cy:qd(n,e,o),r:e,stroke:"transparent",fill:"transparent"})};Wo.props=["radius","centerX","centerY","position","type"];Wo.compatConfig={MODE:3};const Ai=Wo,Kd=Pe({name:"Edge",compatConfig:{MODE:3},props:["id"],setup(e){const{id:t,addSelectedEdges:n,connectionMode:o,edgeUpdaterRadius:i,emits:s,nodesSelectionActive:r,noPanClassName:l,getEdgeTypes:a,removeSelectedEdges:c,findEdge:d,findNode:p,isValidConnection:y,multiSelectionActive:m,disableKeyboardA11y:E,elementsSelectable:f,edgesUpdatable:h,edgesFocusable:C,hooks:P}=Re(),k=W(()=>d(e.id)),{emit:w,on:S}=Fu(k.value,s),j=qt(Qn),Y=hn(),J=he(!1),ee=he(!1),ie=he(""),D=he(null),_=he("source"),se=he(null),b=Be(()=>typeof k.value.selectable>"u"?f.value:k.value.selectable),B=Be(()=>typeof k.value.updatable>"u"?h.value:k.value.updatable),I=Be(()=>typeof k.value.focusable>"u"?C.value:k.value.focusable);Yt(Bu,e.id),Yt(Lu,se);const L=W(()=>k.value.class instanceof Function?k.value.class(k.value):k.value.class),H=W(()=>k.value.style instanceof Function?k.value.style(k.value):k.value.style),Q=W(()=>{const v=k.value.type||"default",g=j?.[`edge-${v}`];if(g)return g;let M=k.value.template??a.value[v];if(typeof M=="string"&&Y){const z=Object.keys(Y.appContext.components);z&&z.includes(v)&&(M=Et(v,!1))}return M&&typeof M!="string"?M:(s.error(new Ge(Fe.EDGE_TYPE_MISSING,M)),!1)}),{handlePointerDown:K}=Ps({nodeId:ie,handleId:D,type:_,isValidConnection:y,edgeUpdaterType:_,onEdgeUpdate:me,onEdgeUpdateEnd:te});return()=>{const v=p(k.value.source),g=p(k.value.target),M="pathOptions"in k.value?k.value.pathOptions:{};if(!v&&!g)return s.error(new Ge(Fe.EDGE_SOURCE_TARGET_MISSING,k.value.id,k.value.source,k.value.target)),null;if(!v)return s.error(new Ge(Fe.EDGE_SOURCE_MISSING,k.value.id,k.value.source)),null;if(!g)return s.error(new Ge(Fe.EDGE_TARGET_MISSING,k.value.id,k.value.target)),null;if(!k.value||k.value.hidden||v.hidden||g.hidden)return null;let z;o.value===kt.Strict?z=v.handleBounds.source:z=[...v.handleBounds.source||[],...v.handleBounds.target||[]];const le=_i(z,k.value.sourceHandle);let U;o.value===kt.Strict?U=g.handleBounds.target:U=[...g.handleBounds.target||[],...g.handleBounds.source||[]];const ae=_i(U,k.value.targetHandle),ge=le?.position||X.Bottom,we=ae?.position||X.Top,{x:Ne,y:Ae}=Zt(v,le,ge),{x:dt,y:ft}=Zt(g,ae,we);return k.value.sourceX=Ne,k.value.sourceY=Ae,k.value.targetX=dt,k.value.targetY=ft,De("g",{ref:se,key:e.id,"data-id":e.id,class:["vue-flow__edge",`vue-flow__edge-${Q.value===!1?"default":k.value.type||"default"}`,l.value,L.value,{updating:J.value,selected:k.value.selected,animated:k.value.animated,inactive:!b.value&&!P.value.edgeClick.hasListeners()}],tabIndex:I.value?0:void 0,"aria-label":k.value.ariaLabel===null?void 0:k.value.ariaLabel??`Edge from ${k.value.source} to ${k.value.target}`,"aria-describedby":I.value?`${ms}-${t}`:void 0,"aria-roledescription":"edge",role:I.value?"group":"img",...k.value.domAttributes,onClick:re,onContextmenu:_e,onDblclick:ue,onMouseenter:ke,onMousemove:Ie,onMouseleave:pe,onKeyDown:I.value?x:void 0},[ee.value?null:De(Q.value===!1?a.value.default:Q.value,{id:e.id,sourceNode:v,targetNode:g,source:k.value.source,target:k.value.target,type:k.value.type,updatable:B.value,selected:k.value.selected,animated:k.value.animated,label:k.value.label,labelStyle:k.value.labelStyle,labelShowBg:k.value.labelShowBg,labelBgStyle:k.value.labelBgStyle,labelBgPadding:k.value.labelBgPadding,labelBgBorderRadius:k.value.labelBgBorderRadius,data:k.value.data,events:{...k.value.events,...S},style:H.value,markerStart:`url('#${gn(k.value.markerStart,t)}')`,markerEnd:`url('#${gn(k.value.markerEnd,t)}')`,sourcePosition:ge,targetPosition:we,sourceX:Ne,sourceY:Ae,targetX:dt,targetY:ft,sourceHandleId:k.value.sourceHandle,targetHandleId:k.value.targetHandle,interactionWidth:k.value.interactionWidth,...M}),[B.value==="source"||B.value===!0?[De("g",{onMousedown:Se,onMouseenter:ne,onMouseout:fe},De(Ai,{position:ge,centerX:Ne,centerY:Ae,radius:i.value,type:"source","data-type":"source"}))]:null,B.value==="target"||B.value===!0?[De("g",{onMousedown:be,onMouseenter:ne,onMouseout:fe},De(Ai,{position:we,centerX:dt,centerY:ft,radius:i.value,type:"target","data-type":"target"}))]:null]])};function ne(){J.value=!0}function fe(){J.value=!1}function me(v,g){w.update({event:v,edge:k.value,connection:g})}function te(v){w.updateEnd({event:v,edge:k.value}),ee.value=!1}function ce(v,g){v.button===0&&(ee.value=!0,ie.value=g?k.value.target:k.value.source,D.value=(g?k.value.targetHandle:k.value.sourceHandle)??null,_.value=g?"target":"source",w.updateStart({event:v,edge:k.value}),K(v))}function re(v){var g;const M={event:v,edge:k.value};b.value&&(r.value=!1,k.value.selected&&m.value?(c([k.value]),(g=se.value)==null||g.blur()):n([k.value])),w.click(M)}function _e(v){w.contextMenu({event:v,edge:k.value})}function ue(v){w.doubleClick({event:v,edge:k.value})}function ke(v){w.mouseEnter({event:v,edge:k.value})}function Ie(v){w.mouseMove({event:v,edge:k.value})}function pe(v){w.mouseLeave({event:v,edge:k.value})}function Se(v){ce(v,!0)}function be(v){ce(v,!1)}function x(v){var g;!E.value&&vs.includes(v.key)&&b.value&&(v.key==="Escape"?((g=se.value)==null||g.blur(),c([d(e.id)])):n([d(e.id)]))}}}),jd=Kd,Jd=Pe({name:"ConnectionLine",compatConfig:{MODE:3},setup(){var e;const{id:t,connectionMode:n,connectionStartHandle:o,connectionEndHandle:i,connectionPosition:s,connectionLineType:r,connectionLineStyle:l,connectionLineOptions:a,connectionStatus:c,viewport:d,findNode:p}=Re(),y=(e=qt(Qn))==null?void 0:e["connection-line"],m=W(()=>{var P;return p((P=o.value)==null?void 0:P.nodeId)}),E=W(()=>{var P;return p((P=i.value)==null?void 0:P.nodeId)??null}),f=W(()=>({x:(s.value.x-d.value.x)/d.value.zoom,y:(s.value.y-d.value.y)/d.value.zoom})),h=W(()=>a.value.markerStart?`url(#${gn(a.value.markerStart,t)})`:""),C=W(()=>a.value.markerEnd?`url(#${gn(a.value.markerEnd,t)})`:"");return()=>{var P,k,w;if(!m.value||!o.value)return null;const S=o.value.id,j=o.value.type,Y=m.value.handleBounds;let J=Y?.[j]??[];if(n.value===kt.Loose){const H=Y?.[j==="source"?"target":"source"]??[];J=[...J,...H]}if(!J)return null;const ee=(S?J.find(H=>H.id===S):J[0])??null,ie=ee?.position??X.Top,{x:D,y:_}=Zt(m.value,ee,ie);let se=null;E.value&&(n.value===kt.Strict?se=((P=E.value.handleBounds[j==="source"?"target":"source"])==null?void 0:P.find(H=>{var Q;return H.id===((Q=i.value)==null?void 0:Q.id)}))||null:se=((k=[...E.value.handleBounds.source??[],...E.value.handleBounds.target??[]])==null?void 0:k.find(H=>{var Q;return H.id===((Q=i.value)==null?void 0:Q.id)}))||null);const b=((w=i.value)==null?void 0:w.position)??(ie?Mo[ie]:null);if(!ie||!b)return null;const B=r.value??a.value.type??It.Bezier;let I="";const L={sourceX:D,sourceY:_,sourcePosition:ie,targetX:f.value.x,targetY:f.value.y,targetPosition:b};return B===It.Bezier?[I]=Vs(L):B===It.Step?[I]=Ao({...L,borderRadius:0}):B===It.SmoothStep?[I]=Ao(L):B===It.SimpleBezier?[I]=Fs(L):I=`M${D},${_} ${f.value.x},${f.value.y}`,De("svg",{class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},De("g",{class:"vue-flow__connection"},y?De(y,{sourceX:D,sourceY:_,sourcePosition:ie,targetX:f.value.x,targetY:f.value.y,targetPosition:b,sourceNode:m.value,sourceHandle:ee,targetNode:E.value,targetHandle:se,markerEnd:C.value,markerStart:h.value,connectionStatus:c.value}):De("path",{d:I,class:[a.value.class,c,"vue-flow__connection-path"],style:{...l.value,...a.value.style},"marker-end":C.value,"marker-start":h.value})))}}}),Qd=Jd,ef=["id","markerWidth","markerHeight","markerUnits","orient"],tf={name:"MarkerType",compatConfig:{MODE:3}},nf=Pe({...tf,props:{id:{},type:{},color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(e){return(t,n)=>($(),O("marker",{id:t.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${t.width}`,markerHeight:`${t.height}`,markerUnits:t.markerUnits,orient:t.orient},[t.type===T($o).ArrowClosed?($(),O("polyline",{key:0,style:We({stroke:t.color,fill:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",points:"-5,-4 0,0 -5,4 -5,-4"},null,4)):ye("",!0),t.type===T($o).Arrow?($(),O("polyline",{key:1,style:We({stroke:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",fill:"none",points:"-5,-4 0,0 -5,4"},null,4)):ye("",!0)],8,ef))}}),of={class:"vue-flow__marker vue-flow__container","aria-hidden":"true"},sf={name:"MarkerDefinitions",compatConfig:{MODE:3}},rf=Pe({...sf,setup(e){const{id:t,edges:n,connectionLineOptions:o,defaultMarkerColor:i}=Re(),s=W(()=>{const r=new Set,l=[],a=c=>{if(c){const d=gn(c,t);r.has(d)||(typeof c=="object"?l.push({...c,id:d,color:c.color||i.value}):l.push({id:d,color:i.value,type:c}),r.add(d))}};for(const c of[o.value.markerEnd,o.value.markerStart])a(c);for(const c of n.value)for(const d of[c.markerStart,c.markerEnd])a(d);return l.sort((c,d)=>c.id.localeCompare(d.id))});return(r,l)=>($(),O("svg",of,[u("defs",null,[($(!0),O(xe,null,Te(s.value,a=>($(),$e(nf,{id:a.id,key:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,"stroke-width":a.strokeWidth,orient:a.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))])]))}}),lf={name:"Edges",compatConfig:{MODE:3}},af=Pe({...lf,setup(e){const{findNode:t,getEdges:n,elevateEdgesOnSelect:o}=Re();return(i,s)=>($(),O(xe,null,[q(rf),($(!0),O(xe,null,Te(T(n),r=>($(),O("svg",{key:r.id,class:"vue-flow__edges vue-flow__container",style:We({zIndex:T(Su)(r,T(t),T(o))})},[q(T(jd),{id:r.id},null,8,["id"])],4))),128)),q(T(Qd))],64))}}),cf=Pe({name:"Node",compatConfig:{MODE:3},props:["id","resizeObserver"],setup(e){const{id:t,noPanClassName:n,selectNodesOnDrag:o,nodesSelectionActive:i,multiSelectionActive:s,emits:r,removeSelectedNodes:l,addSelectedNodes:a,updateNodeDimensions:c,onUpdateNodeInternals:d,getNodeTypes:p,nodeExtent:y,elevateNodesOnSelect:m,disableKeyboardA11y:E,ariaLiveMessage:f,snapToGrid:h,snapGrid:C,nodeDragThreshold:P,nodesDraggable:k,elementsSelectable:w,nodesConnectable:S,nodesFocusable:j,hooks:Y}=Re(),J=he(null);Yt(Ds,J),Yt(Ms,e.id);const ee=qt(Qn),ie=hn(),D=Rs(),{node:_,parentNode:se}=Os(e.id),{emit:b,on:B}=Wu(_,r),I=Be(()=>typeof _.draggable>"u"?k.value:_.draggable),L=Be(()=>typeof _.selectable>"u"?w.value:_.selectable),H=Be(()=>typeof _.connectable>"u"?S.value:_.connectable),Q=Be(()=>typeof _.focusable>"u"?j.value:_.focusable),K=W(()=>L.value||I.value||Y.value.nodeClick.hasListeners()||Y.value.nodeDoubleClick.hasListeners()||Y.value.nodeMouseEnter.hasListeners()||Y.value.nodeMouseMove.hasListeners()||Y.value.nodeMouseLeave.hasListeners()),ne=Be(()=>!!_.dimensions.width&&!!_.dimensions.height),fe=W(()=>{const g=_.type||"default",M=ee?.[`node-${g}`];if(M)return M;let z=_.template||p.value[g];if(typeof z=="string"&&ie){const le=Object.keys(ie.appContext.components);le&&le.includes(g)&&(z=Et(g,!1))}return z&&typeof z!="string"?z:(r.error(new Ge(Fe.NODE_TYPE_MISSING,z)),!1)}),me=As({id:e.id,el:J,disabled:()=>!I.value,selectable:L,dragHandle:()=>_.dragHandle,onStart(g){b.dragStart(g)},onDrag(g){b.drag(g)},onStop(g){b.dragStop(g)},onClick(g){x(g)}}),te=W(()=>_.class instanceof Function?_.class(_):_.class),ce=W(()=>{const g=(_.style instanceof Function?_.style(_):_.style)||{},M=_.width instanceof Function?_.width(_):_.width,z=_.height instanceof Function?_.height(_):_.height;return!g.width&&M&&(g.width=typeof M=="string"?M:`${M}px`),!g.height&&z&&(g.height=typeof z=="string"?z:`${z}px`),g}),re=Be(()=>Number(_.zIndex??ce.value.zIndex??0));return d(g=>{(g.includes(e.id)||!g.length)&&ue()}),ct(()=>{Me(()=>_.hidden,(g=!1,M,z)=>{!g&&J.value&&(e.resizeObserver.observe(J.value),z(()=>{J.value&&e.resizeObserver.unobserve(J.value)}))},{immediate:!0,flush:"post"})}),Me([()=>_.type,()=>_.sourcePosition,()=>_.targetPosition],()=>{et(()=>{c([{id:e.id,nodeElement:J.value,forceUpdate:!0}])})}),Me([()=>_.position.x,()=>_.position.y,()=>{var g;return(g=se.value)==null?void 0:g.computedPosition.x},()=>{var g;return(g=se.value)==null?void 0:g.computedPosition.y},()=>{var g;return(g=se.value)==null?void 0:g.computedPosition.z},re,()=>_.selected,()=>_.dimensions.height,()=>_.dimensions.width,()=>{var g;return(g=se.value)==null?void 0:g.dimensions.height},()=>{var g;return(g=se.value)==null?void 0:g.dimensions.width}],([g,M,z,le,U,ae])=>{const ge={x:g,y:M,z:ae+(m.value&&_.selected?1e3:0)};typeof z<"u"&&typeof le<"u"?_.computedPosition=wu({x:z,y:le,z:U},ge):_.computedPosition=ge},{flush:"post",immediate:!0}),Me([()=>_.extent,y],([g,M],[z,le])=>{(g!==z||M!==le)&&_e()}),_.extent==="parent"||typeof _.extent=="object"&&"range"in _.extent&&_.extent.range==="parent"?wo(()=>ne).toBe(!0).then(_e):_e(),()=>_.hidden?null:De("div",{ref:J,"data-id":_.id,class:["vue-flow__node",`vue-flow__node-${fe.value===!1?"default":_.type||"default"}`,{[n.value]:I.value,dragging:me?.value,draggable:I.value,selected:_.selected,selectable:L.value,parent:_.isParent},te.value],style:{visibility:ne.value?"visible":"hidden",zIndex:_.computedPosition.z??re.value,transform:`translate(${_.computedPosition.x}px,${_.computedPosition.y}px)`,pointerEvents:K.value?"all":"none",...ce.value},tabIndex:Q.value?0:void 0,role:Q.value?"group":void 0,"aria-describedby":E.value?void 0:`${hs}-${t}`,"aria-label":_.ariaLabel,"aria-roledescription":"node",..._.domAttributes,onMouseenter:ke,onMousemove:Ie,onMouseleave:pe,onContextmenu:Se,onClick:x,onDblclick:be,onKeydown:v},[De(fe.value===!1?p.value.default:fe.value,{id:_.id,type:_.type,data:_.data,events:{..._.events,...B},selected:_.selected,resizing:_.resizing,dragging:me.value,connectable:H.value,position:_.computedPosition,dimensions:_.dimensions,isValidTargetPos:_.isValidTargetPos,isValidSourcePos:_.isValidSourcePos,parent:_.parentNode,parentNodeId:_.parentNode,zIndex:_.computedPosition.z??re.value,targetPosition:_.targetPosition,sourcePosition:_.sourcePosition,label:_.label,dragHandle:_.dragHandle,onUpdateNodeInternals:ue})]);function _e(){const g=_.computedPosition,{computedPosition:M,position:z}=Go(_,h.value?jn(g,C.value):g,r.error,y.value,se.value);(_.computedPosition.x!==M.x||_.computedPosition.y!==M.y)&&(_.computedPosition={..._.computedPosition,...M}),(_.position.x!==z.x||_.position.y!==z.y)&&(_.position=z)}function ue(){J.value&&c([{id:e.id,nodeElement:J.value,forceUpdate:!0}])}function ke(g){me?.value||b.mouseEnter({event:g,node:_})}function Ie(g){me?.value||b.mouseMove({event:g,node:_})}function pe(g){me?.value||b.mouseLeave({event:g,node:_})}function Se(g){return b.contextMenu({event:g,node:_})}function be(g){return b.doubleClick({event:g,node:_})}function x(g){L.value&&(!o.value||!I.value||P.value>0)&&Do(_,s.value,a,l,i,!1,J.value),b.click({event:g,node:_})}function v(g){if(!(Io(g)||E.value))if(vs.includes(g.key)&&L.value){const M=g.key==="Escape";Do(_,s.value,a,l,i,M,J.value)}else I.value&&_.selected&&Gt[g.key]&&(g.preventDefault(),f.value=`Moved selected node ${g.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~_.position.x}, y: ${~~_.position.y}`,D({x:Gt[g.key].x,y:Gt[g.key].y},g.shiftKey))}}}),uf=cf;function df(e={includeHiddenNodes:!1}){const{nodes:t}=Re();return W(()=>{if(t.value.length===0)return!1;for(const n of t.value)if((e.includeHiddenNodes||!n.hidden)&&(n?.handleBounds===void 0||n.dimensions.width===0||n.dimensions.height===0))return!1;return!0})}const ff={class:"vue-flow__nodes vue-flow__container"},pf={name:"Nodes",compatConfig:{MODE:3}},gf=Pe({...pf,setup(e){const{getNodes:t,updateNodeDimensions:n,emits:o}=Re(),i=df(),s=he();return Me(i,r=>{r&&et(()=>{o.nodesInitialized(t.value)})},{immediate:!0}),ct(()=>{s.value=new ResizeObserver(r=>{const l=r.map(a=>({id:a.target.getAttribute("data-id"),nodeElement:a.target,forceUpdate:!0}));et(()=>n(l))})}),zi(()=>{var r;return(r=s.value)==null?void 0:r.disconnect()}),(r,l)=>($(),O("div",ff,[s.value?($(!0),O(xe,{key:0},Te(T(t),(a,c,d,p)=>{const y=[a.id];if(p&&p.key===a.id&&Js(p,y))return p;const m=($(),$e(T(uf),{id:a.id,key:a.id,"resize-observer":s.value},null,8,["id","resize-observer"]));return m.memo=y,m},l,0),128)):ye("",!0)]))}});function hf(){const{emits:e}=Re();ct(()=>{if(Ts()){const t=document.querySelector(".vue-flow__pane");t&&window.getComputedStyle(t).zIndex!=="1"&&e.error(new Ge(Fe.MISSING_STYLES))}})}const mf=u("div",{class:"vue-flow__edge-labels"},null,-1),vf={name:"VueFlow",compatConfig:{MODE:3}},yf=Pe({...vf,props:{id:{},modelValue:{},nodes:{},edges:{},edgeTypes:{},nodeTypes:{},connectionMode:{},connectionLineType:{},connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:{},isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:{default:void 0},selectionKeyCode:{type:[Boolean,null],default:void 0},multiSelectionKeyCode:{default:void 0},zoomActivationKeyCode:{default:void 0},panActivationKeyCode:{default:void 0},snapToGrid:{type:Boolean,default:void 0},snapGrid:{},onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},nodeDragThreshold:{},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:{},maxZoom:{},defaultViewport:{},translateExtent:{},nodeExtent:{},defaultMarkerColor:{},zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:{},panOnScrollMode:{},paneClickDistance:{},zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:{},edgeUpdaterRadius:{},fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:{},noWheelClassName:{},noPanClassName:{},defaultEdgeOptions:{},elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},autoPanSpeed:{}},emits:["nodesChange","edgesChange","nodesInitialized","paneReady","init","updateNodeInternals","error","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeUpdate","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdateEnd","nodeContextMenu","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeDoubleClick","nodeClick","nodeDragStart","nodeDrag","nodeDragStop","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","update:modelValue","update:nodes","update:edges"],setup(e,{expose:t,emit:n}){const o=e,i=Xs(),s=so(o,"modelValue",n),r=so(o,"nodes",n),l=so(o,"edges",n),a=Re(o),c=qu({modelValue:s,nodes:r,edges:l},o,a);return ju(n,a.hooks),Xd(),hf(),Yt(Qn,i),Zs(()=>{c()}),t(a),(d,p)=>($(),O("div",{ref:T(a).vueFlowRef,class:"vue-flow"},[q(Fd,null,{default:Xe(()=>[q(af),mf,q(gf),lt(d.$slots,"zoom-pane")]),_:3}),lt(d.$slots,"default"),q(Ud)],512))}});var yt=(e=>(e.Lines="lines",e.Dots="dots",e))(yt||{});const Gs=function({dimensions:e,size:t,color:n}){return De("path",{stroke:n,"stroke-width":t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})},Ys=function({radius:e,color:t}){return De("circle",{cx:e,cy:e,r:e,fill:t})};yt.Lines+"",yt.Dots+"";const wf={[yt.Dots]:"#81818a",[yt.Lines]:"#eee"},xf=["id","x","y","width","height","patternTransform"],_f={key:2,height:"100",width:"100"},bf=["fill"],Ef=["x","y","fill"],kf={name:"Background",compatConfig:{MODE:3}},Sf=Pe({...kf,props:{id:{},variant:{default:()=>yt.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:{},color:{},bgColor:{},height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:0}},setup(e){const{id:t,viewport:n}=Re(),o=W(()=>{const r=n.value.zoom,[l,a]=Array.isArray(e.gap)?e.gap:[e.gap,e.gap],c=[l*r||1,a*r||1],d=e.size*r,[p,y]=Array.isArray(e.offset)?e.offset:[e.offset,e.offset],m=[p*r||1+c[0]/2,y*r||1+c[1]/2];return{scaledGap:c,offset:m,size:d}}),i=Be(()=>`pattern-${t}${e.id?`-${e.id}`:""}`),s=Be(()=>e.color||e.patternColor||wf[e.variant||yt.Dots]);return(r,l)=>($(),O("svg",{class:"vue-flow__background vue-flow__container",style:We({height:`${r.height>100?100:r.height}%`,width:`${r.width>100?100:r.width}%`})},[lt(r.$slots,"pattern-container",{id:i.value},()=>[u("pattern",{id:i.value,x:T(n).x%o.value.scaledGap[0],y:T(n).y%o.value.scaledGap[1],width:o.value.scaledGap[0],height:o.value.scaledGap[1],patternTransform:`translate(-${o.value.offset[0]},-${o.value.offset[1]})`,patternUnits:"userSpaceOnUse"},[lt(r.$slots,"pattern",{},()=>[r.variant===T(yt).Lines?($(),$e(T(Gs),{key:0,size:r.lineWidth,color:s.value,dimensions:o.value.scaledGap},null,8,["size","color","dimensions"])):r.variant===T(yt).Dots?($(),$e(T(Ys),{key:1,color:s.value,radius:o.value.size/2},null,8,["color","radius"])):ye("",!0),r.bgColor?($(),O("svg",_f,[u("rect",{width:"100%",height:"100%",fill:r.bgColor},null,8,bf)])):ye("",!0)])],8,xf)]),u("rect",{x:r.x,y:r.y,width:"100%",height:"100%",fill:`url(#${i.value})`},null,8,Ef),lt(r.$slots,"default",{id:i.value})],4))}}),Nf={class:"ultra-card-wrapper"},Cf={class:"ribbon-text"},$f={class:"card-content"},If={class:"text-content"},Tf={class:"card-title"},Mf={class:"tech-strip"},Df={class:"tech-dots"},Af={class:"tech-type"},Pf={key:0,class:"tech-badge"},Of=Pe({__name:"UltraModernCard",props:{data:{},selected:{type:Boolean}},setup(e){const t=e,n=W(()=>{const f=t.data.nodeType||"",h=t.data.type||"",C=t.data.label.toLowerCase();return h==="tool"||f.includes("toolWorkflow")||f.includes("dateTimeTool")||f.includes("vectorStoreQdrant")||f.includes("embeddingsOpenAi")||f.includes("lmChatOpenAi")||f.includes("outputParser")||C==="info ordini"||C==="date & time"||C==="parcelapp"||C==="formatta risposta"||C.includes("retriever")||C.includes("memory")||C.includes("buffer")}),o=W(()=>{const f=t.data.nodeType||"",h=t.data.type||"",C=t.data.label.toLowerCase(),P=h==="ai"&&f.includes("langchain.agent");return P&&console.log("🤖 AI Agent detected:",C,"type:",h,"nodeType:",f),P}),i=W(()=>{const f=t.data.type,h=t.data.nodeType||"",C=t.data.label.toLowerCase();return f==="trigger"||h.includes("trigger")?"trigger":f==="ai"||h.includes("agent")||h.includes("openai")?"ai":f==="storage"||h.includes("database")||h.includes("vector")?"storage":h.includes("if")||h.includes("switch")?"logic":h.includes("http")||h.includes("webhook")?"integration":h.includes("code")||h.includes("function")?"transform":C.includes("email")||C.includes("slack")?"communication":"process"}),s=W(()=>({trigger:"carbon:flash",ai:"carbon:watson-machine-learning",storage:"carbon:db2-database",logic:"carbon:decision-tree",integration:"carbon:api",transform:"carbon:transform",communication:"carbon:email",process:"carbon:flow"})[i.value]||"carbon:circle-solid"),r=W(()=>{const f=t.data.label.toLowerCase(),h=t.data.nodeType||"";return h.includes("postgres")||f.includes("postgres")?"simple-icons:postgresql":h.includes("mysql")||f.includes("mysql")?"simple-icons:mysql":h.includes("mongodb")||f.includes("mongo")?"simple-icons:mongodb":h.includes("redis")||f.includes("redis")?"simple-icons:redis":h.includes("supabase")||f.includes("supabase")?"simple-icons:supabase":h==="n8n-nodes-base.microsoftOutlook"||h==="n8n-nodes-base.microsoftOutlookTrigger"||h.includes("microsoftOutlook")||h.includes("outlook")||f.includes("outlook")||f.includes("mail")&&(f.includes("ordini")||f.includes("email"))?"vscode-icons:file-type-outlook":h.includes("telegram")||f.includes("telegram")?"simple-icons:telegram":h.includes("slack")||f.includes("slack")?"simple-icons:slack":h.includes("gmail")||f.includes("gmail")?"simple-icons:gmail":h.includes("discord")||f.includes("discord")?"simple-icons:discord":h.includes("whatsapp")||f.includes("whatsapp")?"simple-icons:whatsapp":h.includes("langchain.agent")||h==="ai"&&nodeType.includes("agent")||f.includes("agent")||f.includes("assistente")||f.includes("milena")?"fluent:brain-circuit-20-regular":h.includes("openai")||f.includes("openai")||f.includes("gpt")?"simple-icons:openai":h.includes("anthropic")||f.includes("claude")?"simple-icons:anthropic":h.includes("langchain")?"carbon:flow-data":h.includes("google")||f.includes("google")?"simple-icons:google":h.includes("aws")||f.includes("aws")?"simple-icons:amazonaws":h.includes("azure")||f.includes("azure")?"simple-icons:microsoftazure":h.includes("github")||f.includes("github")?"simple-icons:github":h.includes("gitlab")||f.includes("gitlab")?"simple-icons:gitlab":h.includes("docker")||f.includes("docker")?"simple-icons:docker":h.includes("kubernetes")||f.includes("kubernetes")?"simple-icons:kubernetes":h.includes("git")||f.includes("git")?"simple-icons:git":h.includes("twitter")||f.includes("twitter")?"simple-icons:x":h.includes("facebook")||f.includes("facebook")?"simple-icons:facebook":h.includes("instagram")||f.includes("instagram")?"simple-icons:instagram":h.includes("linkedin")||f.includes("linkedin")?"simple-icons:linkedin":h.includes("stripe")||f.includes("stripe")?"simple-icons:stripe":h.includes("paypal")||f.includes("paypal")?"simple-icons:paypal":h.includes("shopify")||f.includes("shopify")?"simple-icons:shopify":h.includes("wordpress")||f.includes("wordpress")?"simple-icons:wordpress":h.includes("excel")||f.includes("excel")?"vscode-icons:file-type-excel":h.includes("csv")||f.includes("csv")?"vscode-icons:file-type-csv":h.includes("json")||f.includes("json")?"vscode-icons:file-type-json":h.includes("xml")||f.includes("xml")?"vscode-icons:file-type-xml":h.includes("pdf")||f.includes("pdf")?"vscode-icons:file-type-pdf":h.includes("n8n-nodes-base.spreadsheetFile")?"vscode-icons:file-type-excel":h.includes("n8n-nodes-base.googleSheets")?"simple-icons:googlesheets":h.includes("n8n-nodes-base.googleDrive")?"simple-icons:googledrive":h.includes("n8n-nodes-base.notion")?"simple-icons:notion":h.includes("n8n-nodes-base.airtable")?"simple-icons:airtable":h.includes("n8n-nodes-base.trello")?"simple-icons:trello":h.includes("n8n-nodes-base.jira")?"simple-icons:jira":h.includes("n8n-nodes-base.asana")?"simple-icons:asana":h.includes("n8n-nodes-base.monday")?"simple-icons:mondaydotcom":h.includes("n8n-nodes-base.clickup")?"simple-icons:clickup":h.includes("n8n-nodes-base.hubspot")?"simple-icons:hubspot":h.includes("n8n-nodes-base.salesforce")?"simple-icons:salesforce":h.includes("n8n-nodes-base.zendesk")?"simple-icons:zendesk":h.includes("n8n-nodes-base.twilio")?"simple-icons:twilio":h.includes("n8n-nodes-base.sendgrid")?"simple-icons:sendgrid":h.includes("n8n-nodes-base.mailchimp")?"simple-icons:mailchimp":h.includes("n8n-nodes-base.calendly")?"simple-icons:calendly":h.includes("n8n-nodes-base.zoom")?"simple-icons:zoom":h.includes("n8n-nodes-base.teams")?"simple-icons:microsoftteams":h.includes("n8n-nodes-base.dropbox")?"simple-icons:dropbox":h.includes("n8n-nodes-base.box")?"simple-icons:box":h.includes("n8n-nodes-base.onedrive")?"simple-icons:microsoftonedrive":h.includes("webhook")?"carbon:webhook":h.includes("schedule")||h.includes("cron")?"carbon:alarm":h.includes("httpRequest")?"carbon:http":h.includes("n8n-nodes-base.code")?"carbon:code":h.includes("n8n-nodes-base.function")?"carbon:function":h.includes("n8n-nodes-base.if")?"carbon:decision-tree":h.includes("n8n-nodes-base.switch")?"carbon:flow-switch":h.includes("n8n-nodes-base.merge")?"carbon:join-inner":h.includes("n8n-nodes-base.wait")?"carbon:hourglass":h.includes("n8n-nodes-base.set")?"carbon:settings-adjust":h.includes("n8n-nodes-base.splitInBatches")?"carbon:batch-job":h.includes("email")?"carbon:email":s.value}),l=W(()=>{const f=t.data.label,h={Webhook:"Data Receiver","Schedule Trigger":"Scheduled Process","Manual Trigger":"Manual Start",OpenAI:"AI Processing","Chat Model":"AI Conversation",Agent:"Smart Assistant",Postgres:"Database Operations","Vector Store":"Knowledge Store","HTTP Request":"API Call",If:"Decision Logic",Switch:"Multi-Path Router",Code:"Custom Processing",Function:"Data Transform"};for(const[C,P]of Object.entries(h))if(f.includes(C))return P;return f});W(()=>({trigger:"Initiates business process",ai:"Intelligent processing",storage:"Data persistence layer",logic:"Business rule evaluation",integration:"External system bridge",transform:"Data manipulation",communication:"Message handling",process:"Business operation"})[i.value]||"Processing node");const a=W(()=>({trigger:"PROCESS START",ai:"INTELLIGENCE",storage:"DATA LAYER",logic:"DECISION",integration:"INTEGRATION",transform:"TRANSFORM",communication:"MESSAGING",process:"OPERATION"})[i.value]||"PROCESS");W(()=>({trigger:"ASYNC",ai:"ML/AI",storage:"CRUD",logic:"CONDITIONAL",integration:"REST/API",transform:"COMPUTE",communication:"SMTP/WEBHOOK",process:"SYNC"})[i.value]||"PROCESS");const c=W(()=>{const f={trigger:"linear-gradient(135deg, #2f855a, #276749)",ai:"linear-gradient(135deg, #553c9a, #434190)",storage:"linear-gradient(135deg, #2b6cb0, #2c5282)",logic:"linear-gradient(135deg, #4a5568, #2d3748)",integration:"linear-gradient(135deg, #742a2a, #63171b)",transform:"linear-gradient(135deg, #234e52, #1a4044)",communication:"linear-gradient(135deg, #744210, #5f370e)",process:"linear-gradient(135deg, #2d3748, #1a202c)"};return f[i.value]||f.process}),d=W(()=>{const f={trigger:"#276749",ai:"#434190",storage:"#2c5282",logic:"#2d3748",integration:"#63171b",transform:"#1a4044",communication:"#5f370e",process:"#1a202c"}[i.value]||"#1a202c";return`radial-gradient(circle, ${f}22, ${f}11)`});W(()=>t.data.inputs||["input"]),W(()=>t.data.outputs||["output"]);const p=W(()=>t.data.status==="active"),y=W(()=>t.data.status==="error");W(()=>t.data.status||"idle"),W(()=>i.value!=="trigger"),W(()=>t.data.executionCount),W(()=>t.data.successRate),W(()=>t.data.avgTime);const m=W(()=>{const f=t.data.nodeType||"",h=t.data.label.toLowerCase(),C=t.data.type||"";return f.includes("trigger")||f.includes("webhook")||f.includes("wait")||f.includes("cron")||f.includes("schedule")||C==="trigger"?"ASYNC":f.includes("n8n-nodes-base.code")||f.includes("n8n-nodes-base.function")||f.includes("javascript")||f.includes("python")||h.includes("code")||h.includes("function")?"CODE":f.includes("langchain")||f.includes("openai")||f.includes("ai")||C==="ai"||C==="tool"?"AI":f.includes("postgres")||f.includes("mysql")||f.includes("mongo")||f.includes("redis")||f.includes("supabase")||C==="storage"?"DB":f.includes("httpRequest")||f.includes("webhook")||f.includes("api")||h.includes("http")?"API":f.includes("n8n-nodes-base.if")||f.includes("switch")||h.includes("if")?"LOGIC":"SYNC"}),E=W(()=>{const f=t.data.nodeType||"";return t.data.label.toLowerCase(),f.includes("n8n-nodes-base.code")?"</>":f.includes("n8n-nodes-base.function")?"f(x)":f.includes("javascript")?"JS":f.includes("python")?"PY":f.includes("langchain.agent")?"AI":f.includes("openai")||f.includes("gpt")?"GPT":f.includes("embeddings")?"↗️":f.includes("postgres")?"PG":f.includes("mysql")?"SQL":f.includes("qdrant")||f.includes("vectorStore")?"VEC":f.includes("telegram")?"TG":f.includes("gmail")||f.includes("email")?"✉️":f.includes("slack")?"SK":f.includes("n8n-nodes-base.if")?"IF":f.includes("switch")?"⇄":f.includes("merge")?"⊕":f.includes("cron")?"⏰":f.includes("wait")?"⏸":null});return(f,h)=>($(),O("div",Nf,[u("div",{class:ve(["ultra-card",`card-${i.value}`,{"card-ai-wide":o.value,"card-tool-narrow":n.value,"card-running":p.value,"card-executing":f.data.isExecuting||f.data.status==="executing","card-error":y.value,"card-selected":f.selected}])},[u("div",{class:"card-ribbon",style:We({background:c.value})},[u("span",Cf,V(a.value),1)],4),u("div",$f,[u("div",{class:"icon-container",style:We({background:d.value})},[q(T(Ee),{icon:r.value,class:"main-icon"},null,8,["icon"]),h[0]||(h[0]=u("div",{class:"icon-pulse"},null,-1))],4),u("div",If,[u("h3",Tf,V(l.value),1)])]),u("div",Mf,[u("div",Df,[($(),O(xe,null,Te(3,C=>u("span",{key:C,class:"tech-dot"})),64))]),u("span",Af,V(m.value),1),E.value?($(),O("div",Pf,[u("span",null,V(E.value),1)])):ye("",!0)])],2),o.value?($(),O(xe,{key:0},[q(T(Oe),{type:"target",position:T(X).Left,id:"left",class:"ultra-handle handle-main"},null,8,["position"]),q(T(Oe),{type:"source",position:T(X).Right,id:"right",class:"ultra-handle handle-main"},null,8,["position"]),($(),O(xe,null,Te(4,C=>q(T(Oe),{key:`tool-out-${C}`,type:"source",position:T(X).Bottom,id:`tool-${C-1}`,class:"ultra-handle handle-tool",style:We({left:`${20+(C-1)*20}%`})},null,8,["position","id","style"])),64))],64)):n.value?($(),O(xe,{key:1},[q(T(Oe),{type:"target",position:T(X).Top,id:"top",class:"ultra-handle handle-tool-input"},null,8,["position"]),q(T(Oe),{type:"source",position:T(X).Bottom,id:"bottom",class:"ultra-handle handle-tool-output"},null,8,["position"])],64)):i.value==="storage"?($(),O(xe,{key:2},[q(T(Oe),{type:"target",position:T(X).Top,id:"top",class:"ultra-handle handle-data"},null,8,["position"]),q(T(Oe),{type:"source",position:T(X).Bottom,id:"bottom",class:"ultra-handle handle-data"},null,8,["position"])],64)):i.value==="trigger"?($(),$e(T(Oe),{key:3,type:"source",position:T(X).Right,id:"right",class:"ultra-handle handle-trigger"},null,8,["position"])):($(),O(xe,{key:4},[q(T(Oe),{type:"target",position:T(X).Left,id:"left",class:"ultra-handle handle-standard"},null,8,["position"]),q(T(Oe),{type:"source",position:T(X).Right,id:"right",class:"ultra-handle handle-standard"},null,8,["position"])],64))]))}}),Pi=Yn(Of,[["__scopeId","data-v-0f20d1c8"]]),Rf={class:"w-full max-w-6xl max-h-[90vh] bg-surface border border-border rounded-xl shadow-2xl overflow-hidden"},zf={class:"flex items-center justify-between p-6 border-b border-border"},Bf={class:"flex items-center gap-4"},Lf={class:"p-3 bg-primary/10 border border-primary/30 rounded-lg"},Vf={class:"text-xl font-semibold text-text"},Ff={class:"flex items-center gap-3 mt-1"},Hf={class:"text-sm text-text-muted"},Gf={key:0,class:"px-2 py-1 bg-blue-500/10 border border-blue-500/30 text-blue-400 rounded text-xs font-medium"},Yf={class:"flex items-center gap-2"},Wf=["disabled","title"],Uf={key:0,class:"flex items-center justify-center p-12"},Xf={key:1,class:"p-6"},Zf={class:"text-sm text-text-secondary mt-2"},qf={class:"mt-4 flex gap-2"},Kf={key:2},jf={class:"flex items-center gap-1 p-2 border-b border-border bg-gray-900/50"},Jf=["onClick"],Qf={class:"overflow-y-auto",style:{"max-height":"calc(90vh - 200px)"}},ep={key:0,class:"p-6 space-y-6"},tp={key:0,class:"control-card p-6 border-blue-500/30"},np={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},op={class:"space-y-3"},ip={class:"text-text text-sm whitespace-pre-wrap"},sp={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},rp={class:"control-card p-4"},lp={class:"flex items-center justify-between mb-2"},ap={class:"text-base font-bold text-text"},cp={class:"control-card p-4"},up={class:"flex items-center justify-between mb-2"},dp={class:"text-base font-bold text-text"},fp={class:"control-card p-4"},pp={class:"flex items-center justify-between mb-2"},gp={class:"text-base font-bold text-primary"},hp={class:"control-card p-4"},mp={class:"flex items-center justify-between mb-2"},vp={class:"text-base font-bold text-text"},yp={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},wp={class:"control-card p-6"},xp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},_p={class:"space-y-3"},bp={class:"flex justify-between"},Ep={class:"text-text"},kp={class:"flex justify-between"},Sp={class:"text-text"},Np={class:"flex justify-between"},Cp={class:"text-text"},$p={class:"flex justify-between"},Ip={class:"flex justify-between"},Tp={class:"control-card p-6"},Mp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Dp={class:"space-y-3"},Ap={class:"flex justify-between"},Pp={class:"text-primary font-bold"},Op={class:"flex justify-between"},Rp={class:"text-red-400 font-bold"},zp={class:"flex justify-between"},Bp={class:"text-purple-400 font-bold"},Lp={class:"flex justify-between"},Vp={class:"text-orange-400 font-bold"},Fp={class:"flex justify-between"},Hp={class:"text-yellow-400"},Gp={key:1,class:"p-6 space-y-6"},Yp={class:"control-card p-6"},Wp={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Up={class:"space-y-3"},Xp={key:0,class:"text-text-secondary text-center py-4"},Zp={class:"flex items-center gap-3"},qp={class:"text-text text-sm"},Kp={class:"text-xs text-text-muted"},jp={class:"text-right"},Jp={class:"text-text text-sm"},Qp={key:2,class:"p-6 space-y-6"},eg={key:0,class:"control-card p-6 border-purple-500/30"},tg={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},ng={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},og={class:"flex items-start justify-between mb-2"},ig={class:"text-text font-medium"},sg={class:"space-y-1 text-sm"},rg={class:"text-text-muted"},lg={class:"text-purple-300"},ag={key:0,class:"text-text-muted"},cg={class:"text-purple-300"},ug={key:1,class:"mt-2"},dg={class:"flex flex-wrap gap-1"},fg={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},pg={class:"control-card p-6"},gg={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},hg={key:0,class:"space-y-3"},mg={class:"flex-1"},vg={class:"text-text font-medium"},yg={class:"text-xs text-text-muted"},wg={key:1,class:"text-text-secondary text-center py-4"},xg={class:"control-card p-6"},_g={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},bg={class:"space-y-3"},Eg={key:0,class:"flex items-center justify-between p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg"},kg={class:"flex items-center gap-2"},Sg={class:"text-text text-sm"},Ng={class:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs font-bold"},Cg={class:"control-card p-6"},$g={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Ig={key:0,class:"space-y-3"},Tg={class:"flex-1"},Mg={class:"text-text font-medium"},Dg={class:"text-xs text-text-muted"},Ag={key:1,class:"text-text-secondary text-center py-4"},Pg={key:3,class:"p-6 space-y-6"},Og={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Rg={class:"control-card p-6"},zg={class:"flex items-center justify-between mb-4"},Bg={class:"text-base font-bold text-text"},Lg={class:"control-card p-6"},Vg={class:"flex items-center justify-between mb-4"},Fg={class:"text-base font-bold text-text"},Hg={class:"control-card p-6"},Gg={class:"flex items-center justify-between mb-4"},Yg={class:"text-base font-bold text-text"},Wg={key:0,class:"control-card p-6"},Ug={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},Xg={class:"space-y-3"},Zg={class:"flex items-start justify-between"},qg={class:"flex-1"},Kg={class:"text-red-400 font-medium"},jg={class:"text-xs text-text-muted mt-1"},Jg={class:"text-xs text-text-secondary"},Qg={key:4,class:"p-6"},eh={class:"control-card p-6"},th={class:"text-lg font-semibold text-text mb-4 flex items-center gap-2"},nh={class:"space-y-4"},oh={class:"flex-shrink-0 mt-1"},ih={key:0,class:"w-8 h-8 bg-primary/10 border border-primary/30 rounded-full flex items-center justify-center"},sh={key:1,class:"w-8 h-8 bg-red-500/10 border border-red-500/30 rounded-full flex items-center justify-center"},rh={key:2,class:"w-8 h-8 bg-yellow-500/10 border border-yellow-500/30 rounded-full flex items-center justify-center"},lh={class:"flex-1 pb-4 border-l-2 border-border pl-4 -ml-4"},ah={class:"flex items-center justify-between mb-1"},ch={class:"text-text font-medium"},uh={class:"text-xs text-text-secondary"},dh={class:"text-sm text-text-muted"},fh={key:0,class:"text-sm text-red-400 mt-1"},ph=Pe({__name:"WorkflowDetailModal",props:{workflow:{},show:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const n=e,o=Bi(),i=he(!1),s=he(null),r=he("overview"),l=he([]),a=he({totalNodes:0,nodesByType:{},triggers:[],outputs:[],aiAgents:[],tools:[],subWorkflows:[],connections:[]}),c=he({total:0,successful:0,failed:0,averageDuration:0,recentExecutions:[]}),d=he({minExecutionTime:0,avgExecutionTime:0,maxExecutionTime:0,errorRate:0,commonErrors:[]}),p=[{id:"overview",label:"Overview",icon:"lucide:info"},{id:"executions",label:"Executions",icon:"lucide:activity"},{id:"nodes",label:"Nodes",icon:"lucide:layers"},{id:"performance",label:"Performance",icon:"lucide:trending-up"},{id:"activity",label:"Activity",icon:"lucide:clock"}],y=async()=>{i.value=!0,s.value=null;try{console.log("🔄 [MODAL DEBUG] Loading workflow details for:",n.workflow.id,{modalShow:n.show,workflowName:n.workflow.name,callStack:new Error().stack?.split(`
`)[1]?.trim()});const w=await je.getProcessDetails(n.workflow.id);console.log("✅ Workflow details loaded:",w.data),w.data.businessDescription&&(l.value=Array.isArray(w.data.businessDescription)?w.data.businessDescription:[w.data.businessDescription]),a.value={totalNodes:w.data.nodeCount||0,nodesByType:w.data.nodesByType||{},triggers:w.data.triggers||[],outputs:w.data.outputs||[],aiAgents:w.data.aiAgents||[],tools:w.data.tools||[],subWorkflows:w.data.subWorkflows||[],connections:w.data.connections||[]},c.value={total:w.data.totalExecutions||n.workflow.execution_count||0,successful:w.data.successfulExecutions||0,failed:w.data.failedExecutions||0,averageDuration:w.data.avgDuration||0,recentExecutions:w.data.recentExecutions||[]},d.value={minExecutionTime:w.data.minExecutionTime||0,avgExecutionTime:w.data.avgExecutionTime||0,maxExecutionTime:w.data.maxExecutionTime||0,errorRate:w.data.errorRate||0,commonErrors:w.data.commonErrors||[]},await m()}catch(w){console.error("❌ Failed to load workflow details:",w),s.value=w}finally{i.value=!1}},m=async()=>{try{const w=await je.getProcessDetails(n.workflow.id);w?.data?.stickyNotes?.length>0&&(l.value=w.data.stickyNotes.map(S=>S.content).filter(Boolean),console.log("✅ Business description loaded from sticky notes:",l.value.length))}catch(w){console.warn("⚠️ Could not load sticky notes:",w)}},E=w=>w<1e3?`${w}ms`:w<6e4?`${(w/1e3).toFixed(1)}s`:`${(w/6e4).toFixed(1)}min`,f=w=>new Date(w).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),h=w=>{navigator.clipboard.writeText(w),o.showToast("Success","ID copiato negli appunti","success")},C=()=>{const w=JSON.stringify(n.workflow,null,2),S="data:application/json;charset=utf-8,"+encodeURIComponent(w),j=`workflow-${n.workflow.name}-${Date.now()}.json`,Y=document.createElement("a");Y.setAttribute("href",S),Y.setAttribute("download",j),Y.click(),o.showToast("Success","Workflow esportato","success")},P=async()=>{console.log("🔄 Force refresh requested for workflow",n.workflow.id),await y(),o.showToast("Success","Dati aggiornati dal backend","success")},k=()=>{y()};return Me(()=>n.show,w=>{console.log("🔍 [MODAL DEBUG] Show prop changed:",{newShow:w,oldShow:!w,workflowId:n.workflow?.id,workflowName:n.workflow?.name}),w&&(console.log("📊 [MODAL DEBUG] Modal opened for workflow:",n.workflow.name),y(),r.value="overview")}),ct(()=>{console.log("🎬 [MODAL DEBUG] Modal mounted:",{show:n.show,workflowId:n.workflow?.id,workflowName:n.workflow?.name}),n.show&&(console.log("📊 [MODAL DEBUG] Modal mounted and showing - loading details"),y())}),(w,S)=>{const j=Et("Info"),Y=Et("Activity"),J=Et("AlertTriangle"),ee=Et("XCircle"),ie=Et("CheckCircle");return $(),$e(ir,{to:"body"},[w.show?($(),O("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:S[3]||(S[3]=sr(D=>w.$emit("close"),["self"]))},[u("div",Rf,[u("div",zf,[u("div",Bf,[u("div",Lf,[q(T(Ee),{icon:"lucide:git-branch",class:"h-6 w-6 text-primary"})]),u("div",null,[u("h2",Vf,V(w.workflow.name),1),u("div",Ff,[u("span",Hf,"ID: "+V(w.workflow.id),1),u("span",{class:ve(["px-2 py-1 rounded text-xs font-medium",w.workflow.active?"bg-primary/10 border border-primary/30 text-primary":"bg-yellow-500/10 border border-yellow-500/30 text-yellow-400"])},V(w.workflow.active?"Active":"Inactive"),3),w.workflow.has_webhook?($(),O("span",Gf,' Icon icon="lucide:webhook" ')):ye("",!0)])])]),u("div",Yf,[u("button",{onClick:S[0]||(S[0]=D=>h(w.workflow.id)),class:"p-2 text-text-muted hover:text-primary transition-colors",title:"Copy ID"},[q(T(Ee),{icon:"lucide:copy",class:"h-4 w-4"})]),u("button",{onClick:C,class:"p-2 text-text-muted hover:text-primary transition-colors",title:"Export JSON"},[q(T(Ee),{icon:"lucide:download",class:"h-4 w-4"})]),u("button",{onClick:P,disabled:i.value,class:"p-2 text-text-muted hover:text-primary disabled:text-gray-600 transition-colors",title:i.value?"Refreshing...":"Force Refresh from n8n"},[q(T(Ee),{icon:"lucide:refresh-cw",class:ve(["h-4 w-4",{"animate-spin":i.value}])},null,8,["class"])],8,Wf),u("button",{onClick:S[1]||(S[1]=D=>w.$emit("close")),class:"p-2 text-text-muted hover:text-red-400 transition-colors"},[q(T(Ee),{icon:"lucide:x",class:"h-5 w-5"})])])]),i.value?($(),O("div",Uf,[...S[4]||(S[4]=[u("div",{class:"text-center"},[u("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),u("p",{class:"mt-4 text-text-muted"},"Caricamento dettagli workflow...")],-1)])])):s.value?($(),O("div",Xf,[S[5]||(S[5]=u("div",{class:"flex items-center justify-between mb-4"},[u("h2",{class:"text-lg font-semibold text-error"},"Errore nel caricamento")],-1)),S[6]||(S[6]=u("p",{class:"text-text-muted"},"Impossibile caricare i dettagli del workflow. Riprova più tardi.",-1)),u("p",Zf,V(s.value.message||"Errore sconosciuto"),1),u("div",qf,[u("button",{onClick:k,class:"btn-control-primary"},"Riprova"),u("button",{onClick:S[2]||(S[2]=D=>w.$emit("close")),class:"btn-control"},"Chiudi")])])):($(),O("div",Kf,[u("div",jf,[($(),O(xe,null,Te(p,D=>u("button",{key:D.id,onClick:_=>r.value=D.id,class:ve(["flex items-center gap-2 px-4 py-2 rounded-md text-sm transition-all",r.value===D.id?"bg-primary text-white":"text-text-secondary hover:bg-surface hover:text-text"])},[q(T(Ee),{icon:D.icon,class:"h-4 w-4"},null,8,["icon"]),Ye(" "+V(D.label),1)],10,Jf)),64))]),u("div",Qf,[r.value==="overview"?($(),O("div",ep,[l.value?($(),O("div",tp,[u("h3",np,[q(T(Ee),{icon:"lucide:info",class:"h-5 w-5 text-blue-400"}),S[7]||(S[7]=Ye(" Business Description ",-1))]),u("div",op,[($(!0),O(xe,null,Te(l.value,(D,_)=>($(),O("div",{key:_,class:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg"},[q(T(Ee),{icon:"lucide:file-text",class:"h-4 w-4 text-yellow-400 float-left mr-2 mt-1"}),u("div",ip,V(D),1)]))),128))])])):ye("",!0),u("div",sp,[u("div",rp,[u("div",lp,[S[8]||(S[8]=u("span",{class:"text-sm text-text-muted"},"Total Nodes",-1)),q(T(Ee),{icon:"lucide:box",class:"h-4 w-4 text-gray-600"})]),u("p",ap,V(a.value.totalNodes||w.workflow.node_count||0),1)]),u("div",cp,[u("div",up,[S[9]||(S[9]=u("span",{class:"text-sm text-text-muted"},"Total Executions",-1)),q(T(Ee),{icon:"lucide:play",class:"h-4 w-4 text-gray-600"})]),u("p",dp,V(c.value.total||w.workflow.execution_count||0),1)]),u("div",fp,[u("div",pp,[S[10]||(S[10]=u("span",{class:"text-sm text-text-muted"},"Success Rate",-1)),q(T(Ee),{icon:"lucide:check-circle",class:"h-4 w-4 text-gray-600"})]),u("p",gp,V(c.value.total>0?`${(c.value.successful/c.value.total*100).toFixed(1)}%`:"N/A"),1)]),u("div",hp,[u("div",mp,[S[11]||(S[11]=u("span",{class:"text-sm text-text-muted"},"Avg Duration",-1)),q(T(Ee),{icon:"lucide:clock",class:"h-4 w-4 text-gray-600"})]),u("p",vp,V(E(c.value.averageDuration)),1)])]),u("div",yp,[u("div",wp,[u("h3",xp,[q(j,{class:"h-5 w-5 text-primary"}),S[12]||(S[12]=Ye(" Workflow Information ",-1))]),u("div",_p,[u("div",bp,[S[13]||(S[13]=u("span",{class:"text-text-muted"},"Created",-1)),u("span",Ep,V(f(w.workflow.created_at)),1)]),u("div",kp,[S[14]||(S[14]=u("span",{class:"text-text-muted"},"Updated",-1)),u("span",Sp,V(f(w.workflow.updated_at)),1)]),u("div",Np,[S[15]||(S[15]=u("span",{class:"text-text-muted"},"Last Execution",-1)),u("span",Cp,V(w.workflow.last_execution?f(w.workflow.last_execution):"Never"),1)]),u("div",$p,[S[16]||(S[16]=u("span",{class:"text-text-muted"},'Icon icon="lucide:webhook"',-1)),u("span",{class:ve(w.workflow.has_webhook?"text-primary":"text-text-secondary")},V(w.workflow.has_webhook?"Enabled":"Disabled"),3)]),u("div",Ip,[S[17]||(S[17]=u("span",{class:"text-text-muted"},"Archived",-1)),u("span",{class:ve(w.workflow.is_archived?"text-yellow-400":"text-text-secondary")},V(w.workflow.is_archived?"Yes":"No"),3)])])]),u("div",Tp,[u("h3",Mp,[q(T(Ee),{icon:"lucide:activity",class:"h-5 w-5 text-blue-400"}),S[18]||(S[18]=Ye(" Quick Stats ",-1))]),u("div",Dp,[u("div",Ap,[S[19]||(S[19]=u("span",{class:"text-text-muted"},"Successful Runs",-1)),u("span",Pp,V(c.value.successful),1)]),u("div",Op,[S[20]||(S[20]=u("span",{class:"text-text-muted"},"Failed Runs",-1)),u("span",Rp,V(c.value.failed),1)]),u("div",zp,[S[21]||(S[21]=u("span",{class:"text-text-muted"},"AI Agents",-1)),u("span",Bp,V(a.value.aiAgents?.length||0),1)]),u("div",Lp,[S[22]||(S[22]=u("span",{class:"text-text-muted"},"Tools",-1)),u("span",Vp,V(a.value.tools?.length||0),1)]),u("div",Fp,[S[23]||(S[23]=u("span",{class:"text-text-muted"},"Error Rate",-1)),u("span",Hp,V(d.value.errorRate||0)+"%",1)])])])])])):ye("",!0),r.value==="executions"?($(),O("div",Gp,[u("div",Yp,[u("h3",Wp,[q(T(Ee),{icon:"lucide:clock",class:"h-5 w-5 text-blue-400"}),S[24]||(S[24]=Ye(" Recent Executions ",-1))]),u("div",Up,[c.value.recentExecutions?.length===0?($(),O("div",Xp," No recent executions ")):($(!0),O(xe,{key:1},Te(c.value.recentExecutions||[],(D,_)=>($(),O("div",{key:D.id||_,class:"flex items-center justify-between p-3 bg-surface rounded-lg"},[u("div",Zp,[D.status==="success"?($(),$e(T(Ee),{key:0,icon:"lucide:check-circle",class:"h-4 w-4 text-primary"})):D.status==="error"?($(),$e(T(Ee),{key:1,icon:"lucide:x-circle",class:"h-4 w-4 text-red-400"})):($(),$e(T(Ee),{key:2,icon:"lucide:alert-triangle",class:"h-4 w-4 text-yellow-400"})),u("div",null,[u("p",qp,"Execution #"+V(D.id),1),u("p",Kp,V(f(D.started_at)),1)])]),u("div",jp,[u("p",Jp,V(E(D.duration_ms||0)),1),u("p",{class:ve(["text-xs",D.status==="success"?"text-primary":D.status==="error"?"text-red-400":"text-yellow-400"])},V(D.status),3)])]))),128))])])])):ye("",!0),r.value==="nodes"?($(),O("div",Qp,[a.value.aiAgents?.length>0?($(),O("div",eg,[u("h3",tg,[q(T(Ee),{icon:"lucide:brain",class:"h-5 w-5 text-purple-400"}),Ye(" AI Agents ("+V(a.value.aiAgents.length)+") ",1)]),u("div",ng,[($(!0),O(xe,null,Te(a.value.aiAgents,(D,_)=>($(),O("div",{key:_,class:"p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg"},[u("div",og,[u("h4",ig,V(D.name),1),q(T(Ee),{icon:"lucide:brain",class:"h-5 w-5 text-purple-400"})]),u("div",sg,[u("p",rg,[S[25]||(S[25]=Ye("Type: ",-1)),u("span",lg,V(D.type),1)]),D.model!=="unknown"?($(),O("p",ag,[S[26]||(S[26]=Ye(" Model: ",-1)),u("span",cg,V(D.model),1)])):ye("",!0),D.connectedTools?.length>0?($(),O("div",ug,[S[27]||(S[27]=u("p",{class:"text-text-muted mb-1"},"Connected Tools:",-1)),u("div",dg,[($(!0),O(xe,null,Te(D.connectedTools,(se,b)=>($(),O("span",{key:b,class:"px-2 py-1 bg-purple-500/20 text-purple-300 rounded text-xs"},V(se),1))),128))])])):ye("",!0)])]))),128))])])):ye("",!0),u("div",fg,[u("div",pg,[u("h3",gg,[q(T(Ee),{icon:"lucide:zap",class:"h-5 w-5 text-yellow-400"}),S[28]||(S[28]=Ye(" Triggers ",-1))]),a.value.triggers?.length>0?($(),O("div",hg,[($(!0),O(xe,null,Te(a.value.triggers,(D,_)=>($(),O("div",{key:_,class:"flex items-center gap-3 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg"},[q(T(Ee),{icon:"lucide:webhook",class:"h-5 w-5 text-yellow-400"}),u("div",mg,[u("p",vg,V(D.name),1),u("p",yg,V(D.type),1)])]))),128))])):($(),O("p",wg,"No triggers"))]),u("div",xg,[u("h3",_g,[q(T(Ee),{icon:"lucide:layers",class:"h-5 w-5 text-blue-400"}),S[29]||(S[29]=Ye(" Processing ",-1))]),u("div",bg,[($(!0),O(xe,null,Te(Object.entries(a.value.nodesByType||{}),([D,_])=>($(),O(xe,{key:D},[D!=="Triggers"&&D!=="Output/Response"?($(),O("div",Eg,[u("div",kg,[q(T(Ee),{icon:"lucide:package",class:"h-4 w-4 text-blue-400"}),u("span",Sg,V(D),1)]),u("span",Ng,V(_),1)])):ye("",!0)],64))),128))])]),u("div",Cg,[u("h3",$g,[q(T(Ee),{icon:"lucide:external-link",class:"h-5 w-5 text-primary"}),S[30]||(S[30]=Ye(" Outputs ",-1))]),a.value.outputs?.length>0?($(),O("div",Ig,[($(!0),O(xe,null,Te(a.value.outputs,(D,_)=>($(),O("div",{key:_,class:"flex items-center gap-3 p-3 bg-primary/10 border border-primary/30 rounded-lg"},[q(T(Ee),{icon:"lucide:send",class:"h-5 w-5 text-primary"}),u("div",Tg,[u("p",Mg,V(D.name),1),u("p",Dg,V(D.type),1)])]))),128))])):($(),O("p",Ag,"No outputs"))])])])):ye("",!0),r.value==="performance"?($(),O("div",Pg,[u("div",Og,[u("div",Rg,[u("div",zg,[S[31]||(S[31]=u("span",{class:"text-sm text-text-muted"},"Min Execution Time",-1)),q(T(Ee),{icon:"lucide:trending-up",class:"h-4 w-4 text-primary"})]),u("p",Bg,V(E(d.value.minExecutionTime||0)),1)]),u("div",Lg,[u("div",Vg,[S[32]||(S[32]=u("span",{class:"text-sm text-text-muted"},"Average Time",-1)),q(Y,{class:"h-4 w-4 text-blue-400"})]),u("p",Fg,V(E(d.value.avgExecutionTime||0)),1)]),u("div",Hg,[u("div",Gg,[S[33]||(S[33]=u("span",{class:"text-sm text-text-muted"},"Max Execution Time",-1)),q(J,{class:"h-4 w-4 text-red-400"})]),u("p",Yg,V(E(d.value.maxExecutionTime||0)),1)])]),d.value.commonErrors?.length>0?($(),O("div",Wg,[u("h3",Ug,[q(ee,{class:"h-5 w-5 text-red-400"}),S[34]||(S[34]=Ye(" Common Errors ",-1))]),u("div",Xg,[($(!0),O(xe,null,Te(d.value.commonErrors,(D,_)=>($(),O("div",{key:_,class:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg"},[u("div",Zg,[u("div",qg,[u("p",Kg,V(D.message),1),u("p",jg,"Occurred "+V(D.count)+" times",1)]),u("span",Jg,V(D.lastOccurred),1)])]))),128))])])):ye("",!0)])):ye("",!0),r.value==="activity"?($(),O("div",Qg,[u("div",eh,[u("h3",th,[q(T(Ee),{icon:"lucide:clock",class:"h-5 w-5 text-blue-400"}),S[35]||(S[35]=Ye(" Recent Activity Timeline ",-1))]),u("div",nh,[($(!0),O(xe,null,Te((c.value.recentExecutions||[]).slice(0,20),(D,_)=>($(),O("div",{key:D.id||_,class:"flex items-start gap-4"},[u("div",oh,[D.status==="success"?($(),O("div",ih,[q(ie,{class:"h-4 w-4 text-primary"})])):D.status==="error"?($(),O("div",sh,[q(ee,{class:"h-4 w-4 text-red-400"})])):($(),O("div",rh,[q(T(Ee),{icon:"lucide:clock",class:"h-4 w-4 text-yellow-400"})]))]),u("div",lh,[u("div",ah,[u("p",ch," Execution "+V(D.status==="success"?"completed":D.status==="error"?"failed":"started"),1),u("span",uh,V(f(D.started_at)),1)]),u("p",dh," Duration: "+V(E(D.duration_ms||0)),1),D.error_message?($(),O("p",fh,V(D.error_message),1)):ye("",!0)])]))),128))])])])):ye("",!0)])]))])])):ye("",!0)])}}}),gh=Yn(ph,[["__scopeId","data-v-ced19fdf"]]),hh=["title"],mh=["title"],vh={class:"placeholder-text"},yh=Pe({__name:"N8nIcon",props:{nodeType:{},className:{}},setup(e){const t=e,n={"n8n-nodes-base.cron":{icon:"mdi:timer-outline",category:"schedule_triggers",shape:"diamond"},"n8n-nodes-base.scheduleTrigger":{icon:"mdi:calendar-clock",category:"schedule_triggers",shape:"diamond"},"n8n-nodes-base.webhook":{icon:"mdi:webhook",category:"webhook_triggers",shape:"diamond"},"n8n-nodes-base.formTrigger":{icon:"mdi:form-select",category:"webhook_triggers",shape:"diamond"},"n8n-nodes-base.gmailTrigger":{icon:"simple-icons:gmail",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.microsoftOutlookTrigger":{icon:"simple-icons:microsoftoutlook",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.emailReadImap":{icon:"mdi:email-receive-outline",category:"email_triggers",shape:"diamond"},"n8n-nodes-base.telegramTrigger":{icon:"simple-icons:telegram",category:"social_triggers",shape:"diamond"},"n8n-nodes-base.whatsAppTrigger":{icon:"simple-icons:whatsapp",category:"social_triggers",shape:"diamond"},"n8n-nodes-base.manualTrigger":{icon:"mdi:play-circle",category:"workflow_triggers",shape:"diamond"},"n8n-nodes-base.executeWorkflowTrigger":{icon:"mdi:play-circle",category:"workflow_triggers",shape:"diamond"},"@n8n/n8n-nodes-langchain.chatTrigger":{icon:"mdi:chat-outline",category:"ai_triggers",shape:"diamond"},"n8n-nodes-base.activeCampaignTrigger":{icon:"mdi:email-newsletter",category:"marketing_triggers",shape:"diamond"},"n8n-nodes-base.set":{icon:"mdi:pencil-circle",category:"data_processing"},"n8n-nodes-base.filter":{icon:"mdi:filter-outline",category:"data_processing"},"n8n-nodes-base.sort":{icon:"mdi:sort-variant",category:"data_processing"},"n8n-nodes-base.limit":{icon:"mdi:numeric",category:"data_processing"},"n8n-nodes-base.splitInBatches":{icon:"mdi:format-list-bulleted",category:"data_processing"},"n8n-nodes-base.splitOut":{icon:"mdi:call-split",category:"data_processing"},"n8n-nodes-base.telegram":{icon:"simple-icons:telegram",category:"communication",shape:"circle"},"n8n-nodes-base.whatsApp":{icon:"simple-icons:whatsapp",category:"communication",shape:"circle"},"n8n-nodes-base.slack":{icon:"simple-icons:slack",category:"communication",shape:"circle"},"n8n-nodes-base.gmail":{icon:"simple-icons:gmail",category:"communication",shape:"circle"},"n8n-nodes-base.microsoftOutlook":{icon:"simple-icons:microsoftoutlook",category:"communication",shape:"circle"},"n8n-nodes-base.emailSend":{icon:"mdi:email-send-outline",category:"communication",shape:"circle"},"n8n-nodes-base.postgres":{icon:"simple-icons:postgresql",category:"databases"},"n8n-nodes-base.supabase":{icon:"simple-icons:supabase",category:"databases"},"n8n-nodes-base.googleSheets":{icon:"simple-icons:googlesheets",category:"databases"},"n8n-nodes-base.googleDrive":{icon:"simple-icons:googledrive",category:"file_operations"},"n8n-nodes-base.extractFromFile":{icon:"mdi:file-document-outline",category:"file_operations"},"n8n-nodes-base.httpRequest":{icon:"mdi:web",category:"http_api"},"n8n-nodes-base.httpRequestTool":{icon:"mdi:api",category:"http_api"},"n8n-nodes-base.respondToWebhook":{icon:"mdi:webhook",category:"http_api"},"n8n-nodes-base.code":{icon:"mdi:code-braces",category:"code"},"n8n-nodes-base.function":{icon:"mdi:function",category:"code"},"n8n-nodes-base.if":{icon:"mdi:help-rhombus-outline",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.switch":{icon:"mdi:electric-switch",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.merge":{icon:"mdi:merge",category:"workflow_control",shape:"diamond-flat"},"n8n-nodes-base.wait":{icon:"mdi:timer-sand",category:"workflow_control",shape:"circle"},"n8n-nodes-base.executeWorkflow":{icon:"mdi:play-circle-outline",category:"workflow_control",shape:"circle"},"n8n-nodes-base.debug":{icon:"mdi:bug-outline",category:"logging_monitoring"},"n8n-nodes-base.noOp":{icon:"mdi:minus-circle-outline",category:"utilities"},"n8n-nodes-base.stickyNote":{icon:"mdi:note-text-outline",category:"utilities"},"n8n-nodes-base.html":{icon:"mdi:language-html5",category:"parsers"},"n8n-nodes-base.markdown":{icon:"simple-icons:markdown",category:"parsers"},"n8n-nodes-base.dateTimeTool":{icon:"mdi:calendar-clock",category:"parsers"},"n8n-nodes-base.googleCalendar":{icon:"simple-icons:googlecalendar",category:"calendar_scheduling"},"n8n-nodes-base.openAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.agent":{icon:"mdi:robot-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.lmChatOpenAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.embeddingsOpenAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.openAi":{icon:"simple-icons:openai",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.lmChatGoogleGemini":{icon:"simple-icons:google",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chainLlm":{icon:"mdi:brain",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chainSummarization":{icon:"mdi:format-list-text",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.textClassifier":{icon:"mdi:text-box-check-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter":{icon:"mdi:format-text-wrapping-clip",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.memoryBufferWindow":{icon:"mdi:memory",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.memoryPostgresChat":{icon:"simple-icons:postgresql",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStoreQdrant":{icon:"mdi:database-search",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStorePinecone":{icon:"mdi:pine-tree",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.vectorStoreSupabase":{icon:"simple-icons:supabase",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.retrieverVectorStore":{icon:"mdi:database-arrow-down",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.rerankerCohere":{icon:"mdi:sort-ascending",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.outputParserStructured":{icon:"mdi:code-braces",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.documentDefaultDataLoader":{icon:"mdi:file-upload-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.chatTrigger":{icon:"mdi:chat-outline",category:"triggers"},"@n8n/n8n-nodes-langchain.toolSerpApi":{icon:"mdi:google",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolCalculator":{icon:"mdi:calculator",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolVectorStore":{icon:"mdi:database-search-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolWorkflow":{icon:"mdi:workflow",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolHttpRequest":{icon:"mdi:web",category:"http_api",shape:"rectangle"},"@n8n/n8n-nodes-langchain.toolConvertToFile":{icon:"mdi:file-document-outline",category:"ai_ml",shape:"rectangle"},"@n8n/n8n-nodes-langchain.mcpClientTool":{icon:"mdi:connection",category:"ai_ml",shape:"rectangle"},"n8n-nodes-base.xml":{icon:"mdi:code-tags",category:"parsers"},"n8n-nodes-base.json":{icon:"mdi:code-json",category:"parsers"},"n8n-nodes-base.csv":{icon:"mdi:file-delimited-outline",category:"parsers"},"n8n-nodes-base.yaml":{icon:"mdi:file-code-outline",category:"parsers"},"n8n-nodes-base.javascript":{icon:"vscode-icons:file-type-js-official",category:"code"},"n8n-nodes-base.typescript":{icon:"vscode-icons:file-type-typescript-official",category:"code"},"n8n-nodes-base.python":{icon:"vscode-icons:file-type-python",category:"code"},"n8n-nodes-base.start":{icon:"mdi:play-circle",category:"utilities"},"n8n-nodes-base.itemLists":{icon:"mdi:format-list-bulleted",category:"utilities"},"n8n-nodes-base.database":{icon:"vscode-icons:file-type-sql",category:"utilities"}},o={triggers:"#4F709C",data_processing:"#5F8A5F",communication:"#B8860B",ai_ml:"#6B46C1",databases:"#C2793D",http_api:"#B91C1C",code:"#A855F7",utilities:"#64748B",parsers:"#8B5A2B",cloud_services:"#0284C7",media_processing:"#DC2626",file_operations:"#7C3AED",calendar_scheduling:"#059669",business_intelligence:"#D97706",order_management:"#1D4ED8",notification_systems:"#DC2626",authentication:"#374151",workflow_control:"#6366F1",logging_monitoring:"#6B7280",document_processing:"#92400E",schedule_triggers:"#2563EB",webhook_triggers:"#DC2626",email_triggers:"#F59E0B",social_triggers:"#10B981",workflow_triggers:"#8B5CF6",ai_triggers:"#EC4899",marketing_triggers:"#F97316"},i=W(()=>n[t.nodeType]||null),s=W(()=>i.value?.icon||null),r=W(()=>{const d=i.value?.category||"utilities";return o[d]||o.utilities}),l=W(()=>i.value?.shape||"rectangle"),a=W(()=>`shape-${l.value}`),c=W(()=>{const d=t.nodeType.split(".");return d[d.length-1].substring(0,3).toUpperCase()});return(d,p)=>($(),O("div",{class:ve(["node-icon",[d.className,a.value]]),title:`Shape: ${l.value}, Type: ${d.nodeType}`},[s.value?($(),$e(T(Ee),{key:0,icon:s.value,width:48,height:48,class:"icon-styled",style:We({color:r.value})},null,8,["icon","style"])):($(),O("div",{key:1,class:"placeholder-icon",title:`Iconify mapping needed: ${d.nodeType}`},[u("span",vh,V(c.value),1)],8,mh))],10,hh))}}),en=Yn(yh,[["__scopeId","data-v-92bfb441"]]),wh={class:"h-[calc(100vh-4rem)] overflow-auto"},xh={class:"grid grid-cols-6 gap-3 mb-3"},_h={class:"p-2"},bh={class:"flex items-center justify-between mb-1"},Eh={class:"text-lg font-bold text-text"},kh={class:"p-2"},Sh={class:"flex items-center justify-between mb-1"},Nh={class:"text-lg font-bold text-text"},Ch={class:"p-2"},$h={class:"flex items-center justify-between mb-1"},Ih={class:"text-lg font-bold text-cyan-500"},Th={class:"p-2"},Mh={class:"flex items-center justify-between mb-1"},Dh={class:"text-lg font-bold text-warning"},Ah={class:"p-2"},Ph={class:"flex items-center justify-between mb-1"},Oh={class:"text-lg font-bold text-text"},Rh={class:"p-2"},zh={class:"flex items-center justify-between mb-1"},Bh={class:"text-lg font-bold text-blue-500"},Lh={class:"flex gap-4 h-[calc(100%-4rem)]"},Vh={class:"p-3 border-b border-border flex items-center justify-between"},Fh={key:0,class:"text-xs font-bold text-text"},Hh={key:0,class:"p-4 overflow-y-auto h-full"},Gh={class:"flex items-center justify-between mb-3"},Yh={class:"text-xs text-text-muted"},Wh={class:"space-y-1.5"},Uh=["onClick"],Xh={class:"flex items-center gap-2 mb-1"},Zh=["title"],qh={class:"text-xs text-text-muted pl-3.5"},Kh={key:1,class:"p-2 overflow-y-auto h-full"},jh={class:"space-y-2"},Jh=["onClick","title"],Qh={class:"flex-1 premium-glass rounded-lg overflow-hidden"},em={class:"bg-surface/30 border-b border-border px-4 py-3 flex items-center justify-between"},tm={class:"flex items-center gap-3"},nm={class:"text-sm font-bold text-white"},om={key:0,class:"flex items-center gap-3 text-xs text-text-muted mt-1"},im={class:"flex items-center gap-1"},sm={class:"flex items-center gap-2"},rm=["disabled"],lm={class:"flex items-center gap-4"},am={key:0,class:"flex items-center gap-2 text-xs"},cm={class:"text-text-muted"},um={class:"flex items-center gap-2"},dm={class:"text-xs text-text-muted"},fm=["disabled"],pm={class:"relative h-full"},gm={key:0,class:"absolute bottom-32 left-1/2 transform -translate-x-1/2 z-50 flex gap-2"},hm=["disabled"],mm={class:"absolute bottom-32 left-4 flex flex-row gap-2 z-50"},vm={class:"absolute bottom-4 left-16 right-4 z-50"},ym={key:0,class:"bg-gray-800 border border-gray-600 border-t-0 rounded-b-lg shadow-lg",style:{"max-height":"200px"}},wm={class:"p-4 overflow-y-auto",style:{"max-height":"180px"}},xm={key:0,class:"text-center py-6"},_m={key:1,class:"space-y-2"},bm={class:"text-gray-500 shrink-0 font-mono"},Em={class:"text-gray-200"},km={class:"premium-ai-icon"},Sm={class:"premium-ai-content"},Nm={class:"premium-ai-name"},Cm={key:0,class:"premium-ai-connections"},$m={key:1,class:"premium-node-wrapper"},Im={class:"premium-trigger-icon"},Tm={class:"premium-external-label"},Mm={key:2,class:"premium-node-wrapper"},Dm={class:"premium-tool-icon"},Am={class:"premium-external-label"},Pm={style:{display:"flex","align-items":"center",width:"100%",height:"100%",padding:"0 8px"}},Om={style:{width:"32px",height:"32px","margin-right":"10px","flex-shrink":"0"}},Rm={style:{color:"#ffffff !important","font-size":"13px !important","font-weight":"600 !important","text-shadow":"0 1px 2px rgba(0, 0, 0, 0.8) !important","white-space":"nowrap !important",overflow:"hidden !important","text-overflow":"ellipsis !important",flex:"1"}},zm={key:4,class:"premium-node-wrapper"},Bm={class:"premium-process-icon"},Lm={class:"premium-external-label"},Vm={key:1,class:"absolute inset-0 flex items-center justify-center"},Fm={class:"text-center"},Hm={class:"p-4"},Gm={class:"space-y-3"},Ym={class:"text-base font-semibold text-text"},Wm={key:0,class:"mb-2 text-xs text-text-muted"},Um={key:1,class:"border border-border rounded-lg overflow-hidden"},Xm={class:"w-full text-sm"},Zm={class:"px-3 py-2"},qm={class:"flex items-center gap-2"},Km={class:"px-3 py-2 text-text-muted font-mono text-xs"},jm={class:"px-3 py-2 text-text-muted text-xs"},Jm={class:"px-3 py-2 text-text-muted text-xs"},Qm={key:2,class:"mt-4 flex items-center justify-between pt-4 border-t border-border"},ev={class:"text-sm text-text-muted"},tv={class:"flex items-center gap-2"},nv=["disabled"],ov={class:"flex items-center gap-1"},iv=["onClick"],sv={key:0,class:"text-text-muted px-2"},rv=["disabled"],lv={key:3,class:"text-center py-8"},av={class:"p-6"},cv={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},uv={class:"control-card p-4"},dv={class:"flex items-center justify-between mb-2"},fv={class:"text-lg font-bold text-text"},pv={class:"control-card p-4"},gv={class:"flex items-center justify-between mb-2"},hv={class:"text-lg font-bold text-cyan-500"},mv={class:"control-card p-4"},vv={class:"flex items-center justify-between mb-2"},yv={class:"text-lg font-bold text-text"},wv="client_simulation_a",Vt=20,xv=Pe({__name:"WorkflowCommandCenter",setup(e){const t=rr();Bi();const n=fr(),o=W(()=>n.user?.role==="viewer"),i=W(()=>!o.value),{success:s,error:r}=lr(),l=he(!1),a=he(!1),c=he(!1),d=he([{timestamp:"23:32:15",level:"INFO",message:"Workflow execution started"},{timestamp:"23:32:16",level:"DEBUG",message:"Processing node: Schedule Trigger"},{timestamp:"23:32:17",level:"SUCCESS",message:"AI Agent completed successfully"}]),p=he([]),y=he(null),m=he(null),E=he(""),f=he(null),h=he(null);let C=null;const P=he(!1),k=he(!1),w=he(!1),S=he(null),j=he(null),Y=he(null),J=[{id:"executions",label:"Executions",icon:"lucide:play"},{id:"stats",label:"Statistics",icon:"lucide:trending-up"}],ee=he(1),ie=W(()=>Y.value?.executions?Math.ceil(Y.value.executions.length/Vt):1),D=W(()=>{if(!Y.value?.executions)return[];const A=(ee.value-1)*Vt,N=A+Vt;return Y.value.executions.slice(A,N)}),_=he([]),{fitView:se,zoomIn:b,zoomOut:B,setViewport:I,getViewport:L}=Re(),H={enterprise:Pi,custom:Pi},Q=W(()=>p.value.length),K=W(()=>p.value.filter(A=>A.is_active).length);W(()=>Math.round(100-te.value)),W(()=>_.value.filter(A=>!A.source)),W(()=>_.value.filter(A=>A.source));const ne=(A,N)=>!1,fe=W(()=>m.value?.kpis?.totalExecutions!==void 0?m.value.kpis.totalExecutions:y.value?.overview?.totalExecutions||0),me=W(()=>{if(m.value?.kpis?.failedExecutions!==void 0)return m.value.kpis.failedExecutions;const A=fe.value,N=y.value?.overview?.successRate||100;return Math.round(A*(1-N/100))}),te=W(()=>m.value?.kpis?.failureRate!==void 0?m.value.kpis.failureRate:(100-(y.value?.overview?.successRate||100)).toFixed(1)),ce=W(()=>m.value?.kpis?.timeSavedHours!==void 0?m.value.kpis.timeSavedHours:y.value?.businessImpact?.timeSavedHours||0),re=W(()=>{if(m.value?.kpis?.avgRunTime!==void 0){const N=m.value.kpis.avgRunTime;return N<1?N.toFixed(2)+"s":N<60?N.toFixed(1)+"s":(N/60).toFixed(1)+"m"}const A=y.value?.overview?.avgDurationSeconds||0;return A>0?(A/60).toFixed(1):"0.0"}),_e=async()=>{l.value=!0;const A=E.value;try{console.log("🔄 Loading ALL REAL workflow data for Command Center...");const[N,de]=await Promise.all([je.getProcesses({_t:Date.now(),refresh:!0}),je.getAnalytics({_t:Date.now()})]);console.log("✅ REAL workflows loaded:",N.data?.length||0),console.log("📋 Raw data preview:",N.data?.slice(0,3));const R=(N.data||[]).sort((G,Z)=>G.is_active!==Z.is_active?G.is_active?-1:1:G.process_name.localeCompare(Z.process_name));p.value=R,console.log("🔄 Set realWorkflows to:",p.value.length,"items (sorted: active first)"),console.log("📊 Active workflows:",p.value.filter(G=>G.is_active).map(G=>G.process_name)),y.value=de,console.log("✅ REAL analytics loaded:",{totalExecutions:y.value.overview?.totalExecutions,successRate:y.value.overview?.successRate,avgDuration:y.value.overview?.avgDurationSeconds}),console.log("✅ Workflows loaded, manual selection required")}catch(N){console.error("❌ Failed to fetch workflows:",N),console.error("🔍 Error details:",N.stack);const de=N.message?.includes("fetch")?"Cannot connect to backend server. Is it running on port 3001?":`API Error: ${N.message}`;N("Errore di Connessione",de),p.value=[]}finally{if(l.value=!1,p.value.length>0)if(A){const N=p.value.find(de=>de.id===A);N?(console.log("🔄 Re-selecting previous workflow:",N.process_name),await ue(N)):(console.log("🎯 Previous workflow not found, selecting first:",p.value[0].process_name),await ue(p.value[0]))}else console.log("🎯 Auto-selecting first workflow after refresh:",p.value[0].process_name),await ue(p.value[0])}},ue=async A=>{console.log("🔘 [FORCE TEST] CLICK DETECTED - selectWorkflow called with:",{workflowName:A.process_name,workflowId:A.id,currentSelectedId:E.value}),E.value=A.id,f.value=A,console.log("✅ Workflow selected:",A.name,"ID:",A.id),await Promise.all([ke(A.id),Ie(A)])},ke=async A=>{try{console.log("📊 Loading statistics for workflow:",A);const N=await cr(`/api/business/workflow/${A}/full-stats`,{params:{days:30}});m.value=N,console.log("✅ Workflow stats loaded:",{totalExecutions:N.kpis?.totalExecutions,failureRate:N.kpis?.failureRate,avgRunTime:N.kpis?.avgRunTime})}catch(N){console.error("❌ Error loading workflow statistics:",N),m.value=null}},Ie=async A=>{try{C&&(console.log("🚫 Cancelling previous workflow request"),C.abort()),C=new AbortController,console.log("🔍 Loading REAL structure for:",A.process_name,"with ID:",A.id),console.log("📡 Fetching details with OFETCH for workflow:",A.id);const N=await je.getProcessDetails(A.id,{_t:Date.now(),forceRefresh:!0});h.value=N.data,console.log("✅ REAL workflow structure loaded for",A.process_name,":",N.data.nodeCount,"nodes"),pe(N.data,A)}catch(N){if(N.name==="AbortError"){console.log("🚫 Request cancelled for",A.process_name);return}console.error("❌ Failed to load workflow structure for",A.process_name,":",N),console.error("🔄 Falling back to enhanced flow"),Se(A)}console.log("✅ Workflow structure loading completed")},pe=(A,N)=>{const de=A.processSteps||[],R=A.processFlow||[];console.log("🔧 Creating flow from REAL data:",de.length,"steps",R.length,"connections");const G=new Map;R.forEach(F=>{G.has(F.from)||G.set(F.from,{inputs:[],outputs:[]});const nt=G.get(F.from);nt.outputs.includes(F.type)||nt.outputs.push(F.type),G.has(F.to)||G.set(F.to,{inputs:[],outputs:[]});const ze=G.get(F.to);ze.inputs.includes(F.type)||ze.inputs.push(F.type)});const Z=de.filter(F=>!F.nodeType.includes("stickyNote")).map((F,nt)=>{const ze=G.get(F.stepName)||{inputs:["main"],outputs:["main"]};return{id:F.stepName,type:"enterprise",position:{x:(F.position[0]||0)*1.8,y:(F.position[1]||0)*1.6},data:{label:F.stepName,status:N.is_active?"success":"inactive",type:ft(F.nodeType,F.stepName),nodeType:F.nodeType||"unknown-node",isExecuting:!1,inputs:ze.inputs.length>0?ze.inputs:["main"],outputs:ze.outputs.length>0?ze.outputs:["main"],executionCount:m.totalExecutions||Math.floor(Math.random()*100)+10,successRate:m.kpis?.successRate||Math.floor(Math.random()*20)+80,avgTime:m.kpis?.avgDuration?(m.kpis.avgDuration/1e3).toFixed(1):(Math.random()*2+.5).toFixed(1)}}}),He=R.map((F,nt)=>{const ze=F.type==="main",io=F.type.startsWith("ai_"),Us=de.find(Le=>Le.stepName===F.from),pt=de.find(Le=>Le.stepName===F.to),zt=ft(Us?.nodeType||"",F.from),Kt=ft(pt?.nodeType||"",F.to);let gt="right",ot="left",yn=!1;if(zt==="storage")gt="bottom";else if(zt==="tool")gt="bottom";else if(zt==="ai")if(yn=Kt==="tool"||pt?.stepName?.toLowerCase().includes("ordini")||pt?.stepName?.toLowerCase().includes("date")||pt?.stepName?.toLowerCase().includes("parcel")||pt?.stepName?.toLowerCase().includes("formatta")||pt?.stepName?.toLowerCase().includes("clean data")||pt?.nodeType&&pt.nodeType.includes("langchain.tool"),ze&&!yn)gt="right";else if(yn){const Le=F.to.toLowerCase(),Ue=pt?.stepName?.toLowerCase()||"";let Ke=0;Le.includes("clean")||Le.includes("data")||Ue.includes("clean")||Ue.includes("data")||Le.includes("info")||Le.includes("ordini")||Ue.includes("info")||Ue.includes("ordini")?Ke=0:Le.includes("date")||Le.includes("time")||Ue.includes("date")||Ue.includes("time")?Ke=1:Le.includes("parcel")||Le.includes("app")||Ue.includes("parcel")||Ue.includes("app")?Ke=2:Le.includes("formatta")||Le.includes("risposta")||Ue.includes("formatta")||Ue.includes("risposta")?Ke=3:Le.includes("openai")||Le.includes("chat")||Ue.includes("openai")||Ue.includes("chat")?Ke=0:Le.includes("qdrant")||Ue.includes("qdrant")?Ke=1:Le.includes("embedding")||Ue.includes("embedding")?Ke=2:Ke=Math.abs(F.to.charCodeAt(0)+F.to.charCodeAt(1))%4,gt=`tool-${Ke}`,console.log(`🔧 Tool connection: ${F.from} -> ${F.to} (${Ue}) using handle: ${gt}`)}else gt="right";else gt="right";if(Kt==="storage")zt==="ai"&&!ze?ot="top":zt==="tool"||F.from.toLowerCase().includes("embedding")?ot="bottom":ot="top";else if(Kt==="tool")ot="top";else if(Kt==="ai")if(ze)ot="left";else if(io){const Le=G.get(F.to)||{inputs:[],outputs:[]},Ke=[...Le.inputs.filter(jt=>jt!=="main"),...Le.outputs.filter(jt=>jt!=="main")].findIndex(jt=>jt===F.type);ot=`tool-${Math.max(0,Ke)}`}else ot="left";else ot="left";return console.log(`🔗 Edge ${F.from}->${F.to}: type=${F.type}, source=${zt}, target=${Kt}, handles=${gt}->${ot}, isMain=${ze}, isConnectionToTool=${yn||!1}`),{id:`edge-${nt}`,source:F.from,target:F.to,type:"smoothstep",animated:N.is_active&&ze,style:{stroke:ze?"#10b981":io?"#667eea":"#3b82f6",strokeWidth:ze?3:2,strokeDasharray:ze?"none":"5 5",opacity:ze?1:.7,strokeLinecap:"round",strokeLinejoin:"round",filter:ze?"drop-shadow(0 0 3px rgba(16, 185, 129, 0.5))":"none"},sourceHandle:gt,targetHandle:ot,className:ze?"main-edge":"secondary-edge",markerEnd:ze?{type:"arrowclosed",width:20,height:20,color:"#10b981"}:void 0}});console.log("✅ Created nodes with handles:",Z.map(F=>`ID:${F.id} Label:${F.data.label} type=${F.data.type} nodeType=${F.data.nodeType} inputs=${JSON.stringify(F.data.inputs)} outputs=${JSON.stringify(F.data.outputs)}`)),console.log("🔗 Created edges:",He.map(F=>`${F.source}->${F.target} (${F.sourceHandle}->${F.targetHandle}) color=${F.style.stroke}`)),console.log("🔢 Nodes count:",Z.length,"Edges count:",He.length),_.value=[...Z,...He],console.log("🎯 FlowElements final:",_.value.length,"elements"),et(()=>{I({x:0,y:0,zoom:.5}),setTimeout(()=>{se({duration:0,padding:.2}),console.log("🎯 Forced fit applied with viewport reset")},50)})},Se=A=>{console.log("🔧 Creating enhanced flow for:",A.process_name);const N=A.process_name.toLowerCase();let de=[];N.includes("grab")||N.includes("track")?de=["Data Source","Extract","Process","AI Analysis","Store","Notify"]:N.includes("chatbot")?de=["Webhook","Parse","Intent","AI Response","Reply","Log"]:N.includes("customer")||N.includes("service")?de=["Request","Classify","Route","AI Process","Respond","Update"]:de=["Trigger","Process","Execute","Complete"];const R=de.map((Z,He)=>({id:Z,type:"enterprise",position:{x:He*280,y:50},data:{label:Z,status:A.is_active?"success":"inactive",type:He===0?"trigger":He===de.length-1?"storage":"process"}})),G=[];for(let Z=0;Z<de.length-1;Z++)G.push({id:`e${Z}`,source:de[Z],target:de[Z+1],type:"default",animated:A.is_active,style:{stroke:"#10b981",strokeWidth:1},sourceHandle:"right",targetHandle:"left"});_.value=[...R,...G],et(()=>{I({x:0,y:0,zoom:.5}),setTimeout(()=>{se({duration:0,padding:.2}),console.log("🎯 Forced fit applied for enhanced flow")},50)})},be=()=>{const A=L();I({...A,zoom:Math.min(A.zoom*1.2,3)},{duration:300})},x=()=>{const A=L();I({...A,zoom:Math.max(A.zoom*.8,.2)},{duration:300})},v=()=>{k.value=!0},g=()=>{P.value=!1,S.value=null},M=()=>{k.value=!1},z=()=>{w.value=!1,S.value=null,Y.value=null,j.value=null},le=he(!1),U=he(null),ae=he(new Set),ge=(A,N)=>{const de=`http://localhost:3001/api/business/processes/${A}/execution-stream?executionId=${N}`;console.log("🔗 Connecting to SSE:",de);const R=new EventSource(de);return R.onopen=()=>{console.log("✅ SSE Connection opened")},R.onmessage=G=>{const Z=JSON.parse(G.data);if(console.log("🔄 SSE Event received:",Z),Z.type==="nodeExecuteBefore"){const He=_.value.filter(F=>!F.source).map(F=>({id:F.id,name:F.data?.stepName,type:F.type}));console.log("📋 Current flowElements nodes:",He),console.log("🎯 Looking for nodeId:",Z.nodeId)}switch(Z.type){case"nodeExecuteBefore":console.log(`🟠 Node ${Z.nodeName} (${Z.nodeId}) starting execution`);let He=!1;_.value=_.value.map(F=>F.id===Z.nodeName?(console.log(`✅ Found matching node by name: ${F.id}, setting isExecuting=true`),He=!0,{...F,data:{...F.data,isExecuting:!0}}):F),He||console.warn(`⚠️ Node ${Z.nodeName} not found in flowElements! Available nodes:`,_.value.filter(F=>!F.source).map(F=>F.id));break;case"nodeExecuteAfter":console.log(`⚫ Node ${Z.nodeName} (${Z.nodeId}) finished execution`),_.value=_.value.map(F=>F.id===Z.nodeName?(console.log(`✅ Found matching node by name: ${F.id}, setting isExecuting=false`),{...F,data:{...F.data,isExecuting:!1}}):F);break;case"workflowExecuteAfter":console.log("🏁 Workflow completed, waiting for last animation to finish..."),setTimeout(()=>{le.value=!1,ae.value.clear(),_.value=_.value.map(nt=>({...nt,data:{...nt.data,isExecuting:!1}}));const F=f.value?.process_name||"Workflow";s("Processo Completato ✅",`"${F}" eseguito con successo`),console.log("✅ Toast shown AFTER final animation"),setTimeout(async()=>{await loadWorkflowDetails(E.value),await dt(E.value)},1e3)},300),R.close();break;case"error":le.value=!1,ae.value.clear(),R.close(),r("Errore Esecuzione",Z.message);break}},R.onerror=G=>{console.error("❌ SSE connection error:",G),R.close(),le.value=!1,ae.value.clear(),_.value=_.value.map(Z=>({...Z,data:{...Z.data,isExecuting:!1}}))},R},we=async()=>{if(!f.value||!E.value){r("Nessun Workflow","Seleziona un workflow da eseguire");return}if(le.value)return;const A=f.value.process_name||"Unknown";le.value=!0;try{console.log(`🚀 Executing workflow ${E.value}...`);const N=`exec_${Date.now()}`;console.log(`🔗 About to connect SSE with executionId: ${N}`);const de=ge(E.value,N);console.log("📞 Calling businessAPI.executeWorkflow...");const R=await je.executeWorkflow(E.value);if(console.log("✅ Workflow execution result:",R),R.success&&R.data.executionStarted){U.value=R.data.executionId,console.log(`🚀 Workflow "${A}" started, SSE will handle feedback`);let G=0;const Z=30,He=setInterval(async()=>{G++;try{const F=await je.getExecutionStatus(R.data.executionId);if(F.success&&F.data.isFinished){if(clearInterval(He),le.value=!1,U.value=null,F.data.status==="success")s("Esecuzione Completata",`Il workflow "${A}" è stato eseguito con successo in ${Math.round(F.data.duration/1e3)}s`);else if(F.data.status==="error"&&F.data.errorInfo){const nt=F.data.errorInfo.errors.map(ze=>`${ze.nodeName}: ${ze.error.message}`).join(`
`);r("Esecuzione Fallita",`Il workflow "${A}" ha riscontrato errori:
${nt}`)}else r("Esecuzione Interrotta",`Il workflow "${A}" è stato interrotto`);fetchRealWorkflows(),E.value&&ke(E.value)}G>=Z&&(clearInterval(He),le.value=!1,U.value=null,s("Esecuzione in Corso",`Il workflow "${A}" è ancora in esecuzione dopo 30s`))}catch(F){console.error("Error polling execution status:",F)}},1e3)}else le.value=!1,U.value=null,r("Esecuzione Fallita",R.data?.n8nApiResult?.error||`Impossibile eseguire il workflow "${A}"`)}catch(N){console.error("❌ Failed to execute workflow:",N),le.value=!1,U.value=null,N("Errore di Esecuzione",`Impossibile eseguire il workflow "${A}". ${N.message}`)}},Ne=async()=>{if(!E.value||!U.value){r("Errore Stop","Nessuna esecuzione da fermare");return}const A=f.value?.process_name||"Unknown";try{console.log(`🛑 Stopping workflow ${E.value}, execution ${U.value}...`);const N=await je.stopWorkflow(E.value);console.log("✅ Workflow stop result:",N),N.success?s("Esecuzione Fermata",`Il workflow "${A}" è stato fermato con successo`):r("Errore Stop",N.data?.n8nApiResult?.error||`Impossibile fermare il workflow "${A}"`)}catch(N){console.error("❌ Failed to stop workflow:",N),N("Errore di Stop",`Impossibile fermare il workflow "${A}". ${N.message}`)}finally{le.value=!1,U.value=null}},Ae=async()=>{if(console.log("🚀 toggleWorkflowStatus called!"),console.log("📊 selectedWorkflowData:",f.value),console.log("📊 selectedWorkflowId:",E.value),!f.value||!E.value){console.log("❌ No workflow selected for toggle - EARLY RETURN");return}console.log("📊 Current workflow data:",f.value);const A=f.value.is_active||!1,N=!A;console.log(`🔄 Will toggle workflow ${E.value} from ${A} to ${N}`);try{console.log("🔄 Doing optimistic update..."),f.value.is_active=N;const de=p.value.findIndex(G=>G.id===E.value);de!==-1&&(p.value[de].is_active=N,console.log("✅ Updated workflow in list"));const R=await je.toggleWorkflow(E.value,N);console.log("✅ Workflow status updated:",R),R.success?R.data?.n8nApiResult?.error?s(`Workflow ${N?"Attivato":"Disattivato"}`,`${R.data.workflowName} è stato ${N?"attivato":"disattivato"} localmente`):s(`Workflow ${N?"Attivato":"Disattivato"}`,`${R.data.workflowName} è stato ${N?"attivato":"disattivato"} con successo`):r("Errore Attivazione","Impossibile aggiornare lo stato del workflow")}catch(de){console.error("❌ Failed to toggle workflow:",de),f.value.is_active=A;const R=p.value.findIndex(G=>G.id===E.value);R!==-1&&(p.value[R].is_active=A),de("Errore di Attivazione",`Impossibile ${N?"attivare":"disattivare"} il workflow. ${de.message}`)}},dt=async()=>{if(!S.value?.id)return;j.value=null,ee.value=1;const A=performance.now();try{console.log("🔄 Loading executions for workflow:",S.value.id);const N=await je.getProcessExecutionsForWorkflow(S.value.id),de=performance.now()-A;console.log(`✅ Executions loaded in ${de.toFixed(0)}ms:`,N.data),Y.value={...N.data,loading:!1}}catch(N){console.error("❌ Failed to load executions:",N),j.value=N.message,Y.value={executions:[],totalExecutions:0,successRate:0,avgDuration:0,loading:!1}}},ft=(A,N)=>A==="@n8n/n8n-nodes-langchain.agent"?"ai":A.includes("vectorstore")||A.includes("vectorStore")?"storage":A.includes("@n8n/n8n-nodes-langchain.lmChat")||A.includes("@n8n/n8n-nodes-langchain.embeddings")?"tool":A.includes("@n8n/n8n-nodes-langchain.openAi")?"agent":A.includes("@n8n/n8n-nodes-langchain.tool")||A.includes("@n8n/n8n-nodes-langchain.memory")||A.includes("@n8n/n8n-nodes-langchain.output")||A.includes("@n8n/n8n-nodes-langchain.reranker")||A.includes("@n8n/n8n-nodes-langchain.retriever")||A==="n8n-nodes-base.dateTimeTool"?"tool":A.toLowerCase().includes("trigger")?"trigger":"process",Nt=(A,N="")=>{if(!A||A==="undefined"||A==="null")return{nodeType:"",fallback:"Settings",size:"w-5 h-5"};if(N.toUpperCase().includes("UPSERT")&&N.toUpperCase().includes("SUPABASE"))return{nodeType:"UPSERT_SUPABASE_OVERRIDE",fallback:"Database",size:"w-5 h-5"};if(N.toUpperCase().includes("CALCULATOR"))return{nodeType:"CALCULATOR_TOOL_OVERRIDE",fallback:"Calculator",size:"w-5 h-5"};if(N.toUpperCase().includes("MCP")&&!N.toUpperCase().includes("SUPABASE"))return{nodeType:"MCP_CLIENT_OVERRIDE",fallback:"Zap",size:"w-5 h-5"};if(A==="n8n-nodes-base.set")return{nodeType:"n8n-nodes-base.set",fallback:"Edit",size:"w-5 h-5"};const de={nodeType:A,fallback:"Settings",size:"w-5 h-5"};return A?.includes("code")?de.fallback="Code":A?.includes("httpRequest")||N.toLowerCase().includes("scarica")?de.fallback="Globe":A?.includes("function")?de.fallback="Zap":A?.includes("webhook")?de.fallback="Link":A?.includes("email")||A?.includes("outlook")||A?.includes("gmail")?de.fallback="Mail":A?.includes("googleDrive")||A?.includes("file")?de.fallback="FileText":A?.includes("scheduleTrigger")||A?.includes("intervalTrigger")||A?.includes("cronTrigger")?de.fallback="Clock":A?.includes("executeWorkflowTrigger")?de.fallback="GitBranch":A?.includes("manualTrigger")?de.fallback="PlayCircle":A?.includes("trigger")?de.fallback="Play":A?.includes("agent")?de.fallback="Bot":A?.includes("database")||A?.includes("supabase")||A?.includes("vectorStore")?de.fallback="Database":A?.includes("telegram")&&(de.fallback="MessageSquare"),de},Ws=A=>{switch(A){case"SUCCESS":return"text-cyan-500 font-semibold";case"INFO":return"text-blue-400 font-semibold";case"DEBUG":return"text-gray-400 font-semibold";case"WARN":return"text-yellow-400 font-semibold";case"ERROR":return"text-red-400 font-semibold";default:return"text-gray-400 font-semibold"}};return Me(f,(A,N)=>{console.log("🔍 [DEBUG] selectedWorkflowData changed:",{newData:A?.process_name,oldData:N?.process_name,newId:A?.id,oldId:N?.id,stackTrace:new Error().stack?.split(`
`)[2]?.trim()})}),ct(async()=>{console.log("🚀 WorkflowCommandCenter mounted, loading data...");try{await _e(),console.log("📊 Final state:",{workflows:p.value.length,totalExecutions:fe.value,activeWorkflows:K.value});const A=t.query.workflowId;if(A&&p.value.length>0){console.log("🎯 URL workflowId detected:",A);const N=p.value.find(de=>de.id===A);if(N){console.log("✅ Found workflow from URL, selecting:",N.process_name),await ue(N);return}else console.log("❌ Workflow from URL not found, falling back to first")}p.value.length>0&&!E.value&&(console.log("🎯 Auto-selecting first workflow:",p.value[0].process_name),await ue(p.value[0]))}catch(A){console.error("❌ ERROR in onMounted:",A),console.error("❌ Error stack:",A.stack);try{console.log("🔄 Trying alternative data load...");const N=await je.getProcesses({_t:Date.now()});console.log("🔧 Alternative data:",N);const de=(N.data||[]).sort((R,G)=>R.is_active!==G.is_active?R.is_active?-1:1:R.process_name.localeCompare(G.process_name));p.value=de,console.log("🔧 Alternative workflows set:",p.value.length,"(sorted)"),p.value.length>0&&!E.value&&(console.log("🎯 Auto-selecting first workflow (fallback):",p.value[0].process_name),await ue(p.value[0]))}catch(N){console.error("❌ Alternative load also failed:",N)}}}),(A,N)=>{const de=Et("GitBranch");return $(),$e(ar,null,{default:Xe(()=>[u("div",wh,[u("div",xh,[q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",_h,[u("div",bh,[u("p",Eh,V(fe.value.toLocaleString()),1),q(T(Ct),{value:"Totali",severity:"info",class:"text-xs badge-white-text"})]),N[7]||(N[7]=u("p",{class:"text-xs text-text-muted"},"Prod. executions • Last 7 days",-1))])]),_:1}),q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",kh,[u("div",Sh,[u("p",Nh,V(me.value),1),q(T(Ct),{value:"Fallite",severity:"danger",class:"text-xs badge-white-text"})]),N[8]||(N[8]=u("p",{class:"text-xs text-text-muted"},"Failed prod. executions • Last 7 days",-1))])]),_:1}),q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",Ch,[u("div",$h,[u("p",Ih,V(Math.round(100-te.value))+"%",1),q(T(Ct),{value:"SUCCESS",severity:"info",class:"text-xs badge-white-text"})]),N[9]||(N[9]=u("p",{class:"text-xs text-text-muted"},"Tasso Successo • Last 7 days",-1))])]),_:1}),q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",Th,[u("div",Mh,[u("p",Dh,V(ce.value)+"h",1),q(T(Ct),{value:"SAVED",severity:"warning",class:"text-xs badge-white-text"})]),N[10]||(N[10]=u("p",{class:"text-xs text-text-muted"},"Time saved • Last 7 days",-1))])]),_:1}),q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",Ah,[u("div",Ph,[u("p",Oh,V(re.value),1),q(T(Ct),{value:"AVG",severity:"info",class:"text-xs badge-white-text"})]),N[11]||(N[11]=u("p",{class:"text-xs text-text-muted"},"Run time (avg.) • Last 7 days",-1))])]),_:1}),q(T(Bt),{class:"premium-glass premium-hover-lift"},{content:Xe(()=>[u("div",Rh,[u("div",zh,[u("p",Bh,V(K.value)+"/"+V(Q.value),1),q(T(Ct),{value:"SYSTEM",severity:"info",class:"text-xs badge-white-text"})]),N[12]||(N[12]=u("p",{class:"text-xs text-text-muted"},"Active workflows • System status",-1))])]),_:1})]),u("div",Lh,[u("div",{class:ve([a.value?"w-12":"w-48","premium-glass rounded-lg overflow-hidden transition-all duration-300 flex-shrink-0"])},[u("div",Vh,[a.value?ye("",!0):($(),O("h3",Fh,"BUSINESS PROCESSES")),u("button",{onClick:N[0]||(N[0]=R=>a.value=!a.value),class:"p-1 text-text-muted hover:text-text transition-colors"},[q(T(Ee),{icon:"lucide:chevron-left",class:ve([{"rotate-180":a.value},"w-4 h-4 transition-transform"])},null,8,["class"])])]),a.value?($(),O("div",Kh,[u("div",jh,[($(!0),O(xe,null,Te(p.value,R=>($(),O("div",{key:R.id,onClick:G=>ue(R),class:ve(["w-8 h-8 rounded-md cursor-pointer transition-all flex items-center justify-center",E.value===R.id?"bg-primary/20 border border-primary/50":"bg-surface/50 hover:bg-surface"]),title:R.process_name},[u("div",{class:ve(["w-2 h-2 rounded-full",R.is_active?"bg-primary":"bg-text-muted"])},null,2)],10,Jh))),128))])])):($(),O("div",Hh,[u("div",Gh,[u("span",Yh,V(K.value)+"/"+V(Q.value)+" active",1)]),u("div",Wh,[($(!0),O(xe,null,Te(p.value,R=>($(),O("div",{key:R.id,onClick:G=>ue(R),class:ve(["p-2 rounded-md cursor-pointer transition-all text-xs",E.value===R.id?"bg-primary/10 border border-primary/30":"bg-surface/50 hover:bg-surface border border-transparent hover:border-border"])},[u("div",Xh,[u("div",{class:ve(["w-1.5 h-1.5 rounded-full",R.is_active?"bg-primary animate-pulse":"bg-text-muted"])},null,2),u("span",{class:"font-medium text-text truncate flex-1 max-w-32",title:R.process_name},V(R.process_name),9,Zh)]),u("div",qh,V(R.executions_today)+" today ",1)],10,Uh))),128))])]))],2),u("div",Qh,[u("div",em,[u("div",tm,[u("div",null,[u("div",nm,V(f.value?.process_name||"Select a workflow to visualize"),1),m.value?($(),O("div",om,[u("span",null,V(m.value.kpis?.totalExecutions||0)+" executions",1),N[13]||(N[13]=u("span",null,"•",-1)),u("span",im,[u("div",{style:We({width:"6px",height:"6px",borderRadius:"50%",backgroundColor:(m.value.kpis?.successRate||0)>=80?"#10b981":"#ef4444"})},null,4),Ye(" "+V(m.value.kpis?.successRate||0)+"% success ",1)]),N[14]||(N[14]=u("span",null,"•",-1)),u("span",null,V(m.value.kpis?.avgRunTime?Math.round(m.value.kpis.avgRunTime)+"ms":"N/A")+" avg",1)])):ye("",!0)])]),u("div",sm,[u("button",{onClick:v,disabled:!E.value,class:"px-4 py-2 text-sm font-medium rounded-lg bg-primary/10 hover:bg-primary/20 text-primary border border-primary/20 hover:border-primary/40 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all backdrop-blur-sm"},[q(T(Ee),{icon:"lucide:bar-chart-3",class:"w-4 h-4"}),N[15]||(N[15]=Ye(" Business Analytics ",-1))],8,rm)]),u("div",lm,[m.value?.kpis?.last24hExecutions?($(),O("div",am,[N[16]||(N[16]=u("div",{class:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"},null,-1)),u("span",cm,V(m.value.kpis.last24hExecutions)+" runs today",1)])):ye("",!0),m.value?.kpis?.efficiencyScore?($(),$e(T(Ct),{key:1,value:`${m.value.kpis.efficiencyScore}% efficiency`,severity:m.value.kpis.efficiencyScore>=80?"success":m.value.kpis.efficiencyScore>=60?"warning":"danger",class:"text-xs"},null,8,["value","severity"])):ye("",!0),u("div",um,[u("span",dm,V(f.value?.is_active?"Active":"Inactive"),1),i.value?($(),O("button",{key:0,onClick:Ae,disabled:!E.value,class:ve(["relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",f.value?.is_active?"bg-primary":"bg-gray-600"])},[u("span",{class:ve(["inline-block h-3 w-3 transform rounded-full bg-white transition-transform",f.value?.is_active?"translate-x-5":"translate-x-1"])},null,2)],10,fm)):ye("",!0)])])]),u("div",pm,[E.value?($(),$e(T(yf),{key:0,modelValue:_.value,"onUpdate:modelValue":N[3]||(N[3]=R=>_.value=R),"node-types":H,"default-viewport":{zoom:1,x:0,y:0},"min-zoom":.2,"max-zoom":3,"connection-line-type":"default",class:"workflow-flow h-full"},{"node-custom":Xe(({data:R})=>[R.type==="ai"?($(),O("div",{key:0,class:ve(["premium-ai-node",[R.status==="success"?"premium-ai-active":"premium-ai-inactive"]])},[($(!0),O(xe,null,Te((R.inputs||[]).filter(G=>G==="main"),(G,Z)=>($(),$e(T(Oe),{key:"main-input-"+Z,id:"input-"+Z,type:"target",position:T(X).Left,style:{top:"50%",transform:"translateY(-50%)"},class:ve(`premium-handle-ai-main ${ne(R.id,"input-"+Z)?"handle-connected":"handle-disconnected"}`),title:`Main Input: ${G}`},null,8,["id","position","class","title"]))),128)),($(!0),O(xe,null,Te((R.outputs||[]).filter(G=>G==="main"),(G,Z)=>($(),$e(T(Oe),{key:"main-output-"+Z,id:"output-"+Z,type:"source",position:T(X).Right,style:{top:"50%",transform:"translateY(-50%)"},class:ve(["premium-handle-ai-main",ne(R.id,"output-"+Z)?"handle-connected":"handle-disconnected"]),title:`Main Output: ${G}`},null,8,["id","position","class","title"]))),128)),($(!0),O(xe,null,Te([...(R.inputs||[]).filter(G=>G!=="main"),...(R.outputs||[]).filter(G=>G!=="main")],(G,Z)=>($(),$e(T(Oe),{key:"tool-"+Z,id:"tool-"+Z,type:(R.inputs||[]).includes(G)?"target":"source",position:T(X).Bottom,style:We({left:G.length>1?`${20+Z*(140/Math.max([...(R.inputs||[]).filter(He=>He!=="main"),...(R.outputs||[]).filter(He=>He!=="main")].length-1,1))}px`:"50%",transform:"translateX(-50%)"}),class:ve(["premium-handle-ai-tool",ne(R.id,"tool-"+Z)?"handle-connected":"handle-disconnected"]),title:`AI Tool: ${G}`},null,8,["id","type","position","style","class","title"]))),128)),u("div",km,[q(en,$t(Nt(R.nodeType,R.label),{size:"w-16 h-16"}),null,16)]),u("div",Sm,[u("div",Nm,V(R.label),1),R.outputs?.length>1?($(),O("div",Cm,V(R.outputs.length)+" outputs ",1)):ye("",!0)]),u("div",{class:ve(["premium-ai-status",R.status==="success"?"premium-status-ai-active":"premium-status-ai-inactive"])},null,2)],2)):R.type==="trigger"?($(),O("div",$m,[u("div",{class:ve(["premium-trigger-node",[R.status==="success"?"premium-trigger-active":"premium-trigger-inactive"]])},[($(!0),O(xe,null,Te(R.outputs||["main"],(G,Z)=>($(),$e(T(Oe),{key:"output-"+Z,id:"output-"+Z,type:"source",position:T(X).Right,style:We({top:R.outputs?.length>1?`${15+Z*20}px`:"50%",transform:"translateY(-50%)"}),class:ve(["premium-handle-trigger",ne(R.id,"output-"+Z)?"handle-connected":"handle-disconnected"])},null,8,["id","position","style","class"]))),128)),u("div",Im,[q(en,$t(Nt(R.nodeType,R.label),{size:"w-12 h-12"}),null,16)])],2),u("div",Tm,V(R.label),1)])):R.type==="tool"?($(),O("div",Mm,[u("div",{class:ve(["premium-tool-node",[R.status==="success"?"premium-tool-active":"premium-tool-inactive"]])},[($(!0),O(xe,null,Te(R.inputs||["main"],(G,Z)=>($(),$e(T(Oe),{key:"input-"+Z,id:"input-"+Z,type:"target",position:T(X).Bottom,style:{left:"50%",transform:"translateX(-50%)"},class:ve(["premium-handle-tool-bottom",ne(R.id,"input-"+Z)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),($(!0),O(xe,null,Te(R.outputs||["main"],(G,Z)=>($(),$e(T(Oe),{key:"output-"+Z,id:"output-"+Z,type:"source",position:T(X).Top,style:{left:"50%",transform:"translateX(-50%)"},class:ve(["premium-handle-tool-top",ne(R.id,"output-"+Z)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),u("div",Dm,[q(en,$t(Nt(R.nodeType,R.label),{size:"w-12 h-12"}),null,16)])],2),u("div",Am,V(R.label),1)])):R.type==="storage"?($(),O("div",{key:3,class:ve(["premium-storage-node",[R.status==="success"?"premium-storage-active":"premium-storage-inactive"]])},[($(!0),O(xe,null,Te((R.inputs||["main"]).filter(G=>G==="main"),(G,Z)=>($(),$e(T(Oe),{key:"input-"+Z,id:"input-"+Z,type:"target",position:T(X).Top,style:{left:"50%",transform:"translateX(-50%)"},class:ve(["premium-handle-storage",ne(R.id,"input-"+Z)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),($(!0),O(xe,null,Te((R.inputs||[]).filter(G=>G!=="main"),(G,Z)=>($(),$e(T(Oe),{key:"tool-input-"+Z,id:"tool-"+Z,type:"target",position:T(X).Bottom,style:{left:"50%",transform:"translateX(-50%)"},class:ve(["premium-handle-storage",ne(R.id,"tool-"+Z)?"handle-connected":"handle-disconnected"])},null,8,["id","position","class"]))),128)),u("div",Pm,[u("div",Om,[q(en,$t(Nt(R.nodeType,R.label),{size:"w-8 h-8"}),null,16)]),u("div",Rm,V(R.label),1)])],2)):($(),O("div",zm,[u("div",{class:ve(["premium-process-node",[R.status==="success"?"premium-process-active":"premium-process-inactive"]])},[($(!0),O(xe,null,Te(R.inputs||["main"],(G,Z)=>($(),$e(T(Oe),{key:"input-"+Z,id:"input-"+Z,type:"target",position:T(X).Left,style:We({top:R.inputs?.length>1?`${15+Z*20}px`:"50%",transform:"translateY(-50%)"}),class:ve("premium-handle-process handle-disconnected")},null,8,["id","position","style"]))),128)),($(!0),O(xe,null,Te(R.outputs||["main"],(G,Z)=>($(),$e(T(Oe),{key:"output-"+Z,id:"output-"+Z,type:"source",position:T(X).Right,style:We({top:R.outputs?.length>1?`${15+Z*20}px`:"50%",transform:"translateY(-50%)"}),class:ve("premium-handle-process handle-disconnected")},null,8,["id","position","style"]))),128)),u("div",Bm,[q(en,$t(Nt(R.nodeType,R.label),{size:"w-12 h-12"}),null,16)])],2),u("div",Lm,V(R.label),1)]))]),default:Xe(()=>[q(T(Sf),{"pattern-color":"#10b981",size:1,variant:"dots"}),i.value?($(),O("div",gm,[le.value?($(),O("button",{key:1,onClick:Ne,class:"px-4 py-2 bg-red-700 border border-red-600 text-white rounded transition-colors shadow-lg flex items-center gap-2 hover:bg-red-600",title:"Stop Workflow"},[q(T(Ee),{icon:"lucide:square",class:"w-4 h-4"}),N[18]||(N[18]=Ye(" Stop ",-1))])):($(),O("button",{key:0,onClick:we,disabled:!E.value,class:ve(["px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded transition-colors shadow-lg flex items-center gap-2","hover:bg-gray-700",E.value?"":"opacity-50 cursor-not-allowed"]),title:"Execute Workflow"},[q(T(Ee),{icon:"lucide:play",class:"w-4 h-4"}),N[17]||(N[17]=Ye(" Execute Now ",-1))],10,hm))])):ye("",!0),u("div",mm,[u("button",{onClick:N[1]||(N[1]=()=>T(se)({duration:600,padding:.15})),class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center shadow-lg",title:"Fit View"},[...N[19]||(N[19]=[u("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[u("path",{d:"M5 5h4v2H7v2H5V5zm10 0h4v4h-2V7h-2V5zM7 15v2h2v2H5v-4h2zm8 2v-2h2v4h-4v-2h2z"})],-1)])]),u("button",{onClick:be,class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center text-lg font-bold shadow-lg",title:"Zoom In"}," + "),u("button",{onClick:x,class:"w-10 h-10 bg-gray-800 border border-gray-600 text-white rounded hover:bg-gray-700 transition-colors flex items-center justify-center text-lg font-bold shadow-lg",title:"Zoom Out"}," − ")]),u("div",vm,[u("button",{onClick:N[2]||(N[2]=R=>c.value=!c.value),class:"bg-gray-800 border border-gray-600 text-white px-4 py-2 rounded-t-lg shadow-lg hover:bg-gray-700 transition-colors flex items-center gap-2"},[N[21]||(N[21]=u("span",{class:"text-sm font-medium"},"Logs",-1)),N[22]||(N[22]=u("div",{class:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"},null,-1)),($(),O("svg",{class:ve(["w-4 h-4 text-gray-400 transition-transform",{"rotate-180":c.value}]),fill:"currentColor",viewBox:"0 0 20 20"},[...N[20]||(N[20]=[u("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])],2))]),c.value?($(),O("div",ym,[u("div",wm,[d.value.length===0?($(),O("div",xm,[...N[23]||(N[23]=[u("p",{class:"text-gray-400 text-sm"},"Nothing to display yet. Execute the workflow to see execution logs.",-1)])])):($(),O("div",_m,[($(!0),O(xe,null,Te(d.value,(R,G)=>($(),O("div",{key:G,class:"flex items-start gap-3 text-sm"},[u("span",bm,V(R.timestamp),1),u("span",{class:ve([Ws(R.level),"shrink-0 min-w-[60px]"])},V(R.level),3),u("span",Em,V(R.message),1)]))),128))]))])])):ye("",!0)])]),_:1},8,["modelValue"])):($(),O("div",Vm,[u("div",Fm,[q(de,{class:"w-16 h-16 text-text-muted mx-auto mb-4"}),N[24]||(N[24]=u("h3",{class:"text-lg font-semibold text-text mb-2"},"Select a Process",-1)),N[25]||(N[25]=u("p",{class:"text-text-muted"},"Choose a workflow from the list to visualize its structure",-1))])]))])])]),S.value?($(),$e(gh,{key:0,workflow:S.value,show:P.value,onClose:g},null,8,["workflow","show"])):ye("",!0),E.value&&k.value?($(),$e(ur,{key:1,"workflow-id":E.value,"tenant-id":wv,show:k.value,onClose:M},null,8,["workflow-id","show"])):ye("",!0),S.value?($(),$e(dr,{key:2,show:w.value,title:`Process Executions: ${S.value.process_name}`,subtitle:`ID: ${S.value.id}`,"header-icon":"lucide:play",tabs:J,"default-tab":"executions","is-loading":Y.value?.loading||!1,error:j.value,data:Y.value,onClose:z,onRefresh:dt,onRetry:dt},{executions:Xe(({data:R})=>[u("div",Hm,[u("div",Gm,[u("h3",Ym,"Recent Executions (Page "+V(ee.value)+"/"+V(ie.value)+")",1),R?.executions?.length>0?($(),O("div",Wm," Showing the "+V(R.executions.length)+" most recent executions ",1)):ye("",!0),D.value.length>0?($(),O("div",Um,[u("table",Xm,[N[26]||(N[26]=u("thead",{class:"bg-surface-hover border-b border-border"},[u("tr",null,[u("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Status"),u("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"ID"),u("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Started"),u("th",{class:"text-left px-3 py-2 text-text-muted font-medium"},"Duration")])],-1)),u("tbody",null,[($(!0),O(xe,null,Te(D.value,(G,Z)=>($(),O("tr",{key:G.id||Z,class:"border-b border-border/50 hover:bg-surface-hover/30"},[u("td",Zm,[u("div",qm,[G.finished&&!G.error?($(),$e(T(Ee),{key:0,icon:"lucide:check-circle",class:"h-4 w-4 text-cyan-500"})):G.error?($(),$e(T(Ee),{key:1,icon:"lucide:x-circle",class:"h-4 w-4 text-red-400"})):($(),$e(T(Ee),{key:2,icon:"lucide:clock",class:"h-4 w-4 text-yellow-400"})),u("span",{class:ve(["text-xs font-medium",G.finished&&!G.error?"text-cyan-500":G.error?"text-red-400":"text-yellow-400"])},V(G.finished&&!G.error?"Success":G.error?"Failed":"Running"),3)])]),u("td",Km," #"+V(G.id),1),u("td",jm,V(A.formatDate(G.startedAt)),1),u("td",Jm,V(A.formatDuration(G.execution_time||0)),1)]))),128))])])])):ye("",!0),R?.executions?.length>Vt?($(),O("div",Qm,[u("div",ev," Showing "+V((ee.value-1)*Vt+1)+" - "+V(Math.min(ee.value*Vt,R.executions.length))+" of "+V(R.executions.length),1),u("div",tv,[u("button",{onClick:N[4]||(N[4]=G=>ee.value=Math.max(1,ee.value-1)),disabled:ee.value===1,class:"px-3 py-1 text-xs bg-surface border border-border rounded hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,nv),u("div",ov,[($(!0),O(xe,null,Te(Math.min(5,ie.value),G=>($(),O("button",{key:G,onClick:Z=>ee.value=G,class:ve(["w-8 h-8 text-xs rounded transition-colors",ee.value===G?"bg-primary text-white":"bg-surface border border-border hover:bg-surface-hover"])},V(G),11,iv))),128)),ie.value>5?($(),O("span",sv,"...")):ye("",!0),ie.value>5?($(),O("button",{key:1,onClick:N[5]||(N[5]=G=>ee.value=ie.value),class:ve(["w-8 h-8 text-xs rounded transition-colors",ee.value===ie.value?"bg-primary text-white":"bg-surface border border-border hover:bg-surface-hover"])},V(ie.value),3)):ye("",!0)]),u("button",{onClick:N[6]||(N[6]=G=>ee.value=Math.min(ie.value,ee.value+1)),disabled:ee.value===ie.value,class:"px-3 py-1 text-xs bg-surface border border-border rounded hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,rv)])])):R?.executions?.length?ye("",!0):($(),O("div",lv,[q(T(Ee),{icon:"lucide:play",class:"w-12 h-12 text-text-muted mx-auto mb-4"}),N[27]||(N[27]=u("p",{class:"text-text-muted"},"No executions found for this process",-1))]))])])]),stats:Xe(({data:R})=>[u("div",av,[u("div",cv,[u("div",uv,[u("div",dv,[N[28]||(N[28]=u("span",{class:"text-sm text-text-muted"},"Total Executions",-1)),q(T(Ee),{icon:"lucide:play",class:"h-4 w-4 text-gray-600"})]),u("p",fv,V(R?.totalExecutions||0),1)]),u("div",pv,[u("div",gv,[N[29]||(N[29]=u("span",{class:"text-sm text-text-muted"},"Success Rate",-1)),q(T(Ee),{icon:"lucide:check-circle",class:"h-4 w-4 text-gray-600"})]),u("p",hv,V(R?.successRate?`${R.successRate.toFixed(1)}%`:"N/A"),1)]),u("div",mv,[u("div",vv,[N[30]||(N[30]=u("span",{class:"text-sm text-text-muted"},"Avg Duration",-1)),q(T(Ee),{icon:"lucide:clock",class:"h-4 w-4 text-gray-600"})]),u("p",yv,V(A.formatDuration(R?.avgDuration||0)),1)])])])]),_:1},8,["show","title","subtitle","is-loading","error","data"])):ye("",!0)])]),_:1})}}}),Tv=Yn(xv,[["__scopeId","data-v-d032f6cf"]]);export{Tv as default};
//# sourceMappingURL=WorkflowCommandCenter-BiK0PVnh.js.map
