import{I as C}from"./iconify-DotyfKt7.js";import{a3 as $e,r as M,G as ae,d as le,q as oe,j as ne,e as u,a4 as Se,c as d,g as j,f as e,m as R,k as A,t as l,I as te,n as B,F as q,z as J,l as Q,a0 as Te,w as je,o as Ee,y as K,aa as Ie}from"./index-jxRXDN-X.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{$ as Ce,b as ie}from"./api-client-BIZDZkFB.js";function ce(h=!1,c={}){const s=$e(),o=M(h),g=M(!1),p=M(null),{closeOnEscape:v=!0,closeOnClickOutside:$=!0,showLoadingSpinner:T=!0}=c,N=()=>{o.value=!0,p.value=null},_=()=>{o.value=!1,p.value=null},H=f=>{g.value=f},a=f=>{f===null?p.value=null:typeof f=="string"?p.value=f:p.value=f.message,g.value=!1},n=(f,E,L)=>{s.showToast(E,L||"",f)},b=f=>{v&&f.key==="Escape"&&o.value&&_()},y=()=>{$&&_()};return ae(o,f=>{f&&v?document.addEventListener("keydown",b):document.removeEventListener("keydown",b)}),{show:o,isLoading:g,error:p,open:N,close:_,setLoading:H,setError:a,showToast:n,handleClickOutside:y,hasError:()=>p.value!==null,canSubmit:()=>!g.value&&p.value===null}}const Re={class:"w-full max-w-5xl h-[80vh] premium-glass premium-modal-container overflow-hidden flex flex-col premium-float"},Ne={class:"flex items-center justify-between p-6 border-b border-gray-800/50 bg-gradient-to-r from-gray-900/50 to-gray-800/30"},De={class:"flex items-center gap-4"},Pe={class:"p-3 bg-primary/20 border border-primary/40 rounded-lg premium-glow-subtle premium-hover-lift"},Oe={class:"text-xl font-bold text-white premium-gradient-text"},Le={key:0,class:"flex items-center gap-3 mt-1"},Be={class:"text-sm text-gray-400"},ze={class:"flex items-center gap-2"},Ve=["disabled","title"],Fe={key:0,class:"flex items-center justify-center p-12 bg-gray-900/30"},Me={class:"text-center"},Ue={class:"mt-4 text-gray-300"},qe={key:1,class:"p-6 bg-red-900/10 border border-red-500/20 m-4 rounded-lg"},Je={class:"text-gray-300"},He={class:"mt-4 flex gap-2"},Ge={key:2,class:"flex flex-col flex-1"},Ke={key:0,class:"flex items-center gap-1 p-3 border-b border-gray-800/50 bg-gradient-to-r from-gray-900/30 to-gray-800/20"},Ze=["onClick"],We={class:"overflow-y-auto flex-1 bg-gray-900/20",style:{"max-height":"calc(70vh - 140px)"}},Xe={class:"p-6"},Ye=le({__name:"DetailModal",props:{show:{type:Boolean},title:{},subtitle:{},headerIcon:{default:"lucide:file-text"},tabs:{default:()=>[]},defaultTab:{},loadingText:{default:"Caricamento dati..."},showRefresh:{type:Boolean,default:!0},isLoading:{type:Boolean,default:!1},error:{default:null},data:{default:null}},emits:["close","refresh","retry","tabChanged"],setup(h,{emit:c}){const s=h,o=c,{handleClickOutside:g}=ce(!1),p=M(s.defaultTab||s.tabs[0]?.id||"default"),v=oe(()=>s.data!==null||s.error!==null),$=()=>{o("refresh")};return(T,N)=>(u(),ne(Se,{to:"body"},[T.show?(u(),d("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 premium-modal-overlay",onClick:N[3]||(N[3]=je((..._)=>A(g)&&A(g)(..._),["self"]))},[e("div",Re,[e("div",Ne,[e("div",De,[e("div",Pe,[R(A(C),{icon:T.headerIcon,class:"h-6 w-6 text-primary premium-text-glow"},null,8,["icon"])]),e("div",null,[e("h2",Oe,l(T.title),1),T.subtitle||T.$slots.subtitle?(u(),d("div",Le,[te(T.$slots,"subtitle",{},()=>[e("span",Be,l(T.subtitle),1)],!0)])):j("",!0)])]),e("div",ze,[te(T.$slots,"headerActions",{isLoading:T.isLoading,refresh:$},void 0,!0),T.showRefresh?(u(),d("button",{key:0,onClick:$,disabled:T.isLoading,class:"p-2 text-gray-400 hover:text-primary disabled:text-gray-600 transition-all duration-200 premium-hover-lift rounded-lg hover:bg-gray-800/50",title:T.isLoading?"Aggiornamento...":"Aggiorna dati"},[R(A(C),{icon:"lucide:refresh-cw",class:B(["h-4 w-4",{"animate-spin":T.isLoading}])},null,8,["class"])],8,Ve)):j("",!0),e("button",{onClick:N[0]||(N[0]=_=>T.$emit("close")),class:"p-2 text-gray-400 hover:text-red-400 transition-all duration-200 premium-hover-lift rounded-lg hover:bg-red-900/20"},[R(A(C),{icon:"lucide:x",class:"h-5 w-5"})])])]),T.isLoading&&!v.value?(u(),d("div",Fe,[e("div",Me,[N[4]||(N[4]=e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary premium-neon-pulse"},null,-1)),e("p",Ue,l(T.loadingText),1)])])):T.error?(u(),d("div",qe,[N[5]||(N[5]=e("div",{class:"flex items-center justify-between mb-4"},[e("h2",{class:"text-lg font-semibold text-red-400 premium-text-glow"},"Errore nel caricamento")],-1)),e("p",Je,l(T.error),1),e("div",He,[e("button",{onClick:N[1]||(N[1]=_=>T.$emit("retry")),class:"btn-premium"},"Riprova"),e("button",{onClick:N[2]||(N[2]=_=>T.$emit("close")),class:"btn-premium-secondary"},"Chiudi")])])):(u(),d("div",Ge,[T.tabs.length>1?(u(),d("div",Ke,[(u(!0),d(q,null,J(T.tabs,_=>(u(),d("button",{key:_.id,onClick:H=>p.value=_.id,class:B(["flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all duration-200 premium-hover-lift",p.value===_.id?"bg-primary text-white premium-glow-intense premium-text-glow":"text-gray-400 hover:bg-gray-800/50 hover:text-white"])},[(u(),ne(Te(_.icon),{class:"h-4 w-4"})),Q(" "+l(_.label),1)],10,Ze))),128))])):j("",!0),e("div",We,[te(T.$slots,p.value,{activeTab:p.value,isLoading:T.isLoading,error:T.error,data:T.data},()=>[e("div",Xe,[te(T.$slots,"default",{activeTab:p.value,data:T.data},void 0,!0)])],!0)])]))])])):j("",!0)]))}}),Qe=Ae(Ye,[["__scopeId","data-v-04749c74"]]);function et(){const h=a=>a?a.replace(/n8n/gi,"WFEngine").replace(/\.nodes\./g,".engine.").replace(/\.base\./g,".core."):"",c=a=>{if(!a?.json)return null;const n=[],b=a.json.oggetto||a.json.subject;b&&n.push(`Oggetto: "${b}"`);const f=[a.json.mittente,a.json.mittente_nome,a.json.sender?.emailAddress?.address,a.sender?.emailAddress?.address].find(S=>S);f&&n.push(`Da: ${f}`);const L=[a.json.messaggio_cliente,a.json.messaggio,a.json.body?.content,a.json.body,a.json.content].find(S=>S&&typeof S=="string"&&S.length>20);if(L){const D=L.replace(/<[^>]+>/g," ").replace(/&[a-zA-Z0-9]+;/g," ").replace(/\s+/g," ").trim().substring(0,150);n.push(`Messaggio: "${D}${D.length>=150?"...":""}"`)}return n.length>0?{summary:"Email ricevuta",details:n,type:"email",confidence:"high"}:null},s=a=>{if(!a?.json)return null;const n=[],y=[a.json.output?.risposta_html,a.json.risposta_html,a.json.ai_response,a.json.response,a.json.output].find(f=>f&&typeof f=="string"&&f.length>20);if(y){const E=y.replace(/<[^>]+>/g," ").replace(/&[a-zA-Z0-9]+;/g," ").replace(/\s+/g," ").trim().substring(0,200);n.push(`Risposta: "${E}${E.length>=200?"...":""}"`)}return(a.json.categoria||a.json.classification)&&n.push(`Categoria: ${a.json.categoria||a.json.classification}`),n.length>0?{summary:"Risposta AI generata",details:n,type:"ai",confidence:"high"}:null},o=a=>{if(!a?.json)return null;const n=[];return a.json.order_reference&&n.push(`Riferimento: ${a.json.order_reference}`),a.json.customer_full_name&&n.push(`Cliente: ${a.json.customer_full_name}`),a.json.order_status&&n.push(`Stato: ${a.json.order_status}`),a.json.order_total_paid&&n.push(`Totale: ${a.json.order_total_paid}`),a.json.delivery_city&&n.push(`CittÃ  consegna: ${a.json.delivery_city}`),a.json.order_shipping_number&&n.push(`Tracking: ${a.json.order_shipping_number}`),n.length>0?{summary:"Dati ordine recuperati",details:n,type:"order",confidence:"high"}:null},g=a=>{if(!a?.json)return null;const n=[];if(a.json.matches||a.json.results){const b=a.json.matches||a.json.results,y=Array.isArray(b)?b.length:1;n.push(`Documenti trovati: ${y}`)}if((a.json.score||a.json.similarity)&&n.push(`SimilaritÃ : ${a.json.score||a.json.similarity}`),a.json.content||a.json.text){const y=(a.json.content||a.json.text).substring(0,100);n.push(`Contenuto: "${y}${y.length>=100?"...":""}"`)}return n.length>0?{summary:"Ricerca vettoriale completata",details:n,type:"vector",confidence:"medium"}:null},p=a=>{const n=JSON.stringify(a),b=[],y=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,f=n.match(y);f&&f.length>0&&b.push(`Email rilevata: ${f[0]}`);const E=Array.isArray(a)?a[0]:a;if(E&&typeof E=="object"){const L=Object.keys(E.json||E);L.length>0&&b.push(`Campi disponibili: ${L.slice(0,4).join(", ")}${L.length>4?"...":""}`)}return{summary:"Dati di processo",details:b.length>0?b:["Dati complessi disponibili"],type:"generic",confidence:"low"}},v=(a,n,b,y)=>{const f=h(b),E=y?.toLowerCase()||"";if((f?.includes("trigger")||f?.includes("Trigger")||E.includes("ricezione")||E.includes("trigger"))&&n==="input")return{summary:"In attesa di eventi",details:["In attesa di nuove email dal server Microsoft Outlook"],type:"email",confidence:"high"};if(f==="execution_error"||E.includes("execution error")){let I="Errore di Esecuzione",P=["Il workflow ha riscontrato un errore durante l'esecuzione"];if(a&&typeof a=="object"&&(a.n8nErrorDetails||a.errorType)){const U=a.errorType||"Unknown Error",G=a.failedNode||"Unknown Node",W=a.specificErrorMessage||"Error details not available",V=a.stackTrace,X=a.httpCode,ee=a.errorTimestamp;if(I=`${U}: ${G}`,P=[`Errore: ${W}`,`Nodo Fallito: ${G}`,`Tipo Errore: ${U}`],X&&P.push(`Codice HTTP: ${X}`),ee){const Y=new Date(ee);P.push(`Timestamp: ${Y.toLocaleString("it-IT")}`)}if(V&&V.includes("at ")){const Y=V.split(`
`)[0];P.push(`Stack: ${Y}`)}U==="NodeApiError"?P.push("Suggerimento: Verificare connessioni API e credenziali"):W.toLowerCase().includes("connection")?P.push("Suggerimento: Controllare connettivitÃ  di rete"):W.toLowerCase().includes("auth")&&P.push("Suggerimento: Verificare le credenziali di autenticazione")}return{summary:I,details:P,type:"error",confidence:"high"}}if(!a)return{summary:"Nessun dato",details:["Nessun dato disponibile per questo step"],type:"generic",confidence:"high"};const S=Array.isArray(a)?a[0]:a;if(!S||typeof S!="object")return{summary:"Dato semplice",details:[String(S)||"Dato non strutturato"],type:"generic",confidence:"medium"};const D=E.includes("mail")||E.includes("ricezione"),Z=E.includes("milena")||E.includes("assistente")||E.includes("ai"),w=E.includes("ordini")||E.includes("order"),k=E.includes("qdrant")||E.includes("vector");if(D&&n==="output"){const I=c(S);if(I)return I}if(Z&&n==="output"){const I=s(S);if(I)return I}if(w){const I=o(S);if(I)return I}if(k&&n==="output"){const I=g(S);if(I)return I}return p(S)},$=a=>{const n=`--- ${a.summary.toUpperCase()} ---`,b=a.details.join(`
`);return`${n}
${b}`},T=(a,n,b,y)=>{const f=v(a,"input",b,y),E=v(n,"output",b,y);let L=f.details.length>0?f.details.join(" â€¢ "):f.summary,S=E.details.length>0?E.details.join(" â€¢ "):E.summary;const D=y?.toLowerCase()||"";if(D.includes("mail")||D.includes("ricezione")||E.type==="email"){const w=n?.body?.content||n?.json?.body?.content||n?.main?.json?.body?.content||a?.body?.content||a?.json?.body?.content||a?.main?.json?.body?.content;if(w&&typeof w=="string"){let k=w.replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/<style[^>]*>.*?<\/style>/gi,"").replace(/<[^>]+>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&[a-zA-Z0-9]+;/g," ").replace(/\r\n/g," ").replace(/\n/g," ").replace(/\t/g," ").replace(/\s+/g," ").trim();if(k.length>20)if(!k.toLowerCase().includes("content-type")&&!k.toLowerCase().includes("charset")&&!k.toLowerCase().includes("viewport"))S=`Email received: "${k.length>150?k.substring(0,150)+"...":k}"`;else{const I=n?.oggetto||n?.json?.oggetto||a?.oggetto||a?.json?.oggetto,P=n?.mittente||n?.json?.mittente||a?.mittente||a?.json?.mittente;I&&P?S=`Email from ${P} - Subject: "${I}"`:I?S=`Email received - Subject: "${I}"`:S="Customer email received and processed"}}if(D.includes("rispond")){const k=n?.body?.content||n?.json?.body?.content;if(k&&typeof k=="string"){const I=k.replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim();S=`Email sent: "${I.length>200?I.substring(0,200)+"...":I}"`}}}else if(D.includes("milena")||D.includes("assistente")||b==="ai_agent"){const w=n?.output?.risposta_html||n?.json?.output?.risposta_html||n?.response||n?.json?.response||n?.main?.json?.output?.risposta_html;if(w&&typeof w=="string"){const k=w.replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim();S=`AI Response: "${k.length>200?k.substring(0,200)+"...":k}"`}}else if(D.includes("qdrant")||D.includes("vector")||b==="vector_search"){const w=n?.ai_tool?.json?.response||n?.json?.response||n?.response||n?.main?.ai_tool?.json?.response;if(w&&Array.isArray(w)){const k=w.length,I=w[0];if(I&&typeof I.text=="string")try{const P=JSON.parse(I.text),U=P.pageContent||P.content;if(U){const G=U.length>150?U.substring(0,150)+"...":U;S=`Found ${k} documents: "${G}"`}}catch{S=`Found ${k} search results`}else S=`Found ${k} search results`}}else if(D.includes("ordini")||D.includes("parcel")||b==="order_lookup"||b==="parcel_tracking"){const w=n?.json||n?.main?.json||n;if(w){const k=[];w.order_reference&&k.push(`Order: ${w.order_reference}`),w.customer_full_name&&k.push(`Customer: ${w.customer_full_name}`),w.order_status&&k.push(`Status: ${w.order_status}`),w.tracking_number&&k.push(`Tracking: ${w.tracking_number}`),w.delivery_status&&k.push(`Delivery: ${w.delivery_status}`),k.length>0&&(S=k.join(" â€¢ "))}}else if(D.includes("execute")||D.includes("workflow")||b==="sub_workflow"){const w=n?.json||n?.main?.json||n;if(w){const k=[];w.workflow_name&&k.push(`Workflow: ${w.workflow_name}`),w.execution_status&&k.push(`Status: ${w.execution_status}`),w.duration&&k.push(`Duration: ${w.duration}ms`),w.nodes_executed&&k.push(`Nodes: ${w.nodes_executed}`),k.length>0?S=k.join(" â€¢ "):S="Sub-workflow executed successfully"}}L.length>150&&(L=L.substring(0,150)+"..."),S.length>250&&(S=S.substring(0,250)+"...");const Z=N(f,E,b,y);return{inputSummary:L,outputSummary:S,businessValue:Z}},N=(a,n,b,y)=>{const f=y?.toLowerCase()||"";return f.includes("milena")||f.includes("assistente")||n.type==="ai"?"Risposta intelligente generata per il cliente":f.includes("mail")||f.includes("ricezione")||n.type==="email"?f.includes("ricezione")?"Email cliente acquisita nel sistema":"Comunicazione inviata al cliente":f.includes("supabase")||f.includes("database")||n.type==="order"?"Dati salvati nel sistema aziendale":f.includes("extractor")||f.includes("parser")?"Informazioni estratte e processate":b?.includes("http")||f.includes("api")?"Integrazione esterna completata":"Operazione completata con successo"},_=a=>{const n=[];a.businessSummary&&(n.push(a.businessSummary.description),a.summaryType==="document"&&a.businessSummary.pageCount&&n.push(`Pages: ${a.businessSummary.pageCount}`),a.summaryType==="dataset"&&(a.businessSummary.totalRows&&n.push(`Rows: ${a.businessSummary.totalRows}`),a.businessSummary.totalColumns&&n.push(`Columns: ${a.businessSummary.totalColumns}`))),a.metrics&&Object.entries(a.metrics).slice(0,3).forEach(([y,f])=>{n.push(`${y}: ${f}`)}),a.businessInsight&&n.push(`Insight: ${a.businessInsight}`);let b="generic";switch(a.summaryType){case"document":b="document";break;case"dataset":b="dataset";break;case"emails":b="email";break;case"statistics":b="statistical";break;case"ai":b="ai";break}return{summary:a.businessSummary?.title||"Process Data",details:n,type:b,confidence:a.type==="ai_generated"?"medium":"high"}};return{parseBusinessData:v,formatBusinessData:$,formatTimelineStepData:T,sanitizeNodeType:h,parseIntelligentSummary:_,formatIntelligentData:a=>{const n=_(a);return $(n)}}}function se(h){return h?h.replace(/<[^>]+>/g," ").replace(/&[a-zA-Z0-9]+;/g," ").replace(/\s+/g," ").replace(/\n{3,}/g,`

`).trim():""}function F(h,c=150){if(!h||h.length<=c)return h;const s=h.substring(0,c),o=s.lastIndexOf(" ");return o>0?s.substring(0,o)+"...":s+"..."}function tt(h){return h?h.subject||h.oggetto||h.sender||h.mittente||h.email_body?"email":h.ai_response||h.risposta_html||h.output?.risposta_html||h.chatResponse||h.gpt_response?"ai":h.orderId||h.order_id||h.items||h.orderDetails?"order":h.vector_results||h.similarity_search||h.embeddings?"vector":"generic":"generic"}function ue(h){if(!h)return"low";const s=Object.keys(h).filter(o=>h[o]!==null&&h[o]!==void 0).length;return s>5?"high":s>2?"medium":"low"}class st{static parse(c){const s=this.extractEmailData(c),o=ue(s),g=[];let p="Email received";if(s.subject&&(p=`Email: ${F(s.subject,100)}`,g.push(`Subject: ${s.subject}`)),s.sender&&g.push(`From: ${s.sender}`),s.recipient&&g.push(`To: ${s.recipient}`),s.body){const v=se(s.body),$=F(v,200);$&&g.push(`Content: ${$}`)}return s.attachments&&s.attachments.length>0&&g.push(`Attachments: ${s.attachments.length} file(s)`),{summary:p,details:g,type:"email",confidence:o,metadata:s,businessValue:this.extractBusinessValue(s)}}static extractEmailData(c){if(!c)return{};const s={},o=c.json||c;return s.subject=o.subject||o.oggetto||o.email_subject||o.Subject||o.title,s.sender=o.sender||o.mittente||o.from||o.From||o.email_from||o.sender_email,s.recipient=o.recipient||o.destinatario||o.to||o.To||o.email_to,s.body=o.body||o.email_body||o.corpo||o.message||o.content||o.text||o.html||o.email_content,(o.attachments||o.allegati)&&(s.attachments=o.attachments||o.allegati),s.timestamp=o.timestamp||o.date||o.received_at||o.sent_at,s}static extractBusinessValue(c){const s=[];if(c.subject){const o=c.subject.toLowerCase();(o.includes("order")||o.includes("ordine"))&&s.push("Order-related"),(o.includes("support")||o.includes("help")||o.includes("assistenza"))&&s.push("Support request"),(o.includes("urgent")||o.includes("urgente"))&&s.push("High priority"),(o.includes("invoice")||o.includes("fattura"))&&s.push("Financial")}if(c.sender){const o=c.sender.toLowerCase();if(o.includes(".com")||o.includes(".it")){const g=o.split("@")[1];g&&(g.includes("google")||g.includes("microsoft")||g.includes("amazon"))&&s.push("Major vendor")}}return s.length>0?s.join(", "):"Standard communication"}static generateSummary(c){return c.subject?`Processed email: "${F(c.subject,80)}"`:c.sender?`Email received from ${c.sender}`:"Email communication processed"}}class ot{static parse(c){const s=this.extractAIData(c),o=ue(s),g=[];let p="AI processing completed";if(s.response){const v=se(s.response);p=`AI: ${F(v,100)}`,g.push(`Response: ${F(v,300)}`)}return s.prompt&&g.push(`Prompt: ${F(s.prompt,150)}`),s.model&&g.push(`Model: ${s.model}`),s.tokens&&g.push(`Tokens used: ${s.tokens}`),{summary:p,details:g,type:"ai",confidence:o,metadata:s,businessValue:this.extractBusinessValue(s)}}static extractAIData(c){if(!c)return{};const s={},o=c.json||c;return s.response=o.ai_response||o.risposta_html||o.output?.risposta_html||o.chatResponse||o.gpt_response||o.response||o.answer||o.output?.text||o.completion||o.generated_text||o.ai_output,s.prompt=o.prompt||o.question||o.query||o.input||o.user_message||o.domanda,s.model=o.model||o.model_name||o.ai_model||o.llm_model||this.detectModelFromResponse(s.response),(o.tokens||o.token_count||o.usage?.total_tokens)&&(s.tokens=o.tokens||o.token_count||o.usage?.total_tokens),s.timestamp=o.timestamp||o.created_at||o.generated_at,s}static detectModelFromResponse(c){if(!c)return"Unknown AI Model";const s=c.toLowerCase();return s.includes("gpt-4")||s.includes("openai")?"GPT-4":s.includes("gpt-3")?"GPT-3.5":s.includes("claude")?"Claude":s.includes("gemini")?"Gemini":s.includes("llama")?"LLaMA":"AI Assistant"}static extractBusinessValue(c){const s=[];if(c.response){const o=c.response.toLowerCase();(o.includes("customer")||o.includes("cliente"))&&s.push("Customer-focused"),(o.includes("analysis")||o.includes("analisi"))&&s.push("Data analysis"),(o.includes("recommendation")||o.includes("suggest")||o.includes("consiglio"))&&s.push("Strategic advice"),(o.includes("report")||o.includes("summary")||o.includes("rapporto"))&&s.push("Report generation"),(o.includes("translation")||o.includes("traduzione"))&&s.push("Translation service")}if(c.prompt){const o=c.prompt.toLowerCase();(o.includes("write")||o.includes("scrivi"))&&s.push("Content creation"),(o.includes("analyze")||o.includes("analizza"))&&s.push("Analysis task"),(o.includes("help")||o.includes("aiuto"))&&s.push("Support task")}return c.tokens&&(c.tokens>1e3?s.push("Complex processing"):c.tokens<100&&s.push("Quick response")),s.length>0?s.join(", "):"AI processing task"}static generateSummary(c){if(c.response){const s=se(c.response);return`AI generated: ${F(s,80)}`}return c.prompt?`AI processed: "${F(c.prompt,60)}"`:c.model?`${c.model} completed processing`:"AI task completed successfully"}static hasStructuredData(c){if(!c.response)return!1;const s=c.response;if(s.includes("{")&&s.includes("}"))try{return JSON.parse(s),!0}catch{}return!!(s.includes("|")||s.includes("â€¢")||s.includes("1."))}}class nt{static cache=new Map;static process(c,s){if(s?.executionId){const p=`${s.executionId}-${JSON.stringify(c).substring(0,50)}`;if(this.cache.has(p))return this.cache.get(p)}const o=tt(c);let g;switch(o){case"email":g=st.parse(c);break;case"ai":g=ot.parse(c);break;case"order":g=this.parseOrderData(c);break;case"vector":g=this.parseVectorData(c);break;default:g=this.parseGenericData(c)}if(s&&(g.metadata={...g.metadata,source:s.source,nodeType:s.nodeType,workflowId:s.workflowId}),s?.executionId){const p=`${s.executionId}-${JSON.stringify(c).substring(0,50)}`;if(this.cache.set(p,g),this.cache.size>100){const v=this.cache.keys().next().value;this.cache.delete(v)}}return g}static parseOrderData(c){const s=c.json||c,o=[];let g="Order processed";if(s.orderId||s.order_id){const p=s.orderId||s.order_id;g=`Order #${p}`,o.push(`Order ID: ${p}`)}if((s.customer||s.customerName)&&o.push(`Customer: ${s.customer||s.customerName}`),s.items&&Array.isArray(s.items)&&(o.push(`Items: ${s.items.length} product(s)`),s.items.slice(0,3).forEach(p=>{(p.name||p.product)&&o.push(`  â€¢ ${p.name||p.product}`)})),s.total||s.totalAmount){const p=s.total||s.totalAmount;o.push(`Total: â‚¬${p}`)}return(s.status||s.orderStatus)&&o.push(`Status: ${s.status||s.orderStatus}`),{summary:g,details:o,type:"order",confidence:"high",metadata:s,businessValue:"Customer transaction"}}static parseVectorData(c){const s=c.json||c,o=[];let g="Search completed";if(s.query||s.search_query){const p=s.query||s.search_query;g=`Search: "${F(p,50)}"`,o.push(`Query: ${p}`)}if(s.results||s.vector_results){const p=s.results||s.vector_results;Array.isArray(p)&&(o.push(`Found: ${p.length} result(s)`),p.slice(0,3).forEach((v,$)=>{const T=v.content||v.text||v.document;T&&o.push(`  ${$+1}. ${F(T,100)}`)}))}return(s.similarity_score||s.score)&&o.push(`Match score: ${s.similarity_score||s.score}`),{summary:g,details:o,type:"vector",confidence:"medium",metadata:s,businessValue:"Information retrieval"}}static parseGenericData(c){const s=c.json||c,o=[];let g="Data processed";const p=Object.keys(s).filter(v=>s[v]!==null&&s[v]!==void 0&&v!=="json");for(const v of p){const $=s[v];if(typeof $=="string"&&$.length>0){g=F(se($),100);break}}return p.slice(0,5).forEach(v=>{const $=s[v];$!=null&&(typeof $=="string"?o.push(`${v}: ${F($,100)}`):typeof $=="number"?o.push(`${v}: ${$}`):typeof $=="boolean"?o.push(`${v}: ${$?"Yes":"No"}`):Array.isArray($)?o.push(`${v}: ${$.length} items`):typeof $=="object"&&o.push(`${v}: [Complex data]`))}),{summary:g,details:o.length>0?o:["Data processing completed"],type:"generic",confidence:"low",metadata:s,businessValue:"Business operation"}}static clearCache(){this.cache.clear()}static getCacheStats(){return{size:this.cache.size,maxSize:100}}}const rt={class:"p-6 space-y-6"},it={class:"bg-surface-hover rounded-lg p-5 border border-border"},at={class:"text-text-muted whitespace-pre-wrap"},lt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ct={class:"bg-surface-hover rounded-lg p-4 border border-border"},ut={class:"flex items-center justify-between mb-2"},dt={class:"text-2xl font-bold text-white"},mt={class:"bg-surface-hover rounded-lg p-4 border border-border"},pt={class:"flex items-center justify-between mb-2"},gt={class:"text-sm text-text-muted"},ft={class:"text-2xl font-bold text-white"},xt={class:"bg-surface-hover rounded-lg p-4 border border-border"},ht={class:"flex items-center justify-between mb-2"},bt={class:"text-2xl font-bold text-white"},yt={class:"bg-surface-hover rounded-lg p-5 border border-border"},vt={key:0,class:"space-y-2"},_t={class:"text-text-muted"},wt={key:1,class:"space-y-2"},kt={class:"flex items-start gap-2"},$t={class:"flex items-start gap-2"},St={class:"flex items-start gap-2"},Tt={class:"bg-gradient-to-r from-primary/20 to-primary/10 rounded-lg p-5 border border-primary/30"},jt={class:"flex items-start gap-3"},Et={class:"text-text-muted"},It={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4"},At={key:0,class:"text-center"},Ct={class:"text-xl font-bold text-primary"},Rt={key:1,class:"text-center"},Nt={class:"text-xl font-bold text-green-400"},Dt={key:2,class:"text-center"},Pt={class:"text-xl font-bold text-blue-400"},Ot={key:3,class:"text-center"},Lt={class:"text-xl font-bold text-purple-400"},Bt={class:"p-6"},zt={key:0,class:"space-y-4 mb-6"},Vt={class:"flex items-center justify-between"},Ft={class:"flex-1"},Mt={class:"flex items-center gap-2 mb-2"},Ut={class:"text-xs text-text-muted"},qt={class:"text-sm text-white"},Jt={key:0,class:"text-xs text-text-muted mt-1"},Ht={key:1,class:"space-y-6"},Gt={class:"flex items-center justify-between mb-4"},Kt={class:"flex items-center"},Zt={class:"text-white font-medium"},Wt={class:"text-sm text-gray-400"},Xt={class:"text-xs text-gray-500"},Yt={class:"mb-4"},Qt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},es={class:"text-sm text-gray-300"},ts={class:"text-sm text-gray-300"},ss={key:0,class:"mt-4 p-3 bg-purple-400/10 rounded border border-purple-400/20"},os={class:"text-sm text-white"},ns={key:1,class:"mt-4 space-y-3"},rs={class:"flex items-center gap-2"},is={class:"text-xs font-medium text-blue-400 uppercase"},as={key:0,class:"ml-auto"},ls={key:0,class:"bg-blue-900/20 border border-blue-500/20 rounded-lg p-4"},cs={class:"text-sm font-medium text-blue-300 mb-2"},us={class:"text-sm text-gray-300"},ds={key:0,class:"mt-2 text-xs text-gray-400"},ms={key:1,class:"mt-2 text-xs text-gray-400"},ps={key:1,class:"grid grid-cols-2 md:grid-cols-4 gap-2"},gs={class:"text-xs text-gray-500 capitalize"},fs={class:"text-sm font-medium text-white"},xs={key:2,class:"bg-gray-900/50 rounded-lg p-3"},hs={class:"flex items-center justify-between mb-2"},bs=["onClick"],ys={key:0,class:"text-xs text-gray-300 space-y-1"},vs={key:0},_s={key:1},ws={key:1,class:"overflow-x-auto"},ks={class:"text-xs w-full"},$s={class:"text-gray-500"},Ss={key:3,class:"bg-green-900/20 border border-green-500/20 rounded-lg p-3"},Ts={class:"flex items-start gap-2"},js={class:"text-sm text-gray-300"},Es={key:4,class:"flex flex-wrap gap-2"},Is=["onClick"],As={key:2,class:"text-center py-12 text-gray-400"},Cs={class:"p-6 overflow-y-auto"},Rs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Ns={class:"bg-surface-hover rounded-lg p-3 border border-border"},Ds={class:"text-xl font-bold text-white"},Ps={class:"bg-surface-hover rounded-lg p-3 border border-border"},Os={class:"text-xl font-bold text-green-400"},Ls={class:"bg-surface-hover rounded-lg p-3 border border-border"},Bs={class:"text-xl font-bold text-red-400"},zs={key:0,class:"text-xs text-orange-400 mt-1"},Vs={class:"bg-surface-hover rounded-lg p-3 border border-border"},Fs={key:0,class:"bg-surface-hover rounded-lg border border-border overflow-hidden"},Ms={class:"w-full"},Us={class:"divide-y divide-border/50"},qs={class:"px-4 py-3 text-sm text-text-muted"},Js={class:"px-4 py-3"},Hs={class:"px-4 py-3 text-sm text-text-muted"},Gs={class:"px-4 py-3 text-sm text-text-muted"},Ks={key:1,class:"text-center py-8 text-gray-400"},Zs={class:"p-6 space-y-6 overflow-y-auto"},Ws={class:"bg-surface-hover rounded-lg p-5 border border-border"},Xs={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Ys={class:"text-center p-3 bg-surface rounded-lg"},Qs={class:"text-3xl font-bold text-primary"},eo={class:"text-center p-3 bg-surface rounded-lg"},to={class:"text-3xl font-bold text-blue-400"},so={key:0,class:"text-xs text-gray-500 mt-1"},oo={class:"text-center p-3 bg-surface rounded-lg"},no={class:"text-3xl font-bold text-green-400"},ro={class:"text-center p-3 bg-surface rounded-lg"},io={class:"text-3xl font-bold text-purple-400"},ao={class:"grid grid-cols-3 gap-3"},lo={class:"p-3 bg-surface/50 rounded"},co={class:"flex items-center justify-between"},uo={class:"text-lg font-bold text-white"},mo={class:"p-3 bg-surface/50 rounded"},po={class:"flex items-center justify-between"},go={class:"text-lg font-bold text-white"},fo={class:"p-3 bg-surface/50 rounded"},xo={class:"flex items-center justify-between"},ho={class:"text-lg font-bold text-white"},bo={class:"bg-surface-hover rounded-lg p-5 border border-border"},yo={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},vo={class:"text-center"},_o={class:"text-2xl font-bold text-white"},wo={class:"text-center"},ko={class:"text-2xl font-bold text-white"},$o={class:"text-center"},So={class:"text-2xl font-bold text-white"},To={class:"text-center"},jo={class:"text-2xl font-bold text-white"},Eo={key:0,class:"mt-4 p-3 bg-surface/50 rounded"},Io={class:"flex items-center justify-between"},Ao={class:"bg-surface-hover rounded-lg p-5 border border-border"},Co={class:"space-y-3"},Ro={key:0,class:"flex items-start gap-2"},No={class:"text-xs text-text-muted"},Do={key:1,class:"flex items-start gap-2"},Po={class:"text-xs text-text-muted"},Oo={key:2,class:"flex items-start gap-2"},Lo={class:"text-xs text-text-muted"},Bo={key:3,class:"flex items-start gap-2"},zo={class:"text-xs text-text-muted"},Vo={class:"bg-gradient-to-r from-blue-500/20 to-blue-500/10 rounded-lg p-5 border border-blue-500/30"},Fo={class:"space-y-2 text-sm text-text-muted"},Mo={key:0},Uo={key:1},qo={key:2},Jo={key:3},Ho={key:4},Go={class:"p-6"},Ko={class:"flex items-center justify-between mb-4"},Zo={class:"flex items-center"},Wo={class:"flex gap-2"},Xo={id:"raw-data-content",class:"bg-black/50 p-4 rounded-lg border border-gray-800 text-xs text-gray-300 overflow-auto max-h-96 font-mono whitespace-pre premium-scrollbar"},sn=le({__name:"TimelineModal",props:{workflowId:{},executionId:{},tenantId:{},show:{type:Boolean}},emits:["close"],setup(h,{emit:c}){const s=h,{isLoading:o,error:g,setLoading:p,setError:v,showToast:$}=ce(),{formatTimelineStepData:T}=et(),N=(r,t,m,i)=>{const x=nt.process(r,{source:"frontend",nodeType:m,workflowId:s.workflowId});return{summary:x.summary,details:x.details,type:x.type,metadata:x.metadata,businessValue:x.businessValue}},_=M(null);M(null);const H=M(new Set),a=M([]),n=M(null),b=M([]),y=M(null),f=oe(()=>_.value?.workflow?.name||`Business Process ${s.workflowId}`),E=oe(()=>{if(!_.value)return"";const r=_.value.workflow,t=_.value.execution,m=r?.active?"ACTIVE":"INACTIVE";return`ID: ${s.workflowId} â€¢ Status: ${m}${t?` â€¢ Last: ${t.id}`:""}`}),L=[{id:"overview",label:"Process Overview",icon:"lucide:info"},{id:"executions",label:"Latest Activity",icon:"lucide:activity"},{id:"history",label:"Process History",icon:"lucide:history"},{id:"analytics",label:"Analytics",icon:"lucide:bar-chart-2"}],S=async()=>{p(!0),v(null);const r=Ie;try{console.log("ðŸ”„ Loading dashboard data for workflow:",s.workflowId);const t=await Ce(`${r}/api/business/dashboard/${s.workflowId}`);console.log("âœ… Dashboard data loaded:",t),t.workflow&&(y.value=t.workflow),t.executions&&(a.value=t.executions,console.log("âœ… Executions with business data:",a.value.length)),t.statistics&&(n.value=t.statistics,console.log("âœ… Statistics loaded:",n.value)),t.recentActivity&&(b.value=t.recentActivity,console.log("âœ… Recent activity loaded:",b.value.length,"items"))}catch(t){console.error("âŒ Failed to load dashboard data:",t),v("Failed to load dashboard data. Please try again.")}try{let t=`${r}/api/business/raw-data-for-modal/${s.workflowId}`;s.executionId&&(t+=`?executionId=${s.executionId}`);const m=await ie.getWorkflowDetails(s.workflowId);if(console.log("âœ… Process timeline loaded:",m.data),!m.data?.businessNodes||m.data.businessNodes.length===0){console.log("â„¹ï¸ No show-n nodes found for this workflow - showing empty state"),_.value={...m.data,businessNodes:[]};return}if(console.log(`ðŸ“Š Starting enrichment of ${m.data?.businessNodes?.length||0} nodes`),m.data?.businessNodes){const i=m.data.businessNodes.length;m.data.businessNodes=m.data.businessNodes.map((x,O)=>{if(console.log(`ðŸ“Š Processing node ${O+1}/${i}: "${x.name}"`),x.data&&(x.data.inputJson||x.data.outputJson))try{const z=T(x.data.inputJson,x.data.outputJson,x.data.nodeType,x.name);return console.log(`âœ… Enriched node "${x.name}":`,z),{...x,enrichedData:z}}catch(z){return console.warn(`âš ï¸ Failed to enrich node "${x.name}":`,z),x}else return console.log(`â„¹ï¸ Skipping enrichment for node "${x.name}" - no input/output data`),x}),console.log(`ðŸ“Š Enrichment complete: ${m.data.businessNodes.length}/${i} nodes processed`),m.data.businessNodes.length!==i&&console.error(`âŒ Node count mismatch! Original: ${i}, Final: ${m.data.businessNodes.length}`)}_.value=m.data}catch(t){console.error("âŒ Failed to load process timeline:",t),t.message.includes("Failed to fetch")||t.message.includes("fetch")?v("Process configuration incomplete. This business process needs to be configured with visible steps for reporting."):t.message.includes("404")?v("Process not found or not yet configured for business reporting."):v("Unable to load process details. Please try again or contact support.")}finally{p(!1)}},D=async()=>{try{console.log("ðŸ”¥ Force refresh: Process timeline for",s.workflowId);try{await ie.refreshProcess(s.workflowId),console.log("âœ… Force refresh succeeded"),$("success","Timeline data refreshed successfully")}catch(r){console.warn("âš ï¸ Force refresh endpoint not available:",r)}await S()}catch(r){$("error","Failed to refresh",r.message)}},Z=r=>N(r.outputData||r.inputData,r.outputData?"output":"input",r.nodeType,r.nodeName).summary,w=r=>{const t=N(r.data,"output",r.nodeType,r.name);if(t.type==="error"&&t.details.length>0)return t.details.join(`
`);if(r.data?.n8nErrorDetails){const m=r.data.n8nErrorDetails;return`${m.errorType}: ${m.message} (Nodo: ${m.nodeName})`}return"Process execution failed to complete successfully"},k=r=>{const t=N(r.data,"output",r.nodeType,r.name);return t.type==="error"&&t.details.length>0?t.details.find(m=>m.includes("Errore:"))||t.details[0]:r.data?.n8nErrorDetails?r.data.n8nErrorDetails.message||"Error details not available":"Check raw data for error details"},I=r=>{const t=N(r.data,"output",r.nodeType,r.name);if(t.type==="error"&&t.details.length>1)return t.details.find(m=>m.includes("Nodo Fallito:"))||t.details.find(m=>m.includes("Tipo Errore:"))||t.details[1];if(r.data?.n8nErrorDetails){const m=r.data.n8nErrorDetails;return`Errore nel nodo: ${m.nodeName} (${m.errorType})`}return`Errore durante l'esecuzione del nodo: ${r.name}`},P=()=>{const r=n.value?.successCount||0,t=n.value?.errorCount||0,m=r+t;return m===0?100:Math.round(r/m*100)},U=()=>n.value?.total_orders>0?"Orders Processed":n.value?.ai_responses>0?"AI Responses":n.value?.emails_processed>0?"Emails Handled":n.value?.unique_senders>0?"Unique Customers":"Data Points",G=()=>n.value?.total_orders>0?n.value.total_orders:n.value?.ai_responses>0?n.value.ai_responses:n.value?.emails_processed>0?n.value.emails_processed:n.value?.unique_senders>0?n.value.unique_senders:n.value?.total_executions||0,W=r=>{const t=new Date(r),i=new Date().getTime()-t.getTime(),x=Math.floor(i/6e4),O=Math.floor(i/36e5),z=Math.floor(i/864e5);return x<1?"Just now":x<60?`${x} minute${x>1?"s":""} ago`:O<24?`${O} hour${O>1?"s":""} ago`:`${z} day${z>1?"s":""} ago`},V=r=>r<1e3?`${r}ms`:r<6e4?`${(r/1e3).toFixed(1)}s`:`${(r/6e4).toFixed(1)}min`,X=r=>(typeof r=="number"?new Date(r):new Date(r)).toLocaleString("it-IT",{dateStyle:"short",timeStyle:"medium"}),ee=()=>{if(!_.value)return"";let r=`â•”${"â•".repeat(78)}â•—
`;if(r+=`â•‘${" ".repeat(15)}BUSINESS PROCESS EXECUTION REPORT${" ".repeat(16)}â•‘
`,r+=`â•‘${" ".repeat(25)}PilotPro Control Center${" ".repeat(29)}â•‘
`,r+=`â•š${"â•".repeat(78)}â•

`,r+=`â”Œâ”€ PROCESS INFORMATION ${"â”€".repeat(56)}â”

`,r+=`  Process Name:      ${_.value.workflowName||"Not specified"}
`,r+=`  Process ID:        ${s.workflowId}
`,r+=`  Status:            ${_.value.status==="active"?"ACTIVE":"INACTIVE"}
`,_.value.lastExecution&&(r+=`
  LAST EXECUTION:
`,r+=`  â”œâ”€ Execution ID:   ${_.value.lastExecution.id}
`,r+=`  â”œâ”€ Date/Time:      ${X(_.value.lastExecution.executedAt)}
`,r+=`  â”œâ”€ Total Duration: ${V(_.value.lastExecution.duration)}
`,r+=`  â””â”€ Status:         ${_.value.lastExecution.status||"Completed"}
`),r+=`
â””${"â”€".repeat(78)}â”˜

`,_.value.execution?.businessContext&&Object.keys(_.value.execution.businessContext).length>0){r+=`â”Œâ”€ BUSINESS CONTEXT ANALYSIS ${"â”€".repeat(50)}â”

`;const t=_.value.execution.businessContext;t.customerEmail&&(r+=`  CUSTOMER INFORMATION:
`,r+=`     Email: ${t.customerEmail}

`),t.subject&&(r+=`  COMMUNICATION SUBJECT:
`,r+=`     "${t.subject}"

`),t.orderId&&(r+=`  ORDER REFERENCE:
`,r+=`     Order ID: ${t.orderId}

`),t.classification&&(r+=`  AI CLASSIFICATION:
`,r+=`     Category: ${t.classification}
`,t.confidence&&(r+=`     Confidence: ${t.confidence}%
`),r+=`
`),r+=`â””${"â”€".repeat(78)}â”˜

`}return r},Y=()=>{const r=document.getElementById("raw-data-content");if(r&&_.value){const t=JSON.stringify(_.value,null,2).replace(/n8n/gi,"WFEngine").replace(/\.nodes\./g,".engine.").replace(/\.base\./g,".core.");r.textContent=t}},de=r=>{const t=r.name?.toLowerCase()||"";return t.includes("mail")||t.includes("ricezione")?"Customer Communication":t.includes("milena")||t.includes("assistente")?"AI Assistant Processing":t.includes("qdrant")||t.includes("vector")?"Knowledge Base Search":t.includes("ordini")||t.includes("order")?"Order Management":t.includes("supabase")||t.includes("database")?"Data Storage Operation":t.includes("execute")||t.includes("workflow")?"Business Process Execution":"Business Process Step"},me=r=>{const t=r.name?.toLowerCase()||"";if(t.includes("ricezione")&&r.data?.outputJson){const m=r.data.outputJson;return m.oggetto&&m.mittente?`Customer email received from ${m.mittente} regarding "${m.oggetto}". Message successfully processed and categorized for business response.`:"Customer email received and processed successfully."}if((t.includes("milena")||t.includes("assistente"))&&r.data?.outputJson?.output){const m=r.data.outputJson.output;return m.categoria?`AI Assistant analyzed the customer request and generated an intelligent response. Category: ${m.categoria}. Response crafted based on business knowledge and customer context.`:"AI Assistant processed the request and generated an intelligent, personalized response for the customer."}return t.includes("qdrant")||t.includes("vector")?"Knowledge base searched to find relevant information and context for providing accurate customer support.":t.includes("ordini")||t.includes("order")?"Order information retrieved and processed to provide customer with accurate status and details.":t.includes("supabase")||t.includes("database")?"Customer interaction data saved to business database for future reference and analytics.":t.includes("execute")||t.includes("workflow")?"Business process sub-routine executed successfully to handle specific customer requirements.":"Business process step completed successfully, contributing to efficient customer service automation."},pe=r=>({document:"lucide:file-text",dataset:"lucide:table",statistical:"lucide:bar-chart-2",ai_generated:"lucide:sparkles",email_batch:"lucide:mail",api_response:"lucide:cloud",generic:"lucide:file"})[r]||"lucide:file",ge=r=>({document:"Document Analysis",dataset:"Data Table",emails:"Email Batch",api:"API Response",statistics:"Statistical Analysis",ai:"AI Analysis",generic:"Process Data"})[r]||"Process Data",fe=r=>r.replace(/_/g," ").replace(/([A-Z])/g," $1").trim(),xe=r=>typeof r=="number"?r>1e6?`${(r/1e6).toFixed(1)}M`:r>1e3?`${(r/1e3).toFixed(1)}K`:r%1!==0?r.toFixed(2):r.toString():typeof r=="boolean"?r?"Yes":"No":r==null?"-":r.toString(),he=r=>({download_full:"Download Full Data",request_ai_analysis:"AI Analysis",extract_data:"Extract Data",view_full_table:"View Full Table",export_excel:"Export Excel",generate_report:"Generate Report",analyze_patterns:"Analyze Patterns",view_all_emails:"View All Emails",export_list:"Export List",analyze_sentiment:"Analyze Sentiment",view_json:"View JSON",export_data:"Export Data",analyze_structure:"Analyze Structure",view_chart:"View Chart",export_stats:"Export Statistics",analyze_trends:"Analyze Trends",view_raw:"View Raw",download:"Download",regenerate_analysis:"Regenerate Analysis"})[r]||r,be=r=>{H.value.has(r)?H.value.delete(r):H.value.add(r)},ye=async(r,t)=>{switch(console.log("ðŸŽ¯ Handling intelligent action:",r,t),r){case"download_full":ve(t);break;case"request_ai_analysis":await _e();break;case"export_excel":we();break;case"generate_report":ke(t);break;default:$("info",`Action "${r}" not yet implemented`)}},ve=r=>{const t=r.data?.rawOutputData||r.data?.outputJson||{},m=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(m),x=document.createElement("a");x.href=i,x.download=`${r.name}-data-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(i),$("success","Data downloaded successfully")},_e=async r=>{$("info","Requesting AI analysis..."),setTimeout(()=>{$("success","AI analysis complete")},2e3)},we=r=>{$("info","Excel export feature coming soon")},ke=r=>{const t=`
Business Process Step Report
============================
Step Name: ${r.name}
Type: ${r.data?.intelligentSummary?.businessSummary?.title||r.type}
Status: ${r.status}
Execution Time: ${V(r.executionTime||0)}

Business Summary:
${r.data?.intelligentSummary?.businessSummary?.description||"No summary available"}

Business Insight:
${r.data?.intelligentSummary?.businessInsight||"No insights available"}

Generated: ${new Date().toLocaleString()}
  `.trim(),m=new Blob([t],{type:"text/plain"}),i=URL.createObjectURL(m),x=document.createElement("a");x.href=i,x.download=`${r.name}-report-${new Date().toISOString().slice(0,10)}.txt`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(i),$("success","Report generated successfully")};return ae(()=>s.show,r=>{r&&(console.log("ðŸ“Š Timeline modal opened for process:",s.workflowId),S())}),Ee(()=>{s.show&&S()}),(r,t)=>(u(),ne(Qe,{show:r.show,title:"Business Process Dashboard",subtitle:`${f.value} â€¢ ${E.value}`,"header-icon":"lucide:bar-chart-2",tabs:L,"default-tab":"overview","is-loading":A(o),error:A(g),data:_.value,"show-refresh":!0,onClose:t[0]||(t[0]=m=>r.$emit("close")),onRefresh:D,onRetry:S},{headerActions:K(({isLoading:m,refresh:i})=>[...t[1]||(t[1]=[])]),overview:K(({data:m})=>[e("div",rt,[e("div",it,[t[2]||(t[2]=e("h3",{class:"text-lg font-semibold text-white mb-3"},"Process Description",-1)),e("div",at,l(y.value?.description||y.value?.purpose||"This business process automates operations to ensure efficient workflow execution and reliable business outcomes."),1)]),e("div",lt,[e("div",ct,[e("div",ut,[t[3]||(t[3]=e("span",{class:"text-sm text-text-muted"},"Success Rate",-1)),R(A(C),{icon:"lucide:trending-up",class:"w-4 h-4 text-green-400"})]),e("div",dt,l(P())+"% ",1)]),e("div",mt,[e("div",pt,[e("span",gt,l(U()),1),R(A(C),{icon:"lucide:database",class:"w-4 h-4 text-blue-400"})]),e("div",ft,l(G()),1)]),e("div",xt,[e("div",ht,[t[4]||(t[4]=e("span",{class:"text-sm text-text-muted"},"Total Operations",-1)),R(A(C),{icon:"lucide:layers",class:"w-4 h-4 text-purple-400"})]),e("div",bt,l(n.value?.total_executions||a.value.length||0),1)])]),e("div",yt,[t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-white mb-3"},"Process Capabilities",-1)),y.value?.capabilities?.length>0?(u(),d("ul",vt,[(u(!0),d(q,null,J(y.value.capabilities,(i,x)=>(u(),d("li",{key:x,class:"flex items-start gap-2"},[R(A(C),{icon:"lucide:check-circle",class:"w-5 h-5 text-green-400 mt-0.5"}),e("span",_t,l(i),1)]))),128))])):(u(),d("ul",wt,[e("li",kt,[R(A(C),{icon:"lucide:check-circle",class:"w-5 h-5 text-green-400 mt-0.5"}),t[5]||(t[5]=e("span",{class:"text-text-muted"},"Automated workflow processing",-1))]),e("li",$t,[R(A(C),{icon:"lucide:check-circle",class:"w-5 h-5 text-green-400 mt-0.5"}),t[6]||(t[6]=e("span",{class:"text-text-muted"},"Data transformation and routing",-1))]),e("li",St,[R(A(C),{icon:"lucide:check-circle",class:"w-5 h-5 text-green-400 mt-0.5"}),t[7]||(t[7]=e("span",{class:"text-text-muted"},"Business process optimization",-1))])]))]),e("div",Tt,[e("div",jt,[R(A(C),{icon:"lucide:target",class:"w-6 h-6 text-primary mt-0.5"}),e("div",null,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold text-white mb-2"},"Business Value",-1)),e("p",Et,l(y.value?.businessValue?.summary||"This automated process optimizes business operations, reduces manual workload, and ensures consistent service delivery. All operations are tracked for continuous improvement."),1),y.value?.businessValue?(u(),d("div",It,[y.value.businessValue.automationRate?(u(),d("div",At,[e("div",Ct,l(y.value.businessValue.automationRate),1),t[9]||(t[9]=e("div",{class:"text-xs text-text-muted"},"Automation",-1))])):j("",!0),y.value.businessValue.timeSaved?(u(),d("div",Rt,[e("div",Nt,l(y.value.businessValue.timeSaved),1),t[10]||(t[10]=e("div",{class:"text-xs text-text-muted"},"Time Saved",-1))])):j("",!0),y.value.businessValue.avgResponseTime?(u(),d("div",Dt,[e("div",Pt,l(y.value.businessValue.avgResponseTime),1),t[11]||(t[11]=e("div",{class:"text-xs text-text-muted"},"Avg Response",-1))])):j("",!0),y.value.businessValue.dataProcessed?(u(),d("div",Ot,[e("div",Lt,l(y.value.businessValue.dataProcessed),1),t[12]||(t[12]=e("div",{class:"text-xs text-text-muted"},"Items Processed",-1))])):j("",!0)])):j("",!0)])])])])]),executions:K(({data:m})=>[e("div",Bt,[b.value?.length>0?(u(),d("div",zt,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Recent Business Activity",-1)),(u(!0),d(q,null,J(b.value.slice(0,10),(i,x)=>(u(),d("div",{key:x,class:"bg-surface-hover rounded-lg p-4 border border-border"},[e("div",Vt,[e("div",Ft,[e("div",Mt,[e("span",{class:B(["px-2 py-1 text-xs rounded",i.type==="AI Response"?"bg-purple-500/20 text-purple-300":i.type==="Email"?"bg-blue-500/20 text-blue-300":i.type==="Order"?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-300"])},l(i.type),3),e("span",Ut,l(W(i.timestamp)),1)]),e("p",qt,l(i.summary),1),i.classification?(u(),d("p",Jt," Classification: "+l(i.classification),1)):j("",!0)])])]))),128))])):m?.businessNodes?.length>0?(u(),d("div",Ht,[(u(!0),d(q,null,J(m.businessNodes,(i,x)=>(u(),d("div",{key:i._nodeId||x,class:B(["rounded-lg p-5 border transition-all",i.status==="error"||i.showTag==="error"?"bg-red-900/20 border-red-500/30":"bg-gray-800/50 border-gray-700",i.data?.intelligentSummary?"ring-1 ring-blue-500/20":""])},[e("div",Gt,[e("div",Kt,[e("div",{class:B(["w-8 h-8 rounded-full flex items-center justify-center mr-3",i.status==="error"||i.showTag==="error"?"bg-red-400/20":"bg-green-400/20"])},[e("span",{class:B(["font-medium",i.status==="error"||i.showTag==="error"?"text-red-400":"text-green-400"])},l(i.showTag==="error"?"ERR":x+1),3)],2),e("div",null,[e("h4",Zt,l(i.businessName||i.name||`Process Step ${x+1}`),1),e("p",Wt,l(de(i)),1)])]),e("div",Xt,l(V(i.executionTime||0)),1)]),e("div",Yt,[e("div",{class:B(["text-sm font-medium mb-2",i.status==="error"||i.showTag==="error"?"text-red-400":"text-green-400"])},l(i.status==="error"||i.showTag==="error"?"Error Details:":"Business Summary:"),3),e("div",{class:B(["text-white bg-gray-900/50 p-3 rounded border-l-4",i.status==="error"||i.showTag==="error"?"border-red-400":"border-green-400"])},l(i.status==="error"||i.showTag==="error"?w(i):me(i)),3)]),e("div",Qt,[e("div",{class:B(["rounded p-3 border",i.status==="error"||i.showTag==="error"?"bg-orange-400/10 border-orange-400/20":"bg-blue-400/10 border-blue-400/20"])},[e("div",{class:B(["text-xs font-medium mb-1",i.status==="error"||i.showTag==="error"?"text-orange-400":"text-blue-400"])},l(i.status==="error"||i.showTag==="error"?"ERROR CONTEXT":"WHAT HAPPENED"),3),e("div",es,l(i.status==="error"||i.showTag==="error"?I(i):i.enrichedData?.inputSummary||Z(i)),1)],2),e("div",{class:B(["rounded p-3 border",i.status==="error"||i.showTag==="error"?"bg-red-400/10 border-red-400/20":"bg-green-400/10 border-green-400/20"])},[e("div",{class:B(["text-xs font-medium mb-1",i.status==="error"||i.showTag==="error"?"text-red-400":"text-green-400"])},l(i.status==="error"||i.showTag==="error"?"ERROR RESULT":"RESULT"),3),e("div",ts,l(i.status==="error"||i.showTag==="error"?k(i):i.enrichedData?.outputSummary||"Process completed successfully"),1)],2)]),i.enrichedData?.businessValue?(u(),d("div",ss,[t[15]||(t[15]=e("div",{class:"text-xs text-purple-400 font-medium mb-1"},"BUSINESS VALUE",-1)),e("div",os,l(i.enrichedData.businessValue),1)])):j("",!0),i.data?.intelligentSummary?(u(),d("div",ns,[e("div",rs,[R(A(C),{icon:pe(i.data.intelligentSummary.type),class:"w-4 h-4 text-blue-400"},null,8,["icon"]),e("span",is,l(ge(i.data.intelligentSummary.summaryType)),1),i.data.intelligentSummary.type==="ai_generated"?(u(),d("div",as,[...t[16]||(t[16]=[e("span",{class:"px-2 py-0.5 text-xs bg-purple-500/20 text-purple-300 rounded"},"AI Generated",-1)])])):j("",!0)]),i.data.intelligentSummary.businessSummary?(u(),d("div",ls,[e("h5",cs,l(i.data.intelligentSummary.businessSummary.title),1),e("p",us,l(i.data.intelligentSummary.businessSummary.description),1),i.data.intelligentSummary.summaryType==="document"?(u(),d("div",ds,[e("span",null,l(i.data.intelligentSummary.businessSummary.pageCount)+" pages",1),t[17]||(t[17]=e("span",{class:"mx-2"},"â€¢",-1)),e("span",null,"Type: "+l(i.data.intelligentSummary.businessSummary.documentType),1)])):i.data.intelligentSummary.summaryType==="dataset"?(u(),d("div",ms,[e("span",null,l(i.data.intelligentSummary.businessSummary.totalRows)+" rows",1),t[18]||(t[18]=e("span",{class:"mx-2"},"â€¢",-1)),e("span",null,l(i.data.intelligentSummary.businessSummary.totalColumns)+" columns",1)])):j("",!0)])):j("",!0),i.data.intelligentSummary.metrics&&Object.keys(i.data.intelligentSummary.metrics).length>0?(u(),d("div",ps,[(u(!0),d(q,null,J(i.data.intelligentSummary.metrics,(O,z)=>(u(),d("div",{key:z,class:"bg-gray-800/50 rounded p-2 text-center"},[e("div",gs,l(fe(z)),1),e("div",fs,l(xe(O)),1)]))),128))])):j("",!0),i.data.intelligentSummary.preview&&!H.value.has(i._nodeId)?(u(),d("div",xs,[e("div",hs,[t[19]||(t[19]=e("span",{class:"text-xs font-medium text-gray-400"},"DATA PREVIEW",-1)),e("button",{onClick:O=>be(i._nodeId),class:"text-xs text-blue-400 hover:text-blue-300"}," View More â†’ ",8,bs)]),i.data.intelligentSummary.summaryType==="document"?(u(),d("div",ys,[i.data.intelligentSummary.preview.keyDates?.length>0?(u(),d("div",vs,[t[20]||(t[20]=e("span",{class:"text-gray-500"},"Dates:",-1)),Q(" "+l(i.data.intelligentSummary.preview.keyDates.join(", ")),1)])):j("",!0),i.data.intelligentSummary.preview.amounts?.length>0?(u(),d("div",_s,[t[21]||(t[21]=e("span",{class:"text-gray-500"},"Amounts:",-1)),Q(" "+l(i.data.intelligentSummary.preview.amounts.join(", ")),1)])):j("",!0)])):i.data.intelligentSummary.summaryType==="dataset"&&i.data.intelligentSummary.preview.sampleRows?(u(),d("div",ws,[e("table",ks,[e("thead",null,[e("tr",$s,[(u(!0),d(q,null,J(i.data.intelligentSummary.preview.headers?.slice(0,4),O=>(u(),d("th",{key:O,class:"px-2 py-1 text-left"},l(O),1))),128))])]),e("tbody",null,[(u(!0),d(q,null,J(i.data.intelligentSummary.preview.sampleRows?.slice(0,3),(O,z)=>(u(),d("tr",{key:z,class:"text-gray-300 border-t border-gray-800"},[(u(!0),d(q,null,J(i.data.intelligentSummary.preview.headers?.slice(0,4),re=>(u(),d("td",{key:re,class:"px-2 py-1"},l(O[re]),1))),128))]))),128))])])])):j("",!0)])):j("",!0),i.data.intelligentSummary.businessInsight?(u(),d("div",Ss,[e("div",Ts,[R(A(C),{icon:"lucide:lightbulb",class:"w-4 h-4 text-green-400 mt-0.5"}),e("div",null,[t[22]||(t[22]=e("div",{class:"text-xs font-medium text-green-400 mb-1"},"BUSINESS INSIGHT",-1)),e("div",js,l(i.data.intelligentSummary.businessInsight),1)])])])):j("",!0),i.data.intelligentSummary.actions?.length>0?(u(),d("div",Es,[(u(!0),d(q,null,J(i.data.intelligentSummary.actions,O=>(u(),d("button",{key:O,onClick:z=>ye(O,i),class:"px-3 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-white rounded-md transition-colors"},l(he(O)),9,Is))),128))])):j("",!0)])):j("",!0)],2))),128))])):(u(),d("div",As,[R(A(C),{icon:"lucide:list",class:"w-12 h-12 mx-auto mb-4 opacity-50"}),t[23]||(t[23]=e("h3",{class:"text-lg font-medium mb-2"},"Process Not Yet Configured",-1)),t[24]||(t[24]=e("p",{class:"text-sm mb-2"},"This business process doesn't have steps configured for client reporting.",-1)),t[25]||(t[25]=e("div",{class:"bg-blue-400/10 border border-blue-400/20 rounded-lg p-4 mt-4 max-w-md mx-auto"},[e("h4",{class:"text-blue-400 font-medium mb-2"},"For Administrators:"),e("p",{class:"text-xs text-blue-300"}," Add 'show-1', 'show-2', etc. notes to workflow nodes to make them visible in business reporting. ")],-1))]))])]),history:K(({data:m})=>[e("div",Cs,[t[32]||(t[32]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Process Execution History",-1)),e("div",Rs,[e("div",Ns,[t[26]||(t[26]=e("div",{class:"text-xs text-text-muted mb-1"},"Total Executions",-1)),e("div",Ds,l(n.value?.kpis?.totalExecutions||0),1)]),e("div",Ps,[t[27]||(t[27]=e("div",{class:"text-xs text-text-muted mb-1"},"Success",-1)),e("div",Os,l(n.value?.kpis?.successfulExecutions||0),1)]),e("div",Ls,[t[28]||(t[28]=e("div",{class:"text-xs text-text-muted mb-1"},"Failed",-1)),e("div",Bs,l(n.value?.kpis?.failedExecutions||0),1),n.value?.kpis?.canceledExecutions>0?(u(),d("div",zs," +"+l(n.value.kpis.canceledExecutions)+" canceled ",1)):j("",!0)]),e("div",Vs,[t[29]||(t[29]=e("div",{class:"text-xs text-text-muted mb-1"},"Success Rate",-1)),e("div",{class:B(["text-xl font-bold",n.value?.kpis?.successRate>=50?"text-green-400":"text-orange-400"])},l(n.value?.kpis?.successRate||0)+"% ",3)])]),a.value.length>0?(u(),d("div",Fs,[e("table",Ms,[t[30]||(t[30]=e("thead",{class:"bg-black/20 border-b border-border"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase"},"Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase"},"Business Outcome")])],-1)),e("tbody",Us,[(u(!0),d(q,null,J(a.value.slice(0,10),i=>(u(),d("tr",{key:i.id,class:"hover:bg-surface-hover/50"},[e("td",qs,l(X(i.startedAt||i.createdAt)),1),e("td",Js,[e("span",{class:B(["px-2 py-1 text-xs rounded",i.status==="success"?"bg-green-400/20 text-green-400":i.status==="error"?"bg-red-400/20 text-red-400":"bg-yellow-400/20 text-yellow-400"])},l(i.status==="success"?"Success":i.status==="error"?"Failed":"Running"),3)]),e("td",Hs,l(i.duration?V(i.duration):"N/A"),1),e("td",Gs,l(i.status==="success"?"Process completed successfully":i.status==="error"?"Process encountered an error":"Process in progress"),1)]))),128))])])])):(u(),d("div",Ks,[R(A(C),{icon:"lucide:history",class:"w-12 h-12 mx-auto mb-4 opacity-50"}),t[31]||(t[31]=e("p",null,"No execution history available yet",-1))]))])]),analytics:K(({data:m})=>[e("div",Zs,[t[55]||(t[55]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Process Analytics",-1)),e("div",Ws,[t[42]||(t[42]=e("h4",{class:"text-md font-medium text-white mb-4"},"Performance Metrics",-1)),e("div",Xs,[e("div",Ys,[e("div",Qs,l(n.value?.kpis?.successRate||0)+"% ",1),t[33]||(t[33]=e("div",{class:"text-xs text-text-muted mt-1"},"Success Rate",-1)),n.value?.trends?.successRateTrend?(u(),d("div",{key:0,class:B(["text-xs mt-1",n.value.trends.successRateTrend>0?"text-green-400":"text-red-400"])},l(n.value.trends.successRateTrend>0?"â†‘":"â†“")+" "+l(Math.abs(n.value.trends.successRateTrend))+"% ",3)):j("",!0)]),e("div",eo,[e("div",to,l(n.value?.kpis?.avgRunTime?V(n.value.kpis.avgRunTime):"0ms"),1),t[34]||(t[34]=e("div",{class:"text-xs text-text-muted mt-1"},"Avg Response",-1)),n.value?.kpis?.minRunTime?(u(),d("div",so,l(V(n.value.kpis.minRunTime))+" - "+l(V(n.value.kpis.maxRunTime)),1)):j("",!0)]),e("div",oo,[e("div",no,l(n.value?.kpis?.efficiencyScore||0),1),t[35]||(t[35]=e("div",{class:"text-xs text-text-muted mt-1"},"Efficiency Score",-1)),t[36]||(t[36]=e("div",{class:"text-xs text-gray-500 mt-1"},"out of 100",-1))]),e("div",ro,[e("div",io,l(n.value?.kpis?.reliabilityScore||0)+"% ",1),t[37]||(t[37]=e("div",{class:"text-xs text-text-muted mt-1"},"Reliability",-1)),t[38]||(t[38]=e("div",{class:"text-xs text-gray-500 mt-1"},"last 10 runs",-1))])]),e("div",ao,[e("div",lo,[e("div",co,[t[39]||(t[39]=e("span",{class:"text-xs text-text-muted"},"Total Runs",-1)),e("span",uo,l(n.value?.kpis?.totalExecutions||0),1)])]),e("div",mo,[e("div",po,[t[40]||(t[40]=e("span",{class:"text-xs text-text-muted"},"Data Processed",-1)),e("span",go,l(n.value?.kpis?.totalDataProcessed||0),1)])]),e("div",fo,[e("div",xo,[t[41]||(t[41]=e("span",{class:"text-xs text-text-muted"},"Automation Impact",-1)),e("span",ho,l(n.value?.kpis?.automationImpact||0),1)])])])]),e("div",bo,[t[48]||(t[48]=e("h4",{class:"text-md font-medium text-white mb-4"},"Activity Patterns",-1)),e("div",yo,[e("div",vo,[e("div",_o,l(n.value?.kpis?.last24hExecutions||0),1),t[43]||(t[43]=e("div",{class:"text-xs text-text-muted"},"Last 24h",-1))]),e("div",wo,[e("div",ko,l(n.value?.kpis?.last7dExecutions||0),1),t[44]||(t[44]=e("div",{class:"text-xs text-text-muted"},"Last 7 days",-1))]),e("div",$o,[e("div",So,l(n.value?.kpis?.avgExecutionsPerDay||0),1),t[45]||(t[45]=e("div",{class:"text-xs text-text-muted"},"Daily Average",-1))]),e("div",To,[e("div",jo,l(n.value?.kpis?.peakHour!==null?`${n.value.kpis.peakHour}:00`:"N/A"),1),t[46]||(t[46]=e("div",{class:"text-xs text-text-muted"},"Peak Hour",-1))])]),n.value?.trends?.volumeTrend!==void 0?(u(),d("div",Eo,[e("div",Io,[t[47]||(t[47]=e("span",{class:"text-sm text-text-muted"},"Volume Trend",-1)),e("span",{class:B(["text-sm font-bold",n.value.trends.volumeTrend>0?"text-green-400":"text-orange-400"])},l(n.value.trends.volumeTrend>0?"â†‘":n.value.trends.volumeTrend<0?"â†“":"â†’")+" "+l(Math.abs(n.value.trends.volumeTrend))+"% vs previous period ",3)])])):j("",!0)]),e("div",Ao,[t[53]||(t[53]=e("h4",{class:"text-md font-medium text-white mb-3"},"Business Insights",-1)),e("ul",Co,[n.value?.kpis?.totalExecutions?(u(),d("li",Ro,[R(A(C),{icon:"lucide:activity",class:"w-5 h-5 text-green-400 mt-0.5"}),e("div",null,[t[49]||(t[49]=e("div",{class:"text-sm text-white"},"Process Activity",-1)),e("div",No,l(n.value.kpis.totalExecutions)+" total executions recorded",1)])])):j("",!0),n.value?.kpis?.successRate?(u(),d("li",Do,[R(A(C),{icon:"lucide:check-circle",class:"w-5 h-5 text-blue-400 mt-0.5"}),e("div",null,[t[50]||(t[50]=e("div",{class:"text-sm text-white"},"Reliability Score",-1)),e("div",Po,l(n.value.kpis.successRate)+"% success rate maintained",1)])])):j("",!0),n.value?.kpis?.avgRunTime?(u(),d("li",Oo,[R(A(C),{icon:"lucide:clock",class:"w-5 h-5 text-purple-400 mt-0.5"}),e("div",null,[t[51]||(t[51]=e("div",{class:"text-sm text-white"},"Performance Baseline",-1)),e("div",Lo,"Average completion time: "+l(V(n.value.kpis.avgRunTime)),1)])])):j("",!0),a.value.length>0?(u(),d("li",Bo,[R(A(C),{icon:"lucide:trending-up",class:"w-5 h-5 text-green-400 mt-0.5"}),e("div",null,[t[52]||(t[52]=e("div",{class:"text-sm text-white"},"Recent Performance",-1)),e("div",zo," Last "+l(Math.min(a.value.length,10))+" executions: "+l(Math.round(a.value.slice(0,10).filter(i=>i.status==="success").length/Math.min(a.value.length,10)*100))+"% success rate ",1)])])):j("",!0)])]),e("div",Vo,[t[54]||(t[54]=e("h4",{class:"text-md font-medium text-white mb-3"},"Recommendations",-1)),e("ul",Fo,[n.value?.kpis?.successRate&&n.value.kpis.successRate<95?(u(),d("li",Mo," â€¢ Success rate is "+l(n.value.kpis.successRate)+"% - investigate failed executions for improvement opportunities ",1)):j("",!0),n.value?.kpis?.avgRunTime&&n.value.kpis.avgRunTime>1e4?(u(),d("li",Uo," â€¢ Average runtime exceeds 10 seconds - consider optimizing process steps or enabling parallel execution ")):j("",!0),a.value.filter(i=>i.status==="error").length>0?(u(),d("li",qo," â€¢ "+l(a.value.filter(i=>i.status==="error").length)+" failed executions detected - review error patterns for resolution ",1)):j("",!0),!n.value?.kpis?.totalExecutions||n.value.kpis.totalExecutions===0?(u(),d("li",Jo," â€¢ No execution data available - run the process to collect performance metrics ")):n.value?.kpis?.successRate>=95?(u(),d("li",Ho," â€¢ Excellent performance maintained - consider expanding process capabilities ")):j("",!0)])])])]),raw:K(({data:m})=>[e("div",Go,[e("div",Ko,[e("div",Zo,[R(A(C),{icon:"lucide:code",class:"w-5 h-5 text-gray-400 mr-2"}),t[56]||(t[56]=e("h3",{class:"text-lg font-medium text-white"},"Raw Timeline Data",-1))]),e("div",Wo,[e("button",{onClick:ee,class:"flex items-center px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm transition-colors"},[R(A(C),{icon:"lucide:file-text",class:"w-4 h-4 mr-1.5"}),t[57]||(t[57]=Q(" Generate Report ",-1))]),e("button",{onClick:Y,class:"flex items-center px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm transition-colors"},[R(A(C),{icon:"lucide:code",class:"w-4 h-4 mr-1.5"}),t[58]||(t[58]=Q(" Show JSON ",-1))])])]),e("pre",Xo,l(m?JSON.stringify(m,null,2).replace(/n8n/gi,"WFEngine").replace(/\.nodes\./g,".engine.").replace(/\.base\./g,".core."):"No data available"),1)])]),_:1},8,["show","subtitle","is-loading","error","data"]))}});export{Qe as D,sn as _};
//# sourceMappingURL=TimelineModal.vue_vue_type_script_setup_true_lang-DxZyMRCV.js.map
